{"version":3,"sources":["../node_modules/monaco-editor/esm/vs/language/typescript/monaco.contribution.js","../node_modules/monaco-editor/esm/vs/language/typescript/lib/typescriptServicesMetadata.js","../node_modules/monaco-editor/esm/vs/language/css/monaco.contribution.js","../node_modules/monaco-editor/esm/vs/language/json/monaco.contribution.js","../node_modules/monaco-editor/esm/vs/language/html/monaco.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/_.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/abap/abap.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/apex/apex.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/azcli/azcli.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/bat/bat.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/cameligo/cameligo.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/clojure/clojure.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/coffee/coffee.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/cpp/cpp.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/csharp/csharp.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/csp/csp.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/css/css.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/dockerfile/dockerfile.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/fsharp/fsharp.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/go/go.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/graphql/graphql.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/handlebars/handlebars.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/html/html.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/ini/ini.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/java/java.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/javascript/javascript.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/kotlin/kotlin.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/less/less.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/lua/lua.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/markdown/markdown.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/mips/mips.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/msdax/msdax.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/mysql/mysql.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/objective-c/objective-c.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/pascal/pascal.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/pascaligo/pascaligo.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/perl/perl.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/pgsql/pgsql.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/php/php.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/postiats/postiats.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/powerquery/powerquery.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/powershell/powershell.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/pug/pug.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/python/python.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/r/r.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/razor/razor.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/redis/redis.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/redshift/redshift.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/restructuredtext/restructuredtext.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/ruby/ruby.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/rust/rust.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/sb/sb.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/scheme/scheme.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/scss/scss.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/shell/shell.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/solidity/solidity.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/sophia/sophia.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/sql/sql.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/st/st.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/swift/swift.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/tcl/tcl.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/twig/twig.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/typescript/typescript.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/vb/vb.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/xml/xml.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/yaml/yaml.contribution.js","../node_modules/monaco-editor/esm/vs/editor/contrib/bracketMatching/bracketMatching.js","../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/moveCaretCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/caretOperations.js","../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/transpose.js","../node_modules/monaco-editor/esm/vs/editor/contrib/clipboard/clipboard.js","../node_modules/monaco-editor/esm/vs/base/common/lazy.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/types.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeAction.js","../node_modules/monaco-editor/esm/vs/editor/contrib/message/messageController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/lightBulbWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionMenu.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionUi.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionCommands.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionContributions.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/codelens.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/codiconLabel/codiconLabel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/codelensWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/codeLensCache.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/codelensController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/color.js","../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/colorDetector.js","../node_modules/monaco-editor/esm/vs/editor/contrib/comment/blockCommentCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/comment/lineCommentCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/comment/comment.js","../node_modules/monaco-editor/esm/vs/base/browser/contextmenu.js","../node_modules/monaco-editor/esm/vs/editor/contrib/contextmenu/contextmenu.js","../node_modules/monaco-editor/esm/vs/editor/contrib/cursorUndo/cursorUndo.js","../node_modules/monaco-editor/esm/vs/editor/contrib/dnd/dragAndDropCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/dnd/dnd.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findDecorations.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/replaceAllCommand.js","../node_modules/monaco-editor/esm/vs/base/common/search.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/replacePattern.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findModel.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/checkbox/checkbox.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/findInputCheckboxes.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findOptionsWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findState.js","../node_modules/monaco-editor/esm/vs/base/browser/formattedTextRenderer.js","../node_modules/monaco-editor/esm/vs/base/common/history.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/inputbox/inputBox.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/findInput.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/replaceInput.js","../node_modules/monaco-editor/esm/vs/platform/browser/contextScopedHistoryWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/foldingRanges.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/foldingModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/foldingDecorations.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/hiddenRangeModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/indentRangeProvider.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/syntaxRangeProvider.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/intializingRangeProvider.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/folding.js","../node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/fontZoom.js","../node_modules/monaco-editor/esm/vs/editor/contrib/format/formattingEdit.js","../node_modules/monaco-editor/esm/vs/platform/extensions/common/extensions.js","../node_modules/monaco-editor/esm/vs/editor/contrib/format/format.js","../node_modules/monaco-editor/esm/vs/editor/contrib/format/formatActions.js","../node_modules/monaco-editor/esm/vs/editor/contrib/peekView/peekView.js","../node_modules/monaco-editor/esm/vs/editor/browser/widget/embeddedCodeEditorWidget.js","../node_modules/monaco-editor/esm/vs/base/common/idGenerator.js","../node_modules/monaco-editor/esm/vs/editor/contrib/zoneWidget/zoneWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/referencesModel.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/highlightedlabel/highlightedLabel.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/iconLabel/iconLabel.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/countBadge/countBadge.js","../node_modules/monaco-editor/esm/vs/base/common/labels.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/splitview/splitview.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesTree.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/goToSymbol.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/symbolNavigation.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/goToCommands.js","../node_modules/monaco-editor/esm/vs/base/common/htmlContent.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/link/clickLinkGesture.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/link/goToDefinitionAtPosition.js","../node_modules/monaco-editor/esm/vs/platform/severityIcon/common/severityIcon.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoErrorWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoError.js","../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/colorPickerModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/colorPickerWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/getHover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/hoverOperation.js","../node_modules/monaco-editor/esm/vs/base/common/marked/marked.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/hoverWidgets.js","../node_modules/monaco-editor/esm/vs/base/common/insane/insane.js","../node_modules/monaco-editor/esm/vs/base/browser/markdownRenderer.js","../node_modules/monaco-editor/esm/vs/editor/contrib/markdown/markdownRenderer.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/modesContentHover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/modesGlyphHover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/hover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/inPlaceReplaceCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/inPlaceReplace.js","../node_modules/monaco-editor/esm/vs/editor/common/commands/trimTrailingWhitespaceCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/copyLinesCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/indentUtils.js","../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/moveLinesCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/sortLinesCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/linesOperations.js","../node_modules/monaco-editor/esm/vs/editor/contrib/links/getLinks.js","../node_modules/monaco-editor/esm/vs/editor/contrib/links/links.js","../node_modules/monaco-editor/esm/vs/editor/contrib/multicursor/multicursor.js","../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/provideSignatureHelp.js","../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHintsModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHintsWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHints.js","../node_modules/monaco-editor/esm/vs/editor/contrib/rename/renameInputField.js","../node_modules/monaco-editor/esm/vs/editor/contrib/rename/rename.js","../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/wordSelections.js","../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/bracketSelections.js","../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/smartSelect.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggest.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetParser.js","../node_modules/monaco-editor/esm/vs/platform/workspaces/common/workspaces.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetVariables.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetSession.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetController2.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestMemory.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestAlternatives.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/completionModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/wordDistance.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/outlineTree.js","../node_modules/monaco-editor/esm/vs/platform/files/common/files.js","../node_modules/monaco-editor/esm/vs/editor/common/services/getIconClasses.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/wordContextKey.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestCommitCharacters.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestRangeHighlighter.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/tokenization/tokenization.js","../node_modules/monaco-editor/esm/vs/editor/contrib/toggleTabFocusMode/toggleTabFocusMode.js","../node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/wordHighlighter.js","../node_modules/monaco-editor/esm/vs/editor/contrib/wordOperations/wordOperations.js","../node_modules/monaco-editor/esm/vs/editor/contrib/wordPartOperations/wordPartOperations.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/accessibilityHelp/accessibilityHelp.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/iPadShowKeyboard/iPadShowKeyboard.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/inspectTokens/inspectTokens.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/keybindingLabel/keybindingLabel.js","../node_modules/monaco-editor/esm/vs/base/parts/quickopen/browser/quickOpenModel.js","../node_modules/monaco-editor/esm/vs/base/parts/quickopen/browser/quickOpenViewer.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeDefaults.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeModel.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeDnd.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeViewModel.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/tree.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeView.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeImpl.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/progressbar/progressbar.js","../node_modules/monaco-editor/esm/vs/base/parts/quickopen/browser/quickOpenWidget.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickOpen/quickOpenEditorWidget.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickOpen/editorQuickOpen.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickOpen/gotoLine.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickOpen/quickCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/outlineModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/quickOpen/quickOpen.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickOpen/quickOutline.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/referenceSearch/standaloneReferenceSearch.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/toggleHighContrast/toggleHighContrast.js","../node_modules/monaco-editor/esm/vs/editor/editor.main.js"],"names":["ModuleKind","JsxEmit","NewLineKind","ScriptTarget","ModuleResolutionKind","Emitter","monaco","LanguageServiceDefaultsImpl","compilerOptions","diagnosticsOptions","this","_onDidChange","_onDidExtraLibsChange","_extraLibs","Object","create","_eagerModelSync","setCompilerOptions","setDiagnosticsOptions","_onDidExtraLibsChangeTimeout","defineProperty","prototype","get","event","enumerable","configurable","getExtraLibs","addExtraLib","content","_filePath","filePath","_this","Math","random","toString","substring","dispose","myVersion","version","_fireOnDidExtraLibsChangeSoon","extraLib","setExtraLibs","libs","length","_i","libs_1","lib","setTimeout","fire","undefined","getCompilerOptions","_compilerOptions","options","getDiagnosticsOptions","_diagnosticsOptions","setMaximumWorkerIdleTime","value","setEagerModelSync","getEagerModelSync","typescriptDefaults","allowNonTsExtensions","target","Latest","noSemanticValidation","noSyntaxValidation","javascriptDefaults","allowJs","getTypeScriptWorker","getMode","then","mode","getJavaScriptWorker","languages","typescript","typescriptVersion","onLanguage","setupTypeScript","setupJavaScript","languageId","modeConfiguration","_languageId","setModeConfiguration","_modeConfiguration","diagnosticDefault","validate","lint","compatibleVendorPrefixes","vendorPrefix","duplicateProperties","emptyRules","importStatement","boxModel","universalSelector","zeroUnits","fontFaceProperties","hexColorLength","argumentsInColorFunction","unknownProperties","ieHack","unknownVendorSpecificProperties","propertyIgnoredDueToDisplay","important","float","idSelector","modeConfigurationDefault","completionItems","hovers","documentSymbols","definitions","references","documentHighlights","rename","colors","foldingRanges","diagnostics","selectionRanges","cssDefaults","scssDefaults","lessDefaults","css","setupMode","jsonDefaults","allowComments","schemas","enableSchemaRequest","documentFormattingEdits","documentRangeFormattingEdits","tokens","json","register","id","extensions","aliases","mimetypes","setOptions","_options","formatDefaults","tabSize","insertSpaces","wrapLineLength","unformatted","contentUnformatted","indentInnerHtml","preserveNewLines","maxPreserveNewLines","indentHandlebars","endWithNewline","extraLiners","wrapAttributes","handlebarOptionsDefault","format","suggest","html5","razorOptionsDefault","razor","getConfigurationDefault","links","htmlLanguageId","htmlDefaults","angular1","ionic","handlebarDefaults","razorDefaults","html","_monaco","self","languageDefinitions","lazyLanguageLoaders","LazyLanguageLoader","_loadingTriggered","_lazyLoadPromise","Promise","resolve","reject","_lazyLoadPromiseResolve","_lazyLoadPromiseReject","getOrCreate","whenLoaded","load","loader","mod","err","registerLanguage","def","lazyLanguageLoader","setMonarchTokensProvider","language","setLanguageConfiguration","conf","filenames","firstLine","__extends","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","overviewRulerBracketMatchForeground","registerColor","dark","light","hc","nls","JumpToBracketAction","_super","call","label","alias","precondition","kbOpts","kbExpr","EditorContextKeys","editorTextFocus","primary","weight","run","accessor","editor","controller","BracketMatchingController","jumpToBracket","EditorAction","SelectToBracketAction","description","args","name","schema","type","properties","default","selectBrackets","selectToBracket","BracketsData","position","brackets","_editor","_lastBracketsData","_lastVersionId","_decorations","_updateBracketsSoon","_register","RunOnceScheduler","_updateBrackets","_matchBrackets","getOption","schedule","onDidChangeCursorPosition","e","onDidChangeModelContent","onDidChangeModel","onDidChangeModelLanguageConfiguration","onDidChangeConfiguration","hasChanged","deltaDecorations","getContribution","ID","hasModel","model","getModel","newSelections","getSelections","map","selection","getStartPosition","matchBracket","newCursorPosition","containsPosition","enclosingBrackets","findEnclosingBrackets","nextBracket","findNextBracket","range","Selection","lineNumber","column","setSelections","revealRange","forEach","selectFrom","selectTo","sort","Range","compareRangesUsingStarts","open_1","close_1","getEndPosition","push","_recomputeBrackets","newDecorations","newDecorationsLen","_a","bracketData","selections","versionId","getVersionId","previousData","positions","positionsLen","i","len","isEmpty","Position","compare","newData","newDataLen","previousIndex","previousLen","isBefore","equals","_DECORATION_OPTIONS_WITH_OVERVIEW_RULER","_DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER","ModelDecorationOptions","stickiness","className","overviewRuler","color","themeColorFromId","OverviewRulerLane","Center","Disposable","registerEditorContribution","registerEditorAction","registerThemingParticipant","theme","collector","bracketMatchBackground","getColor","editorBracketMatchBackground","addRule","bracketMatchBorder","editorBracketMatchBorder","MenuRegistry","appendMenuItem","group","command","title","key","comment","order","MoveCaretCommand","isMovingLeft","_selection","_isMovingLeft","_cutStartIndex","_cutEndIndex","_moved","_selectionId","getEditOperations","builder","s","trackSelection","startLineNumber","endLineNumber","startColumn","endColumn","getLineMaxColumn","left","middle","right","selectionStartLineNumber","lineContent","getLineContent","newLineContent","addEditOperation","computeCursorState","helper","result","getTrackedSelection","setStartPosition","setEndPosition","MoveCaretAction","opts","commands","selections_1","pushUndoStop","executeCommands","MoveCaretLeftAction","writable","MoveCaretRightAction","TransposeLettersAction","textInputFocus","mac","lastColumn","endPosition","getPosition","MoveOperations","rightPosition","middlePosition","leftPosition","beginPosition","leftChar","getValueInRange","fromPositions","rightChar","replaceRange","ReplaceCommand","supportsCut","platform","document","queryCommandSupported","supportsCopy","supportsCopyWithSyntaxHighlighting","browser","supportsPaste","ExecCommandAction","browserCommand","runCommand","focusedEditor","ICodeEditorService","getFocusedCodeEditor","hasTextFocus","trigger","execCommand","focus","ExecCommandCutAction","win","secondary","contextMenuOpts","menuOpts","menuId","getSelection","ExecCommandCopyAction","ExecCommandPasteAction","ExecCommandCopyWithSyntaxHighlightingAction","CopyOptions","forceCopyWithSyntaxHighlighting","Lazy","executor","_didRun","getValue","_value","_error","CodeActionKind","other","contains","startsWith","sep","intersects","append","part","None","Empty","QuickFix","Refactor","Source","SourceOrganizeImports","SourceFixAll","CodeActionCommandArgs","kind","apply","preferred","fromUser","arg","defaults","getKindFromUser","getApplyFromUser","getPreferredUser","defaultAutoApply","toLowerCase","defaultKind","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","rejected","done","__generator","body","f","y","t","g","_","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","pop","__spreadArrays","il","arguments","r","k","a","j","jl","ManagedCodeActionSet","actions","disposables","allActions","mergeSort","codeActionsComparator","validActions","filter","action","disabled","isNonEmptyArray","message","localeCompare","some","fix","isPreferred","getCodeActions","rangeOrSelection","token","codeActionContext","only","include","cts","TextModelCancellationTokenSource","providers","CodeActionProviderRegistry","all","provider","providedCodeActionKinds","providedKind","includeSourceActions","mayIncludeActionsOfKind","getCodeActionProviders","DisposableStore","promises","providedCodeActions","err_1","provideCodeActions","isCancellationRequested","add","actionKind","excludes","exclude","onlyIncludePreferredActions","filtersAction","isPromiseCanceledError","onUnexpectedExternalError","listener","onDidChange","newProviders","cancel","flatten","finally","registerLanguageCommand","resource","validatedRangeOrSelection","codeActionSet","URI","illegalArgument","IModelService","isISelection","liftSelection","isIRange","validateRange","CancellationToken","__decorate","decorators","desc","c","getOwnPropertyDescriptor","Reflect","decorate","__param","paramIndex","decorator","MessageController","contextKeyService","closeTimeout","_messageWidget","MutableDisposable","_messageListeners","_visible","MESSAGE_VISIBLE","bindTo","onDidAttemptReadOnlyEdit","_onDidAttemptReadOnlyEdit","reset","showMessage","bounds","alert","set","clear","MessageWidget","onDidBlurEditorText","closeMessage","onDidDispose","TimeoutTimer","onMouseMove","fadeOut","RawContextKey","IContextKeyService","MessageCommand","EditorCommand","bindToContribution","registerEditorCommand","handler","text","allowEditorOverflow","suppressMouseDown","revealLinesInCenterIfOutsideViewport","_position","_domNode","createElement","classList","textContent","appendChild","anchor","addContentWidget","messageWidget","handle","clearTimeout","getDomNode","removeEventListener","addEventListener","removeContentWidget","getId","preference","border","inputValidationInfoBorder","borderWidth","HIGH_CONTRAST","background","inputValidationInfoBackground","foreground","inputValidationInfoForeground","LightBulbState","__assign","assign","CodeActionAction","callback","Action","CodeActionMenu","_delegate","_contextMenuService","keybindingService","_showingActions","_keybindingResolver","CodeActionKeybindingResolver","getKeybindings","show","codeActions","at","actionsToShow","menuActions","resolver","includeDisabledActions","canceled","onSelectCodeAction","isIPosition","_toCoords","x","getResolver","showContextMenu","getAnchor","getActions","onHide","autoSelectFirstItem","getKeyBinding","revealPosition","render","cursorCoords","getScrolledVisiblePosition","editorCoords","getDomNodePagePosition","top","height","IContextMenuService","IKeybindingService","_keybindingProvider","allCodeActionBindings","item","codeActionCommands","indexOf","resolvedKeybinding","commandArgs","bestKeybindingForCodeAction","candidates","candidate","reduceRight","currentBest","Hidden","Showing","editorPosition","widgetPosition","LightBulbWidget","_quickFixActionId","_preferredFixActionId","_keybindingService","_onClick","onClick","_state","editorModel","state","getLineCount","hide","Gesture","ignoreTarget","dom","preventDefault","lineHeight","pad","floor","posx","buttons","monitor","GlobalMouseMoveMonitor","startMonitoring","standardMouseMoveMerger","enabled","_updateLightBulbTitle","onDidUpdateKeybindings","update","atPosition","getOptions","fontInfo","indent","TextModel","computeIndentLevel","isFolded","getTopForLineNumber","effectiveLineNumber","spaceWidth","_posPref","hasAutoFix","layoutContentWidget","preferredKb","lookupKeybinding","getLabel","kb","editorLightBulbForegroundColor","editorLightBulbForeground","editorLightBulbAutoFixForegroundColor","editorLightBulbAutoFixForeground","CodeActionsState","CodeActionUi","quickFixActionId","preferredFixActionId","delegate","instantiationService","_activeCodeActions","_codeActionWidget","createInstance","applyCodeAction","_lightBulbWidget","widget","showCodeActionList","newState","_b","_c","e_1","validActionToApply","invalidAction","_d","rawValue","onUnexpectedError","tryGetValidActionToApply","context","getInvalidActionThatWouldHaveBeenApplied","notAvailableMessage","isVisible","autoApply","find","IInstantiationService","SUPPORTED_CODE_ACTIONS","CodeActionOracle","_markerService","_signalChange","_delay","_autoTriggerTimer","onMarkerChanged","_onMarkerChanges","_onCursorChange","_getRangeOfSelectionUnlessWhitespaceEnclosed","_createEventAndSignalChange","resources","isEqual","uri","cancelAndSet","_getRangeOfMarker","read","marker","markerRange","intersectRanges","lift","line","test","Triggered","CodeActionModel","_progressService","_codeActionOracle","_onDidChangeState","onDidChangeState","_supportedCodeActions","_update","onDidChangeModelLanguage","setState","has","supportedActions","isArray","join","createCancelablePromise","showWhile","skipNotify","contextKeyForSupportedActions","ContextKeyExpr","regex","keys","RegExp","escapeRegExpCharacters","argsSchema","required","defaultSnippets","enum","enumDescriptions","QuickFixController","markerService","progressService","contextMenuService","_commandService","_bulkEditService","_instantiationService","_model","_ui","QuickFixAction","Id","AutoFixAction","retrigger","_applyCodeAction","_trigger","showCodeActions","manualTriggerAtCurrentPosition","triggerPosition","invokeFunction","IMarkerService","IEditorProgressService","ICommandService","IBulkEditService","bulkEditService","commandService","notificationService","INotificationService","edit","executeCommand","Error","error","triggerCodeActionsForEditorSelection","and","hasCodeActionsProvider","_accessor","CodeActionCommand","runEditorCommand","userArgs","RefactorAction","when","SourceAction","OrganizeImportsAction","FixAllAction","CodeLensModel","lenses","_disposables","list","symbol","getCodeLensData","CodeLensProviderRegistry","ordered","providerRanks","Map","provideCodeLenses","catch","itemResolveCount","_loop_1","Boolean","resolveCodeLens","renderCodicons","escape","replace","_match","_g1","_g3","animation","CodeLensViewZone","afterLineNumber","onHeight","_onHeight","heightInLines","domNode","onComputedHeight","_lastHeight","CodeLensContentWidget","_commands","_isEmpty","_id","_idPool","updatePosition","withCommands","animate","innerHtml","hasSymbol","lens","String","innerHTML","getCommand","link","parentElement","getLineFirstNonWhitespaceColumn","_widgetPosition","CodeLensHelper","_removeDecorations","_addDecorations","_addDecorationsCallbacks","addDecoration","decoration","removeDecoration","decorationId","commit","changeAccessor","resultingDecorations","CodeLensWidget","data","viewZoneChangeAccessor","updateCallback","_isDisposed","_className","_data","_decorationIds","codeLensData","EMPTY","plusRange","_viewZone","_viewZoneId","addZone","_createContentWidgetIfNecessary","_contentWidget","removeZone","isDisposed","isValid","getDecorationRange","updateCodeLensSymbols","computeIfNecessary","hasAttribute","updateCommands","symbols","resolved","getLineNumber","layoutZone","codeLensForeground","editorCodeLensForeground","activeLinkForeground","editorActiveLinkForeground","ICodeLensCache","createDecorator","CacheItem","lineCount","CodeLensCache","storageService","_fakeProvider","class_1","_cache","LRUCache","runWhenIdle","remove","raw","_deserialize","once","onWillSaveState","reason","WillSaveStateReason","SHUTDOWN","store","_serialize","put","copyItems","copyModel","delete","lines","Set","values","JSON","stringify","parse","element","IStorageService","registerSingleton","CodeLensContribution","_notificationService","_codeLensCache","_globalToDispose","_localToDispose","_lenses","_oldCodeLensModels","_modelChangeCounter","_isEnabled","_onModelChange","prevIsEnabled","_updateLensStyle","_styleClassName","hash","_styleElement","createStyleSheet","_localDispose","_currentCodeLensModel","newStyle","round","fontSize","_currentFindCodeLensSymbolsPromise","_currentResolveCodeLensSymbolsPromise","cachedLenses","_renderCodeLensSymbols","registration","scheduler","detectVisibleLenses","_detectVisibleLenses","_onViewportChanged","counterValue","changeDecorations","decorationsAccessor","changeViewZones","viewZonesAccessor","toDispose","lastLensLineNumber","l","splice","onDidScrollChange","scrollTopChanged","onDidLayoutChange","toDisposable","scrollState","StableEditorScrollState","capture","_disposeAllLenses","restore","onMouseUp","tagName","disposableTimeout","cachedLensesNow","decChangeAccessor","lastGroup","maxLineNumber","groups","viewZoneAccessor","codeLensIndex","groupsIndex","symbolsLineNumber","codeLensLineNumber","toResolve","request","resolvePromise","resolvedSymbols","getColorPresentations","colorInfo","provideColorPresentations","rawCIs","ColorProviderRegistry","reverse","provideDocumentColors","result_2","ci","red","green","blue","alpha","presentations","ColorDetector","_codeEditorService","_configurationService","_decorationsIds","_colorDatas","_colorDecoratorIds","_decorationsTypes","isEnabled","onModelChanged","removeAllDecorations","_timeoutTimer","_computePromise","getLanguageIdentifier","deprecatedConfig","colorDecorators","stop","beginCompute","RECOMPUTE_TIME","result_1","getColors","colorInfos","updateDecorations","updateColorDecorators","colorDatas","decorations","colorData","newDecorationsTypes","rgba","RGBA","subKey","registerDecorationType","before","contentText","margin","width","backgroundColor","resolveDecorationOptions","subType","removeDecorationType","getColorData","getDecorationsInRange","IConfigurationService","BlockCommentCommand","_usedEndToken","_haystackHasNeedleAtOffset","haystack","needle","offset","needleLength","codeA","charCodeAt","codeB","_createOperationsForBlockComment","startToken","endToken","startLineText","endLineText","startTokenIndex","lastIndexOf","endTokenIndex","startLineAfterStartToken","endLineBeforeEndToken","_createRemoveBlockCommentOperations","_createAddBlockCommentOperations","ops_1","addTrackedEditOperation","res","EditOperation","insert","tokenizeIfCheap","getLanguageIdAtPosition","config","LanguageConfigurationRegistry","getComments","blockCommentStartToken","blockCommentEndToken","inverseEditOperations","getInverseEditOperations","startTokenEditOperation","endTokenEditOperation","srcRange","deltaColumn","LineCommentCommand","_tabSize","_type","_deltaColumn","_moveEndPositionDown","_gatherPreflightCommentStrings","commentStr","lineCommentToken","ignore","commentStrOffset","commentStrLength","_analyzeLines","shouldRemoveComments","onlyWhitespaceLines","lineData","lineContentStartOffset","strings","commentStrEndOffset","supported","_gatherPreflightData","_executeLineComments","_createRemoveLineCommentsOperations","_normalizeInsertionPoint","_createAddLineCommentsOperations","cursorPosition","positionLineNumber","positionColumn","_attemptRemoveBlockComment","startTokenAllowedBeforeColumn","max","_executeBlockComment","firstNonWhitespaceIndex","selectionStartColumn","nextVisibleColumn","currentVisibleColumn","isTab","columnSize","lenJ","minVisibleColumn","j_1","lenJ_1","CommentLineAction","ToggleCommentLineAction","AddLineCommentAction","KeyChord","RemoveLineCommentAction","BlockCommentAction","linux","selections_2","ContextSubMenu","entries","SubmenuAction","ContextMenuController","_contextViewService","_contextKeyService","_menuService","_toDispose","_contextMenuIsBeingShownCount","onContextMenu","_onContextMenu","onMouseWheel","hideContextView","onKeyDown","keyCode","stopPropagation","setPosition","hasSelectionAtPosition","posy","_getMenuActions","_doShowContextMenu","menu","createMenu","groups_1","addedItems","actions_1","SubmenuItemAction","subActions","submenu","Separator","oldHoverSetting","updateOptions","hover","getActionViewItem","keybinding","_keybindingFor","ActionViewItem","isMenu","customActionViewItem","icon","wasCancelled","IContextViewService","IMenuService","ShowContextMenu","CursorState","thisLen","equalsSelection","CursorUndoRedoController","_isCursorUndoRedo","_undoStack","_redoStack","onDidChangeCursorSelection","oldSelections","oldModelVersionId","modelVersionId","prevState","shift","cursorUndo","_applyState","cursorRedo","revealRangeInCenterIfOutsideViewport","CursorUndo","CursorRedo","DragAndDropCommand","targetPosition","copy","targetSelection","hasTriggerModifier","isMacintosh","altKey","ctrlKey","DragAndDropController","onMouseDown","_onEditorMouseDown","_onEditorMouseUp","onMouseDrag","_onEditorMouseDrag","onMouseDrop","_onEditorMouseDrop","onEditorKeyDown","onKeyUp","onEditorKeyUp","onDidBlurEditorWidget","onEditorBlur","_dndDecorationIds","_mouseDown","_modifierPressed","_dragSelection","_removeDecoration","mouseStyle","TRIGGER_KEY_VALUE","mouseEvent","possibleSelections","showAt","_hitContent","_hitMargin","newCursorPosition_1","shiftKey","primarySelection","_DECORATION_OPTIONS","FindDecorations","_overviewRulerApproximateDecorations","_findScopeDecorationId","_rangeHighlightDecorationId","_highlightedDecorationId","_startPosition","_allDecorations","getCount","getFindScope","newStartPosition","setCurrentFindMatch","_getDecorationIndex","index","getCurrentMatchesPosition","desiredRange","candidates_1","candidateOpts","_FIND_MATCH_DECORATION","_CURRENT_FIND_MATCH_DECORATION","nextMatch","newCurrentDecorationId","matchPosition","equalsRange","changeDecorationOptions","rng","lineBeforeEnd","lineBeforeEndMaxColumn","_RANGE_HIGHLIGHT_DECORATION","findMatches","findScope","findMatchesOptions","newOverviewRulerApproximateDecorations","_FIND_MATCH_NO_OVERVIEW_DECORATION","approxPixelsPerLine","getLayoutInfo","mergeLinesDelta","ceil","prevStartLineNumber","prevEndLineNumber","_FIND_MATCH_ONLY_OVERVIEW_DECORATION","newFindMatchesDecorations","_FIND_SCOPE_DECORATION","matchBeforePosition","matchAfterPosition","concat","zIndex","showIfCollapsed","overviewRulerFindMatchForeground","minimap","minimapFindMatch","MinimapPosition","Inline","isWholeLine","ReplaceAllCommand","editorSelection","ranges","replaceStrings","_editorSelection","_ranges","_replaceStrings","_trackedEditorSelectionId","o1","o2","resultOps","previousOp","resultOps_1","buildReplaceStringWithCasePreserved","matches","pattern","containsHyphens","validateSpecificSpecialCharacter","containsUnderscores","buildReplaceStringForSpecificSpecialCharacter","toUpperCase","substr","specialCharacter","split","splitPatternAtSpecialCharacter","splitMatchAtSpecialCharacter","replaceString","splitValue","slice","StaticValueReplacePattern","staticValue","DynamicPiecesReplacePattern","pieces","ReplacePattern","fromStaticValue","ReplacePiece","buildReplaceString","preserveCase","piece","_substitute","matchIndex","remainder","ReplacePieceBuilder","source","_source","_lastCharIndex","_result","_resultLen","_currentStaticPiece","emitUnchanged","toCharIndex","_emitStatic","emitStatic","emitMatchIndex","finalize","CONTEXT_FIND_WIDGET_VISIBLE","CONTEXT_FIND_INPUT_FOCUSED","CONTEXT_REPLACE_INPUT_FOCUSED","ToggleCaseSensitiveKeybinding","ToggleWholeWordKeybinding","ToggleRegexKeybinding","ToggleSearchScopeKeybinding","FIND_IDS","FindModelBoundToEditorModel","_startSearchingTimer","_updateDecorationsScheduler","research","_ignoreModelContentChanged","isFlush","onFindReplaceStateChange","_onStateChanged","searchScope","searchString","isReplaceRevealed","isRegex","wholeWord","matchCase","isTooLargeForSyncing","setIfNotSet","moveCursor","_getSearchRange","getFullModelRange","newFindScope","_findMatches","changeMatchInfo","_moveToNextMatch","_hasMatches","matchesCount","_cannotFind","_setCurrentFindMatch","match","matchesPosition","setSelection","_prevSearchPosition","isUsingLineStops","_moveToPrevMatch","isRecursed","prevMatchRange","searchRange","prevMatch","findPreviousMatch","containsRange","moveToPrevMatch","_nextSearchPosition","after","nextMatchRange","_getNextMatch","captureMatches","forceMove","findNextMatch","moveToNextMatch","_getReplacePattern","chCode","nextChCode","nextNextChCode","parseReplaceString","replacePattern","_executeEditorCommand","limitResultCount","replaceAll","_largeReplaceAll","_regularReplaceAll","searchData","SearchParams","parseSearchRequest","searchRegex","multiline","ignoreCase","global","resultText","modelText","fullModelRange","hasReplacementPatterns","ReplaceCommandThatPreservesSelection","m","selectAllMatches","defaultOpts","inputActiveOptionBorder","Color","fromHex","inputActiveOptionBackground","Checkbox","_onChange","onChange","_onKeyDown","_opts","objects","_checked","isChecked","actionClassName","tabIndex","setAttribute","applyStyles","onclick","ev","checked","ignoreGesture","onkeydown","keyboardEvent","getAttribute","newIsChecked","style","styles","borderColor","enable","disable","DOM","Widget","NLS_CASE_SENSITIVE_CHECKBOX_LABEL","NLS_WHOLE_WORD_CHECKBOX_LABEL","NLS_REGEX_CHECKBOX_LABEL","CaseSensitiveCheckbox","appendTitle","WholeWordsCheckbox","RegexCheckbox","FindOptionsWidget","themeService","_hideSoon","_hide","_isVisible","display","inputActiveOptionBorderColor","getTheme","inputActiveOptionBackgroundColor","caseSensitive","_keybindingLabelFor","change","wholeWords","addOverlayWidget","somethingChanged","isRevealed","_revealTemporarily","_onMouseOut","_onMouseOver","_applyTheme","onThemeChange","bind","actionId","removeOverlayWidget","highlightFindOptions","_show","inputStyles","widgetBackground","editorWidgetBackground","widgetForeground","editorWidgetForeground","widgetShadowColor","widgetShadow","hcBorder","contrastBorder","effectiveOptionValue","override","FindReplaceState","_onFindReplaceStateChange","_searchString","_replaceString","_isRevealed","_isReplaceRevealed","_isRegex","_isRegexOverride","_wholeWord","_wholeWordOverride","_matchCase","_matchCaseOverride","_preserveCase","_preserveCaseOverride","_searchScope","_matchesPosition","_matchesCount","_currentMatch","currentMatch","changeEvent","updateHistory","oldEffectiveIsRegex","oldEffectiveWholeWords","oldEffectiveMatchCase","oldEffectivePreserveCase","isRegexOverride","wholeWordOverride","matchCaseOverride","preserveCaseOverride","renderFormattedText","formattedText","_renderFormattedText","treeNode","actionHandler","child","createTextNode","href","disposeables","children","nodeChild","root","actionViewItemIndex","current","stack","stream","StringStream","eos","isEscapedFormatType","formatTagType","peek","textCurrent","advance","newCurrent","parseFormattedText","inline","char","HistoryNavigator","history","limit","_initialize","_limit","_history","_navigator","previous","parent","first","last","_reduceToLimit","elements","_elements","ArrayNavigator","history_1","entry","$","inputBackground","inputForeground","inputValidationWarningBorder","inputValidationWarningBackground","inputValidationErrorBorder","inputValidationErrorBackground","InputBox","container","contextViewProvider","maxHeight","Number","POSITIVE_INFINITY","_onDidHeightChange","onDidHeightChange","mixin","placeholder","ariaLabel","inputBorder","inputValidationWarningForeground","inputValidationErrorForeground","validationOptions","validation","flexibleHeight","wrapper","input","onfocus","onblur","flexibleMaxHeight","mirror","scrollableElement","ScrollableElement","vertical","flexibleWidth","whiteSpace","wordWrap","onScroll","scrollTop","onSelectionChange","Event","domEvent","anchorNode","updateScrollDimensions","setPlaceHolder","oninput","onValueChange","onBlur","onFocus","Bal","updateMirror","actionbar","ActionBar","_hideMessage","_showMessage","placeHolder","setAriaLabel","removeAttribute","newValue","cachedHeight","blur","hasFocus","activeElement","select","setSelectionRange","start","end","horizontalPadding","parseFloat","paddingLeft","paddingRight","cachedContentHeight","scrollHeight","setScrollDimensions","setScrollPosition","force","classForType","alertText","stylesForType","aria","hideMessage","errorMsg","inputElement","div","layout","showContextView","anchorAlignment","renderOptions","spanElement","formatContent","renderText","suffix","borderStyle","previousHeight","min","insertAtCursor","selectionStart","selectionEnd","HistoryInputBox","addToHistory","getCurrentValue","showNextValue","getNextValue","showPreviousValue","getPreviousValue","currentValue","NLS_DEFAULT_LABEL","FindInput","_showOptionButtons","fixFocusOnOptionClickEnabled","_onDidOptionChange","onDidOptionChange","_onMouseDown","_onInput","_onKeyUp","_onCaseSensitiveKeyDown","onCaseSensitiveKeyDown","_onRegexKeyDown","onRegexKeyDown","_lastHighlightFindOptions","appendCaseSensitiveLabel","appendWholeWordsLabel","appendRegexLabel","inputBox","viaKeyboard","indexes","newIndex","controls","onkeyup","onmousedown","setFocusInputOnOptionClick","setEnabled","setValue","checkBoxStyles","inputBoxStyles","getCaseSensitive","setCaseSensitive","getWholeWords","setWholeWords","getRegex","setRegex","focusOnCaseSensitive","clearMessage","NLS_PRESERVE_CASE_LABEL","PreserveCaseCheckbox","ReplaceInput","cachedOptionsWidth","_onPreserveCaseKeyDown","onPreserveCaseKeyDown","getPreserveCase","setPreserveCase","focusOnPreserve","newWidth","getContextScopedWidget","contextKey","getContext","createAndBindHistoryNavigationWidgetScopedContextKeyService","scopedContextKeyService","createScoped","createWidgetScopedContextKeyService","bindContextScopedWidget","historyNavigationEnablement","ContextScopedFindInput","showFindOptions","historyNavigator","ContextScopedReplaceInput","showReplaceOptions","KeybindingsRegistry","registerCommandAndKeybindingRule","arg2","NLS_FIND_INPUT_LABEL","NLS_FIND_INPUT_PLACEHOLDER","NLS_PREVIOUS_MATCH_BTN_LABEL","NLS_NEXT_MATCH_BTN_LABEL","NLS_TOGGLE_SELECTION_FIND_TITLE","NLS_CLOSE_BTN_LABEL","NLS_REPLACE_INPUT_LABEL","NLS_REPLACE_INPUT_PLACEHOLDER","NLS_REPLACE_BTN_LABEL","NLS_REPLACE_ALL_BTN_LABEL","NLS_TOGGLE_REPLACE_MODE_BTN_LABEL","NLS_MATCHES_COUNT_LIMIT_TITLE","NLS_MATCHES_LOCATION","NLS_NO_RESULTS","MAX_MATCHES_COUNT_WIDTH","ctrlKeyMod","FindWidgetViewZone","heightInPx","stopPropagationForMultiLineUpwards","textarea","isMultiline","stopPropagationForMultiLineDownwards","FindWidget","codeEditor","_cachedHeight","_codeEditor","_controller","_contextViewProvider","_storageService","_ctrlEnterReplaceAllWarningPrompted","getBoolean","_isReplaceVisible","_ignoreChangeEvent","_updateHistoryDelayer","Delayer","_buildDomNode","_updateButtons","_tryUpdateWidgetWidth","_findInput","updateAccessibilitySupport","addExtraSpaceOnTop","_showViewZone","_removeViewZone","_updateToggleSelectionFindButton","onDidFocusEditorWidget","globalBufferTerm","getGlobalBufferTerm","_findInputFocused","_findFocusTracker","onDidFocus","_updateSearchScope","onDidBlur","_replaceInputFocused","_replaceFocusTracker","_replaceInput","_layoutViewZone","_reveal","_tryUpdateHeight","_toggleSelectionFind","showRedOutline","_updateMatchesCount","_delayedUpdateHistory","_updateHistory","minWidth","firstChild","removeChild","alertFn","_getAriaLabel","clientWidth","isSelection","_closeBtn","findInputIsNonEmpty","_prevBtn","_nextBtn","_replaceBtn","_replaceAllBtn","_toggleReplaceBtn","toggleClass","setExpanded","canReplace","autoFindInSelection","isSelectionMultipleLine","layoutOverlayWidget","adjustEditorScrollTop","seedSearchStringFromSelection","startCoords","startLeft","startTop","leftOfFindWidget","endCoords","focusTheEditor","viewZone","_getHeight","setScrollTop","getScrollTop","adjustScroll","newHeight","scrollAdjustment","layoutInfo","contentWidth","editorWidth","minimapWidth","collapsedFindWidget","reducedFindWidget","narrowFindWidget","_resized","maxWidth","FIND_WIDGET_INITIAL_WIDTH","findInputWidth","totalheight","totalHeight","focusFindInput","focusReplaceInput","_onFindInputMouseDown","middleButton","_onFindInputKeyDown","querySelector","_onReplaceInputKeyDown","info","getHorizontalSashTop","_sash","getHorizontalSashLeft","getHorizontalSashWidth","PART_WIDTH","SimpleButton","onTrigger","getAction","findPart","actionsContainer","replacePart","replaceActionsContainer","_resizeSash","Sash","orientation","originalWidth","onDidStart","evt","startX","currentX","onDidReset","currentWidth","expanded","shouldHaveIt","addBackgroundColorRule","selector","editorFindMatchHighlight","editorFindMatch","editorFindRangeHighlight","findMatchHighlightBorder","editorFindMatchHighlightBorder","findMatchBorder","editorFindMatchBorder","findRangeHighlightBorder","editorFindRangeHighlightBorder","errorForeground","resizeBorderBackground","editorWidgetResizeBorder","editorWidgetBorder","focusOutline","focusBorder","getSelectionSearchString","wordAtPosition","getWordAtPosition","word","getValueLengthInRange","CommonFindController","clipboardService","_findWidgetVisible","_clipboardService","loadQueryState","shouldRestartFind","disposeModel","_start","forceRevealReplace","seedSearchStringFromGlobalClipboard","shouldFocus","shouldAnimate","updateSearchScope","saveQueryState","setGlobalBufferTerm","actualIsRegex","actualWholeWord","actualMatchCase","actualPreserveCase","isFindInputFocused","getState","closeFindWidget","toggleCaseSensitive","toggleWholeWords","toggleRegex","toggleSearchScope","setSearchString","selectionSearchString","stateChanges","currentSelection","globalFindClipboard","readFindText","writeFindText","IClipboardService","FindController","_themeService","_widget","_findOptionsWidget","_createFindWidget","IThemeService","optional","StartFindAction","StartFindWithSelectionAction","MatchFindAction","_run","NextMatchFindAction","NextMatchFindAction2","PreviousMatchFindAction","PreviousMatchFindAction2","SelectionMatchFindAction","NextSelectionMatchFindAction","PreviousSelectionMatchFindAction","StartFindReplaceAction","findInputFocused","FindCommand","FoldingRegions","startIndexes","endIndexes","types","_startIndexes","_endIndexes","_collapseStates","Uint32Array","_types","_parentsComputed","ensureParentIndices","parentIndexes_1","isInsideLast","getStartLineNumber","getEndLineNumber","parentIndex","getType","hasTypes","isCollapsed","arrayIndex","bit","setCollapsed","toRegion","FoldingRegion","getParentIndex","findIndex","low","high","mid","findRange","containedBy","containsLine","FoldingModel","textModel","decorationProvider","_updateEventEmitter","_textModel","_decorationProvider","_regions","_editorDecorationIds","_isInitialized","toggleCollapseState","regions","processed","regions_1","regionIndex","editorDecorationId","newCollapseState","getDecorationOption","collapseStateChanged","newRegions","blockedLineNumers","newEditorDecorations","initRange","blockedLineNumers_1","blockedLineNumber","isBlocked","maxColumn","decorationRange","nextCollapsed","collapsedIndex","decRange","collapsedStartLineNumber","getMemento","collapsedRanges","applyMemento","toToogle","state_1","region","getRegionAtLine","getAllRegionsAtLine","level","getRegionsInside","MAX_VALUE","levelStack","setCollapseStateLevelsDown","foldingModel","doCollapse","levels","lineNumbers","toToggle","lineNumbers_2","regionsInside","setCollapseStateLevelsUp","lineNumbers_3","setCollapseStateForMatchingLines","regExp","setCollapseStateForType","FoldingDecorationProvider","autoHideFoldingControls","COLLAPSED_VISUAL_DECORATION","EXPANDED_AUTO_HIDE_VISUAL_DECORATION","EXPANDED_VISUAL_DECORATION","oldDecorations","afterContentClassName","linesDecorationsClassName","HiddenRangeModel","_foldingModel","_foldingModelListener","updateHiddenRanges","_hiddenRanges","updateHiddenAreas","newHiddenAreas","lastCollapsedStart","lastCollapsedEnd","applyHiddenRanges","hiddenRanges","hasRanges","isHidden","adjustSelections","hasChanges","lastRange","adjustLine","isInside","adjustedStartLine","adjustedEndLine","findFirstInSorted","IndentRangeProvider","compute","cancelationToken","foldingRules","getFoldingRules","offSide","markers","foldingRangesLimit","RangesCollector","previousRegions","endAbove","line_1","insertFirst","toIndentRanges","computeRanges","_indentOccurrences","_length","_foldingRangesLimit","maxIndent","startIndex","foldingContext","SyntaxRangeProvider","cancellationToken","rangeData","provideFoldingRanges","nLines","ranges_1","rank","collectSyntaxRanges","sanitizeRanges","_nestingLevels","_nestingLevelCounts","nestingLevel","maxLevel","sorted","d1","d2","diff","sorted_1","InitializingRangeProvider","initialRanges","onTimeout","timeoutTime","decorationIds","getLineLength","timeout","foldingRangeData","CONTEXT_FOLDING_ENABLED","FoldingController","localToDispose","_autoHideFoldingControls","_useFoldingProviders","hiddenRangeModel","rangeProvider","foldingRegionPromise","foldingStateMemento","foldingModelPromise","updateScheduler","cursorChangedScheduler","mouseDownInfo","foldingDecorationProvider","foldingEnabled","oldIsEnabled","options_1","oldShowFoldingControls","onModelContentChanged","oldUseFoldingProviders","onFoldingStrategyChanged","saveViewState","isTooLargeForTokenization","collapsedRegions","isInitialized","restoreViewState","getFoldingModel","hr","onHiddenRangesChanges","revealCursor","FoldingRangeProviderRegistry","onCursorPositionChanged","onEditorMouseDown","onEditorMouseUp","getRangeProvider","foldingProviders","selectionLineNumbers","setHiddenAreas","reveal","leftButton","iconClicked","detail","offsetLeftInGutter","offsetLeft","offsetX","isAfterLines","isCollapsed_1","revealPositionInCenterIfOutsideViewport","FoldingAction","foldingController","reportTelemetry","invoke","getSelectedLines","getLineNumbers","selectionLines","foldingArgumentsConstraint","foldingArgs","direction","every","UnfoldAction","constraint","_foldingController","UnFoldRecursivelyAction","_args","FoldAction","ToggleFoldAction","doCollapse_1","lineNumbers_1","FoldRecursivelyAction","selectedLines","FoldAllBlockCommentsAction","FoldingRangeKind","Comment","comments","FoldAllRegionsAction","Region","UnfoldAllRegionsAction","FoldAllAction","UnfoldAllAction","FoldLevelAction","getFoldingLevel","parseInt","ID_PREFIX","foldLevel","blockedLineNumbers","setCollapseStateAtLevel","registerInstantiatedEditorAction","EditorFontZoomIn","EditorZoom","setZoomLevel","getZoomLevel","EditorFontZoomOut","EditorFontZoomReset","FormattingEdit","_handleEolEdits","edits","newEol","singleEdits","edits_1","eol","pushEOL","_isFullModelReplaceEdit","editRange","execute","_edits","executeEdits","replaceMove","ExtensionIdentifier","_lower","toKey","alertFormattingEdits","getRealAndSyntheticDocumentFormattersOrdered","seen","docFormatter_1","DocumentFormattingEditProviderRegistry","formatter","extensionId","displayName","provideDocumentFormattingEdits","provideDocumentRangeFormattingEdits","rangeFormatter_1","DocumentRangeFormattingEditProviderRegistry","FormattingConflicts","_selectors","LinkedList","formatDocumentRangeWithSelectedProvider","editorOrModel","instaService","selected","isCodeEditor","formatDocumentRangeWithProvider","workerService","rawEdits","range_1","initialSelection_1","IEditorWorkerService","EditorStateCancellationTokenSource","getFormattingOptions","computeMoreMinimalEdits","pushEditOperations","forceMoveMarkers","undoEdits","undoEdits_1","range_2","areIntersectingOrTouching","formatDocumentWithSelectedProvider","formatDocumentWithProvider","initialSelection_2","undoEdits_2","range_3","getOnTypeFormattingEdits","ch","OnTypeFormattingEditProviderRegistry","autoFormatTriggerCharacters","provideOnTypeFormattingEdits","providers_1","getDocumentRangeFormattingEditsUntilResult","providers_2","getDocumentFormattingEditsUntilResult","FormatOnType","_workerService","_callOnDispose","_callOnModel","support","triggerChars","CharacterSet","onDidType","lastCharCode","fromCharCode","unbind","changes","FormatOnPaste","onDidPaste","FormatDocumentAction","hasDocumentFormattingProvider","FormatSelectionAction","hasDocumentSelectionFormattingProvider","hasNonEmptySelection","CommandsRegistry","registerCommand","PeekContext","EmbeddedCodeEditorWidget","domElement","parentEditor","codeEditorService","accessibilityService","getRawOptions","_parentEditor","_overwriteOptions","_onParentConfigurationChanged","getParentEditor","newOptions","IAccessibilityService","CodeEditorWidget","IdGenerator","prefix","_prefix","_lastId","nextId","defaultGenerator","defaultColor","defaultOptions","showArrow","showFrame","frameColor","arrowColor","keepEditorSelection","ViewZoneDelegate","afterColumn","onDomNodeTop","_onDomNodeTop","_onComputedHeight","OverlayWidgetDelegate","Arrow","_ruleName","_IdGenerator","_color","_height","_updateStyle","where","ZoneWidget","_arrow","_overlayWidget","_positionMarkerId","_isShowing","isAccessible","_getWidth","_getLeft","_onWidth","_fillContainer","_initSash","_applyStyles","borderTopColor","borderBottomColor","verticalScrollbarWidth","minimapLeft","_onViewZoneTop","_onViewZoneHeight","containerHeight","_decoratingElementsHeight","_doLayout","rangeOrPos","_showImpl","viewZoneDomNode","overflow","maxHeightInLines","arrowHeight","frameThickness","width_1","frameWidth","borderTopWidth","borderBottomWidth","revealLine","isLastLine","revealLineInCenter","setCssClass","classToReplace","widthInPixel","heightInPixel","_relayout","newHeightInLines","isResizeable","startY","onDidEnd","lineDelta","currentY","roundedLineDelta","IPeekViewService","_widgets","addExclusiveWidget","existing","onDidClose","inPeekEditor","notInPeekEditor","toNegated","PeekContextController","headerBackgroundColor","white","primaryHeadingColor","secondaryHeadingColor","PeekViewWidget","_onDidClose","_headElement","_primaryHeading","_secondaryHeading","_bodyElement","_fillHead","_fillBody","titleElement","_onTitleClick","_fillTitleIcon","_metaHeading","actionBarOptions","_getActionBarOptions","_actionbarWidget","setTitle","primaryHeading","secondaryHeading","setMetaTitle","headHeight","bodyHeight","_doLayoutHead","_doLayoutBody","peekViewTitleBackground","peekViewTitleForeground","peekViewTitleInfoForeground","peekViewBorder","peekViewResultsBackground","black","peekViewResultsMatchForeground","peekViewResultsFileForeground","peekViewResultsSelectionBackground","peekViewResultsSelectionForeground","peekViewEditorBackground","peekViewEditorGutterBackground","peekViewResultsMatchHighlight","peekViewEditorMatchHighlight","peekViewEditorMatchHighlightBorder","activeContrastBorder","OneReference","isProviderFirst","_range","_rangeCallback","localize","basename","FilePreview","_modelReference","preview","object","textEditorModel","getWordUntilPosition","beforeRange","afterRange","inside","highlight","FileReferences","_preview","_loadFailure","fsPath","textModelResolverService","_resolved","createModelReference","modelReference","ReferencesModel","_onDidChangeReferenceRange","onDidChangeReferenceRange","_links","_title","providersFirst","_compareReferences","links_1","oneRef","targetSelectionRange","ref","clone","nextOrPreviousReference","reference","idx","childCount","groupCount","nearestReference","nearest","prefixLen","offsetDist","abs","referenceAt","firstReference","HighlightedLabel","supportCodicons","highlights","didEverRender","escapeNewLines","htmlContent","pos","substring_1","total","extra","highlights_1","FastLabelNode","_element","disposed","_textContent","empty","_empty","marginLeft","IconLabel","labelContainer","nameContainer","descriptionContainer","supportHighlights","nameNode","LabelWithHighlights","Label","supportDescriptionHighlights","descriptionNodeFactory","setLabel","classes","extraClasses","italic","descriptionNode","descriptionMatches","descriptionTitle","singleLabel","domId","separator","_e","_f","_g","_h","_j","_k","labelEscapeNewLines","labels","labelStart","labelRange","intersect","splitMatches","name_1","badgeBackground","badgeForeground","CountBadge","count","badgeBorder","countFormat","titleFormat","setCount","setTitleFormat","getPathLabel","userHomeProvider","rootProvider","file","baseResource","getWorkspaceFolder","hasMultipleRoots","getWorkspace","folders","pathLabel","relativePath","rootName","scheme","Schemas","untitled","with","query","fragment","hasDriveLetter","normalize","normalizeDriveLetter","isWindows","path","userHome","normalizedUserHome","normalizedUserHomeCached","original","normalized","rtrim","posix","isLinux","startsWithIgnoreCase","tildify","getBaseLabel","base","charAt","State","Sizing","DataSource","_resolverService","hasChildren","failure","getChildren","val","ITextModelService","Delegate","getHeight","getTemplateId","FileReferencesRenderer","OneReferenceRenderer","StringRepresentationProvider","getKeyboardNavigationLabel","parts","IdentityProvider","FileReferencesTemplate","_uriLabel","badge","attachBadgeStyler","dirname","getUriLabel","relative","ILabelService","templateId","renderTemplate","renderElement","node","template","createMatches","filterData","disposeTemplate","templateData","OneReferenceTemplate","score","filePreview","FuzzyScore","isDefault","AriaProvider","getAriaLabel","ariaMessage","defaultStyles","separatorBorder","transparent","ViewItem","view","size","disposable","_cachedVisibleSize","_size","cachedVisibleSize","setVisible","visible","clamp","viewMinimumSize","viewMaximumSize","minimumSize","maximumSize","priority","snap","pointerEvents","layoutContext","layoutContainer","VerticalViewItem","HorizontalViewItem","Distribute","Split","Invisible","SplitView","contentSize","proportions","viewItems","sashItems","Idle","_onDidSashChange","onDidSashChange","_onDidSashReset","_startSnappingEnabled","_endSnappingEnabled","inverseAltBehavior","proportionalLayout","el","sashContainer","viewContainer","descriptor","views","viewDescriptor","sizing","doAddView","reduce","saveProportions","_orthogonalStartSash","sash","orthogonalStartSash","_orthogonalEndSash","orthogonalEndSash","startSnappingEnabled","updateSashEnablement","endSnappingEnabled","isTransparent","removeProperty","setProperty","addView","previousSize","lowPriorityIndexes","highPriorityIndexes","resize","distributeEmptySpace","layoutViews","onSashStart","alt","firstIndex","combinedDisposable","resetSashDragState","sashDragState","snapBefore","snapAfter","sizes","minDelta","NEGATIVE_INFINITY","maxDelta","viewItem","upIndexes","downIndexes","minDeltaUp","maxDeltaUp","maxDeltaDown","minDeltaDown","minDelta_1","maxDelta_1","snapBeforeIndex","findFirstSnapIndex","snapAfterIndex","halfSize","limitDelta","onSashChange","delta","newDelta","isLastSash","newSizes","viewItemIndex","newMinDelta","newMaxDelta","resizeIndex","onSashEnd","onViewChange","relayout","resizeView","Busy","distributeViewSizes","flexibleViewItems","flexibleSize","flexibleViewItems_1","getViewSize","skipLayout","insertBefore","viewSize","onChangeDisposable","containerDisposable","orientation_1","layoutProvider","getSashPosition","getVerticalSashLeft","sash_1","sashEventMapper","onStartDisposable","onStart","onChangeDisposable_1","onEndDisposable","onEnd","onDidResetDisposable","disposable_1","sashItem","overloadMinDelta","overloadMaxDelta","highPriorityIndexes_1","index_1","pushToStart","lowPriorityIndexes_1","index_2","pushToEnd","upItems","upSizes","downItems","downSizes","snapped","snapView","deltaUp","deltaDown","lowPriorityIndex","emptyDelta","highPriorityIndexes_2","lowPriorityIndexes_2","collapsesDown","expandsDown","reverseViews","collapsesUp","expandsUp","snappedBefore","snappedAfter","indexes_1","indexes_2","DecorationsManager","_decorationIgnoreSet","_callOnModelChange","_onModelChanged","removeDecorations","onDidChangeDecorations","_onDecorationChanged","newDecorationsActualIndex","oneReference","DecorationOptions","toRemove","newRange","spansMultipleLines","LayoutData","ratio","fromJSON","ReferenceWidget","_defaultTreeKeyboardSupport","layoutData","_textModelResolverService","_peekViewService","_disposeOnNewModel","_onDidSelectReference","onDidSelectReference","_dim","setModel","_previewNotAvailableMessage","_tree","_previewModelReference","_splitView","peekView","domFocus","_getFocusedReference","metaKey","containerElement","_messageContainer","_previewContainer","scrollBeyondLastLine","scrollbar","verticalScrollbarSize","horizontal","useShadows","verticalHasArrows","horizontalHasArrows","alwaysConsumeMouseWheel","overviewRulerLanes","fixedOverflowWidgets","createFromString","_treeContainer","treeOptions","keyboardSupport","accessibilityProvider","keyboardNavigationLabelProvider","identityProvider","overrideStyles","listBackground","WorkbenchAsyncDataTree","onEvent","_revealReference","onDidChangeFocus","onDidOpen","browserEvent","MouseEvent","KeyboardEvent","tapCount","setFocus","newModel","_onNewModel","_decorationsManager","rerender","setInput","getFocus","revealParent","promise","scrollType","sel","_revealedReference","inMemory","basenameOrAuthority","getInput","expand","collapseToStart","revealRangeInCenter","findMatchHighlightColor","referenceHighlightColor","referenceHighlightBorder","hcOutline","resultsBackground","resultsMatchForeground","resultsFileForeground","resultsSelectedBackground","resultsSelectedForeground","editorBackground","editorGutterBackground","ctxReferenceSearchVisible","ReferencesController","_editorService","_requestIdPool","_ignoreModelChangeEvent","_referenceSearchVisible","toggleWidget","modelPromise","peekMode","closeWidget","_peekMode","openReference","_gotoReference","requestId","goToNextOrPreviousReference","fwd","currentPosition","editorFocus","openCodeEditor","openedEditor","model_1","sideBySide","withController","fn","outerEditor","getOuterEditor","not","WorkbenchListFocusContextKey","IListService","lastFocusedList","getLocationLinks","registry","provide","coalesce","getDefinitionsAtPosition","DefinitionProviderRegistry","provideDefinition","getDeclarationsAtPosition","DeclarationProviderRegistry","provideDeclaration","getImplementationsAtPosition","ImplementationProviderRegistry","provideImplementation","getTypeDefinitionsAtPosition","TypeDefinitionProviderRegistry","provideTypeDefinition","getReferencesAtPosition","compact","ReferenceProviderRegistry","resultWithoutDeclaration","provideReferences","includeDeclaration","registerDefaultLanguageCommand","ctxHasSymbols","ISymbolNavigationService","SymbolNavigationService","_currentModel","_currentIdx","_ignoreEditorChange","_ctxHasSymbols","_currentState","_currentMessage","refModel","editorState","EditorState","getActiveCodeEditor","seenUri","seenPosition","revealNext","revealInCenterIfOutsideViewport","status","editorService","_listener","onCodeEditorRemove","_onDidRemoveEditor","onCodeEditorAdd","_onDidAddEditor","listCodeEditors","SymbolNavigationAction","configuration","_configuration","symbolNavService","raceCancellation","_getLocationModel","altAction","altActionId","referenceCount","_getAlternativeCommand","muteMessage","_getNoResultFoundMessage","_onResult","gotoLocation","targetEditor","_getGoToPreference","openInPeek","_openInPeek","_openReference","openToSide","modelNow_1","ids_1","isLocationLink","DefinitionAction","alternativeDefinitionCommand","multipleDefinitions","goToDefinitionKb","isWeb","isStandalone","GoToDefinitionAction","hasDefinitionProvider","isInEmbeddedEditor","registerCommandAlias","OpenDefinitionToSideAction","PeekDefinitionAction","DeclarationAction","alternativeDeclarationCommand","multipleDeclarations","GoToDeclarationAction","hasDeclarationProvider","PeekDeclarationAction","TypeDefinitionAction","alternativeTypeDefinitionCommand","multipleTypeDefinitions","GoToTypeDefinitionAction","hasTypeDefinitionProvider","PeekTypeDefinitionAction","ImplementationAction","alternativeImplementationCommand","multipleImplementations","GoToImplementationAction","hasImplementationProvider","PeekImplementationAction","ReferencesAction","alternativeReferenceCommand","multipleReferences","GoToReferencesAction","hasReferenceProvider","PeekReferencesAction","GenericGoToLocationAction","_references","_gotoMultipleBehaviour","_token","corePosition","multiple","assertType","isUri","invokeWithinContext","control","MarkdownString","isTrusted","_isTrusted","appendText","appendMarkdown","appendCodeblock","langId","code","isEmptyMarkdownString","oneOrMany","isMarkdownString","thing","markdownStringEqual","removeMarkdownEscapes","hasModifier","modifier","ClickLinkMouseEvent","triggerModifier","hasSideBySideModifier","triggerSideBySideModifier","isNoneOrSingleMouseDown","ClickLinkKeyboardEvent","keyCodeIsTriggerKey","triggerKey","keyCodeIsSideBySideKey","triggerSideBySideKey","ClickLinkOptions","createOptions","multiCursorModifier","ClickLinkGesture","_onMouseMoveOrRelevantKeyDown","onMouseMoveOrRelevantKeyDown","_onExecute","onExecute","_onCancel","onCancel","lastMouseMoveEvent","hasTriggerKeyOnMouseDown","newOpts","onEditorMouseMove","resetHandler","scrollLeftChanged","GotoDefinitionAtPositionEditorContribution","modeService","toUnhook","toUnhookForKeyboard","linkDecorations","currentWordAtPosition","previousPromise","linkGesture","startFindDefinitionFromMouse","withNullAsUndefined","gotoDefinition","removeLinkDecorations","startFindDefinitionFromCursor","startFindDefinition","withKey","findDefinition","results","wordRange","previewValue","getPreviewValue","originSelectionRange","modeId","getModeIdByFilepathOrFirstLine","rangeToUse","getPreviewRangeBasedOnBrackets","MAX_SOURCE_PREVIEW_LINES","getPreviewRangeBasedOnIndentation","stripIndentationFromPreviewRange","previewRange","minIndent","endIndent","trim","startIndent","ignoreFirstEmpty","currentBracket","lastBracket","open","isOpen","nextLineNumber","nextColumn","hoverMessage","inlineClassName","IModeService","SeverityIcon","severity","Severity","Ignore","Info","Warning","errorIconForeground","problemsErrorIconForeground","warningIconForeground","problemsWarningIconForeground","infoIconForeground","problemsInfoIconForeground","onRelatedInformation","_lines","_longestLineLength","_relatedDiagnostics","WeakMap","_messageBlock","_relatedBlock","related","_scrollable","horizontalScrollbarSize","scrollLeft","relatedInformation","lines_1","applyFontInfo","lastLineElement","lines_2","innerText","detailsElement","sourceElement","codeElement","relatedInformationNode","paddingTop","relatedInformation_1","relatedResource","relatedMessage","scrollWidth","typicalFullwidthCharacterWidth","getHeightInLines","MarkerNavigationWidget","_onDidSelectRelatedInformation","onDidSelectRelatedInformation","_severity","MarkerSeverity","_backgroundColor","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","editorMarkerNavigationWarning","editorMarkerNavigationInfo","_parentContainer","_icon","_container","_message","showAtMarker","markerIdx","markerCount","computeRequiredHeight","toSeverity","revealPositionInCenter","updateMarker","showStale","_heightInPixel","errorDefault","oneOf","editorErrorForeground","editorErrorBorder","warningDefault","editorWarningForeground","editorWarningBorder","infoDefault","editorInfoForeground","editorInfoBorder","textLinkForeground","MarkerModel","_toUnbind","_markers","_nextIdx","_ignoreSelectionChange","_onCurrentMarkerChanged","_onMarkerSetChanged","setMarkers","currentMarker","oldMarker","MarkerNavigationAction","compareMarker","binarySearch","withoutWatchingEditorPosition","_initIdx","found","isBeforeOrEqual","canNavigate","move","inCircles","oldIdx","atEdge","findMarkerAtPosition","MarkerController","_disposeOnClose","_widgetVisible","CONTEXT_MARKERS_NAVIGATION_VISIBLE","_cleanUp","getOrCreateModel","_getMarkers","_onMarkerChanged","prevMarkerKeybinding","PrevMarkerAction","nextMarkerKeybinding","NextMarkerAction","LABEL","closeMarkersNavigation","pinned","revealIfOpened","onCurrentMarkerChanged","onMarkerSetChanged","focusEditor","changedResources","severities","multiFile","_isNext","_multiFile","newMarker","NextMarkerInFilesAction","PrevMarkerInFilesAction","MarkerCommand","ColorPickerModel","availableColorPresentations","presentationIndex","_onColorFlushed","onColorFlushed","_onDidChangeColor","onDidChangeColor","_onDidChangePresentation","onDidChangePresentation","originalColor","_colorPresentations","colorPresentations","presentation","selectNextColorPresentation","flushColor","guessColorPresentation","originalText","ColorPickerHeader","pickedColorNode","colorBox","Format","CSS","editorHoverBackground","CLICK","isLighter","ColorPickerBody","pixelRatio","saturationBox","SaturationBox","onDidSaturationValueChange","opacityStrip","OpacityStrip","onDidOpacityChange","hueStrip","HueStrip","onDidHueChange","hsva","HSVA","h","canvas","origin","onDidChangePosition","offsetY","mouseUpListener","stopMonitoring","paintSelection","offsetWidth","offsetHeight","paint","saturatedColor","ctx","whiteGradient","createLinearGradient","addColorStop","blackGradient","rect","fillStyle","fill","isMonitoring","Strip","overlay","slider","updateSliderPosition","onDidChangeTop","opaque","ColorPickerWidget","onDidChangeZoomLevel","header","getHover","HoverProviderRegistry","provideHover","hasRange","hasHtmlContent","contents","__marked_exports","HoverOperation","computer","success","progress","hoverTime","_computer","_hoverTime","_firstWaitScheduler","_triggerAsyncComputation","_secondWaitScheduler","_triggerSyncComputation","_loadingMessageScheduler","_showLoadingMessage","_asyncComputationPromise","_asyncComputationPromiseDone","_completeCallback","_errorCallback","_progressCallback","setHoverTime","_firstWaitTime","_secondWaitTime","_loadingMessageTime","computeAsync","asyncResult","_withAsyncResult","_onError","computeSync","onResult","_onComplete","getResult","_onProgress","getResultWithLoadingMessage","ContentHoverWidget","_stoleFocus","_containerDomNode","DomScrollableElement","updateFont","_showAtPosition","_showAtRange","getElementsByClassName","updateContents","onContentsChange","scanDomNode","GlyphHoverWidget","_showAtLineNumber","editorLayout","topForLineNumber","editorScrollTop","clientHeight","glyphMarginLeft","glyphMarginWidth","codeTags","getElementsByTagName","codeClasses","block","newline","fences","noop","heading","nptable","blockquote","table","lheading","paragraph","Lexer","marked","rules","normal","pedantic","gfm","tables","_label","bullet","_tag","_comment","merge","lex","src","loose","cap","bull","listStart","listItems","space","tag","isordered","istask","ischecked","exec","lang","depth","splitCells","align","cells","smartLists","task","sanitize","pre","sanitizer","autolink","url","reflink","nolink","strong","em","br","del","InlineLexer","renderer","Renderer","breaks","TextRenderer","Parser","slugger","Slugger","encode","escapeTest","escapeReplace","replacements","escapeTestNoEncode","escapeReplaceNoEncode","unescape","opt","cleanUrl","prot","decodeURIComponent","originIndependentUrl","baseUrls","resolveUrl","encodeURI","_punctuation","_escapes","_scheme","_email","_attribute","_href","_extended_email","_backpedal","output","prevCapZero","out","inLink","inRawBlock","lastParenIndex","findClosingBracket","linkLen","outputLink","escapes","codespan","mangle","smartypants","image","infostring","escaped","langPrefix","quote","headerIds","headerPrefix","slug","xhtml","listitem","checkbox","tablerow","tablecell","flags","baseUrl","inlineText","tok","parseText","row","cell","errMsg","silent","console","log","originalSlug","obj","tableRow","str","curr","invert","suffLen","currChar","pending","getDefaults","parser","lexer","inlineLexer","__insane_func","o","u","exports","1","require","module","toMap","uris","2","allowedAttributes","iframe","img","allowedClasses","allowedSchemes","allowedTags","3","voids","4","insane","strict","buffer","5","string","6","assignment","7","he","lowercase","rstart","rend","rattrs","rtag","rtagend","chars","lastItem","createStack","parsePart","parseComment","parseEdge","parseEndTag","parseStartTag","parseTagDecode","parseTag","same","rest","unary","attrs","doubleQuotedValue","singleQuotedValue","unquotedValue","decode","8","attributes","ignoring","classesOk","attrsOk","lkey","colon","questionmark","testUrl","unignore","transformText","9","unescapes","rescaped","runescaped","escapeHtmlChar","unescapeHtmlChar","escapeHtml","unescapeHtml","10","asKey","accumulator","renderMarkdown","markdown","signalInnerHTML","_uriMassage","cloneAndChange","revive","encodeURIComponent","isDomUri","withInnerHTML","dimensions","splitted","parameters","heightFromParams","widthFromParams","widthIsFinite","isFinite","heightIsFinite","parseHrefAndDimensions","codeBlockRenderer","strValue","span","codeBlockRenderCallback","dataset","markedOptions","http","https","mailto","vscodeRemote","vscodeRemoteResource","renderedMarkdown","MarkdownRenderer","_modeService","_openerService","NullOpenerService","_onDidRenderCodeBlock","onDidRenderCodeBlock","languageAlias","getModeIdForLanguageName","triggerMode","TokenizationRegistry","getPromise","tokenizeToString","fontFamily","fromUserGesture","IOpenerService","ColorHover","MarkerHover","ModesContentComputer","_markerDecorationsService","setRange","clearResult","colorDetector","lineDecorations","getLineDecorations","didFindColor","hoverRange","getMarker","asArray","isFromSynchronousComputation","_getLoadingMessage","ModesContentHoverWidget","markerDecorationsService","renderDisposable","_messages","_lastRange","_highlightDecorations","_isChangingDecorations","_shouldFocus","_colorPicker","_hoverOperation","_withResult","delay","FOCUS","BLUR","_renderMessages","onModelDecorationsChanged","startShowingAt","filteredMessages","msg","second","firstElement","secondElement","IMarkerData","makeKey","hoverContentsEquals","isColorPickerVisible","complete","renderRange","messages","renderColumn","highlightRange","createDocumentFragment","isEmptyHoverContent","containColorPicker","markdownDisposeables","markerMessages","color_1","editorModel_1","widget_1","updateEditorModel","textEdits","textEdit","identifier","additionalTextEdits","updateColorPresentations","colorListener","colorChangeListener","markdownHoverElement","hoverContentsElement","renderedContents","renderMarkerHover","markerHoverForStatusbar","renderMarkerStatusbar","markerHover","hoverElement","markerElement","messageElement","opacity","message_1","relatedInfoContainer","marginTop","cursor","messageElement_1","this_1","actionsElement","renderAction","commandId","quickfixPlaceholderElement","transition","codeActionsPromise","showing","elementPosition","actionOptions","actionContainer","iconClass","MarginComputer","_lineNumber","setLineNumber","toHoverMessage","lineDecorations_1","glyphMarginClassName","glyphMarginHoverMessage","ModesGlyphHoverWidget","openerService","_renderDisposeables","_lastLineNumber","_markdownRenderer","messages_1","ModesHoverController","_toUnhook","_glyphWidget","_isMouseDown","_hoverClicked","_hookEvents","_didChangeConfigurationHandler","_hideWidgets","_unhookEvents","_createHoverWidgets","hideWidgetsEventHandler","hoverOpts","_isHoverEnabled","_isHoverSticky","sticky","_onEditorMouseMove","onDidChangeModelDecorations","_onModelDecorationsChanged","onMouseLeave","_onEditorScrollChanged","contentWidget","glyphWidget","targetType","epsilon","typicalHalfwidthCharacterWidth","horizontalDistanceToText","showContentHover","IMarkerDecorationsService","ShowHoverAction","ShowDefinitionPreviewHoverAction","editorHoverHighlightColor","editorHoverHighlight","hoverBackground","hoverBorder","editorHoverBorder","hoverForeground","editorHoverForeground","actionsBackground","editorHoverStatusBarBackground","codeBackground","textCodeBlockBackground","InPlaceReplaceCommand","originalSelection","_editRange","_originalSelection","_text","InPlaceReplaceController","editorWorkerService","up","currentRequest","modelURI","canNavigateValueSet","navigateValueSet","DECORATION","decorationRemover","InPlaceReplaceUp","InPlaceReplaceDown","TrimTrailingWhitespaceCommand","cursors","_cursors","rLen","cursorIndex","cursorLen","maxLineColumn","minEditColumn","lastNonWhitespaceIndex","fromColumn","trimTrailingWhitespace","CopyLinesCommand","isCopyingDown","_isCopyingDown","_selectionDirection","_startLineNumberDelta","_endLineNumberDelta","sourceLines","sourceText","getDirection","createWithDirection","getSpaceCnt","spacesCnt","generateIndent","tabsCnt","MoveLinesCommand","isMovingDown","autoIndent","_isMovingDown","_autoIndent","_moveEndLineSelectionShrink","modelLineCount","indentSize","indentConverter","buildIndentConverter","virtualModel","getLineTokens","otherLineNumber","movingLineNumber_1","movingLineText","insertingText_1","shouldAutoIndent","movingLineMatchResult","matchEnterRule","newIndentation","indentUtils","newSpaceCnt","oldIndentation","trimLeft","indentOfMovingLine","getGoodIndentForLine","oldSpaceCnt","ret","getIndentEditsOfMovingBlock","newIndentatOfMovingBlock","spaceCntOffset","indentOfFirstLine","oldIndent","shiftIndent","indentation","ShiftCommand","unshiftIndent","oneLineAbove","oneLineAboveText","validPrecedingLine","enter","getEnterAction","enterPrefix","indentAction","IndentAction","Indent","IndentOutdent","Outdent","indentMetadataOfMovelingLine","getIndentMetadata","isCheapToTokenize","languageAtSelectionStart","getIndentRulesSupport","originalIndent","newIndent","SortLinesCommand","descending","selectionId","getCollator","_COLLATOR","Intl","Collator","getSortData","sortLines","canRun","linesToSort","AbstractCopyLinesAction","down","CopyLinesUpAction","CopyLinesDownAction","DuplicateSelectionAction","insertSelection","ReplaceCommandThatSelectsText","AbstractMoveLinesAction","selections_3","MoveLinesUpAction","MoveLinesDownAction","AbstractSortLinesAction","selections_4","SortLinesAscendingAction","SortLinesDescendingAction","TrimTrailingWhitespaceAction","DeleteLinesAction","_getLinesToRemove","linesDeleted","cursorState","operations","mergedOperations","previousOperation","IndentLinesAction","_getCursors","TypeOperations","OutdentLinesAction","CoreEditingCommands","InsertLineBeforeAction","lineInsertBefore","InsertLineAfterAction","lineInsertAfter","AbstractDeleteAllToBoundaryAction","primaryCursor","rangesToDelete","_getRangesToDelete","effectiveRanges","nextRange","endCursorState","_getEndCursorState","DeleteAllLeftAction","endPrimaryCursor","deletedLines","endCursor","newStartLine","unshift","deleteFromLine","deleteFromColumn","DeleteAllRightAction","JoinLinesAction","reducedSelections","lastSelection","previousValue","lineOffset","columnDeltaOffset","selectionEndPositionOffset","trimmedLinesContent","i_1","lineText","firstNonWhitespaceIdx","insertSpace","lineTextWithoutIndent","deleteSelection","resultSelection","TransposeAction","AbstractCaseAction","wordSeparators","_modifyText","UpperCaseAction","toLocaleUpperCase","LowerCaseAction","toLocaleLowerCase","TitleCaseAction","excludedChars","startUpperCase","currentChar","Link","_link","_provider","toJSON","tooltip","resolveLink","LinksList","tuples","newLinks","_union","isDisposable","tuples_1","oldLinks","oldIndex","oldLen","newLen","oldLink","newLink","getLinks","lists","LinkProviderRegistry","provideLinks","general","collapseOnReplaceEdit","active","LinkOccurrence","useMetaKey","_getOptions","isActive","executeCmd","getHoverMessage","activate","deactivate","LinkDetector","listenersToRemove","clickLinkGesture","cleanUpActiveLinkDecoration","onModelModeChanged","async","computePromise","activeLinksList","currentOccurrences","activeLinkDecorationId","occurance","occurrence_1","getLinkOccurrence","occurrence_2","occurrence","openLinkOccurrence","messageOrError","warn","decorations_1","decoration_1","currentOccurrence","OpenLinkAction","linkDetector","InsertCursorAbove","useLogicalLine","logicalLine","readOnly","pushStackElement","setStates","CursorMoveCommands","addCursorUp","getAll","InsertCursorBelow","addCursorDown","InsertCursorAtEndOfEachLineSelected","getCursorsForSelection","currentLineMaxColumn","InsertCursorAtEndOfLineSelected","InsertCursorAtTopOfLineSelected","MultiCursorSessionResult","revealScrollType","MultiCursorSession","findController","isDisconnectedFromFindController","searchText","findState","addSelectionToNextFindMatch","allSelections","moveSelectionToNextFindMatch","lastAddedSelection","addSelectionToPreviousFindMatch","previousMatch","_getPreviousMatch","moveSelectionToPreviousFindMatch","selectAll","MultiCursorSelectionController","_sessionDispose","_session","_endSession","_beginSessionIfNeeded","session","_setSelections","_expandEmptyToWord","_applySessionResult","getSession","modelRangesContainSameText","resultingSelections","inSelection","MultiCursorSelectionControllerAction","multiCursorController","AddSelectionToNextFindMatchAction","AddSelectionToPreviousFindMatchAction","MoveSelectionToNextFindMatchAction","MoveSelectionToPreviousFindMatchAction","SelectHighlightsAction","CompatChangeAll","SelectionHighlighterState","softEquals","SelectionHighlighter","updateSoon","_setState","_createState","findStateSearchString","mySearchString","hasFindOccurrences","DocumentHighlightProviderRegistry","allMatches","cmp","areIntersecting","_SELECTION_HIGHLIGHT","_SELECTION_HIGHLIGHT_OVERVIEW","overviewRulerSelectionHighlightForeground","selectedText","Context","Visible","MultipleSignatures","provideSignatureHelp","supports","modes","triggerKind","Invoke","isRetrigger","triggerCharacter","ParameterHintState","Default","Pending","Active","hints","ParameterHintsModel","DEFAULT_DELAY","_onChangedHints","onChangedHints","triggerOnType","_pendingTriggers","_lastSignatureHelpResult","retriggerChars","triggerId","throttledDelayer","onEditorConfigurationChange","onCursorChange","onModelContentChange","doTrigger","signatures","activeSignature","cycle","updateActiveSignature","activeSignatureHelp","triggerContext","error_1","mergeTriggerContexts","isTriggered","signatureHelpTriggerCharacters","signatureHelpRetriggerCharacters","lastCharIndex","triggerCharCode","TriggerCharacter","ContentChange","ParameterHintsWidget","renderDisposeables","announcedLabel","markdownRenderer","keyVisible","keyMultipleSignatures","newParameterHints","createParamaterHintDOMNodes","overloads","onPreviousClick","onNextClick","signature","docs","userSelect","domNodes","chain","on","updateMaxHeight","hasParameters","renderParameters","activeParameter","documentation","hasDocs","labelToAnnounce","getParameterLabel","currentParameter","getParameterLabelOffsets","beforeSpan","paramSpan","afterSpan","paramIdx","param","ParameterHintsController","TriggerParameterHintsAction","hasSignatureHelpProvider","ParameterHintsCommand","CONTEXT_RENAME_INPUT_VISIBLE","RenameInputField","_currentAcceptInput","_currentCancelInput","_visibleContextKey","updateStyles","_inputField","boxShadow","fontWeight","acceptInput","cancelInput","disposeOnDone","always","revealLineInCenterIfOutsideViewport","RenameSkeleton","_providers","RenameProviderRegistry","hasProvider","resolveRenameLocation","firstProvider","provideRenameEdits","newName","rejects","rejectReason","RenameController","_dispoableStore","_cts","CancellationTokenSource","_renameInputField","IdleValue","skeleton","loc","resolveLocationOperation","newNameOrFocusFlag","renameOperation","renameResult","editResult","ariaSummary","acceptRenameInput","cancelRenameInput","RenameAction","hasRenameProvider","RenameCommand","WordSelectionRangeProvider","provideSelectionRanges","positions_1","bucket","_addInWordRanges","_addWordRanges","_addWhitespaceLine","lastCh","isLowerAsciiLetter","isUpperAsciiLetter","getLineLastNonWhitespaceColumn","BracketSelectionRangeProvider","_bracketsRightYield","_bracketsLeftYield","counts","t1","Date","now","_maxRounds","bracket","_maxDuration","close","findPrevBracket","closing","innerBracket","outerBracket","_addBracketLeading","startLine","aboveLine","column_1","SelectionRanges","mov","SmartSelectController","_ignoreSelection","_selectionListener","forward","arrays","AbstractSmartSelect","_forward","GrowSelectionAction","ShrinkSelectionAction","work","allRawRanges","allProviderRanges","oneProviderRanges","oneRawRanges","oneRanges","oneRawRanges_1","oneRangesWithTrivia","prev","cur","rangeNoWhitespace","rangeFull","MultipleSuggestions","MakesTextEdit","AcceptSuggestionsOnEnter","CompletionItem","completion","distance","labelLow","sortTextLow","sortText","filterTextLow","filterText","editStart","editInsertEnd","editReplaceEnd","cached_1","resolveCompletionItem","isDone_1","onCancellationRequested","CompletionOptions","snippetSortOrder","kindFilter","providerFilter","provideSuggestionItems","defaultReplaceRange","defaultInsertRange","orderedGroups","allSuggestions","hasResult","factory","provideCompletionItems","suggestions","suggestion","_snippetSuggestSupport","getSuggestionComparator","defaultComparator","_snippetComparators","snippetConfig","resolving","maxItemsToResolve","items","items_1","incomplete","onlyOnceSuggestions","Scanner","isDigitCharacter","isVariableCharacter","tokenText","_table","isNaN","Marker","_children","Text","others","newChildren","_fixParent","children_1","child_1","TextmateSnippet","_this_1","TransformableMarker","Placeholder","compareByIndex","isFinalTabstop","Choice","transform","Transform","regexp","didMatch","_replace","FormatString","elseValue","shorthandName","ifValue","_toPascalCase","Variable","walk","visitor","marker_1","_placeholders","last_1","all_1","placeholderInfo","fullLen","enclosingPlaceholders","resolveVariables","SnippetParser","_scanner","insertFinalTabstop","enforceFinalTabstop","snippet","_parse","placeholderDefaultValues","incompletePlaceholders","placeholderCount","incompletePlaceholders_1","defaultValues","defaultValues_1","_accept","_backTo","_until","nextToken","_parseEscaped","_parseTabstopOrVariableName","_parseComplexPlaceholder","_parseComplexVariable","_parseAnything","_parseTransform","choice","_parseChoiceElement","variable","regexValue","regexOptions","_parseFormatString","complex","shorthand","isSingleFolderWorkspaceIdentifier","CompositeSnippetVariableResolver","_delegates","SelectionBasedVariableResolver","lineLeadingWhitespace","getLeadingWhitespace","varLeadingWhitespace_1","whitespaceCommonLength_1","commonPrefixLength","ModelBasedVariableResolver","_labelService","ClipboardBasedVariableResolver","_readClipboardText","_selectionIdx","_selectionCount","_spread","clipboardText","isFalsyOrWhitespace","CommentBasedVariableResolver","TimeBasedVariableResolver","getFullYear","getMonth","valueOf","getDate","getHours","getMinutes","getSeconds","dayNames","getDay","dayNamesShort","monthNames","monthNamesShort","WorkspaceBasedVariableResolver","_workspaceService","workspaceIdentifier","workspace","configPath","toWorkspaceIdentifier","_resolveWorkspaceName","_resoveWorkspacePath","filename","endsWith","folderpath","RandomBasedVariableResolver","getColorGraceful","OneSnippet","_nestingLevel","_snippet","_offset","_placeholderGroups","groupBy","placeholders","_placeholderGroupsIdx","_placeholderDecorations","toRemove_1","_initDecorations","placeholderOffset","placeholderLen","getPositionAt","_decor","inactiveFinal","inactive","couldSkipThisPlaceholder","activePlaceholders","_hasPlaceholderBeenCollapsed","activeFinal","enclosingPlaceholder","id_1","computePossibleSelections","placeholdersWithEqualIndex_1","nested","assert","indexLastPlaceholder","nestedPlaceholder","placeholder_1","_defaultOptions","overwriteBefore","overwriteAfter","adjustWhitespace","SnippetSession","_templateMerges","_snippets","_template","adjustIndentation","adjustNewlines","templateLeadingWhitespace","normalizeIndentation","getEOL","adjustSelection","positionColumnBefore","positionColumnAfter","createEditsAndSnippets","snippets","workspaceService","IWorkspaceContextService","modelBasedVariableResolver","readClipboardText","readTextSync","firstBeforeText","firstAfterText","firstLineFirstNonWhitespace","indexedSelections","indexedSelections_1","extensionBefore","extensionAfter","snippetSelection","getOffsetAt","_logInfo","hasPlaceholder","_move","oneSelection","isAtFirstPlaceholder","isAtLastPlaceholder","isSelectionWithinPlaceholders","allPossibleSelections","array","undoStopBefore","undoStopAfter","SnippetController2","_logService","_snippetListener","_modelVersionId","_inSnippet","InSnippetMode","_hasNextTabstop","HasNextTabstop","_hasPrevTabstop","HasPrevTabstop","_doInsert","getAlternativeVersionId","_updateState","_handleChoice","_currentChoice","first_1","option","insertText","repeat","triggerSuggest","finish","resetSelection","isInSnippet","ILogService","CommandCtor","ctrl","Memory","topScore","preselect","NoMemory","memorize","LRUMemory","_seq","touch","lineSuffix","indexPreselect","indexRecency","seq","data_1","completionKindFromString","PrefixMemory","_trie","TernarySearchTree","forStrings","findSubstr","data_2","SuggestMemoryService","_configService","_storagePrefix","share","_persistSoon","_saveState","affectsConfiguration","onDidChangeStorage","scope","_mode","_shareMem","shareMem","_strategy","ISuggestMemoryService","SuggestAlternatives","_index","_ckOtherSuggestions","OtherSuggestions","_acceptNext","_ignore","acceptNext","_moveIndex","CompletionModel","lineContext","wordDistance","snippetSuggestions","_snippetCompareFn","_compareCompletionItems","_items","_column","_wordDistance","_refilterKind","_lineContext","_compareCompletionItemsSnippetsUp","_compareCompletionItemsSnippetsDown","leadingLineContent","characterCountDelta","_filteredItems","_ensureCachedState","_isIncomplete","adopt","except","_stats","_createCachedState","suggestionCount","snippetCount","textCount","wordLow","scoreFn","filterGraceful","fuzzyScore","fuzzyScoreGracefulAggressive","wordLen","wordPos","compareIgnoreCase","anyScore","WordDistance","service","wordRanges","localityBonus","canComputeWordRanges","computeWordRanges","wordLines","isFalsyOrEmpty","bestWordRange","blockDistance","class_2","LineContext","auto","shy","leadingWord","shouldAutoTrigger","SuggestModel","_editorWorker","_quickSuggestDelay","_triggerQuickSuggest","_completionDisposables","_onDidCancel","_onDidTrigger","_onDidSuggest","onDidCancel","onDidTrigger","onDidSuggest","_currentSelection","_updateTriggerCharacters","_updateQuickSuggest","CompletionProviderRegistry","_updateActiveSuggestSession","editorIsComposing","onCompositionStart","onCompositionEnd","_refilterCompletionItems","_triggerCharacterListener","supportsByTriggerCharacter","triggerCharacters","getSnippetSuggestSupport","lastChar","_completionModel","_requestToken","_context","prevSelection","snippetsPreventQuickSuggestions","quickSuggestions","lineTokens","tokenType","getStandardTokenType","findTokenIndexAtOffset","_onNewContext","onlyFrom","existingItems","suggestCtx","itemKindFilter","_createItemKindFilter","cmpFn","suggestOptions","showMethods","showFunctions","showConstructors","showFields","showVariables","showClasses","showStructs","showInterfaces","showModules","showProperties","showEvents","showOperators","showUnits","showValues","showConstants","showEnums","showEnumMembers","showKeywords","showWords","showColors","showFiles","showReferences","showFolders","showTypeParameters","showSnippets","adopted","oldLineContext","isFrozen","completionModel","SYMBOL_ICON_ARRAY_FOREGROUND","SYMBOL_ICON_BOOLEAN_FOREGROUND","SYMBOL_ICON_CLASS_FOREGROUND","SYMBOL_ICON_COLOR_FOREGROUND","SYMBOL_ICON_CONSTANT_FOREGROUND","SYMBOL_ICON_CONSTRUCTOR_FOREGROUND","SYMBOL_ICON_ENUMERATOR_FOREGROUND","SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND","SYMBOL_ICON_EVENT_FOREGROUND","SYMBOL_ICON_FIELD_FOREGROUND","SYMBOL_ICON_FILE_FOREGROUND","SYMBOL_ICON_FOLDER_FOREGROUND","SYMBOL_ICON_FUNCTION_FOREGROUND","SYMBOL_ICON_INTERFACE_FOREGROUND","SYMBOL_ICON_KEY_FOREGROUND","SYMBOL_ICON_KEYWORD_FOREGROUND","SYMBOL_ICON_METHOD_FOREGROUND","SYMBOL_ICON_MODULE_FOREGROUND","SYMBOL_ICON_NAMESPACE_FOREGROUND","SYMBOL_ICON_NULL_FOREGROUND","SYMBOL_ICON_NUMBER_FOREGROUND","SYMBOL_ICON_OBJECT_FOREGROUND","SYMBOL_ICON_OPERATOR_FOREGROUND","SYMBOL_ICON_PACKAGE_FOREGROUND","SYMBOL_ICON_PROPERTY_FOREGROUND","SYMBOL_ICON_REFERENCE_FOREGROUND","SYMBOL_ICON_SNIPPET_FOREGROUND","SYMBOL_ICON_STRING_FOREGROUND","SYMBOL_ICON_STRUCT_FOREGROUND","SYMBOL_ICON_TEXT_FOREGROUND","SYMBOL_ICON_TYPEPARAMETER_FOREGROUND","SYMBOL_ICON_UNIT_FOREGROUND","SYMBOL_ICON_VARIABLE_FOREGROUND","symbolIconArrayColor","symbolIconBooleanColor","symbolIconClassColor","symbolIconMethodColor","symbolIconColorColor","symbolIconConstantColor","symbolIconConstructorColor","symbolIconEnumeratorColor","symbolIconEnumeratorMemberColor","symbolIconEventColor","symbolIconFieldColor","symbolIconFileColor","symbolIconFolderColor","symbolIconFunctionColor","symbolIconInterfaceColor","symbolIconKeyColor","symbolIconKeywordColor","symbolIconModuleColor","outlineNamespaceColor","symbolIconNullColor","symbolIconNumberColor","symbolIconObjectColor","symbolIconOperatorColor","symbolIconPackageColor","symbolIconPropertyColor","symbolIconReferenceColor","symbolIconSnippetColor","symbolIconStringColor","symbolIconStructColor","symbolIconTextColor","symbolIconTypeParameterColor","symbolIconUnitColor","symbolIconVariableColor","FileKind","getIconClasses","modelService","fileKind","ROOT_FOLDER","FOLDER","DataUri","parseMetaData","META_DATA_LABEL","cssEscape","dotSegments","detectedModeId","mime","META_DATA_MIME","getModeId","PLAINTEXT_MODE_ID","detectModeId","editorSuggestWidgetBackground","editorSuggestWidgetBorder","editorSuggestWidgetForeground","editorForeground","editorSuggestWidgetSelectedBackground","listFocusBackground","editorSuggestWidgetHighlightForeground","listHighlightForeground","colorRegExp","canExpandCompletionItem","triggerKeybindingLabel","_modelService","addClass","colorspan","main","iconContainer","iconLabel","typeLabel","readMore","configureFont","fontSizePx","lineHeightPx","completionKindToCssClass","labelOptions","getIconTheme","hasFileIcons","labelClasses","from","FILE","detailClasses","hasFolderIcons","addClasses","tags","toggleDetails","SuggestionDetails","renderLoading","renderItem","explainMode","renderDisposeable","md","_debugDisplayName","removeClass","scrollDown","much","scrollUp","scrollBottom","pageDown","pageUp","setBorderWidth","SuggestWidget","telemetryService","isAuto","loadingTimeout","currentSuggestionDetails","ignoreFocusEvents","showTimeout","onDidSelectEmitter","onDidFocusEmitter","onDidHideEmitter","onDidShowEmitter","onDidSelect","onDidHide","onDidShow","maxWidgetWidth","listWidth","firstFocusInCurrentList","preferDocPositionTop","docsPositionPreviousWidgetY","_onDetailsKeydown","onDetailsKeyDown","_lastAriaAlertLabel","focusedItem","addDisposableListener","hideWidget","listElement","details","applyIconStyle","showIcons","List","openController","shouldOpen","mouseSupport","attachListStyler","listInactiveFocusBackground","listInactiveFocusOutline","onEditorLayoutChange","onListMouseDownOrTap","onTap","onListSelection","onFocusChange","onListFocus","onCursorSelectionChanged","suggestWidgetVisible","SuggestContext","suggestWidgetMultipleSuggestions","addStandardDisposableListener","expandDocsSettingFromStorage","expandSideOrBelow","_getSuggestionAriaAlertLabel","_ariaAlert","newAriaAlertLabel","detailsBorderColor","focusBorderColor","detailsFocusBorderColor","loading","showDetails","stateChanged","listHeight","LOADING_MESSAGE","NO_SUGGESTIONS_MESSAGE","showTriggered","showSuggestions","selectionIndex","visibleCount","stats","publicLog","selectNextPage","focusNextPage","selectNext","focusNext","selectLast","focusLast","selectPreviousPage","focusPreviousPage","selectPrevious","focusPrevious","selectFirst","focusFirst","getFocusedItem","getFocusedElements","toggleDetailsFocus","publicLog2","updateExpandDocsSetting","maxWidgetHeight","adjustDocsPosition","toggleExplainMode","updateListHeight","unfocusedHeight","contentHeight","maxVisibleSuggestions","cursorX","cursorY","widgetCoords","widgetX","widgetY","hasClass","ITelemetryService","matchHighlight","WordContextKey","_enabled","_ckAtEnd","AtEnd","checkForWordEnd","CommitCharacterController","accept","_onItem","onWillType","_active","acceptCharacters","commitCharacters","SuggestRangeHighlighter","focused","_highlight","_widgetListener","_reset","_shiftKeyListener","_currentItem","newDeco","insertHighlight","getOverwriteInfo","isPressed","insertMode","wordInfo","ShiftKey","_subscriptions","_isPressed","LineSuffix","_marker","SuggestController","editorWorker","_memoryService","_lineSuffix","_insertSuggestion","commitCharacterController","makesTextEdit","insertTextRules","_alternatives","toKeybinding","SimpleKeybinding","isModifierKey","acceptSuggestionsOnEnter","updateFromConfig","acceptSuggestionOnEnter","modelVersionNow","TriggerSuggestAction","canUndo","undo","_alertCompletionItem","toggleMode","triggerSuggestAndAcceptBest","positionNow","fallback","any","acceptSelectedSuggestion","keepAlternativeSuggestions","alternativeOverwriteConfig","acceptNextSuggestion","acceptPrevSuggestion","cancelSuggestWidget","selectNextSuggestion","selectNextPageSuggestion","selectLastSuggestion","selectPrevSuggestion","selectPrevPageSuggestion","selectFirstSuggestion","toggleSuggestionDetails","toggleSuggestionFocus","hasCompletionItemProvider","SuggestCommand","alternative","registerKeybindingRule","isObject","ForceRetokenizeAction","resetTokenization","sw","StopWatch","forceTokenization","elapsed","ToggleTabFocusModeAction","TabFocus","getTabFocusMode","setTabFocusMode","editorWordHighlight","editorWordHighlightStrong","editorWordHighlightBorder","editorWordHighlightStrongBorder","overviewRulerWordHighlightForeground","overviewRulerWordHighlightStrongForeground","ctxHasWordHighlights","getOccurrencesAtPosition","orderedByScore","provideDocumentHighlights","OccurenceAtPositionRequest","_wordRange","_getCurrentWordRange","_compute","currentWordRange","requestIsValid","SemanticOccurenceAtPositionRequest","TextualOccurenceAtPositionRequest","_selectionIsEmpty","DocumentHighlightKind","currentSelectionIsEmpty","WordHighlighter","workerRequestTokenId","workerRequestCompleted","workerRequestValue","lastCursorPositionChangeTime","renderDecorationsTimer","_hasWordHighlights","_ignorePositionChangeEvent","occurrencesHighlight","_onPositionChanged","_stopAll","workerRequest","hasDecorations","_getSortedHighlights","moveNext","dest","moveBack","workerRequestIsValid","getTime","_beginRenderDecorations","myRequestId_1","currentTime","minimumRenderTime","renderDecorations","_getDecorationOptions","Write","_WRITE_OPTIONS","_TEXT_OPTIONS","_REGULAR_OPTIONS","WordHighlighterContribution","wordHighligher","createWordHighlighterIfPossible","WordHighlightNavigationAction","NextWordHighlightAction","PrevWordHighlightAction","TriggerWordHighlightAction","selectionHighlight","editorSelectionHighlight","wordHighlight","wordHighlightStrong","selectionHighlightBorder","editorSelectionHighlightBorder","wordHighlightBorder","wordHighlightStrongBorder","MoveWordCommand","_inSelectionMode","inSelectionMode","_wordNavigationType","wordNavigationType","getMapForWordSeparators","inPosition","outPosition","_moveTo","fromModelSelection","to","WordLeftCommand","WordOperations","moveWordLeft","WordRightCommand","moveWordRight","CursorWordStartLeft","CursorWordEndLeft","CursorWordLeft","CursorWordStartLeftSelect","CursorWordEndLeftSelect","CursorWordLeftSelect","CursorWordAccessibilityLeft","CONTEXT_ACCESSIBILITY_MODE_ENABLED","EditorOptions","defaultValue","CursorWordAccessibilityLeftSelect","CursorWordStartRight","CursorWordEndRight","CursorWordRight","CursorWordStartRightSelect","CursorWordEndRightSelect","CursorWordRightSelect","CursorWordAccessibilityRight","CursorWordAccessibilityRightSelect","DeleteWordCommand","_whitespaceHeuristics","whitespaceHeuristics","deleteRange","_delete","DeleteWordLeftCommand","deleteWordLeft","DeleteWordRightCommand","deleteWordRight","DeleteWordStartLeft","DeleteWordEndLeft","DeleteWordLeft","DeleteWordStartRight","DeleteWordEndRight","DeleteWordRight","DeleteWordPartLeft","WordPartOperations","deleteWordPartLeft","DeleteWordPartRight","deleteWordPartRight","WordPartLeftCommand","moveWordPartLeft","CursorWordPartLeft","CursorWordPartLeftSelect","WordPartRightCommand","moveWordPartRight","CursorWordPartRight","CursorWordPartRightSelect","CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE","AccessibilityHelpController","AccessibilityHelpWidget","_isVisibleKey","createFastDomNode","setClassName","setDisplay","_contentDomNode","_layout","AccessibilityHelpNLS","emergencyConfOn","accessibilitySupport","_buildContent","openingDocs","accessibilityHelpUrl","_descriptionForCommand","noKbMsg","charactersSelected","singleSelectionRange","singleSelection","multiSelectionRange","multiSelection","noSelection","getSelectionLabel","readonlyDiffEditor","editableDiffEditor","readonlyEditor","editableEditor","turnOnMessage","changeConfigToOnMac","changeConfigToOnWinLinux","auto_on","auto_off","tabFocusModeOnMsg","tabFocusModeOnMsgNoKb","tabFocusModeOffMsg","tabFocusModeOffMsgNoKb","openDocMac","openDocWinLinux","outroMsg","w","WIDTH","HEIGHT","setWidth","setHeight","setTop","setLeft","ShowAccessibilityHelpAction","showAccessibilityHelpAction","AccessibilityHelpCommand","IPadShowKeyboard","shouldHaveWidget","ShowKeyboardWidget","InspectTokensController","standaloneColorService","launch","InspectTokensWidget","IStandaloneThemeService","InspectTokens","InspectTokensNLS","inspectTokensAction","_tokenizationSupport","languageIdentifier","tokenizationSupport","getInitialState","NULL_STATE","tokenize","deltaOffset","nullTokenize","tokenize2","nullTokenize2","getSafeTokenizationSupport","_ID","_getTokensAtLine","token1Index","tokens1","token2Index","tokens2","tokenStartIndex","tokenEndIndex","charIndex","charCode","renderTokenText","metadata","_decodeMetadata","_tokenTypeToString","_fontStyleToString","fontStyle","formatHex","colorMap","getColorMap","TokenMetadata","getLanguageId","getTokenType","getFontStyle","getForeground","getBackground","stateBeforeLine","_getStateBeforeLine","tokenizationResult1","tokenizationResult2","startState","endState","KeybindingLabel","os","areSame","getParts","firstPart","chordPart","renderPart","renderUnboundKeybindings","renderUnbound","modifierLabels","UILabelProvider","renderKey","keyLabel","IDS","QuickOpenEntry","labelHighlights","descriptionHighlights","getLabelOptions","getDescription","getDetail","getIcon","getTooltip","getDescriptionTooltip","getKeybinding","hidden","setHighlights","detailHighlights","getHighlights","QuickOpenEntryGroup","groupLabel","withBorder","getGroupLabel","setGroupLabel","showBorder","setShowBorder","NoActionProvider","hasActions","tree","actionProvider","actionRunner","entryContainer","row1","row2","keybindingContainer","OS","detailContainer","actionBarContainer","actionBar","groupData","pickerGroupBorder","pickerGroupForeground","QuickOpenModel","_entries","_dataSource","_renderer","_filter","_runner","_accessibilityProvider","modelProvider","isFunction","dataSource","getParent","AccessibilityProvider","getPosInSet","getSetSize","Filter","KeybindingDispatcher","_arr","createKeybinding","dispatch","toChord","DefaultController","clickBehavior","openMode","downKeyBindingDispatcher","upKeyBindingDispatcher","onUp","onDown","onLeft","onRight","onPageUp","onPageDown","onHome","onSpace","onEscape","onEnter","onLeftClick","eventish","payload","originalEvent","didClickOnTwistie","isClickOnTwistie","clearFocus","clearSelection","shouldToggleExpansion","isExpanded","collapse","errors","isDoubleClick","openOnSingleClick","twistieStyle","window","getComputedStyle","backgroundImage","twistieWidth","initialTarget","onKey","bindings","getHighlight","clearHighlight","focus_1","didCollapse","focusParent","focus_2","didExpand","focusFirstChild","toggleExpansion","DefaultDragAndDrop","getDragURI","onDragStart","onDragOver","targetElement","drop","DefaultFilter","DefaultAccessibilityProvider","DefaultTreestyler","styleElement","selectorSuffix","listFocusForeground","listActiveSelectionBackground","listActiveSelectionForeground","listFocusAndSelectionBackground","listFocusAndSelectionForeground","listInactiveSelectionBackground","listInactiveSelectionForeground","listHoverBackground","listHoverForeground","listDropBackground","listFocusOutline","newStyles","LockData","_onDispose","onDispose","_item","Lock","locks","isLocked","lock","getLock","ItemRegistry","_onDidRevealItem","EventMultiplexer","onDidRevealItem","_onExpandItem","onExpandItem","_onDidExpandItem","onDidExpandItem","_onCollapseItem","onCollapseItem","_onDidCollapseItem","onDidCollapseItem","_onDidAddTraitItem","onDidAddTraitItem","_onDidRemoveTraitItem","onDidRemoveTraitItem","_onDidRefreshItem","onDidRefreshItem","_onRefreshItemChildren","onRefreshItemChildren","_onDidRefreshItemChildren","onDidRefreshItemChildren","_onDidDisposeItem","onDidDisposeItem","Assert","isRegistered","onDidReveal","onExpand","onDidExpand","onCollapse","onDidCollapse","onDidAddTrait","onDidRemoveTrait","onDidRefresh","onRefreshChildren","onDidRefreshChildren","deregister","getItem","Item","_onDidCreate","_onDidReveal","_onExpand","_onDidExpand","_onCollapse","_onDidCollapse","_onDidAddTrait","_onDidRemoveTrait","_onDidRefresh","_onRefreshChildren","_onDidRefreshChildren","_onDidDispose","doesHaveChildren","needsChildrenRefresh","lastChild","traits","shouldAutoexpand","getElement","getDepth","_setExpanded","relativeTop","eventData","refreshChildren","autoExpandSingleChildren","recursive","collapseChildrenPromise_1","forEachChild","addTrait","trait","removeTrait","hasTrait","getAllTraits","safe","setNeedsChildrenRefresh_1","doRefresh","isNested","staleItems","addChild","staleItemId","mapEachChild","updateVisibility","refresh","getNavigator","TreeNavigator","isAncestorOf","startItem","afterItem","atHead","atTail","isFirstChild","isLastChild","NaN","sorter","otherElement","RootItem","subTreeOnly","lastDescendantOf","parent_1","TreeModel","registryDisposable","_onSetInput","onSetInput","_onDidSetInput","onDidSetInput","_onRefresh","onRefresh","_onDidHighlight","onDidHighlight","_onDidSelect","_onDidFocus","Relay","traitsToItems","setHighlight","resolveUnknownParentChain","eventPayload","setTraits","includeHidden","getElementsWithTrait","nextItem","nav","previousItem","focusNth","navItem","fromItem","removeTraits","traitItems","itemsToRemoveTrait","ElementsDragAndDropData","dataTransfer","getData","ExternalElementsDragAndDropData","DesktopDragAndDropData","files","HeightMap","heightMap","getContentHeight","onInsertItems","afterItemId","totalSize","sizeDiff","boundSplice","itemsToInsert","createViewItem","onInsertItem","onRefreshItem","onRemoveItems","itemId","onRemoveItem","onRefreshItemSet","sortedItems","onRefreshItems","ArrayIterator","cummDiff","needsRender","indexAt","center","indexAfter","itemAtIndex","itemAfter","ContextMenuEvent","_posx","_posy","_target","MouseContextMenuEvent","KeyboardContextMenuEvent","RowCache","alloc","cache","release","removeFromParent","garbageCollect","cachedRow","unbindDragStart","Lifecycle","_draggable","_styles","_templateId","skipUserRender","draggable","accessibility","base64Id","paddingOnRow","twistiePixels","indentPixels","firstElementChild","dnd","horizontalScrolling","Browser","insertInDOM","afterElement","TreeView","BINDING","removeFromDOM","RootViewItem","lastPointerType","lastClickTimeStamp","contentWidthUpdateDelayer","isRefreshing","refreshingPreviousChildrenIds","currentDragAndDropData","currentDropTarget","currentDropTargets","currentDropDisposable","gestureDisposable","dragAndDropScrollInterval","dragAndDropScrollTimeout","dragAndDropMouseY","highlightedItemWasDraggable","onHiddenScrollTop","_onDOMFocus","onDOMFocus","_onDOMBlur","_onDidScroll","counter","instance","horizontalScrollMode","modelListeners","viewListeners","preventRootFocus","treeStyler","styler","alwaysFocused","verticalScrollMode","msTouchAction","msContentZooming","Touch","addTarget","rowsContainer","showTwistie","focusTracker","button","onMouseMiddleClick","Tap","Change","onTouchChange","onMsPointerDown","onMsGestureTap","onThrottledMsGestureChange","lastEvent","translationY","translationX","onDrop","onDragEnd","lastRenderTop","lastRenderHeight","didJustPressContextMenuKey","shouldInvalidateDropReaction","onRowsChanged","setupMSGesture","getHTMLElement","isFocused","MSGesture","msGesture","isTreeVisible","viewHeight","viewWidth","renderTop","renderBottom","thisRenderBottom","insertItemInDOM","removeItemFromDOM","topItem","releaseModel","onRefreshing","onRefreshed","onClearingInput","onModelFocusChange","onItemChildrenRefreshing","onItemChildrenRefreshed","onItemRefresh","onItemExpanding","onItemExpanded","onItemCollapsing","onItemReveal","onItemAddTrait","onItemRemoveTrait","updateScrollWidth","keys_1","lastPageIndex","lastPageElement","previousScrollTop","firstPageIndex","firstPageElement","getScrollDimensions","getScrollPosition","MappedIterator","inputItem","showLoading","loadingTimer","LOADING_DECORATION_DELAY","childrenIds","navigator_1","childItem","previousChildrenIds_1","afterModelItems_1","navigator_2","skipDiff","doToInsertItemsAlreadyExist","Diff","getElements","ComputeDiff","modifiedLength","modifiedStart","diff_1","diffChange","originalLength","originalStart","beforeItem","onItemsRefresh","viewItemBottom","wrapperBottom","refreshViewItem","shouldBeRendered","Mouse","getItemAround","Platform","resultEvent","Keyboard","effectAllowed","setData","DataTransfers","RESOURCES","setDragImage","getDragLabel","dragImage_1","StaticDND","CurrentDragAndDropData","setupDragAndDropScrollInterval","viewTop","setInterval","scrollDiff","upperLimit","cancelDragAndDropScrollTimeout","cancelDragAndDropScrollInterval","clearInterval","DRAG_LEAVE","dropTarget","currentDropElement","reaction","bubble","canDrop","dropEffect","effect","one","currentDropElementReaction","autoExpand","timeoutPromise_1","event_1","pointerType","MSPOINTER_TYPE_MOUSE","MSPOINTER_TYPE_TOUCH","addPointer","pointerId","elementFromPoint","clientX","clientY","elementAfter","parentNode","TreeContext","TreeDefaults","Tree","_onDidChangeFocus","_onDidChangeSelection","onDidChangeSelection","_onHighlightChange","Model","View","isDOMFocused","domBlur","progressBarBackground","ProgressBar","workedVal","showDelayedScheduler","off","removeClasses","totalWork","doDone","delayed","QuickOpenController","DEFAULT_INPUT_ARIA_LABEL","QuickOpenWidget","callbacks","CONTEXT_MENU","gainingFocus","loosingFocus","KEY_DOWN","StandardKeyboardEvent","stops","currentTarget","querySelectorAll","progressBar","inputContainer","inputPlaceHolder","INPUT","onType","shouldOpenInBackground","navigateInTree","elementSelected","resultCount","treeContainer","createTree","treeCreator","treeElement","elementFocused","StandardMouseEvent","quickNavigateConfiguration","KEY_UP","keybindings","focus_3","layoutDimensions","helpText","isShift","oldFocus","newFocus","arivaActiveDescendant","keymods","extractKeyMods","runner","preferredMode","ctrlCmd","isLoosingFocus","doShowWithPrefix","restoreLastInput","doShowWithInput","autoFocus","inputSelection","onShow","lastInput","setInputAndLayout","isElementVisible","updateResultCount","autoFocusPrefixMatch","caseSensitiveMatch","caseInsensitiveMatch","lowerCasePrefix","entries_1","entryToFocus","autoFocusFirstEntry","autoFocusIndex","autoFocusSecondEntry","autoFocusLastEntry","itemHeight","minItemsToShow","preferredItemsHeight","MAX_ITEMS_HEIGHT","maxEntries","maxItemsToShow","entryHeight","onOk","onInputChanging","inputChangingTimeoutHandle","dimension","quickOpenWidth","MAX_WIDTH","relatedTarget","onFocusLost","QuickOpenEditorWidget","quickOpenWidget","inputAriaLabel","attachQuickOpenStyler","destroy","Dimension","rangeHighlightDecorationId","lastKnownEditorSelection","onClose","clearDecorations","getAutoFocus","decorateLine","BaseEditorQuickOpenAction","_inputAriaLabel","getController","searchValue","GotoLineEntry","parseResult","parseInput","numbers","diffModel","modified","validatePosition","GoToLineNLS","gotoLineLabelValidLineAndColumn","gotoLineLabelValidLine","gotoLineLabelEmptyWithLineLimit","gotoLineLabelEmptyWithLineAndColumnLimit","currentLine","gotoLineAriaLabel","runOpen","runPreview","toSelection","GotoLineAction","gotoLineActionInput","gotoLineActionLabel","EditorActionCommandEntry","keyAriaLabel","QuickCommandNLS","ariaLabelEntryWithKey","ariaLabelEntry","QuickCommandAction","quickCommandActionInput","quickCommandActionLabel","_editorActionsToEntries","_sort","elementA","elementB","elementAName","elementBName","getSupportedActions","matchesFuzzy","TreeElement","findId","candidateId","_key","OutlineElement","OutlineGroup","providerIndex","MovingAverage","_n","_val","OutlineModel","_groups","_keys","for","_requests","promiseCnt","_create","now_1","avg","_requestDurations","DocumentSymbolProviderRegistry","provideDocumentSymbols","_makeOutlineElement","newProvider","_compact","childInfo","_counter","_hash","getDocumentSymbols","flat","roots","flatEntries","overrideContainerLabel","containerName","selectionRange","compareEntriesUsingStart","SymbolEntry","QuickOutlineNLS","entryAriaLabel","getRange","QuickOutlineAction","quickOutlineActionInput","quickOutlineActionLabel","hasDocumentSymbolProvider","toQuickOpenEntries","symbolEntry","flattened","normalizedSearchValue","flattened_1","SymbolKinds","toCssClassName","sortScoped","sortNormal","currentType","currentResult","typeCounter","typeToLabel","_symbols_","_modules_","_class_","_interface_","_method_","_function_","_property_","_variable_","_variable2_","_constructor_","_call_","elementARange","elementBRange","elementAType","elementBType","r_1","StandaloneReferencesController","configurationService","ToggleHighContrast","ToggleHighContrastNLS","toggleHighContrast","_originalThemeName","standaloneThemeService","setTheme","themeName"],"mappings":"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","file":"static/js/4.231ab957.chunk.js","sourcesContent":["import '../../editor/editor.api.js';\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { typescriptVersion } from './lib/typescriptServicesMetadata.js'; // do not import the whole typescriptServices here\r\nvar Emitter = monaco.Emitter;\r\nvar LanguageServiceDefaultsImpl = /** @class */ (function () {\r\n    function LanguageServiceDefaultsImpl(compilerOptions, diagnosticsOptions) {\r\n        this._onDidChange = new Emitter();\r\n        this._onDidExtraLibsChange = new Emitter();\r\n        this._extraLibs = Object.create(null);\r\n        this._eagerModelSync = false;\r\n        this.setCompilerOptions(compilerOptions);\r\n        this.setDiagnosticsOptions(diagnosticsOptions);\r\n        this._onDidExtraLibsChangeTimeout = -1;\r\n    }\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"onDidChange\", {\r\n        get: function () {\r\n            return this._onDidChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"onDidExtraLibsChange\", {\r\n        get: function () {\r\n            return this._onDidExtraLibsChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LanguageServiceDefaultsImpl.prototype.getExtraLibs = function () {\r\n        return this._extraLibs;\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.addExtraLib = function (content, _filePath) {\r\n        var _this = this;\r\n        var filePath;\r\n        if (typeof _filePath === 'undefined') {\r\n            filePath = \"ts:extralib-\" + Math.random().toString(36).substring(2, 15);\r\n        }\r\n        else {\r\n            filePath = _filePath;\r\n        }\r\n        if (this._extraLibs[filePath] && this._extraLibs[filePath].content === content) {\r\n            // no-op, there already exists an extra lib with this content\r\n            return {\r\n                dispose: function () { }\r\n            };\r\n        }\r\n        var myVersion = 1;\r\n        if (this._extraLibs[filePath]) {\r\n            myVersion = this._extraLibs[filePath].version + 1;\r\n        }\r\n        this._extraLibs[filePath] = {\r\n            content: content,\r\n            version: myVersion,\r\n        };\r\n        this._fireOnDidExtraLibsChangeSoon();\r\n        return {\r\n            dispose: function () {\r\n                var extraLib = _this._extraLibs[filePath];\r\n                if (!extraLib) {\r\n                    return;\r\n                }\r\n                if (extraLib.version !== myVersion) {\r\n                    return;\r\n                }\r\n                delete _this._extraLibs[filePath];\r\n                _this._fireOnDidExtraLibsChangeSoon();\r\n            }\r\n        };\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setExtraLibs = function (libs) {\r\n        // clear out everything\r\n        this._extraLibs = Object.create(null);\r\n        if (libs && libs.length > 0) {\r\n            for (var _i = 0, libs_1 = libs; _i < libs_1.length; _i++) {\r\n                var lib = libs_1[_i];\r\n                var filePath = lib.filePath || \"ts:extralib-\" + Math.random().toString(36).substring(2, 15);\r\n                var content = lib.content;\r\n                this._extraLibs[filePath] = {\r\n                    content: content,\r\n                    version: 1\r\n                };\r\n            }\r\n        }\r\n        this._fireOnDidExtraLibsChangeSoon();\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype._fireOnDidExtraLibsChangeSoon = function () {\r\n        var _this = this;\r\n        if (this._onDidExtraLibsChangeTimeout !== -1) {\r\n            // already scheduled\r\n            return;\r\n        }\r\n        this._onDidExtraLibsChangeTimeout = setTimeout(function () {\r\n            _this._onDidExtraLibsChangeTimeout = -1;\r\n            _this._onDidExtraLibsChange.fire(undefined);\r\n        }, 0);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.getCompilerOptions = function () {\r\n        return this._compilerOptions;\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setCompilerOptions = function (options) {\r\n        this._compilerOptions = options || Object.create(null);\r\n        this._onDidChange.fire(undefined);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.getDiagnosticsOptions = function () {\r\n        return this._diagnosticsOptions;\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setDiagnosticsOptions = function (options) {\r\n        this._diagnosticsOptions = options || Object.create(null);\r\n        this._onDidChange.fire(undefined);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setMaximumWorkerIdleTime = function (value) {\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setEagerModelSync = function (value) {\r\n        // doesn't fire an event since no\r\n        // worker restart is required here\r\n        this._eagerModelSync = value;\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.getEagerModelSync = function () {\r\n        return this._eagerModelSync;\r\n    };\r\n    return LanguageServiceDefaultsImpl;\r\n}());\r\nexport { LanguageServiceDefaultsImpl };\r\n//#region enums copied from typescript to prevent loading the entire typescriptServices ---\r\nvar ModuleKind;\r\n(function (ModuleKind) {\r\n    ModuleKind[ModuleKind[\"None\"] = 0] = \"None\";\r\n    ModuleKind[ModuleKind[\"CommonJS\"] = 1] = \"CommonJS\";\r\n    ModuleKind[ModuleKind[\"AMD\"] = 2] = \"AMD\";\r\n    ModuleKind[ModuleKind[\"UMD\"] = 3] = \"UMD\";\r\n    ModuleKind[ModuleKind[\"System\"] = 4] = \"System\";\r\n    ModuleKind[ModuleKind[\"ES2015\"] = 5] = \"ES2015\";\r\n    ModuleKind[ModuleKind[\"ESNext\"] = 99] = \"ESNext\";\r\n})(ModuleKind || (ModuleKind = {}));\r\nvar JsxEmit;\r\n(function (JsxEmit) {\r\n    JsxEmit[JsxEmit[\"None\"] = 0] = \"None\";\r\n    JsxEmit[JsxEmit[\"Preserve\"] = 1] = \"Preserve\";\r\n    JsxEmit[JsxEmit[\"React\"] = 2] = \"React\";\r\n    JsxEmit[JsxEmit[\"ReactNative\"] = 3] = \"ReactNative\";\r\n})(JsxEmit || (JsxEmit = {}));\r\nvar NewLineKind;\r\n(function (NewLineKind) {\r\n    NewLineKind[NewLineKind[\"CarriageReturnLineFeed\"] = 0] = \"CarriageReturnLineFeed\";\r\n    NewLineKind[NewLineKind[\"LineFeed\"] = 1] = \"LineFeed\";\r\n})(NewLineKind || (NewLineKind = {}));\r\nvar ScriptTarget;\r\n(function (ScriptTarget) {\r\n    ScriptTarget[ScriptTarget[\"ES3\"] = 0] = \"ES3\";\r\n    ScriptTarget[ScriptTarget[\"ES5\"] = 1] = \"ES5\";\r\n    ScriptTarget[ScriptTarget[\"ES2015\"] = 2] = \"ES2015\";\r\n    ScriptTarget[ScriptTarget[\"ES2016\"] = 3] = \"ES2016\";\r\n    ScriptTarget[ScriptTarget[\"ES2017\"] = 4] = \"ES2017\";\r\n    ScriptTarget[ScriptTarget[\"ES2018\"] = 5] = \"ES2018\";\r\n    ScriptTarget[ScriptTarget[\"ES2019\"] = 6] = \"ES2019\";\r\n    ScriptTarget[ScriptTarget[\"ES2020\"] = 7] = \"ES2020\";\r\n    ScriptTarget[ScriptTarget[\"ESNext\"] = 99] = \"ESNext\";\r\n    ScriptTarget[ScriptTarget[\"JSON\"] = 100] = \"JSON\";\r\n    ScriptTarget[ScriptTarget[\"Latest\"] = 99] = \"Latest\";\r\n})(ScriptTarget || (ScriptTarget = {}));\r\nvar ModuleResolutionKind;\r\n(function (ModuleResolutionKind) {\r\n    ModuleResolutionKind[ModuleResolutionKind[\"Classic\"] = 1] = \"Classic\";\r\n    ModuleResolutionKind[ModuleResolutionKind[\"NodeJs\"] = 2] = \"NodeJs\";\r\n})(ModuleResolutionKind || (ModuleResolutionKind = {}));\r\n//#endregion\r\nvar typescriptDefaults = new LanguageServiceDefaultsImpl({ allowNonTsExtensions: true, target: ScriptTarget.Latest }, { noSemanticValidation: false, noSyntaxValidation: false });\r\nvar javascriptDefaults = new LanguageServiceDefaultsImpl({ allowNonTsExtensions: true, allowJs: true, target: ScriptTarget.Latest }, { noSemanticValidation: true, noSyntaxValidation: false });\r\nfunction getTypeScriptWorker() {\r\n    return getMode().then(function (mode) { return mode.getTypeScriptWorker(); });\r\n}\r\nfunction getJavaScriptWorker() {\r\n    return getMode().then(function (mode) { return mode.getJavaScriptWorker(); });\r\n}\r\n// Export API\r\nfunction createAPI() {\r\n    return {\r\n        ModuleKind: ModuleKind,\r\n        JsxEmit: JsxEmit,\r\n        NewLineKind: NewLineKind,\r\n        ScriptTarget: ScriptTarget,\r\n        ModuleResolutionKind: ModuleResolutionKind,\r\n        typescriptVersion: typescriptVersion,\r\n        typescriptDefaults: typescriptDefaults,\r\n        javascriptDefaults: javascriptDefaults,\r\n        getTypeScriptWorker: getTypeScriptWorker,\r\n        getJavaScriptWorker: getJavaScriptWorker\r\n    };\r\n}\r\nmonaco.languages.typescript = createAPI();\r\n// --- Registration to monaco editor ---\r\nfunction getMode() {\r\n    return import('./tsMode.js');\r\n}\r\nmonaco.languages.onLanguage('typescript', function () {\r\n    return getMode().then(function (mode) { return mode.setupTypeScript(typescriptDefaults); });\r\n});\r\nmonaco.languages.onLanguage('javascript', function () {\r\n    return getMode().then(function (mode) { return mode.setupJavaScript(javascriptDefaults); });\r\n});\r\n","export var typescriptVersion = \"3.7.3\";\r\n","import '../../editor/editor.api.js';\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nvar Emitter = monaco.Emitter;\r\n// --- CSS configuration and defaults ---------\r\nvar LanguageServiceDefaultsImpl = /** @class */ (function () {\r\n    function LanguageServiceDefaultsImpl(languageId, diagnosticsOptions, modeConfiguration) {\r\n        this._onDidChange = new Emitter();\r\n        this._languageId = languageId;\r\n        this.setDiagnosticsOptions(diagnosticsOptions);\r\n        this.setModeConfiguration(modeConfiguration);\r\n    }\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"onDidChange\", {\r\n        get: function () {\r\n            return this._onDidChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"languageId\", {\r\n        get: function () {\r\n            return this._languageId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"modeConfiguration\", {\r\n        get: function () {\r\n            return this._modeConfiguration;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"diagnosticsOptions\", {\r\n        get: function () {\r\n            return this._diagnosticsOptions;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LanguageServiceDefaultsImpl.prototype.setDiagnosticsOptions = function (options) {\r\n        this._diagnosticsOptions = options || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setModeConfiguration = function (modeConfiguration) {\r\n        this._modeConfiguration = modeConfiguration || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    ;\r\n    return LanguageServiceDefaultsImpl;\r\n}());\r\nexport { LanguageServiceDefaultsImpl };\r\nvar diagnosticDefault = {\r\n    validate: true,\r\n    lint: {\r\n        compatibleVendorPrefixes: 'ignore',\r\n        vendorPrefix: 'warning',\r\n        duplicateProperties: 'warning',\r\n        emptyRules: 'warning',\r\n        importStatement: 'ignore',\r\n        boxModel: 'ignore',\r\n        universalSelector: 'ignore',\r\n        zeroUnits: 'ignore',\r\n        fontFaceProperties: 'warning',\r\n        hexColorLength: 'error',\r\n        argumentsInColorFunction: 'error',\r\n        unknownProperties: 'warning',\r\n        ieHack: 'ignore',\r\n        unknownVendorSpecificProperties: 'ignore',\r\n        propertyIgnoredDueToDisplay: 'warning',\r\n        important: 'ignore',\r\n        float: 'ignore',\r\n        idSelector: 'ignore'\r\n    }\r\n};\r\nvar modeConfigurationDefault = {\r\n    completionItems: true,\r\n    hovers: true,\r\n    documentSymbols: true,\r\n    definitions: true,\r\n    references: true,\r\n    documentHighlights: true,\r\n    rename: true,\r\n    colors: true,\r\n    foldingRanges: true,\r\n    diagnostics: true,\r\n    selectionRanges: true\r\n};\r\nvar cssDefaults = new LanguageServiceDefaultsImpl('css', diagnosticDefault, modeConfigurationDefault);\r\nvar scssDefaults = new LanguageServiceDefaultsImpl('scss', diagnosticDefault, modeConfigurationDefault);\r\nvar lessDefaults = new LanguageServiceDefaultsImpl('less', diagnosticDefault, modeConfigurationDefault);\r\n// Export API\r\nfunction createAPI() {\r\n    return {\r\n        cssDefaults: cssDefaults,\r\n        lessDefaults: lessDefaults,\r\n        scssDefaults: scssDefaults\r\n    };\r\n}\r\nmonaco.languages.css = createAPI();\r\n// --- Registration to monaco editor ---\r\nfunction getMode() {\r\n    return import('./cssMode.js');\r\n}\r\nmonaco.languages.onLanguage('less', function () {\r\n    getMode().then(function (mode) { return mode.setupMode(lessDefaults); });\r\n});\r\nmonaco.languages.onLanguage('scss', function () {\r\n    getMode().then(function (mode) { return mode.setupMode(scssDefaults); });\r\n});\r\nmonaco.languages.onLanguage('css', function () {\r\n    getMode().then(function (mode) { return mode.setupMode(cssDefaults); });\r\n});\r\n","import '../../editor/editor.api.js';\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nvar Emitter = monaco.Emitter;\r\n// --- JSON configuration and defaults ---------\r\nvar LanguageServiceDefaultsImpl = /** @class */ (function () {\r\n    function LanguageServiceDefaultsImpl(languageId, diagnosticsOptions, modeConfiguration) {\r\n        this._onDidChange = new Emitter();\r\n        this._languageId = languageId;\r\n        this.setDiagnosticsOptions(diagnosticsOptions);\r\n        this.setModeConfiguration(modeConfiguration);\r\n    }\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"onDidChange\", {\r\n        get: function () {\r\n            return this._onDidChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"languageId\", {\r\n        get: function () {\r\n            return this._languageId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"modeConfiguration\", {\r\n        get: function () {\r\n            return this._modeConfiguration;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"diagnosticsOptions\", {\r\n        get: function () {\r\n            return this._diagnosticsOptions;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LanguageServiceDefaultsImpl.prototype.setDiagnosticsOptions = function (options) {\r\n        this._diagnosticsOptions = options || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setModeConfiguration = function (modeConfiguration) {\r\n        this._modeConfiguration = modeConfiguration || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    ;\r\n    return LanguageServiceDefaultsImpl;\r\n}());\r\nexport { LanguageServiceDefaultsImpl };\r\nvar diagnosticDefault = {\r\n    validate: true,\r\n    allowComments: true,\r\n    schemas: [],\r\n    enableSchemaRequest: false\r\n};\r\nvar modeConfigurationDefault = {\r\n    documentFormattingEdits: true,\r\n    documentRangeFormattingEdits: true,\r\n    completionItems: true,\r\n    hovers: true,\r\n    documentSymbols: true,\r\n    tokens: true,\r\n    colors: true,\r\n    foldingRanges: true,\r\n    diagnostics: true,\r\n    selectionRanges: true\r\n};\r\nvar jsonDefaults = new LanguageServiceDefaultsImpl('json', diagnosticDefault, modeConfigurationDefault);\r\n// Export API\r\nfunction createAPI() {\r\n    return {\r\n        jsonDefaults: jsonDefaults\r\n    };\r\n}\r\nmonaco.languages.json = createAPI();\r\n// --- Registration to monaco editor ---\r\nfunction getMode() {\r\n    return import('./jsonMode.js');\r\n}\r\nmonaco.languages.register({\r\n    id: 'json',\r\n    extensions: ['.json', '.bowerrc', '.jshintrc', '.jscsrc', '.eslintrc', '.babelrc', '.har'],\r\n    aliases: ['JSON', 'json'],\r\n    mimetypes: ['application/json'],\r\n});\r\nmonaco.languages.onLanguage('json', function () {\r\n    getMode().then(function (mode) { return mode.setupMode(jsonDefaults); });\r\n});\r\n","import '../../editor/editor.api.js';\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nvar Emitter = monaco.Emitter;\r\n// --- HTML configuration and defaults ---------\r\nvar LanguageServiceDefaultsImpl = /** @class */ (function () {\r\n    function LanguageServiceDefaultsImpl(languageId, options, modeConfiguration) {\r\n        this._onDidChange = new Emitter();\r\n        this._languageId = languageId;\r\n        this.setOptions(options);\r\n        this.setModeConfiguration(modeConfiguration);\r\n    }\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"onDidChange\", {\r\n        get: function () {\r\n            return this._onDidChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"languageId\", {\r\n        get: function () {\r\n            return this._languageId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"options\", {\r\n        get: function () {\r\n            return this._options;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"modeConfiguration\", {\r\n        get: function () {\r\n            return this._modeConfiguration;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LanguageServiceDefaultsImpl.prototype.setOptions = function (options) {\r\n        this._options = options || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setModeConfiguration = function (modeConfiguration) {\r\n        this._modeConfiguration = modeConfiguration || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    ;\r\n    return LanguageServiceDefaultsImpl;\r\n}());\r\nexport { LanguageServiceDefaultsImpl };\r\nvar formatDefaults = {\r\n    tabSize: 4,\r\n    insertSpaces: false,\r\n    wrapLineLength: 120,\r\n    unformatted: 'default\": \"a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',\r\n    contentUnformatted: 'pre',\r\n    indentInnerHtml: false,\r\n    preserveNewLines: true,\r\n    maxPreserveNewLines: null,\r\n    indentHandlebars: false,\r\n    endWithNewline: false,\r\n    extraLiners: 'head, body, /html',\r\n    wrapAttributes: 'auto'\r\n};\r\nvar htmlOptionsDefault = {\r\n    format: formatDefaults,\r\n    suggest: { html5: true, angular1: true, ionic: true }\r\n};\r\nvar handlebarOptionsDefault = {\r\n    format: formatDefaults,\r\n    suggest: { html5: true }\r\n};\r\nvar razorOptionsDefault = {\r\n    format: formatDefaults,\r\n    suggest: { html5: true, razor: true }\r\n};\r\nfunction getConfigurationDefault(languageId) {\r\n    return {\r\n        completionItems: true,\r\n        hovers: true,\r\n        documentSymbols: true,\r\n        links: true,\r\n        documentHighlights: true,\r\n        rename: true,\r\n        colors: true,\r\n        foldingRanges: true,\r\n        selectionRanges: true,\r\n        diagnostics: languageId === htmlLanguageId,\r\n        documentFormattingEdits: languageId === htmlLanguageId,\r\n        documentRangeFormattingEdits: languageId === htmlLanguageId // turned off for Razor and Handlebar\r\n    };\r\n}\r\nvar htmlLanguageId = 'html';\r\nvar handlebarsLanguageId = 'handlebars';\r\nvar razorLanguageId = 'razor';\r\nvar htmlDefaults = new LanguageServiceDefaultsImpl(htmlLanguageId, htmlOptionsDefault, getConfigurationDefault(htmlLanguageId));\r\nvar handlebarDefaults = new LanguageServiceDefaultsImpl(handlebarsLanguageId, handlebarOptionsDefault, getConfigurationDefault(handlebarsLanguageId));\r\nvar razorDefaults = new LanguageServiceDefaultsImpl(razorLanguageId, razorOptionsDefault, getConfigurationDefault(razorLanguageId));\r\n// Export API\r\nfunction createAPI() {\r\n    return {\r\n        htmlDefaults: htmlDefaults,\r\n        razorDefaults: razorDefaults,\r\n        handlebarDefaults: handlebarDefaults\r\n    };\r\n}\r\nmonaco.languages.html = createAPI();\r\n// --- Registration to monaco editor ---\r\nfunction getMode() {\r\n    return import('./htmlMode.js');\r\n}\r\nmonaco.languages.onLanguage(htmlLanguageId, function () {\r\n    getMode().then(function (mode) { return mode.setupMode(htmlDefaults); });\r\n});\r\nmonaco.languages.onLanguage(handlebarsLanguageId, function () {\r\n    getMode().then(function (mode) { return mode.setupMode(handlebarDefaults); });\r\n});\r\nmonaco.languages.onLanguage(razorLanguageId, function () {\r\n    getMode().then(function (mode) { return mode.setupMode(razorDefaults); });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\n// Allow for running under nodejs/requirejs in tests\r\nvar _monaco = (typeof monaco === 'undefined' ? self.monaco : monaco);\r\nvar languageDefinitions = {};\r\nvar lazyLanguageLoaders = {};\r\nvar LazyLanguageLoader = /** @class */ (function () {\r\n    function LazyLanguageLoader(languageId) {\r\n        var _this = this;\r\n        this._languageId = languageId;\r\n        this._loadingTriggered = false;\r\n        this._lazyLoadPromise = new Promise(function (resolve, reject) {\r\n            _this._lazyLoadPromiseResolve = resolve;\r\n            _this._lazyLoadPromiseReject = reject;\r\n        });\r\n    }\r\n    LazyLanguageLoader.getOrCreate = function (languageId) {\r\n        if (!lazyLanguageLoaders[languageId]) {\r\n            lazyLanguageLoaders[languageId] = new LazyLanguageLoader(languageId);\r\n        }\r\n        return lazyLanguageLoaders[languageId];\r\n    };\r\n    LazyLanguageLoader.prototype.whenLoaded = function () {\r\n        return this._lazyLoadPromise;\r\n    };\r\n    LazyLanguageLoader.prototype.load = function () {\r\n        var _this = this;\r\n        if (!this._loadingTriggered) {\r\n            this._loadingTriggered = true;\r\n            languageDefinitions[this._languageId].loader().then(function (mod) { return _this._lazyLoadPromiseResolve(mod); }, function (err) { return _this._lazyLoadPromiseReject(err); });\r\n        }\r\n        return this._lazyLoadPromise;\r\n    };\r\n    return LazyLanguageLoader;\r\n}());\r\nexport function loadLanguage(languageId) {\r\n    return LazyLanguageLoader.getOrCreate(languageId).load();\r\n}\r\nexport function registerLanguage(def) {\r\n    var languageId = def.id;\r\n    languageDefinitions[languageId] = def;\r\n    _monaco.languages.register(def);\r\n    var lazyLanguageLoader = LazyLanguageLoader.getOrCreate(languageId);\r\n    _monaco.languages.setMonarchTokensProvider(languageId, lazyLanguageLoader.whenLoaded().then(function (mod) { return mod.language; }));\r\n    _monaco.languages.onLanguage(languageId, function () {\r\n        lazyLanguageLoader.load().then(function (mod) {\r\n            _monaco.languages.setLanguageConfiguration(languageId, mod.conf);\r\n        });\r\n    });\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'abap',\r\n    extensions: ['.abap'],\r\n    aliases: ['abap', 'ABAP'],\r\n    loader: function () { return import('./abap.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'apex',\r\n    extensions: ['.cls'],\r\n    aliases: ['Apex', 'apex'],\r\n    mimetypes: ['text/x-apex-source', 'text/x-apex'],\r\n    loader: function () { return import('./apex.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'azcli',\r\n    extensions: ['.azcli'],\r\n    aliases: ['Azure CLI', 'azcli'],\r\n    loader: function () { return import('./azcli.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'bat',\r\n    extensions: ['.bat', '.cmd'],\r\n    aliases: ['Batch', 'bat'],\r\n    loader: function () { return import('./bat.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'cameligo',\r\n    extensions: ['.mligo'],\r\n    aliases: ['Cameligo'],\r\n    loader: function () { return import('./cameligo.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'clojure',\r\n    extensions: ['.clj', '.cljs', '.cljc', '.edn'],\r\n    aliases: ['clojure', 'Clojure'],\r\n    loader: function () { return import('./clojure.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'coffeescript',\r\n    extensions: ['.coffee'],\r\n    aliases: ['CoffeeScript', 'coffeescript', 'coffee'],\r\n    mimetypes: ['text/x-coffeescript', 'text/coffeescript'],\r\n    loader: function () { return import('./coffee.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'c',\r\n    extensions: ['.c', '.h'],\r\n    aliases: ['C', 'c'],\r\n    loader: function () { return import('./cpp.js'); }\r\n});\r\nregisterLanguage({\r\n    id: 'cpp',\r\n    extensions: ['.cpp', '.cc', '.cxx', '.hpp', '.hh', '.hxx'],\r\n    aliases: ['C++', 'Cpp', 'cpp'],\r\n    loader: function () { return import('./cpp.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'csharp',\r\n    extensions: ['.cs', '.csx', '.cake'],\r\n    aliases: ['C#', 'csharp'],\r\n    loader: function () { return import('./csharp.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'csp',\r\n    extensions: [],\r\n    aliases: ['CSP', 'csp'],\r\n    loader: function () { return import('./csp.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'css',\r\n    extensions: ['.css'],\r\n    aliases: ['CSS', 'css'],\r\n    mimetypes: ['text/css'],\r\n    loader: function () { return import('./css.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'dockerfile',\r\n    extensions: ['.dockerfile'],\r\n    filenames: ['Dockerfile'],\r\n    aliases: ['Dockerfile'],\r\n    loader: function () { return import('./dockerfile.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'fsharp',\r\n    extensions: ['.fs', '.fsi', '.ml', '.mli', '.fsx', '.fsscript'],\r\n    aliases: ['F#', 'FSharp', 'fsharp'],\r\n    loader: function () { return import('./fsharp.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'go',\r\n    extensions: ['.go'],\r\n    aliases: ['Go'],\r\n    loader: function () { return import('./go.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'graphql',\r\n    extensions: ['.graphql', '.gql'],\r\n    aliases: ['GraphQL', 'graphql', 'gql'],\r\n    mimetypes: ['application/graphql'],\r\n    loader: function () { return import('./graphql.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'handlebars',\r\n    extensions: ['.handlebars', '.hbs'],\r\n    aliases: ['Handlebars', 'handlebars'],\r\n    mimetypes: ['text/x-handlebars-template'],\r\n    loader: function () { return import('./handlebars.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'html',\r\n    extensions: ['.html', '.htm', '.shtml', '.xhtml', '.mdoc', '.jsp', '.asp', '.aspx', '.jshtm'],\r\n    aliases: ['HTML', 'htm', 'html', 'xhtml'],\r\n    mimetypes: ['text/html', 'text/x-jshtm', 'text/template', 'text/ng-template'],\r\n    loader: function () { return import('./html.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'ini',\r\n    extensions: ['.ini', '.properties', '.gitconfig'],\r\n    filenames: ['config', '.gitattributes', '.gitconfig', '.editorconfig'],\r\n    aliases: ['Ini', 'ini'],\r\n    loader: function () { return import('./ini.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'java',\r\n    extensions: ['.java', '.jav'],\r\n    aliases: ['Java', 'java'],\r\n    mimetypes: ['text/x-java-source', 'text/x-java'],\r\n    loader: function () { return import('./java.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'javascript',\r\n    extensions: ['.js', '.es6', '.jsx'],\r\n    firstLine: '^#!.*\\\\bnode',\r\n    filenames: ['jakefile'],\r\n    aliases: ['JavaScript', 'javascript', 'js'],\r\n    mimetypes: ['text/javascript'],\r\n    loader: function () { return import('./javascript.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'kotlin',\r\n    extensions: ['.kt'],\r\n    aliases: ['Kotlin', 'kotlin'],\r\n    mimetypes: ['text/x-kotlin-source', 'text/x-kotlin'],\r\n    loader: function () { return import('./kotlin.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'less',\r\n    extensions: ['.less'],\r\n    aliases: ['Less', 'less'],\r\n    mimetypes: ['text/x-less', 'text/less'],\r\n    loader: function () { return import('./less.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'lua',\r\n    extensions: ['.lua'],\r\n    aliases: ['Lua', 'lua'],\r\n    loader: function () { return import('./lua.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'markdown',\r\n    extensions: ['.md', '.markdown', '.mdown', '.mkdn', '.mkd', '.mdwn', '.mdtxt', '.mdtext'],\r\n    aliases: ['Markdown', 'markdown'],\r\n    loader: function () { return import('./markdown.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'mips',\r\n    extensions: ['.s'],\r\n    aliases: ['MIPS', 'MIPS-V'],\r\n    mimetypes: ['text/x-mips', 'text/mips', 'text/plaintext'],\r\n    loader: function () { return import('./mips.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'msdax',\r\n    extensions: ['.dax', '.msdax'],\r\n    aliases: ['DAX', 'MSDAX'],\r\n    loader: function () { return import('./msdax.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'mysql',\r\n    extensions: [],\r\n    aliases: ['MySQL', 'mysql'],\r\n    loader: function () { return import('./mysql.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'objective-c',\r\n    extensions: ['.m'],\r\n    aliases: ['Objective-C'],\r\n    loader: function () { return import('./objective-c.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'pascal',\r\n    extensions: ['.pas', '.p', '.pp'],\r\n    aliases: ['Pascal', 'pas'],\r\n    mimetypes: ['text/x-pascal-source', 'text/x-pascal'],\r\n    loader: function () { return import('./pascal.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'pascaligo',\r\n    extensions: ['.ligo'],\r\n    aliases: ['Pascaligo', 'ligo'],\r\n    loader: function () { return import('./pascaligo.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n*  Copyright (c) Microsoft Corporation. All rights reserved.\r\n*  Licensed under the MIT License. See License.txt in the project root for license information.\r\n*--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'perl',\r\n    extensions: ['.pl'],\r\n    aliases: ['Perl', 'pl'],\r\n    loader: function () { return import('./perl.js'); },\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'pgsql',\r\n    extensions: [],\r\n    aliases: ['PostgreSQL', 'postgres', 'pg', 'postgre'],\r\n    loader: function () { return import('./pgsql.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'php',\r\n    extensions: ['.php', '.php4', '.php5', '.phtml', '.ctp'],\r\n    aliases: ['PHP', 'php'],\r\n    mimetypes: ['application/x-php'],\r\n    loader: function () { return import('./php.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'postiats',\r\n    extensions: ['.dats', '.sats', '.hats'],\r\n    aliases: ['ATS', 'ATS/Postiats'],\r\n    loader: function () { return import('./postiats.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'powerquery',\r\n    extensions: ['.pq', '.pqm'],\r\n    aliases: ['PQ', 'M', 'Power Query', 'Power Query M'],\r\n    loader: function () { return import('./powerquery.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'powershell',\r\n    extensions: ['.ps1', '.psm1', '.psd1'],\r\n    aliases: ['PowerShell', 'powershell', 'ps', 'ps1'],\r\n    loader: function () { return import('./powershell.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'pug',\r\n    extensions: ['.jade', '.pug'],\r\n    aliases: ['Pug', 'Jade', 'jade'],\r\n    loader: function () { return import('./pug.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'python',\r\n    extensions: ['.py', '.rpy', '.pyw', '.cpy', '.gyp', '.gypi'],\r\n    aliases: ['Python', 'py'],\r\n    firstLine: '^#!/.*\\\\bpython[0-9.-]*\\\\b',\r\n    loader: function () { return import('./python.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'r',\r\n    extensions: ['.r', '.rhistory', '.rprofile', '.rt'],\r\n    aliases: ['R', 'r'],\r\n    loader: function () { return import('./r.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'razor',\r\n    extensions: ['.cshtml'],\r\n    aliases: ['Razor', 'razor'],\r\n    mimetypes: ['text/x-cshtml'],\r\n    loader: function () { return import('./razor.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'redis',\r\n    extensions: ['.redis'],\r\n    aliases: ['redis'],\r\n    loader: function () { return import('./redis.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'redshift',\r\n    extensions: [],\r\n    aliases: ['Redshift', 'redshift'],\r\n    loader: function () { return import('./redshift.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'restructuredtext',\r\n    extensions: ['.rst'],\r\n    aliases: ['reStructuredText', 'restructuredtext'],\r\n    loader: function () { return import('./restructuredtext.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'ruby',\r\n    extensions: ['.rb', '.rbx', '.rjs', '.gemspec', '.pp'],\r\n    filenames: ['rakefile'],\r\n    aliases: ['Ruby', 'rb'],\r\n    loader: function () { return import('./ruby.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'rust',\r\n    extensions: ['.rs', '.rlib'],\r\n    aliases: ['Rust', 'rust'],\r\n    loader: function () { return import('./rust.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'sb',\r\n    extensions: ['.sb'],\r\n    aliases: ['Small Basic', 'sb'],\r\n    loader: function () { return import('./sb.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'scheme',\r\n    extensions: ['.scm', '.ss', '.sch', '.rkt'],\r\n    aliases: ['scheme', 'Scheme'],\r\n    loader: function () { return import('./scheme.js'); },\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'scss',\r\n    extensions: ['.scss'],\r\n    aliases: ['Sass', 'sass', 'scss'],\r\n    mimetypes: ['text/x-scss', 'text/scss'],\r\n    loader: function () { return import('./scss.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n*  Copyright (c) Microsoft Corporation. All rights reserved.\r\n*  Licensed under the MIT License. See License.txt in the project root for license information.\r\n*--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'shell',\r\n    extensions: ['.sh', '.bash'],\r\n    aliases: ['Shell', 'sh'],\r\n    loader: function () { return import('./shell.js'); },\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'sol',\r\n    extensions: ['.sol'],\r\n    aliases: ['sol', 'solidity', 'Solidity'],\r\n    loader: function () { return import('./solidity.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'aes',\r\n    extensions: ['.aes'],\r\n    aliases: ['aes', 'sophia', 'Sophia'],\r\n    loader: function () { return import('./sophia.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'sql',\r\n    extensions: ['.sql'],\r\n    aliases: ['SQL'],\r\n    loader: function () { return import('./sql.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'st',\r\n    extensions: ['.st', '.iecst', '.iecplc', '.lc3lib'],\r\n    aliases: ['StructuredText', 'scl', 'stl'],\r\n    loader: function () { return import('./st.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'swift',\r\n    aliases: ['Swift', 'swift'],\r\n    extensions: ['.swift'],\r\n    mimetypes: ['text/swift'],\r\n    loader: function () { return import('./swift.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'tcl',\r\n    extensions: ['.tcl'],\r\n    aliases: ['tcl', 'Tcl', 'tcltk', 'TclTk', 'tcl/tk', 'Tcl/Tk'],\r\n    loader: function () { return import('./tcl.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'twig',\r\n    extensions: ['.twig'],\r\n    aliases: ['Twig', 'twig'],\r\n    mimetypes: ['text/x-twig'],\r\n    loader: function () { return import('./twig.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'typescript',\r\n    extensions: ['.ts', '.tsx'],\r\n    aliases: ['TypeScript', 'ts', 'typescript'],\r\n    mimetypes: ['text/typescript'],\r\n    loader: function () { return import('./typescript.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'vb',\r\n    extensions: ['.vb'],\r\n    aliases: ['Visual Basic', 'vb'],\r\n    loader: function () { return import('./vb.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'xml',\r\n    extensions: ['.xml', '.dtd', '.ascx', '.csproj', '.config', '.wxi', '.wxl', '.wxs', '.xaml', '.svg', '.svgz', '.opf', '.xsl'],\r\n    firstLine: '(\\\\<\\\\?xml.*)|(\\\\<svg)|(\\\\<\\\\!doctype\\\\s+svg)',\r\n    aliases: ['XML', 'xml'],\r\n    mimetypes: ['text/xml', 'application/xml', 'application/xaml+xml', 'application/xml-dtd'],\r\n    loader: function () { return import('./xml.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'yaml',\r\n    extensions: ['.yaml', '.yml'],\r\n    aliases: ['YAML', 'yaml', 'YML', 'yml'],\r\n    mimetypes: ['application/x-yaml'],\r\n    loader: function () { return import('./yaml.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './bracketMatching.css';\r\nimport * as nls from '../../../nls.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { editorBracketMatchBackground, editorBracketMatchBorder } from '../../common/view/editorColorRegistry.js';\r\nimport { registerColor } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant, themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nvar overviewRulerBracketMatchForeground = registerColor('editorOverviewRuler.bracketMatchForeground', { dark: '#A0A0A0', light: '#A0A0A0', hc: '#A0A0A0' }, nls.localize('overviewRulerBracketMatchForeground', 'Overview ruler marker color for matching brackets.'));\r\nvar JumpToBracketAction = /** @class */ (function (_super) {\r\n    __extends(JumpToBracketAction, _super);\r\n    function JumpToBracketAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.jumpToBracket',\r\n            label: nls.localize('smartSelect.jumpBracket', \"Go to Bracket\"),\r\n            alias: 'Go to Bracket',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 88 /* US_BACKSLASH */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    JumpToBracketAction.prototype.run = function (accessor, editor) {\r\n        var controller = BracketMatchingController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        controller.jumpToBracket();\r\n    };\r\n    return JumpToBracketAction;\r\n}(EditorAction));\r\nvar SelectToBracketAction = /** @class */ (function (_super) {\r\n    __extends(SelectToBracketAction, _super);\r\n    function SelectToBracketAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.selectToBracket',\r\n            label: nls.localize('smartSelect.selectToBracket', \"Select to Bracket\"),\r\n            alias: 'Select to Bracket',\r\n            precondition: undefined,\r\n            description: {\r\n                description: \"Select to Bracket\",\r\n                args: [{\r\n                        name: 'args',\r\n                        schema: {\r\n                            type: 'object',\r\n                            properties: {\r\n                                'selectBrackets': {\r\n                                    type: 'boolean',\r\n                                    default: true\r\n                                }\r\n                            },\r\n                        }\r\n                    }]\r\n            }\r\n        }) || this;\r\n    }\r\n    SelectToBracketAction.prototype.run = function (accessor, editor, args) {\r\n        var controller = BracketMatchingController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        var selectBrackets = true;\r\n        if (args && args.selectBrackets === false) {\r\n            selectBrackets = false;\r\n        }\r\n        controller.selectToBracket(selectBrackets);\r\n    };\r\n    return SelectToBracketAction;\r\n}(EditorAction));\r\nvar BracketsData = /** @class */ (function () {\r\n    function BracketsData(position, brackets, options) {\r\n        this.position = position;\r\n        this.brackets = brackets;\r\n        this.options = options;\r\n    }\r\n    return BracketsData;\r\n}());\r\nvar BracketMatchingController = /** @class */ (function (_super) {\r\n    __extends(BracketMatchingController, _super);\r\n    function BracketMatchingController(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._lastBracketsData = [];\r\n        _this._lastVersionId = 0;\r\n        _this._decorations = [];\r\n        _this._updateBracketsSoon = _this._register(new RunOnceScheduler(function () { return _this._updateBrackets(); }, 50));\r\n        _this._matchBrackets = _this._editor.getOption(51 /* matchBrackets */);\r\n        _this._updateBracketsSoon.schedule();\r\n        _this._register(editor.onDidChangeCursorPosition(function (e) {\r\n            if (_this._matchBrackets === 'never') {\r\n                // Early exit if nothing needs to be done!\r\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n                return;\r\n            }\r\n            _this._updateBracketsSoon.schedule();\r\n        }));\r\n        _this._register(editor.onDidChangeModelContent(function (e) {\r\n            _this._updateBracketsSoon.schedule();\r\n        }));\r\n        _this._register(editor.onDidChangeModel(function (e) {\r\n            _this._lastBracketsData = [];\r\n            _this._decorations = [];\r\n            _this._updateBracketsSoon.schedule();\r\n        }));\r\n        _this._register(editor.onDidChangeModelLanguageConfiguration(function (e) {\r\n            _this._lastBracketsData = [];\r\n            _this._updateBracketsSoon.schedule();\r\n        }));\r\n        _this._register(editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(51 /* matchBrackets */)) {\r\n                _this._matchBrackets = _this._editor.getOption(51 /* matchBrackets */);\r\n                _this._decorations = _this._editor.deltaDecorations(_this._decorations, []);\r\n                _this._lastBracketsData = [];\r\n                _this._lastVersionId = 0;\r\n                _this._updateBracketsSoon.schedule();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    BracketMatchingController.get = function (editor) {\r\n        return editor.getContribution(BracketMatchingController.ID);\r\n    };\r\n    BracketMatchingController.prototype.jumpToBracket = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var newSelections = this._editor.getSelections().map(function (selection) {\r\n            var position = selection.getStartPosition();\r\n            // find matching brackets if position is on a bracket\r\n            var brackets = model.matchBracket(position);\r\n            var newCursorPosition = null;\r\n            if (brackets) {\r\n                if (brackets[0].containsPosition(position)) {\r\n                    newCursorPosition = brackets[1].getStartPosition();\r\n                }\r\n                else if (brackets[1].containsPosition(position)) {\r\n                    newCursorPosition = brackets[0].getStartPosition();\r\n                }\r\n            }\r\n            else {\r\n                // find the enclosing brackets if the position isn't on a matching bracket\r\n                var enclosingBrackets = model.findEnclosingBrackets(position);\r\n                if (enclosingBrackets) {\r\n                    newCursorPosition = enclosingBrackets[0].getStartPosition();\r\n                }\r\n                else {\r\n                    // no enclosing brackets, try the very first next bracket\r\n                    var nextBracket = model.findNextBracket(position);\r\n                    if (nextBracket && nextBracket.range) {\r\n                        newCursorPosition = nextBracket.range.getStartPosition();\r\n                    }\r\n                }\r\n            }\r\n            if (newCursorPosition) {\r\n                return new Selection(newCursorPosition.lineNumber, newCursorPosition.column, newCursorPosition.lineNumber, newCursorPosition.column);\r\n            }\r\n            return new Selection(position.lineNumber, position.column, position.lineNumber, position.column);\r\n        });\r\n        this._editor.setSelections(newSelections);\r\n        this._editor.revealRange(newSelections[0]);\r\n    };\r\n    BracketMatchingController.prototype.selectToBracket = function (selectBrackets) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var newSelections = [];\r\n        this._editor.getSelections().forEach(function (selection) {\r\n            var position = selection.getStartPosition();\r\n            var brackets = model.matchBracket(position);\r\n            if (!brackets) {\r\n                brackets = model.findEnclosingBrackets(position);\r\n                if (!brackets) {\r\n                    var nextBracket = model.findNextBracket(position);\r\n                    if (nextBracket && nextBracket.range) {\r\n                        brackets = model.matchBracket(nextBracket.range.getStartPosition());\r\n                    }\r\n                }\r\n            }\r\n            var selectFrom = null;\r\n            var selectTo = null;\r\n            if (brackets) {\r\n                brackets.sort(Range.compareRangesUsingStarts);\r\n                var open_1 = brackets[0], close_1 = brackets[1];\r\n                selectFrom = selectBrackets ? open_1.getStartPosition() : open_1.getEndPosition();\r\n                selectTo = selectBrackets ? close_1.getEndPosition() : close_1.getStartPosition();\r\n            }\r\n            if (selectFrom && selectTo) {\r\n                newSelections.push(new Selection(selectFrom.lineNumber, selectFrom.column, selectTo.lineNumber, selectTo.column));\r\n            }\r\n        });\r\n        if (newSelections.length > 0) {\r\n            this._editor.setSelections(newSelections);\r\n            this._editor.revealRange(newSelections[0]);\r\n        }\r\n    };\r\n    BracketMatchingController.prototype._updateBrackets = function () {\r\n        if (this._matchBrackets === 'never') {\r\n            return;\r\n        }\r\n        this._recomputeBrackets();\r\n        var newDecorations = [], newDecorationsLen = 0;\r\n        for (var _i = 0, _a = this._lastBracketsData; _i < _a.length; _i++) {\r\n            var bracketData = _a[_i];\r\n            var brackets = bracketData.brackets;\r\n            if (brackets) {\r\n                newDecorations[newDecorationsLen++] = { range: brackets[0], options: bracketData.options };\r\n                newDecorations[newDecorationsLen++] = { range: brackets[1], options: bracketData.options };\r\n            }\r\n        }\r\n        this._decorations = this._editor.deltaDecorations(this._decorations, newDecorations);\r\n    };\r\n    BracketMatchingController.prototype._recomputeBrackets = function () {\r\n        if (!this._editor.hasModel()) {\r\n            // no model => no brackets!\r\n            this._lastBracketsData = [];\r\n            this._lastVersionId = 0;\r\n            return;\r\n        }\r\n        var selections = this._editor.getSelections();\r\n        if (selections.length > 100) {\r\n            // no bracket matching for high numbers of selections\r\n            this._lastBracketsData = [];\r\n            this._lastVersionId = 0;\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var versionId = model.getVersionId();\r\n        var previousData = [];\r\n        if (this._lastVersionId === versionId) {\r\n            // use the previous data only if the model is at the same version id\r\n            previousData = this._lastBracketsData;\r\n        }\r\n        var positions = [], positionsLen = 0;\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (selection.isEmpty()) {\r\n                // will bracket match a cursor only if the selection is collapsed\r\n                positions[positionsLen++] = selection.getStartPosition();\r\n            }\r\n        }\r\n        // sort positions for `previousData` cache hits\r\n        if (positions.length > 1) {\r\n            positions.sort(Position.compare);\r\n        }\r\n        var newData = [], newDataLen = 0;\r\n        var previousIndex = 0, previousLen = previousData.length;\r\n        for (var i = 0, len = positions.length; i < len; i++) {\r\n            var position = positions[i];\r\n            while (previousIndex < previousLen && previousData[previousIndex].position.isBefore(position)) {\r\n                previousIndex++;\r\n            }\r\n            if (previousIndex < previousLen && previousData[previousIndex].position.equals(position)) {\r\n                newData[newDataLen++] = previousData[previousIndex];\r\n            }\r\n            else {\r\n                var brackets = model.matchBracket(position);\r\n                var options = BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;\r\n                if (!brackets && this._matchBrackets === 'always') {\r\n                    brackets = model.findEnclosingBrackets(position, 20 /* give at most 20ms to compute */);\r\n                    options = BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER;\r\n                }\r\n                newData[newDataLen++] = new BracketsData(position, brackets, options);\r\n            }\r\n        }\r\n        this._lastBracketsData = newData;\r\n        this._lastVersionId = versionId;\r\n    };\r\n    BracketMatchingController.ID = 'editor.contrib.bracketMatchingController';\r\n    BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'bracket-match',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerBracketMatchForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'bracket-match'\r\n    });\r\n    return BracketMatchingController;\r\n}(Disposable));\r\nexport { BracketMatchingController };\r\nregisterEditorContribution(BracketMatchingController.ID, BracketMatchingController);\r\nregisterEditorAction(SelectToBracketAction);\r\nregisterEditorAction(JumpToBracketAction);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var bracketMatchBackground = theme.getColor(editorBracketMatchBackground);\r\n    if (bracketMatchBackground) {\r\n        collector.addRule(\".monaco-editor .bracket-match { background-color: \" + bracketMatchBackground + \"; }\");\r\n    }\r\n    var bracketMatchBorder = theme.getColor(editorBracketMatchBorder);\r\n    if (bracketMatchBorder) {\r\n        collector.addRule(\".monaco-editor .bracket-match { border: 1px solid \" + bracketMatchBorder + \"; }\");\r\n    }\r\n});\r\n// Go to menu\r\nMenuRegistry.appendMenuItem(17 /* MenubarGoMenu */, {\r\n    group: '5_infile_nav',\r\n    command: {\r\n        id: 'editor.action.jumpToBracket',\r\n        title: nls.localize({ key: 'miGoToBracket', comment: ['&& denotes a mnemonic'] }, \"Go to &&Bracket\")\r\n    },\r\n    order: 2\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nvar MoveCaretCommand = /** @class */ (function () {\r\n    function MoveCaretCommand(selection, isMovingLeft) {\r\n        this._selection = selection;\r\n        this._isMovingLeft = isMovingLeft;\r\n        this._cutStartIndex = -1;\r\n        this._cutEndIndex = -1;\r\n        this._moved = false;\r\n        this._selectionId = null;\r\n    }\r\n    MoveCaretCommand.prototype.getEditOperations = function (model, builder) {\r\n        var s = this._selection;\r\n        this._selectionId = builder.trackSelection(s);\r\n        if (s.startLineNumber !== s.endLineNumber) {\r\n            return;\r\n        }\r\n        if (this._isMovingLeft && s.startColumn === 0) {\r\n            return;\r\n        }\r\n        else if (!this._isMovingLeft && s.endColumn === model.getLineMaxColumn(s.startLineNumber)) {\r\n            return;\r\n        }\r\n        var lineNumber = s.selectionStartLineNumber;\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        var left;\r\n        var middle;\r\n        var right;\r\n        if (this._isMovingLeft) {\r\n            left = lineContent.substring(0, s.startColumn - 2);\r\n            middle = lineContent.substring(s.startColumn - 1, s.endColumn - 1);\r\n            right = lineContent.substring(s.startColumn - 2, s.startColumn - 1) + lineContent.substring(s.endColumn - 1);\r\n        }\r\n        else {\r\n            left = lineContent.substring(0, s.startColumn - 1) + lineContent.substring(s.endColumn - 1, s.endColumn);\r\n            middle = lineContent.substring(s.startColumn - 1, s.endColumn - 1);\r\n            right = lineContent.substring(s.endColumn);\r\n        }\r\n        var newLineContent = left + middle + right;\r\n        builder.addEditOperation(new Range(lineNumber, 1, lineNumber, model.getLineMaxColumn(lineNumber)), null);\r\n        builder.addEditOperation(new Range(lineNumber, 1, lineNumber, 1), newLineContent);\r\n        this._cutStartIndex = s.startColumn + (this._isMovingLeft ? -1 : 1);\r\n        this._cutEndIndex = this._cutStartIndex + s.endColumn - s.startColumn;\r\n        this._moved = true;\r\n    };\r\n    MoveCaretCommand.prototype.computeCursorState = function (model, helper) {\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._moved) {\r\n            result = result.setStartPosition(result.startLineNumber, this._cutStartIndex);\r\n            result = result.setEndPosition(result.startLineNumber, this._cutEndIndex);\r\n        }\r\n        return result;\r\n    };\r\n    return MoveCaretCommand;\r\n}());\r\nexport { MoveCaretCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MoveCaretCommand } from './moveCaretCommand.js';\r\nvar MoveCaretAction = /** @class */ (function (_super) {\r\n    __extends(MoveCaretAction, _super);\r\n    function MoveCaretAction(left, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.left = left;\r\n        return _this;\r\n    }\r\n    MoveCaretAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var selection = selections_1[_i];\r\n            commands.push(new MoveCaretCommand(selection, this.left));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return MoveCaretAction;\r\n}(EditorAction));\r\nvar MoveCaretLeftAction = /** @class */ (function (_super) {\r\n    __extends(MoveCaretLeftAction, _super);\r\n    function MoveCaretLeftAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.moveCarretLeftAction',\r\n            label: nls.localize('caret.moveLeft', \"Move Caret Left\"),\r\n            alias: 'Move Caret Left',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return MoveCaretLeftAction;\r\n}(MoveCaretAction));\r\nvar MoveCaretRightAction = /** @class */ (function (_super) {\r\n    __extends(MoveCaretRightAction, _super);\r\n    function MoveCaretRightAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.moveCarretRightAction',\r\n            label: nls.localize('caret.moveRight', \"Move Caret Right\"),\r\n            alias: 'Move Caret Right',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return MoveCaretRightAction;\r\n}(MoveCaretAction));\r\nregisterEditorAction(MoveCaretLeftAction);\r\nregisterEditorAction(MoveCaretRightAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ReplaceCommand } from '../../common/commands/replaceCommand.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MoveOperations } from '../../common/controller/cursorMoveOperations.js';\r\nvar TransposeLettersAction = /** @class */ (function (_super) {\r\n    __extends(TransposeLettersAction, _super);\r\n    function TransposeLettersAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transposeLetters',\r\n            label: nls.localize('transposeLetters.label', \"Transpose Letters\"),\r\n            alias: 'Transpose Letters',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: {\r\n                    primary: 256 /* WinCtrl */ | 50 /* KEY_T */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TransposeLettersAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var selection = selections_1[_i];\r\n            if (!selection.isEmpty()) {\r\n                continue;\r\n            }\r\n            var lineNumber = selection.startLineNumber;\r\n            var column = selection.startColumn;\r\n            var lastColumn = model.getLineMaxColumn(lineNumber);\r\n            if (lineNumber === 1 && (column === 1 || (column === 2 && lastColumn === 2))) {\r\n                // at beginning of file, nothing to do\r\n                continue;\r\n            }\r\n            // handle special case: when at end of line, transpose left two chars\r\n            // otherwise, transpose left and right chars\r\n            var endPosition = (column === lastColumn) ?\r\n                selection.getPosition() :\r\n                MoveOperations.rightPosition(model, selection.getPosition().lineNumber, selection.getPosition().column);\r\n            var middlePosition = MoveOperations.leftPosition(model, endPosition.lineNumber, endPosition.column);\r\n            var beginPosition = MoveOperations.leftPosition(model, middlePosition.lineNumber, middlePosition.column);\r\n            var leftChar = model.getValueInRange(Range.fromPositions(beginPosition, middlePosition));\r\n            var rightChar = model.getValueInRange(Range.fromPositions(middlePosition, endPosition));\r\n            var replaceRange = Range.fromPositions(beginPosition, endPosition);\r\n            commands.push(new ReplaceCommand(replaceRange, rightChar + leftChar));\r\n        }\r\n        if (commands.length > 0) {\r\n            editor.pushUndoStop();\r\n            editor.executeCommands(this.id, commands);\r\n            editor.pushUndoStop();\r\n        }\r\n    };\r\n    return TransposeLettersAction;\r\n}(EditorAction));\r\nregisterEditorAction(TransposeLettersAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './clipboard.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as browser from '../../../base/browser/browser.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { CopyOptions } from '../../browser/controller/textAreaInput.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nvar CLIPBOARD_CONTEXT_MENU_GROUP = '9_cutcopypaste';\r\nvar supportsCut = (platform.isNative || document.queryCommandSupported('cut'));\r\nvar supportsCopy = (platform.isNative || document.queryCommandSupported('copy'));\r\n// IE and Edge have trouble with setting html content in clipboard\r\nvar supportsCopyWithSyntaxHighlighting = (supportsCopy && !browser.isEdgeOrIE);\r\n// Chrome incorrectly returns true for document.queryCommandSupported('paste')\r\n// when the paste feature is available but the calling script has insufficient\r\n// privileges to actually perform the action\r\nvar supportsPaste = (platform.isNative || (!browser.isChrome && document.queryCommandSupported('paste')));\r\nvar ExecCommandAction = /** @class */ (function (_super) {\r\n    __extends(ExecCommandAction, _super);\r\n    function ExecCommandAction(browserCommand, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.browserCommand = browserCommand;\r\n        return _this;\r\n    }\r\n    ExecCommandAction.prototype.runCommand = function (accessor, args) {\r\n        var focusedEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n        // Only if editor text focus (i.e. not if editor has widget focus).\r\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\r\n            focusedEditor.trigger('keyboard', this.id, args);\r\n            return;\r\n        }\r\n        document.execCommand(this.browserCommand);\r\n    };\r\n    ExecCommandAction.prototype.run = function (accessor, editor) {\r\n        editor.focus();\r\n        document.execCommand(this.browserCommand);\r\n    };\r\n    return ExecCommandAction;\r\n}(EditorAction));\r\nvar ExecCommandCutAction = /** @class */ (function (_super) {\r\n    __extends(ExecCommandCutAction, _super);\r\n    function ExecCommandCutAction() {\r\n        var _this = this;\r\n        var kbOpts = {\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 54 /* KEY_X */,\r\n            win: { primary: 2048 /* CtrlCmd */ | 54 /* KEY_X */, secondary: [1024 /* Shift */ | 20 /* Delete */] },\r\n            weight: 100 /* EditorContrib */\r\n        };\r\n        // Do not bind cut keybindings in the browser,\r\n        // since browsers do that for us and it avoids security prompts\r\n        if (!platform.isNative) {\r\n            kbOpts = undefined;\r\n        }\r\n        _this = _super.call(this, 'cut', {\r\n            id: 'editor.action.clipboardCutAction',\r\n            label: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\r\n            alias: 'Cut',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: kbOpts,\r\n            contextMenuOpts: {\r\n                group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n                order: 1\r\n            },\r\n            menuOpts: {\r\n                menuId: 15 /* MenubarEditMenu */,\r\n                group: '2_ccp',\r\n                title: nls.localize({ key: 'miCut', comment: ['&& denotes a mnemonic'] }, \"Cu&&t\"),\r\n                order: 1\r\n            }\r\n        }) || this;\r\n        return _this;\r\n    }\r\n    ExecCommandCutAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var emptySelectionClipboard = editor.getOption(24 /* emptySelectionClipboard */);\r\n        if (!emptySelectionClipboard && editor.getSelection().isEmpty()) {\r\n            return;\r\n        }\r\n        _super.prototype.run.call(this, accessor, editor);\r\n    };\r\n    return ExecCommandCutAction;\r\n}(ExecCommandAction));\r\nvar ExecCommandCopyAction = /** @class */ (function (_super) {\r\n    __extends(ExecCommandCopyAction, _super);\r\n    function ExecCommandCopyAction() {\r\n        var _this = this;\r\n        var kbOpts = {\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 33 /* KEY_C */,\r\n            win: { primary: 2048 /* CtrlCmd */ | 33 /* KEY_C */, secondary: [2048 /* CtrlCmd */ | 19 /* Insert */] },\r\n            weight: 100 /* EditorContrib */\r\n        };\r\n        // Do not bind copy keybindings in the browser,\r\n        // since browsers do that for us and it avoids security prompts\r\n        if (!platform.isNative) {\r\n            kbOpts = undefined;\r\n        }\r\n        _this = _super.call(this, 'copy', {\r\n            id: 'editor.action.clipboardCopyAction',\r\n            label: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\r\n            alias: 'Copy',\r\n            precondition: undefined,\r\n            kbOpts: kbOpts,\r\n            contextMenuOpts: {\r\n                group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n                order: 2\r\n            },\r\n            menuOpts: {\r\n                menuId: 15 /* MenubarEditMenu */,\r\n                group: '2_ccp',\r\n                title: nls.localize({ key: 'miCopy', comment: ['&& denotes a mnemonic'] }, \"&&Copy\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n        return _this;\r\n    }\r\n    ExecCommandCopyAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var emptySelectionClipboard = editor.getOption(24 /* emptySelectionClipboard */);\r\n        if (!emptySelectionClipboard && editor.getSelection().isEmpty()) {\r\n            return;\r\n        }\r\n        _super.prototype.run.call(this, accessor, editor);\r\n    };\r\n    return ExecCommandCopyAction;\r\n}(ExecCommandAction));\r\nvar ExecCommandPasteAction = /** @class */ (function (_super) {\r\n    __extends(ExecCommandPasteAction, _super);\r\n    function ExecCommandPasteAction() {\r\n        var _this = this;\r\n        var kbOpts = {\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 52 /* KEY_V */,\r\n            win: { primary: 2048 /* CtrlCmd */ | 52 /* KEY_V */, secondary: [1024 /* Shift */ | 19 /* Insert */] },\r\n            weight: 100 /* EditorContrib */\r\n        };\r\n        // Do not bind paste keybindings in the browser,\r\n        // since browsers do that for us and it avoids security prompts\r\n        if (!platform.isNative) {\r\n            kbOpts = undefined;\r\n        }\r\n        _this = _super.call(this, 'paste', {\r\n            id: 'editor.action.clipboardPasteAction',\r\n            label: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\r\n            alias: 'Paste',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: kbOpts,\r\n            contextMenuOpts: {\r\n                group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n                order: 3\r\n            },\r\n            menuOpts: {\r\n                menuId: 15 /* MenubarEditMenu */,\r\n                group: '2_ccp',\r\n                title: nls.localize({ key: 'miPaste', comment: ['&& denotes a mnemonic'] }, \"&&Paste\"),\r\n                order: 3\r\n            }\r\n        }) || this;\r\n        return _this;\r\n    }\r\n    return ExecCommandPasteAction;\r\n}(ExecCommandAction));\r\nvar ExecCommandCopyWithSyntaxHighlightingAction = /** @class */ (function (_super) {\r\n    __extends(ExecCommandCopyWithSyntaxHighlightingAction, _super);\r\n    function ExecCommandCopyWithSyntaxHighlightingAction() {\r\n        return _super.call(this, 'copy', {\r\n            id: 'editor.action.clipboardCopyWithSyntaxHighlightingAction',\r\n            label: nls.localize('actions.clipboard.copyWithSyntaxHighlightingLabel', \"Copy With Syntax Highlighting\"),\r\n            alias: 'Copy With Syntax Highlighting',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ExecCommandCopyWithSyntaxHighlightingAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var emptySelectionClipboard = editor.getOption(24 /* emptySelectionClipboard */);\r\n        if (!emptySelectionClipboard && editor.getSelection().isEmpty()) {\r\n            return;\r\n        }\r\n        CopyOptions.forceCopyWithSyntaxHighlighting = true;\r\n        _super.prototype.run.call(this, accessor, editor);\r\n        CopyOptions.forceCopyWithSyntaxHighlighting = false;\r\n    };\r\n    return ExecCommandCopyWithSyntaxHighlightingAction;\r\n}(ExecCommandAction));\r\nif (supportsCut) {\r\n    registerEditorAction(ExecCommandCutAction);\r\n}\r\nif (supportsCopy) {\r\n    registerEditorAction(ExecCommandCopyAction);\r\n}\r\nif (supportsPaste) {\r\n    registerEditorAction(ExecCommandPasteAction);\r\n}\r\nif (supportsCopyWithSyntaxHighlighting) {\r\n    registerEditorAction(ExecCommandCopyWithSyntaxHighlightingAction);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar Lazy = /** @class */ (function () {\r\n    function Lazy(executor) {\r\n        this.executor = executor;\r\n        this._didRun = false;\r\n    }\r\n    /**\r\n     * Get the wrapped value.\r\n     *\r\n     * This will force evaluation of the lazy value if it has not been resolved yet. Lazy values are only\r\n     * resolved once. `getValue` will re-throw exceptions that are hit while resolving the value\r\n     */\r\n    Lazy.prototype.getValue = function () {\r\n        if (!this._didRun) {\r\n            try {\r\n                this._value = this.executor();\r\n            }\r\n            catch (err) {\r\n                this._error = err;\r\n            }\r\n            finally {\r\n                this._didRun = true;\r\n            }\r\n        }\r\n        if (this._error) {\r\n            throw this._error;\r\n        }\r\n        return this._value;\r\n    };\r\n    Object.defineProperty(Lazy.prototype, \"rawValue\", {\r\n        /**\r\n         * Get the wrapped value without forcing evaluation.\r\n         */\r\n        get: function () { return this._value; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Lazy;\r\n}());\r\nexport { Lazy };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { startsWith } from '../../../base/common/strings.js';\r\nvar CodeActionKind = /** @class */ (function () {\r\n    function CodeActionKind(value) {\r\n        this.value = value;\r\n    }\r\n    CodeActionKind.prototype.equals = function (other) {\r\n        return this.value === other.value;\r\n    };\r\n    CodeActionKind.prototype.contains = function (other) {\r\n        return this.equals(other) || this.value === '' || startsWith(other.value, this.value + CodeActionKind.sep);\r\n    };\r\n    CodeActionKind.prototype.intersects = function (other) {\r\n        return this.contains(other) || other.contains(this);\r\n    };\r\n    CodeActionKind.prototype.append = function (part) {\r\n        return new CodeActionKind(this.value + CodeActionKind.sep + part);\r\n    };\r\n    CodeActionKind.sep = '.';\r\n    CodeActionKind.None = new CodeActionKind('@@none@@'); // Special code action that contains nothing\r\n    CodeActionKind.Empty = new CodeActionKind('');\r\n    CodeActionKind.QuickFix = new CodeActionKind('quickfix');\r\n    CodeActionKind.Refactor = new CodeActionKind('refactor');\r\n    CodeActionKind.Source = new CodeActionKind('source');\r\n    CodeActionKind.SourceOrganizeImports = CodeActionKind.Source.append('organizeImports');\r\n    CodeActionKind.SourceFixAll = CodeActionKind.Source.append('fixAll');\r\n    return CodeActionKind;\r\n}());\r\nexport { CodeActionKind };\r\nexport function mayIncludeActionsOfKind(filter, providedKind) {\r\n    // A provided kind may be a subset or superset of our filtered kind.\r\n    if (filter.include && !filter.include.intersects(providedKind)) {\r\n        return false;\r\n    }\r\n    // Don't return source actions unless they are explicitly requested\r\n    if (!filter.includeSourceActions && CodeActionKind.Source.contains(providedKind)) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nexport function filtersAction(filter, action) {\r\n    var actionKind = action.kind ? new CodeActionKind(action.kind) : undefined;\r\n    // Filter out actions by kind\r\n    if (filter.include) {\r\n        if (!actionKind || !filter.include.contains(actionKind)) {\r\n            return false;\r\n        }\r\n    }\r\n    if (filter.excludes) {\r\n        if (actionKind && filter.excludes.some(function (exclude) {\r\n            // Excludes are overwritten by includes\r\n            return exclude.contains(actionKind) && (!filter.include || !filter.include.contains(actionKind));\r\n        })) {\r\n            return false;\r\n        }\r\n    }\r\n    // Don't return source actions unless they are explicitly requested\r\n    if (!filter.includeSourceActions) {\r\n        if (actionKind && CodeActionKind.Source.contains(actionKind)) {\r\n            return false;\r\n        }\r\n    }\r\n    if (filter.onlyIncludePreferredActions) {\r\n        if (!action.isPreferred) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nvar CodeActionCommandArgs = /** @class */ (function () {\r\n    function CodeActionCommandArgs(kind, apply, preferred) {\r\n        this.kind = kind;\r\n        this.apply = apply;\r\n        this.preferred = preferred;\r\n    }\r\n    CodeActionCommandArgs.fromUser = function (arg, defaults) {\r\n        if (!arg || typeof arg !== 'object') {\r\n            return new CodeActionCommandArgs(defaults.kind, defaults.apply, false);\r\n        }\r\n        return new CodeActionCommandArgs(CodeActionCommandArgs.getKindFromUser(arg, defaults.kind), CodeActionCommandArgs.getApplyFromUser(arg, defaults.apply), CodeActionCommandArgs.getPreferredUser(arg));\r\n    };\r\n    CodeActionCommandArgs.getApplyFromUser = function (arg, defaultAutoApply) {\r\n        switch (typeof arg.apply === 'string' ? arg.apply.toLowerCase() : '') {\r\n            case 'first': return \"first\" /* First */;\r\n            case 'never': return \"never\" /* Never */;\r\n            case 'ifsingle': return \"ifSingle\" /* IfSingle */;\r\n            default: return defaultAutoApply;\r\n        }\r\n    };\r\n    CodeActionCommandArgs.getKindFromUser = function (arg, defaultKind) {\r\n        return typeof arg.kind === 'string'\r\n            ? new CodeActionKind(arg.kind)\r\n            : defaultKind;\r\n    };\r\n    CodeActionCommandArgs.getPreferredUser = function (arg) {\r\n        return typeof arg.preferred === 'boolean'\r\n            ? arg.preferred\r\n            : false;\r\n    };\r\n    return CodeActionCommandArgs;\r\n}());\r\nexport { CodeActionCommandArgs };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { equals, flatten, isNonEmptyArray, mergeSort } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument, isPromiseCanceledError, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { registerLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { CodeActionProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CodeActionKind, filtersAction, mayIncludeActionsOfKind } from './types.js';\r\nimport { TextModelCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { DisposableStore, Disposable } from '../../../base/common/lifecycle.js';\r\nexport var codeActionCommandId = 'editor.action.codeAction';\r\nexport var refactorCommandId = 'editor.action.refactor';\r\nexport var sourceActionCommandId = 'editor.action.sourceAction';\r\nexport var organizeImportsCommandId = 'editor.action.organizeImports';\r\nexport var fixAllCommandId = 'editor.action.fixAll';\r\nvar ManagedCodeActionSet = /** @class */ (function (_super) {\r\n    __extends(ManagedCodeActionSet, _super);\r\n    function ManagedCodeActionSet(actions, disposables) {\r\n        var _this = _super.call(this) || this;\r\n        _this._register(disposables);\r\n        _this.allActions = mergeSort(__spreadArrays(actions), ManagedCodeActionSet.codeActionsComparator);\r\n        _this.validActions = _this.allActions.filter(function (action) { return !action.disabled; });\r\n        return _this;\r\n    }\r\n    ManagedCodeActionSet.codeActionsComparator = function (a, b) {\r\n        if (isNonEmptyArray(a.diagnostics)) {\r\n            if (isNonEmptyArray(b.diagnostics)) {\r\n                return a.diagnostics[0].message.localeCompare(b.diagnostics[0].message);\r\n            }\r\n            else {\r\n                return -1;\r\n            }\r\n        }\r\n        else if (isNonEmptyArray(b.diagnostics)) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return 0; // both have no diagnostics\r\n        }\r\n    };\r\n    Object.defineProperty(ManagedCodeActionSet.prototype, \"hasAutoFix\", {\r\n        get: function () {\r\n            return this.validActions.some(function (fix) { return !!fix.kind && CodeActionKind.QuickFix.contains(new CodeActionKind(fix.kind)) && !!fix.isPreferred; });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return ManagedCodeActionSet;\r\n}(Disposable));\r\nexport function getCodeActions(model, rangeOrSelection, trigger, token) {\r\n    var _this = this;\r\n    var _a;\r\n    var filter = trigger.filter || {};\r\n    var codeActionContext = {\r\n        only: (_a = filter.include) === null || _a === void 0 ? void 0 : _a.value,\r\n        trigger: trigger.type === 'manual' ? 2 /* Manual */ : 1 /* Automatic */\r\n    };\r\n    var cts = new TextModelCancellationTokenSource(model, token);\r\n    var providers = getCodeActionProviders(model, filter);\r\n    var disposables = new DisposableStore();\r\n    var promises = providers.map(function (provider) { return __awaiter(_this, void 0, void 0, function () {\r\n        var providedCodeActions, err_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    _a.trys.push([0, 2, , 3]);\r\n                    return [4 /*yield*/, provider.provideCodeActions(model, rangeOrSelection, codeActionContext, cts.token)];\r\n                case 1:\r\n                    providedCodeActions = _a.sent();\r\n                    if (cts.token.isCancellationRequested || !providedCodeActions) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    disposables.add(providedCodeActions);\r\n                    return [2 /*return*/, providedCodeActions.actions.filter(function (action) { return action && filtersAction(filter, action); })];\r\n                case 2:\r\n                    err_1 = _a.sent();\r\n                    if (isPromiseCanceledError(err_1)) {\r\n                        throw err_1;\r\n                    }\r\n                    onUnexpectedExternalError(err_1);\r\n                    return [2 /*return*/, []];\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    }); });\r\n    var listener = CodeActionProviderRegistry.onDidChange(function () {\r\n        var newProviders = CodeActionProviderRegistry.all(model);\r\n        if (!equals(newProviders, providers)) {\r\n            cts.cancel();\r\n        }\r\n    });\r\n    return Promise.all(promises)\r\n        .then(flatten)\r\n        .then(function (actions) { return new ManagedCodeActionSet(actions, disposables); })\r\n        .finally(function () {\r\n        listener.dispose();\r\n        cts.dispose();\r\n    });\r\n}\r\nfunction getCodeActionProviders(model, filter) {\r\n    return CodeActionProviderRegistry.all(model)\r\n        // Don't include providers that we know will not return code actions of interest\r\n        .filter(function (provider) {\r\n        if (!provider.providedCodeActionKinds) {\r\n            // We don't know what type of actions this provider will return.\r\n            return true;\r\n        }\r\n        return provider.providedCodeActionKinds.some(function (kind) { return mayIncludeActionsOfKind(filter, new CodeActionKind(kind)); });\r\n    });\r\n}\r\nregisterLanguageCommand('_executeCodeActionProvider', function (accessor, args) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var resource, rangeOrSelection, kind, model, validatedRangeOrSelection, codeActionSet;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    resource = args.resource, rangeOrSelection = args.rangeOrSelection, kind = args.kind;\r\n                    if (!(resource instanceof URI)) {\r\n                        throw illegalArgument();\r\n                    }\r\n                    model = accessor.get(IModelService).getModel(resource);\r\n                    if (!model) {\r\n                        throw illegalArgument();\r\n                    }\r\n                    validatedRangeOrSelection = Selection.isISelection(rangeOrSelection)\r\n                        ? Selection.liftSelection(rangeOrSelection)\r\n                        : Range.isIRange(rangeOrSelection)\r\n                            ? model.validateRange(rangeOrSelection)\r\n                            : undefined;\r\n                    if (!validatedRangeOrSelection) {\r\n                        throw illegalArgument();\r\n                    }\r\n                    return [4 /*yield*/, getCodeActions(model, validatedRangeOrSelection, { type: 'manual', filter: { includeSourceActions: true, include: kind && kind.value ? new CodeActionKind(kind.value) : undefined } }, CancellationToken.None)];\r\n                case 1:\r\n                    codeActionSet = _a.sent();\r\n                    setTimeout(function () { return codeActionSet.dispose(); }, 100);\r\n                    return [2 /*return*/, codeActionSet.validActions];\r\n            }\r\n        });\r\n    });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './messageController.css';\r\nimport * as nls from '../../../nls.js';\r\nimport { TimeoutTimer } from '../../../base/common/async.js';\r\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerEditorContribution, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerThemingParticipant, HIGH_CONTRAST } from '../../../platform/theme/common/themeService.js';\r\nimport { inputValidationInfoBorder, inputValidationInfoBackground, inputValidationInfoForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nvar MessageController = /** @class */ (function (_super) {\r\n    __extends(MessageController, _super);\r\n    function MessageController(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.closeTimeout = 3000; // close after 3s\r\n        _this._messageWidget = _this._register(new MutableDisposable());\r\n        _this._messageListeners = _this._register(new DisposableStore());\r\n        _this._editor = editor;\r\n        _this._visible = MessageController.MESSAGE_VISIBLE.bindTo(contextKeyService);\r\n        _this._register(_this._editor.onDidAttemptReadOnlyEdit(function () { return _this._onDidAttemptReadOnlyEdit(); }));\r\n        return _this;\r\n    }\r\n    MessageController.get = function (editor) {\r\n        return editor.getContribution(MessageController.ID);\r\n    };\r\n    MessageController.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._visible.reset();\r\n    };\r\n    MessageController.prototype.showMessage = function (message, position) {\r\n        var _this = this;\r\n        alert(message);\r\n        this._visible.set(true);\r\n        this._messageWidget.clear();\r\n        this._messageListeners.clear();\r\n        this._messageWidget.value = new MessageWidget(this._editor, position, message);\r\n        // close on blur, cursor, model change, dispose\r\n        this._messageListeners.add(this._editor.onDidBlurEditorText(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidChangeCursorPosition(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidDispose(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidChangeModel(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(new TimeoutTimer(function () { return _this.closeMessage(); }, this.closeTimeout));\r\n        // close on mouse move\r\n        var bounds;\r\n        this._messageListeners.add(this._editor.onMouseMove(function (e) {\r\n            // outside the text area\r\n            if (!e.target.position) {\r\n                return;\r\n            }\r\n            if (!bounds) {\r\n                // define bounding box around position and first mouse occurance\r\n                bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\r\n            }\r\n            else if (!bounds.containsPosition(e.target.position)) {\r\n                // check if position is still in bounds\r\n                _this.closeMessage();\r\n            }\r\n        }));\r\n    };\r\n    MessageController.prototype.closeMessage = function () {\r\n        this._visible.reset();\r\n        this._messageListeners.clear();\r\n        if (this._messageWidget.value) {\r\n            this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\r\n        }\r\n    };\r\n    MessageController.prototype._onDidAttemptReadOnlyEdit = function () {\r\n        if (this._editor.hasModel()) {\r\n            this.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this._editor.getPosition());\r\n        }\r\n    };\r\n    MessageController.ID = 'editor.contrib.messageController';\r\n    MessageController.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false);\r\n    MessageController = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], MessageController);\r\n    return MessageController;\r\n}(Disposable));\r\nexport { MessageController };\r\nvar MessageCommand = EditorCommand.bindToContribution(MessageController.get);\r\nregisterEditorCommand(new MessageCommand({\r\n    id: 'leaveEditorMessage',\r\n    precondition: MessageController.MESSAGE_VISIBLE,\r\n    handler: function (c) { return c.closeMessage(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        primary: 9 /* Escape */\r\n    }\r\n}));\r\nvar MessageWidget = /** @class */ (function () {\r\n    function MessageWidget(editor, _a, text) {\r\n        var lineNumber = _a.lineNumber, column = _a.column;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = true;\r\n        this.suppressMouseDown = false;\r\n        this._editor = editor;\r\n        this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0 /* Smooth */);\r\n        this._position = { lineNumber: lineNumber, column: column - 1 };\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.classList.add('monaco-editor-overlaymessage');\r\n        var message = document.createElement('div');\r\n        message.classList.add('message');\r\n        message.textContent = text;\r\n        this._domNode.appendChild(message);\r\n        var anchor = document.createElement('div');\r\n        anchor.classList.add('anchor');\r\n        this._domNode.appendChild(anchor);\r\n        this._editor.addContentWidget(this);\r\n        this._domNode.classList.add('fadeIn');\r\n    }\r\n    MessageWidget.fadeOut = function (messageWidget) {\r\n        var handle;\r\n        var dispose = function () {\r\n            messageWidget.dispose();\r\n            clearTimeout(handle);\r\n            messageWidget.getDomNode().removeEventListener('animationend', dispose);\r\n        };\r\n        handle = setTimeout(dispose, 110);\r\n        messageWidget.getDomNode().addEventListener('animationend', dispose);\r\n        messageWidget.getDomNode().classList.add('fadeOut');\r\n        return { dispose: dispose };\r\n    };\r\n    MessageWidget.prototype.dispose = function () {\r\n        this._editor.removeContentWidget(this);\r\n    };\r\n    MessageWidget.prototype.getId = function () {\r\n        return 'messageoverlay';\r\n    };\r\n    MessageWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    MessageWidget.prototype.getPosition = function () {\r\n        return { position: this._position, preference: [1 /* ABOVE */, 2 /* BELOW */] };\r\n    };\r\n    return MessageWidget;\r\n}());\r\nregisterEditorContribution(MessageController.ID, MessageController);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(inputValidationInfoBorder);\r\n    if (border) {\r\n        var borderWidth = theme.type === HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .anchor { border-top-color: \" + border + \"; }\");\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { border: \" + borderWidth + \"px solid \" + border + \"; }\");\r\n    }\r\n    var background = theme.getColor(inputValidationInfoBackground);\r\n    if (background) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { background-color: \" + background + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(inputValidationInfoForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { color: \" + foreground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { GlobalMouseMoveMonitor, standardMouseMoveMerger } from '../../../base/browser/globalMouseMoveMonitor.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport './lightBulbWidget.css';\r\nimport { TextModel } from '../../common/model/textModel.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { editorLightBulbForeground, editorLightBulbAutoFixForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { Gesture } from '../../../base/browser/touch.js';\r\nvar LightBulbState;\r\n(function (LightBulbState) {\r\n    LightBulbState.Hidden = { type: 0 /* Hidden */ };\r\n    var Showing = /** @class */ (function () {\r\n        function Showing(actions, editorPosition, widgetPosition) {\r\n            this.actions = actions;\r\n            this.editorPosition = editorPosition;\r\n            this.widgetPosition = widgetPosition;\r\n            this.type = 1 /* Showing */;\r\n        }\r\n        return Showing;\r\n    }());\r\n    LightBulbState.Showing = Showing;\r\n})(LightBulbState || (LightBulbState = {}));\r\nvar LightBulbWidget = /** @class */ (function (_super) {\r\n    __extends(LightBulbWidget, _super);\r\n    function LightBulbWidget(_editor, _quickFixActionId, _preferredFixActionId, _keybindingService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._quickFixActionId = _quickFixActionId;\r\n        _this._preferredFixActionId = _preferredFixActionId;\r\n        _this._keybindingService = _keybindingService;\r\n        _this._onClick = _this._register(new Emitter());\r\n        _this.onClick = _this._onClick.event;\r\n        _this._state = LightBulbState.Hidden;\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'codicon codicon-lightbulb';\r\n        _this._editor.addContentWidget(_this);\r\n        _this._register(_this._editor.onDidChangeModelContent(function (_) {\r\n            // cancel when the line in question has been removed\r\n            var editorModel = _this._editor.getModel();\r\n            if (_this.state.type !== 1 /* Showing */ || !editorModel || _this.state.editorPosition.lineNumber >= editorModel.getLineCount()) {\r\n                _this.hide();\r\n            }\r\n        }));\r\n        Gesture.ignoreTarget(_this._domNode);\r\n        _this._register(dom.addStandardDisposableGenericMouseDownListner(_this._domNode, function (e) {\r\n            if (_this.state.type !== 1 /* Showing */) {\r\n                return;\r\n            }\r\n            // Make sure that focus / cursor location is not lost when clicking widget icon\r\n            _this._editor.focus();\r\n            e.preventDefault();\r\n            // a bit of extra work to make sure the menu\r\n            // doesn't cover the line-text\r\n            var _a = dom.getDomNodePagePosition(_this._domNode), top = _a.top, height = _a.height;\r\n            var lineHeight = _this._editor.getOption(47 /* lineHeight */);\r\n            var pad = Math.floor(lineHeight / 3);\r\n            if (_this.state.widgetPosition.position !== null && _this.state.widgetPosition.position.lineNumber < _this.state.editorPosition.lineNumber) {\r\n                pad += lineHeight;\r\n            }\r\n            _this._onClick.fire({\r\n                x: e.posx,\r\n                y: top + height + pad,\r\n                actions: _this.state.actions\r\n            });\r\n        }));\r\n        _this._register(dom.addDisposableListener(_this._domNode, 'mouseenter', function (e) {\r\n            if ((e.buttons & 1) !== 1) {\r\n                return;\r\n            }\r\n            // mouse enters lightbulb while the primary/left button\r\n            // is being pressed -> hide the lightbulb and block future\r\n            // showings until mouse is released\r\n            _this.hide();\r\n            var monitor = new GlobalMouseMoveMonitor();\r\n            monitor.startMonitoring(standardMouseMoveMerger, function () { }, function () {\r\n                monitor.dispose();\r\n            });\r\n        }));\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) {\r\n            // hide when told to do so\r\n            if (e.hasChanged(45 /* lightbulb */) && !_this._editor.getOption(45 /* lightbulb */).enabled) {\r\n                _this.hide();\r\n            }\r\n        }));\r\n        _this._updateLightBulbTitle();\r\n        _this._register(_this._keybindingService.onDidUpdateKeybindings(_this._updateLightBulbTitle, _this));\r\n        return _this;\r\n    }\r\n    LightBulbWidget.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._editor.removeContentWidget(this);\r\n    };\r\n    LightBulbWidget.prototype.getId = function () {\r\n        return 'LightBulbWidget';\r\n    };\r\n    LightBulbWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    LightBulbWidget.prototype.getPosition = function () {\r\n        return this._state.type === 1 /* Showing */ ? this._state.widgetPosition : null;\r\n    };\r\n    LightBulbWidget.prototype.update = function (actions, atPosition) {\r\n        var _this = this;\r\n        if (actions.validActions.length <= 0) {\r\n            return this.hide();\r\n        }\r\n        var options = this._editor.getOptions();\r\n        if (!options.get(45 /* lightbulb */).enabled) {\r\n            return this.hide();\r\n        }\r\n        var lineNumber = atPosition.lineNumber, column = atPosition.column;\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return this.hide();\r\n        }\r\n        var tabSize = model.getOptions().tabSize;\r\n        var fontInfo = options.get(32 /* fontInfo */);\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        var indent = TextModel.computeIndentLevel(lineContent, tabSize);\r\n        var lineHasSpace = fontInfo.spaceWidth * indent > 22;\r\n        var isFolded = function (lineNumber) {\r\n            return lineNumber > 2 && _this._editor.getTopForLineNumber(lineNumber) === _this._editor.getTopForLineNumber(lineNumber - 1);\r\n        };\r\n        var effectiveLineNumber = lineNumber;\r\n        if (!lineHasSpace) {\r\n            if (lineNumber > 1 && !isFolded(lineNumber - 1)) {\r\n                effectiveLineNumber -= 1;\r\n            }\r\n            else if (!isFolded(lineNumber + 1)) {\r\n                effectiveLineNumber += 1;\r\n            }\r\n            else if (column * fontInfo.spaceWidth < 22) {\r\n                // cannot show lightbulb above/below and showing\r\n                // it inline would overlay the cursor...\r\n                return this.hide();\r\n            }\r\n        }\r\n        this.state = new LightBulbState.Showing(actions, atPosition, {\r\n            position: { lineNumber: effectiveLineNumber, column: 1 },\r\n            preference: LightBulbWidget._posPref\r\n        });\r\n        dom.toggleClass(this._domNode, 'codicon-lightbulb-autofix', actions.hasAutoFix);\r\n        this._editor.layoutContentWidget(this);\r\n    };\r\n    LightBulbWidget.prototype.hide = function () {\r\n        this.state = LightBulbState.Hidden;\r\n        this._editor.layoutContentWidget(this);\r\n    };\r\n    Object.defineProperty(LightBulbWidget.prototype, \"state\", {\r\n        get: function () { return this._state; },\r\n        set: function (value) {\r\n            this._state = value;\r\n            this._updateLightBulbTitle();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LightBulbWidget.prototype._updateLightBulbTitle = function () {\r\n        if (this.state.type === 1 /* Showing */ && this.state.actions.hasAutoFix) {\r\n            var preferredKb = this._keybindingService.lookupKeybinding(this._preferredFixActionId);\r\n            if (preferredKb) {\r\n                this.title = nls.localize('prefferedQuickFixWithKb', \"Show Fixes. Preferred Fix Available ({0})\", preferredKb.getLabel());\r\n                return;\r\n            }\r\n        }\r\n        var kb = this._keybindingService.lookupKeybinding(this._quickFixActionId);\r\n        if (kb) {\r\n            this.title = nls.localize('quickFixWithKb', \"Show Fixes ({0})\", kb.getLabel());\r\n        }\r\n        else {\r\n            this.title = nls.localize('quickFix', \"Show Fixes\");\r\n        }\r\n    };\r\n    Object.defineProperty(LightBulbWidget.prototype, \"title\", {\r\n        set: function (value) {\r\n            this._domNode.title = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LightBulbWidget._posPref = [0 /* EXACT */];\r\n    LightBulbWidget = __decorate([\r\n        __param(3, IKeybindingService)\r\n    ], LightBulbWidget);\r\n    return LightBulbWidget;\r\n}(Disposable));\r\nexport { LightBulbWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    // Lightbulb Icon\r\n    var editorLightBulbForegroundColor = theme.getColor(editorLightBulbForeground);\r\n    if (editorLightBulbForegroundColor) {\r\n        collector.addRule(\"\\n\\t\\t.monaco-editor .contentWidgets .codicon-lightbulb,\\n\\t\\t.monaco-workbench .markers-panel-container .codicon-lightbulb {\\n\\t\\t\\tcolor: \" + editorLightBulbForegroundColor + \";\\n\\t\\t}\");\r\n    }\r\n    // Lightbulb Auto Fix Icon\r\n    var editorLightBulbAutoFixForegroundColor = theme.getColor(editorLightBulbAutoFixForeground);\r\n    if (editorLightBulbAutoFixForegroundColor) {\r\n        collector.addRule(\"\\n\\t\\t.monaco-editor .contentWidgets .codicon-lightbulb-autofix,\\n\\t\\t.monaco-workbench .markers-panel-container .codicon-lightbulb-autofix {\\n\\t\\t\\tcolor: \" + editorLightBulbAutoFixForegroundColor + \";\\n\\t\\t}\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { getDomNodePagePosition } from '../../../base/browser/dom.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { canceled } from '../../../base/common/errors.js';\r\nimport { Lazy } from '../../../base/common/lazy.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { refactorCommandId, sourceActionCommandId, codeActionCommandId, organizeImportsCommandId, fixAllCommandId } from './codeAction.js';\r\nimport { CodeActionCommandArgs, CodeActionKind } from './types.js';\r\nimport { IContextMenuService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nvar CodeActionAction = /** @class */ (function (_super) {\r\n    __extends(CodeActionAction, _super);\r\n    function CodeActionAction(action, callback) {\r\n        var _this = _super.call(this, action.command ? action.command.id : action.title, action.title, undefined, !action.disabled, callback) || this;\r\n        _this.action = action;\r\n        return _this;\r\n    }\r\n    return CodeActionAction;\r\n}(Action));\r\nvar CodeActionMenu = /** @class */ (function (_super) {\r\n    __extends(CodeActionMenu, _super);\r\n    function CodeActionMenu(_editor, _delegate, _contextMenuService, keybindingService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._delegate = _delegate;\r\n        _this._contextMenuService = _contextMenuService;\r\n        _this._visible = false;\r\n        _this._showingActions = _this._register(new MutableDisposable());\r\n        _this._keybindingResolver = new CodeActionKeybindingResolver({\r\n            getKeybindings: function () { return keybindingService.getKeybindings(); }\r\n        });\r\n        return _this;\r\n    }\r\n    Object.defineProperty(CodeActionMenu.prototype, \"isVisible\", {\r\n        get: function () {\r\n            return this._visible;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CodeActionMenu.prototype.show = function (codeActions, at, options) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var actionsToShow, menuActions, anchor, resolver;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                actionsToShow = options.includeDisabledActions ? codeActions.allActions : codeActions.validActions;\r\n                if (!actionsToShow.length) {\r\n                    this._visible = false;\r\n                    return [2 /*return*/];\r\n                }\r\n                if (!this._editor.getDomNode()) {\r\n                    // cancel when editor went off-dom\r\n                    this._visible = false;\r\n                    throw canceled();\r\n                }\r\n                this._visible = true;\r\n                this._showingActions.value = codeActions;\r\n                menuActions = actionsToShow.map(function (action) {\r\n                    return new CodeActionAction(action, function () { return _this._delegate.onSelectCodeAction(action); });\r\n                });\r\n                anchor = Position.isIPosition(at) ? this._toCoords(at) : at || { x: 0, y: 0 };\r\n                resolver = this._keybindingResolver.getResolver();\r\n                this._contextMenuService.showContextMenu({\r\n                    getAnchor: function () { return anchor; },\r\n                    getActions: function () { return menuActions; },\r\n                    onHide: function () {\r\n                        _this._visible = false;\r\n                        _this._editor.focus();\r\n                    },\r\n                    autoSelectFirstItem: true,\r\n                    getKeyBinding: function (action) { return action instanceof CodeActionAction ? resolver(action.action) : undefined; },\r\n                });\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    CodeActionMenu.prototype._toCoords = function (position) {\r\n        if (!this._editor.hasModel()) {\r\n            return { x: 0, y: 0 };\r\n        }\r\n        this._editor.revealPosition(position, 1 /* Immediate */);\r\n        this._editor.render();\r\n        // Translate to absolute editor position\r\n        var cursorCoords = this._editor.getScrolledVisiblePosition(position);\r\n        var editorCoords = getDomNodePagePosition(this._editor.getDomNode());\r\n        var x = editorCoords.left + cursorCoords.left;\r\n        var y = editorCoords.top + cursorCoords.top + cursorCoords.height;\r\n        return { x: x, y: y };\r\n    };\r\n    CodeActionMenu = __decorate([\r\n        __param(2, IContextMenuService),\r\n        __param(3, IKeybindingService)\r\n    ], CodeActionMenu);\r\n    return CodeActionMenu;\r\n}(Disposable));\r\nexport { CodeActionMenu };\r\nvar CodeActionKeybindingResolver = /** @class */ (function () {\r\n    function CodeActionKeybindingResolver(_keybindingProvider) {\r\n        this._keybindingProvider = _keybindingProvider;\r\n    }\r\n    CodeActionKeybindingResolver.prototype.getResolver = function () {\r\n        var _this = this;\r\n        // Lazy since we may not actually ever read the value\r\n        var allCodeActionBindings = new Lazy(function () {\r\n            return _this._keybindingProvider.getKeybindings()\r\n                .filter(function (item) { return CodeActionKeybindingResolver.codeActionCommands.indexOf(item.command) >= 0; })\r\n                .filter(function (item) { return item.resolvedKeybinding; })\r\n                .map(function (item) {\r\n                // Special case these commands since they come built-in with VS Code and don't use 'commandArgs'\r\n                var commandArgs = item.commandArgs;\r\n                if (item.command === organizeImportsCommandId) {\r\n                    commandArgs = { kind: CodeActionKind.SourceOrganizeImports.value };\r\n                }\r\n                else if (item.command === fixAllCommandId) {\r\n                    commandArgs = { kind: CodeActionKind.SourceFixAll.value };\r\n                }\r\n                return __assign({ resolvedKeybinding: item.resolvedKeybinding }, CodeActionCommandArgs.fromUser(commandArgs, {\r\n                    kind: CodeActionKind.None,\r\n                    apply: \"never\" /* Never */\r\n                }));\r\n            });\r\n        });\r\n        return function (action) {\r\n            var _a;\r\n            if (action.kind) {\r\n                var binding = _this.bestKeybindingForCodeAction(action, allCodeActionBindings.getValue());\r\n                return (_a = binding) === null || _a === void 0 ? void 0 : _a.resolvedKeybinding;\r\n            }\r\n            return undefined;\r\n        };\r\n    };\r\n    CodeActionKeybindingResolver.prototype.bestKeybindingForCodeAction = function (action, candidates) {\r\n        if (!action.kind) {\r\n            return undefined;\r\n        }\r\n        var kind = new CodeActionKind(action.kind);\r\n        return candidates\r\n            .filter(function (candidate) { return candidate.kind.contains(kind); })\r\n            .filter(function (candidate) {\r\n            if (candidate.preferred) {\r\n                // If the candidate keybinding only applies to preferred actions, the this action must also be preferred\r\n                return action.isPreferred;\r\n            }\r\n            return true;\r\n        })\r\n            .reduceRight(function (currentBest, candidate) {\r\n            if (!currentBest) {\r\n                return candidate;\r\n            }\r\n            // Select the more specific binding\r\n            return currentBest.kind.contains(candidate.kind) ? candidate : currentBest;\r\n        }, undefined);\r\n    };\r\n    CodeActionKeybindingResolver.codeActionCommands = [\r\n        refactorCommandId,\r\n        codeActionCommandId,\r\n        sourceActionCommandId,\r\n        organizeImportsCommandId,\r\n        fixAllCommandId\r\n    ];\r\n    return CodeActionKeybindingResolver;\r\n}());\r\nexport { CodeActionKeybindingResolver };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createCancelablePromise, TimeoutTimer } from '../../../base/common/async.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { CodeActionProviderRegistry } from '../../common/modes.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { getCodeActions } from './codeAction.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nexport var SUPPORTED_CODE_ACTIONS = new RawContextKey('supportedCodeAction', '');\r\nvar CodeActionOracle = /** @class */ (function (_super) {\r\n    __extends(CodeActionOracle, _super);\r\n    function CodeActionOracle(_editor, _markerService, _signalChange, _delay) {\r\n        if (_delay === void 0) { _delay = 250; }\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._markerService = _markerService;\r\n        _this._signalChange = _signalChange;\r\n        _this._delay = _delay;\r\n        _this._autoTriggerTimer = _this._register(new TimeoutTimer());\r\n        _this._register(_this._markerService.onMarkerChanged(function (e) { return _this._onMarkerChanges(e); }));\r\n        _this._register(_this._editor.onDidChangeCursorPosition(function () { return _this._onCursorChange(); }));\r\n        return _this;\r\n    }\r\n    CodeActionOracle.prototype.trigger = function (trigger) {\r\n        var selection = this._getRangeOfSelectionUnlessWhitespaceEnclosed(trigger);\r\n        return this._createEventAndSignalChange(trigger, selection);\r\n    };\r\n    CodeActionOracle.prototype._onMarkerChanges = function (resources) {\r\n        var _this = this;\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        if (resources.some(function (resource) { return isEqual(resource, model.uri); })) {\r\n            this._autoTriggerTimer.cancelAndSet(function () {\r\n                _this.trigger({ type: 'auto' });\r\n            }, this._delay);\r\n        }\r\n    };\r\n    CodeActionOracle.prototype._onCursorChange = function () {\r\n        var _this = this;\r\n        this._autoTriggerTimer.cancelAndSet(function () {\r\n            _this.trigger({ type: 'auto' });\r\n        }, this._delay);\r\n    };\r\n    CodeActionOracle.prototype._getRangeOfMarker = function (selection) {\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return undefined;\r\n        }\r\n        for (var _i = 0, _a = this._markerService.read({ resource: model.uri }); _i < _a.length; _i++) {\r\n            var marker = _a[_i];\r\n            var markerRange = model.validateRange(marker);\r\n            if (Range.intersectRanges(markerRange, selection)) {\r\n                return Range.lift(markerRange);\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    CodeActionOracle.prototype._getRangeOfSelectionUnlessWhitespaceEnclosed = function (trigger) {\r\n        if (!this._editor.hasModel()) {\r\n            return undefined;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var selection = this._editor.getSelection();\r\n        if (selection.isEmpty() && trigger.type === 'auto') {\r\n            var _a = selection.getPosition(), lineNumber = _a.lineNumber, column = _a.column;\r\n            var line = model.getLineContent(lineNumber);\r\n            if (line.length === 0) {\r\n                // empty line\r\n                return undefined;\r\n            }\r\n            else if (column === 1) {\r\n                // look only right\r\n                if (/\\s/.test(line[0])) {\r\n                    return undefined;\r\n                }\r\n            }\r\n            else if (column === model.getLineMaxColumn(lineNumber)) {\r\n                // look only left\r\n                if (/\\s/.test(line[line.length - 1])) {\r\n                    return undefined;\r\n                }\r\n            }\r\n            else {\r\n                // look left and right\r\n                if (/\\s/.test(line[column - 2]) && /\\s/.test(line[column - 1])) {\r\n                    return undefined;\r\n                }\r\n            }\r\n        }\r\n        return selection;\r\n    };\r\n    CodeActionOracle.prototype._createEventAndSignalChange = function (trigger, selection) {\r\n        var model = this._editor.getModel();\r\n        if (!selection || !model) {\r\n            // cancel\r\n            this._signalChange(undefined);\r\n            return undefined;\r\n        }\r\n        var markerRange = this._getRangeOfMarker(selection);\r\n        var position = markerRange ? markerRange.getStartPosition() : selection.getStartPosition();\r\n        var e = {\r\n            trigger: trigger,\r\n            selection: selection,\r\n            position: position\r\n        };\r\n        this._signalChange(e);\r\n        return e;\r\n    };\r\n    return CodeActionOracle;\r\n}(Disposable));\r\nexport var CodeActionsState;\r\n(function (CodeActionsState) {\r\n    CodeActionsState.Empty = { type: 0 /* Empty */ };\r\n    var Triggered = /** @class */ (function () {\r\n        function Triggered(trigger, rangeOrSelection, position, actions) {\r\n            this.trigger = trigger;\r\n            this.rangeOrSelection = rangeOrSelection;\r\n            this.position = position;\r\n            this.actions = actions;\r\n            this.type = 1 /* Triggered */;\r\n        }\r\n        return Triggered;\r\n    }());\r\n    CodeActionsState.Triggered = Triggered;\r\n})(CodeActionsState || (CodeActionsState = {}));\r\nvar CodeActionModel = /** @class */ (function (_super) {\r\n    __extends(CodeActionModel, _super);\r\n    function CodeActionModel(_editor, _markerService, contextKeyService, _progressService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._markerService = _markerService;\r\n        _this._progressService = _progressService;\r\n        _this._codeActionOracle = _this._register(new MutableDisposable());\r\n        _this._state = CodeActionsState.Empty;\r\n        _this._onDidChangeState = _this._register(new Emitter());\r\n        _this.onDidChangeState = _this._onDidChangeState.event;\r\n        _this._supportedCodeActions = SUPPORTED_CODE_ACTIONS.bindTo(contextKeyService);\r\n        _this._register(_this._editor.onDidChangeModel(function () { return _this._update(); }));\r\n        _this._register(_this._editor.onDidChangeModelLanguage(function () { return _this._update(); }));\r\n        _this._register(CodeActionProviderRegistry.onDidChange(function () { return _this._update(); }));\r\n        _this._update();\r\n        return _this;\r\n    }\r\n    CodeActionModel.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this.setState(CodeActionsState.Empty, true);\r\n    };\r\n    CodeActionModel.prototype._update = function () {\r\n        var _this = this;\r\n        this._codeActionOracle.value = undefined;\r\n        this.setState(CodeActionsState.Empty);\r\n        var model = this._editor.getModel();\r\n        if (model\r\n            && CodeActionProviderRegistry.has(model)\r\n            && !this._editor.getOption(65 /* readOnly */)) {\r\n            var supportedActions = [];\r\n            for (var _i = 0, _a = CodeActionProviderRegistry.all(model); _i < _a.length; _i++) {\r\n                var provider = _a[_i];\r\n                if (Array.isArray(provider.providedCodeActionKinds)) {\r\n                    supportedActions.push.apply(supportedActions, provider.providedCodeActionKinds);\r\n                }\r\n            }\r\n            this._supportedCodeActions.set(supportedActions.join(' '));\r\n            this._codeActionOracle.value = new CodeActionOracle(this._editor, this._markerService, function (trigger) {\r\n                if (!trigger) {\r\n                    _this.setState(CodeActionsState.Empty);\r\n                    return;\r\n                }\r\n                var actions = createCancelablePromise(function (token) { return getCodeActions(model, trigger.selection, trigger.trigger, token); });\r\n                if (_this._progressService && trigger.trigger.type === 'manual') {\r\n                    _this._progressService.showWhile(actions, 250);\r\n                }\r\n                _this.setState(new CodeActionsState.Triggered(trigger.trigger, trigger.selection, trigger.position, actions));\r\n            }, undefined);\r\n            this._codeActionOracle.value.trigger({ type: 'auto' });\r\n        }\r\n        else {\r\n            this._supportedCodeActions.reset();\r\n        }\r\n    };\r\n    CodeActionModel.prototype.trigger = function (trigger) {\r\n        if (this._codeActionOracle.value) {\r\n            this._codeActionOracle.value.trigger(trigger);\r\n        }\r\n    };\r\n    CodeActionModel.prototype.setState = function (newState, skipNotify) {\r\n        if (newState === this._state) {\r\n            return;\r\n        }\r\n        // Cancel old request\r\n        if (this._state.type === 1 /* Triggered */) {\r\n            this._state.actions.cancel();\r\n        }\r\n        this._state = newState;\r\n        if (!skipNotify) {\r\n            this._onDidChangeState.fire(newState);\r\n        }\r\n    };\r\n    return CodeActionModel;\r\n}(Disposable));\r\nexport { CodeActionModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { find } from '../../../base/common/arrays.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Lazy } from '../../../base/common/lazy.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { CodeActionMenu } from './codeActionMenu.js';\r\nimport { LightBulbWidget } from './lightBulbWidget.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nvar CodeActionUi = /** @class */ (function (_super) {\r\n    __extends(CodeActionUi, _super);\r\n    function CodeActionUi(_editor, quickFixActionId, preferredFixActionId, delegate, instantiationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this.delegate = delegate;\r\n        _this._activeCodeActions = _this._register(new MutableDisposable());\r\n        _this._codeActionWidget = new Lazy(function () {\r\n            return _this._register(instantiationService.createInstance(CodeActionMenu, _this._editor, {\r\n                onSelectCodeAction: function (action) { return __awaiter(_this, void 0, void 0, function () {\r\n                    return __generator(this, function (_a) {\r\n                        this.delegate.applyCodeAction(action, /* retrigger */ true);\r\n                        return [2 /*return*/];\r\n                    });\r\n                }); }\r\n            }));\r\n        });\r\n        _this._lightBulbWidget = new Lazy(function () {\r\n            var widget = _this._register(instantiationService.createInstance(LightBulbWidget, _this._editor, quickFixActionId, preferredFixActionId));\r\n            _this._register(widget.onClick(function (e) { return _this.showCodeActionList(e.actions, e, { includeDisabledActions: false }); }));\r\n            return widget;\r\n        });\r\n        return _this;\r\n    }\r\n    CodeActionUi.prototype.update = function (newState) {\r\n        var _a, _b, _c;\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var actions, e_1, validActionToApply, invalidAction, includeDisabledActions;\r\n            return __generator(this, function (_d) {\r\n                switch (_d.label) {\r\n                    case 0:\r\n                        if (newState.type !== 1 /* Triggered */) {\r\n                            (_a = this._lightBulbWidget.rawValue) === null || _a === void 0 ? void 0 : _a.hide();\r\n                            return [2 /*return*/];\r\n                        }\r\n                        _d.label = 1;\r\n                    case 1:\r\n                        _d.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, newState.actions];\r\n                    case 2:\r\n                        actions = _d.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        e_1 = _d.sent();\r\n                        onUnexpectedError(e_1);\r\n                        return [2 /*return*/];\r\n                    case 4:\r\n                        this._lightBulbWidget.getValue().update(actions, newState.position);\r\n                        if (!(newState.trigger.type === 'manual')) return [3 /*break*/, 11];\r\n                        if (!((_b = newState.trigger.filter) === null || _b === void 0 ? void 0 : _b.include)) return [3 /*break*/, 10];\r\n                        validActionToApply = this.tryGetValidActionToApply(newState.trigger, actions);\r\n                        if (!validActionToApply) return [3 /*break*/, 9];\r\n                        _d.label = 5;\r\n                    case 5:\r\n                        _d.trys.push([5, , 7, 8]);\r\n                        return [4 /*yield*/, this.delegate.applyCodeAction(validActionToApply, false)];\r\n                    case 6:\r\n                        _d.sent();\r\n                        return [3 /*break*/, 8];\r\n                    case 7:\r\n                        actions.dispose();\r\n                        return [7 /*endfinally*/];\r\n                    case 8: return [2 /*return*/];\r\n                    case 9:\r\n                        // Check to see if there is an action that we would have applied were it not invalid\r\n                        if (newState.trigger.context) {\r\n                            invalidAction = this.getInvalidActionThatWouldHaveBeenApplied(newState.trigger, actions);\r\n                            if (invalidAction && invalidAction.disabled) {\r\n                                MessageController.get(this._editor).showMessage(invalidAction.disabled, newState.trigger.context.position);\r\n                                actions.dispose();\r\n                                return [2 /*return*/];\r\n                            }\r\n                        }\r\n                        _d.label = 10;\r\n                    case 10:\r\n                        includeDisabledActions = !!((_c = newState.trigger.filter) === null || _c === void 0 ? void 0 : _c.include);\r\n                        if (newState.trigger.context) {\r\n                            if (!actions.allActions.length || !includeDisabledActions && !actions.validActions.length) {\r\n                                MessageController.get(this._editor).showMessage(newState.trigger.context.notAvailableMessage, newState.trigger.context.position);\r\n                                this._activeCodeActions.value = actions;\r\n                                actions.dispose();\r\n                                return [2 /*return*/];\r\n                            }\r\n                        }\r\n                        this._activeCodeActions.value = actions;\r\n                        this._codeActionWidget.getValue().show(actions, newState.position, { includeDisabledActions: includeDisabledActions });\r\n                        return [3 /*break*/, 12];\r\n                    case 11:\r\n                        // auto magically triggered\r\n                        if (this._codeActionWidget.getValue().isVisible) {\r\n                            // TODO: Figure out if we should update the showing menu?\r\n                            actions.dispose();\r\n                        }\r\n                        else {\r\n                            this._activeCodeActions.value = actions;\r\n                        }\r\n                        _d.label = 12;\r\n                    case 12: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CodeActionUi.prototype.getInvalidActionThatWouldHaveBeenApplied = function (trigger, actions) {\r\n        if (!actions.allActions.length) {\r\n            return undefined;\r\n        }\r\n        if ((trigger.autoApply === \"first\" /* First */ && actions.validActions.length === 0)\r\n            || (trigger.autoApply === \"ifSingle\" /* IfSingle */ && actions.allActions.length === 1)) {\r\n            return find(actions.allActions, function (action) { return action.disabled; });\r\n        }\r\n        return undefined;\r\n    };\r\n    CodeActionUi.prototype.tryGetValidActionToApply = function (trigger, actions) {\r\n        if (!actions.validActions.length) {\r\n            return undefined;\r\n        }\r\n        if ((trigger.autoApply === \"first\" /* First */ && actions.validActions.length > 0)\r\n            || (trigger.autoApply === \"ifSingle\" /* IfSingle */ && actions.validActions.length === 1)) {\r\n            return actions.validActions[0];\r\n        }\r\n        return undefined;\r\n    };\r\n    CodeActionUi.prototype.showCodeActionList = function (actions, at, options) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                this._codeActionWidget.getValue().show(actions, at, options);\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    CodeActionUi = __decorate([\r\n        __param(4, IInstantiationService)\r\n    ], CodeActionUi);\r\n    return CodeActionUi;\r\n}(Disposable));\r\nexport { CodeActionUi };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { Lazy } from '../../../base/common/lazy.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { escapeRegExpCharacters } from '../../../base/common/strings.js';\r\nimport { EditorAction, EditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IBulkEditService } from '../../browser/services/bulkEditService.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { refactorCommandId, sourceActionCommandId, codeActionCommandId, organizeImportsCommandId, fixAllCommandId } from './codeAction.js';\r\nimport { CodeActionUi } from './codeActionUi.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IContextMenuService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { IMarkerService } from '../../../platform/markers/common/markers.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { CodeActionModel, SUPPORTED_CODE_ACTIONS } from './codeActionModel.js';\r\nimport { CodeActionKind, CodeActionCommandArgs } from './types.js';\r\nfunction contextKeyForSupportedActions(kind) {\r\n    return ContextKeyExpr.regex(SUPPORTED_CODE_ACTIONS.keys()[0], new RegExp('(\\\\s|^)' + escapeRegExpCharacters(kind.value) + '\\\\b'));\r\n}\r\nvar argsSchema = {\r\n    type: 'object',\r\n    required: ['kind'],\r\n    defaultSnippets: [{ body: { kind: '' } }],\r\n    properties: {\r\n        'kind': {\r\n            type: 'string',\r\n            description: nls.localize('args.schema.kind', \"Kind of the code action to run.\"),\r\n        },\r\n        'apply': {\r\n            type: 'string',\r\n            description: nls.localize('args.schema.apply', \"Controls when the returned actions are applied.\"),\r\n            default: \"ifSingle\" /* IfSingle */,\r\n            enum: [\"first\" /* First */, \"ifSingle\" /* IfSingle */, \"never\" /* Never */],\r\n            enumDescriptions: [\r\n                nls.localize('args.schema.apply.first', \"Always apply the first returned code action.\"),\r\n                nls.localize('args.schema.apply.ifSingle', \"Apply the first returned code action if it is the only one.\"),\r\n                nls.localize('args.schema.apply.never', \"Do not apply the returned code actions.\"),\r\n            ]\r\n        },\r\n        'preferred': {\r\n            type: 'boolean',\r\n            default: false,\r\n            description: nls.localize('args.schema.preferred', \"Controls if only preferred code actions should be returned.\"),\r\n        }\r\n    }\r\n};\r\nvar QuickFixController = /** @class */ (function (_super) {\r\n    __extends(QuickFixController, _super);\r\n    function QuickFixController(editor, markerService, contextKeyService, progressService, contextMenuService, keybindingService, _commandService, _bulkEditService, _instantiationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._commandService = _commandService;\r\n        _this._bulkEditService = _bulkEditService;\r\n        _this._instantiationService = _instantiationService;\r\n        _this._editor = editor;\r\n        _this._model = _this._register(new CodeActionModel(_this._editor, markerService, contextKeyService, progressService));\r\n        _this._register(_this._model.onDidChangeState(function (newState) { return _this.update(newState); }));\r\n        _this._ui = new Lazy(function () {\r\n            return _this._register(new CodeActionUi(editor, QuickFixAction.Id, AutoFixAction.Id, {\r\n                applyCodeAction: function (action, retrigger) { return __awaiter(_this, void 0, void 0, function () {\r\n                    return __generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0:\r\n                                _a.trys.push([0, , 2, 3]);\r\n                                return [4 /*yield*/, this._applyCodeAction(action)];\r\n                            case 1:\r\n                                _a.sent();\r\n                                return [3 /*break*/, 3];\r\n                            case 2:\r\n                                if (retrigger) {\r\n                                    this._trigger({ type: 'auto', filter: {} });\r\n                                }\r\n                                return [7 /*endfinally*/];\r\n                            case 3: return [2 /*return*/];\r\n                        }\r\n                    });\r\n                }); }\r\n            }, _this._instantiationService));\r\n        });\r\n        return _this;\r\n    }\r\n    QuickFixController.get = function (editor) {\r\n        return editor.getContribution(QuickFixController.ID);\r\n    };\r\n    QuickFixController.prototype.update = function (newState) {\r\n        this._ui.getValue().update(newState);\r\n    };\r\n    QuickFixController.prototype.showCodeActions = function (actions, at) {\r\n        return this._ui.getValue().showCodeActionList(actions, at, { includeDisabledActions: false });\r\n    };\r\n    QuickFixController.prototype.manualTriggerAtCurrentPosition = function (notAvailableMessage, filter, autoApply) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        MessageController.get(this._editor).closeMessage();\r\n        var triggerPosition = this._editor.getPosition();\r\n        this._trigger({ type: 'manual', filter: filter, autoApply: autoApply, context: { notAvailableMessage: notAvailableMessage, position: triggerPosition } });\r\n    };\r\n    QuickFixController.prototype._trigger = function (trigger) {\r\n        return this._model.trigger(trigger);\r\n    };\r\n    QuickFixController.prototype._applyCodeAction = function (action) {\r\n        return this._instantiationService.invokeFunction(applyCodeAction, action, this._bulkEditService, this._commandService, this._editor);\r\n    };\r\n    QuickFixController.ID = 'editor.contrib.quickFixController';\r\n    QuickFixController = __decorate([\r\n        __param(1, IMarkerService),\r\n        __param(2, IContextKeyService),\r\n        __param(3, IEditorProgressService),\r\n        __param(4, IContextMenuService),\r\n        __param(5, IKeybindingService),\r\n        __param(6, ICommandService),\r\n        __param(7, IBulkEditService),\r\n        __param(8, IInstantiationService)\r\n    ], QuickFixController);\r\n    return QuickFixController;\r\n}(Disposable));\r\nexport { QuickFixController };\r\nexport function applyCodeAction(accessor, action, bulkEditService, commandService, editor) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var notificationService, err_1, message;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    notificationService = accessor.get(INotificationService);\r\n                    if (!action.edit) return [3 /*break*/, 2];\r\n                    return [4 /*yield*/, bulkEditService.apply(action.edit, { editor: editor })];\r\n                case 1:\r\n                    _a.sent();\r\n                    _a.label = 2;\r\n                case 2:\r\n                    if (!action.command) return [3 /*break*/, 6];\r\n                    _a.label = 3;\r\n                case 3:\r\n                    _a.trys.push([3, 5, , 6]);\r\n                    return [4 /*yield*/, commandService.executeCommand.apply(commandService, __spreadArrays([action.command.id], (action.command.arguments || [])))];\r\n                case 4:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 6];\r\n                case 5:\r\n                    err_1 = _a.sent();\r\n                    message = asMessage(err_1);\r\n                    notificationService.error(typeof message === 'string'\r\n                        ? message\r\n                        : nls.localize('applyCodeActionFailed', \"An unknown error occurred while applying the code action\"));\r\n                    return [3 /*break*/, 6];\r\n                case 6: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction asMessage(err) {\r\n    if (typeof err === 'string') {\r\n        return err;\r\n    }\r\n    else if (err instanceof Error && typeof err.message === 'string') {\r\n        return err.message;\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\nfunction triggerCodeActionsForEditorSelection(editor, notAvailableMessage, filter, autoApply) {\r\n    if (editor.hasModel()) {\r\n        var controller = QuickFixController.get(editor);\r\n        if (controller) {\r\n            controller.manualTriggerAtCurrentPosition(notAvailableMessage, filter, autoApply);\r\n        }\r\n    }\r\n}\r\nvar QuickFixAction = /** @class */ (function (_super) {\r\n    __extends(QuickFixAction, _super);\r\n    function QuickFixAction() {\r\n        return _super.call(this, {\r\n            id: QuickFixAction.Id,\r\n            label: nls.localize('quickfix.trigger.label', \"Quick Fix...\"),\r\n            alias: 'Quick Fix...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 84 /* US_DOT */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    QuickFixAction.prototype.run = function (_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.quickFix.noneMessage', \"No code actions available\"), undefined, undefined);\r\n    };\r\n    QuickFixAction.Id = 'editor.action.quickFix';\r\n    return QuickFixAction;\r\n}(EditorAction));\r\nexport { QuickFixAction };\r\nvar CodeActionCommand = /** @class */ (function (_super) {\r\n    __extends(CodeActionCommand, _super);\r\n    function CodeActionCommand() {\r\n        return _super.call(this, {\r\n            id: codeActionCommandId,\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            description: {\r\n                description: 'Trigger a code action',\r\n                args: [{ name: 'args', schema: argsSchema, }]\r\n            }\r\n        }) || this;\r\n    }\r\n    CodeActionCommand.prototype.runEditorCommand = function (_accessor, editor, userArgs) {\r\n        var _a;\r\n        var args = CodeActionCommandArgs.fromUser(userArgs, {\r\n            kind: CodeActionKind.Empty,\r\n            apply: \"ifSingle\" /* IfSingle */,\r\n        });\r\n        return triggerCodeActionsForEditorSelection(editor, typeof ((_a = userArgs) === null || _a === void 0 ? void 0 : _a.kind) === 'string'\r\n            ? args.preferred\r\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred.kind', \"No preferred code actions for '{0}' available\", userArgs.kind)\r\n                : nls.localize('editor.action.codeAction.noneMessage.kind', \"No code actions for '{0}' available\", userArgs.kind)\r\n            : args.preferred\r\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred', \"No preferred code actions available\")\r\n                : nls.localize('editor.action.codeAction.noneMessage', \"No code actions available\"), {\r\n            include: args.kind,\r\n            includeSourceActions: true,\r\n            onlyIncludePreferredActions: args.preferred,\r\n        }, args.apply);\r\n    };\r\n    return CodeActionCommand;\r\n}(EditorCommand));\r\nexport { CodeActionCommand };\r\nvar RefactorAction = /** @class */ (function (_super) {\r\n    __extends(RefactorAction, _super);\r\n    function RefactorAction() {\r\n        return _super.call(this, {\r\n            id: refactorCommandId,\r\n            label: nls.localize('refactor.label', \"Refactor...\"),\r\n            alias: 'Refactor...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 48 /* KEY_R */,\r\n                mac: {\r\n                    primary: 256 /* WinCtrl */ | 1024 /* Shift */ | 48 /* KEY_R */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 2,\r\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Refactor)),\r\n            },\r\n            description: {\r\n                description: 'Refactor...',\r\n                args: [{ name: 'args', schema: argsSchema }]\r\n            }\r\n        }) || this;\r\n    }\r\n    RefactorAction.prototype.run = function (_accessor, editor, userArgs) {\r\n        var _a;\r\n        var args = CodeActionCommandArgs.fromUser(userArgs, {\r\n            kind: CodeActionKind.Refactor,\r\n            apply: \"never\" /* Never */\r\n        });\r\n        return triggerCodeActionsForEditorSelection(editor, typeof ((_a = userArgs) === null || _a === void 0 ? void 0 : _a.kind) === 'string'\r\n            ? args.preferred\r\n                ? nls.localize('editor.action.refactor.noneMessage.preferred.kind', \"No preferred refactorings for '{0}' available\", userArgs.kind)\r\n                : nls.localize('editor.action.refactor.noneMessage.kind', \"No refactorings for '{0}' available\", userArgs.kind)\r\n            : args.preferred\r\n                ? nls.localize('editor.action.refactor.noneMessage.preferred', \"No preferred refactorings available\")\r\n                : nls.localize('editor.action.refactor.noneMessage', \"No refactorings available\"), {\r\n            include: CodeActionKind.Refactor.contains(args.kind) ? args.kind : CodeActionKind.None,\r\n            onlyIncludePreferredActions: args.preferred,\r\n        }, args.apply);\r\n    };\r\n    return RefactorAction;\r\n}(EditorAction));\r\nexport { RefactorAction };\r\nvar SourceAction = /** @class */ (function (_super) {\r\n    __extends(SourceAction, _super);\r\n    function SourceAction() {\r\n        return _super.call(this, {\r\n            id: sourceActionCommandId,\r\n            label: nls.localize('source.label', \"Source Action...\"),\r\n            alias: 'Source Action...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 2.1,\r\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Source)),\r\n            },\r\n            description: {\r\n                description: 'Source Action...',\r\n                args: [{ name: 'args', schema: argsSchema }]\r\n            }\r\n        }) || this;\r\n    }\r\n    SourceAction.prototype.run = function (_accessor, editor, userArgs) {\r\n        var _a;\r\n        var args = CodeActionCommandArgs.fromUser(userArgs, {\r\n            kind: CodeActionKind.Source,\r\n            apply: \"never\" /* Never */\r\n        });\r\n        return triggerCodeActionsForEditorSelection(editor, typeof ((_a = userArgs) === null || _a === void 0 ? void 0 : _a.kind) === 'string'\r\n            ? args.preferred\r\n                ? nls.localize('editor.action.source.noneMessage.preferred.kind', \"No preferred source actions for '{0}' available\", userArgs.kind)\r\n                : nls.localize('editor.action.source.noneMessage.kind', \"No source actions for '{0}' available\", userArgs.kind)\r\n            : args.preferred\r\n                ? nls.localize('editor.action.source.noneMessage.preferred', \"No preferred source actions available\")\r\n                : nls.localize('editor.action.source.noneMessage', \"No source actions available\"), {\r\n            include: CodeActionKind.Source.contains(args.kind) ? args.kind : CodeActionKind.None,\r\n            includeSourceActions: true,\r\n            onlyIncludePreferredActions: args.preferred,\r\n        }, args.apply);\r\n    };\r\n    return SourceAction;\r\n}(EditorAction));\r\nexport { SourceAction };\r\nvar OrganizeImportsAction = /** @class */ (function (_super) {\r\n    __extends(OrganizeImportsAction, _super);\r\n    function OrganizeImportsAction() {\r\n        return _super.call(this, {\r\n            id: organizeImportsCommandId,\r\n            label: nls.localize('organizeImports.label', \"Organize Imports\"),\r\n            alias: 'Organize Imports',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceOrganizeImports)),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 45 /* KEY_O */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n        }) || this;\r\n    }\r\n    OrganizeImportsAction.prototype.run = function (_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.organize.noneMessage', \"No organize imports action available\"), { include: CodeActionKind.SourceOrganizeImports, includeSourceActions: true }, \"ifSingle\" /* IfSingle */);\r\n    };\r\n    return OrganizeImportsAction;\r\n}(EditorAction));\r\nexport { OrganizeImportsAction };\r\nvar FixAllAction = /** @class */ (function (_super) {\r\n    __extends(FixAllAction, _super);\r\n    function FixAllAction() {\r\n        return _super.call(this, {\r\n            id: fixAllCommandId,\r\n            label: nls.localize('fixAll.label', \"Fix All\"),\r\n            alias: 'Fix All',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceFixAll))\r\n        }) || this;\r\n    }\r\n    FixAllAction.prototype.run = function (_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('fixAll.noneMessage', \"No fix all action available\"), { include: CodeActionKind.SourceFixAll, includeSourceActions: true }, \"ifSingle\" /* IfSingle */);\r\n    };\r\n    return FixAllAction;\r\n}(EditorAction));\r\nexport { FixAllAction };\r\nvar AutoFixAction = /** @class */ (function (_super) {\r\n    __extends(AutoFixAction, _super);\r\n    function AutoFixAction() {\r\n        return _super.call(this, {\r\n            id: AutoFixAction.Id,\r\n            label: nls.localize('autoFix.label', \"Auto Fix...\"),\r\n            alias: 'Auto Fix...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.QuickFix)),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 84 /* US_DOT */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 84 /* US_DOT */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    AutoFixAction.prototype.run = function (_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.autoFix.noneMessage', \"No auto fixes available\"), {\r\n            include: CodeActionKind.QuickFix,\r\n            onlyIncludePreferredActions: true\r\n        }, \"ifSingle\" /* IfSingle */);\r\n    };\r\n    AutoFixAction.Id = 'editor.action.autoFix';\r\n    return AutoFixAction;\r\n}(EditorAction));\r\nexport { AutoFixAction };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { CodeActionCommand, OrganizeImportsAction, QuickFixAction, QuickFixController, RefactorAction, SourceAction, AutoFixAction, FixAllAction } from './codeActionCommands.js';\r\nregisterEditorContribution(QuickFixController.ID, QuickFixController);\r\nregisterEditorAction(QuickFixAction);\r\nregisterEditorAction(RefactorAction);\r\nregisterEditorAction(SourceAction);\r\nregisterEditorAction(OrganizeImportsAction);\r\nregisterEditorAction(AutoFixAction);\r\nregisterEditorAction(FixAllAction);\r\nregisterEditorCommand(new CodeActionCommand());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { mergeSort } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { registerLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { CodeLensProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nvar CodeLensModel = /** @class */ (function () {\r\n    function CodeLensModel() {\r\n        this.lenses = [];\r\n        this._disposables = new DisposableStore();\r\n    }\r\n    CodeLensModel.prototype.dispose = function () {\r\n        this._disposables.dispose();\r\n    };\r\n    CodeLensModel.prototype.add = function (list, provider) {\r\n        this._disposables.add(list);\r\n        for (var _i = 0, _a = list.lenses; _i < _a.length; _i++) {\r\n            var symbol = _a[_i];\r\n            this.lenses.push({ symbol: symbol, provider: provider });\r\n        }\r\n    };\r\n    return CodeLensModel;\r\n}());\r\nexport { CodeLensModel };\r\nexport function getCodeLensData(model, token) {\r\n    var provider = CodeLensProviderRegistry.ordered(model);\r\n    var providerRanks = new Map();\r\n    var result = new CodeLensModel();\r\n    var promises = provider.map(function (provider, i) {\r\n        providerRanks.set(provider, i);\r\n        return Promise.resolve(provider.provideCodeLenses(model, token))\r\n            .then(function (list) { return list && result.add(list, provider); })\r\n            .catch(onUnexpectedExternalError);\r\n    });\r\n    return Promise.all(promises).then(function () {\r\n        result.lenses = mergeSort(result.lenses, function (a, b) {\r\n            // sort by lineNumber, provider-rank, and column\r\n            if (a.symbol.range.startLineNumber < b.symbol.range.startLineNumber) {\r\n                return -1;\r\n            }\r\n            else if (a.symbol.range.startLineNumber > b.symbol.range.startLineNumber) {\r\n                return 1;\r\n            }\r\n            else if (providerRanks.get(a.provider) < providerRanks.get(b.provider)) {\r\n                return -1;\r\n            }\r\n            else if (providerRanks.get(a.provider) > providerRanks.get(b.provider)) {\r\n                return 1;\r\n            }\r\n            else if (a.symbol.range.startColumn < b.symbol.range.startColumn) {\r\n                return -1;\r\n            }\r\n            else if (a.symbol.range.startColumn > b.symbol.range.startColumn) {\r\n                return 1;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        });\r\n        return result;\r\n    });\r\n}\r\nregisterLanguageCommand('_executeCodeLensProvider', function (accessor, args) {\r\n    var resource = args.resource, itemResolveCount = args.itemResolveCount;\r\n    if (!(resource instanceof URI)) {\r\n        throw illegalArgument();\r\n    }\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument();\r\n    }\r\n    var result = [];\r\n    var disposables = new DisposableStore();\r\n    return getCodeLensData(model, CancellationToken.None).then(function (value) {\r\n        disposables.add(value);\r\n        var resolve = [];\r\n        var _loop_1 = function (item) {\r\n            if (typeof itemResolveCount === 'undefined' || Boolean(item.symbol.command)) {\r\n                result.push(item.symbol);\r\n            }\r\n            else if (itemResolveCount-- > 0 && item.provider.resolveCodeLens) {\r\n                resolve.push(Promise.resolve(item.provider.resolveCodeLens(model, item.symbol, CancellationToken.None)).then(function (symbol) { return result.push(symbol || item.symbol); }));\r\n            }\r\n        };\r\n        for (var _i = 0, _a = value.lenses; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            _loop_1(item);\r\n        }\r\n        return Promise.all(resolve);\r\n    }).then(function () {\r\n        return result;\r\n    }).finally(function () {\r\n        // make sure to return results, then (on next tick)\r\n        // dispose the results\r\n        setTimeout(function () { return disposables.dispose(); }, 100);\r\n    });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './codicon/codicon.css';\r\nimport './codicon/codicon-animations.css';\r\nimport { escape } from '../../../common/strings.js';\r\nfunction expand(text) {\r\n    return text.replace(/\\$\\((([a-z0-9\\-]+?)(~([a-z0-9\\-]*?))?)\\)/gi, function (_match, _g1, name, _g3, animation) {\r\n        return \"<span class=\\\"codicon codicon-\" + name + \" \" + (animation ? \"codicon-animation-\" + animation : '') + \"\\\"></span>\";\r\n    });\r\n}\r\nexport function renderCodicons(label) {\r\n    return expand(escape(label));\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './codelensWidget.css';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { renderCodicons } from '../../../base/browser/ui/codiconLabel/codiconLabel.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { editorCodeLensForeground } from '../../common/view/editorColorRegistry.js';\r\nimport { editorActiveLinkForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nvar CodeLensViewZone = /** @class */ (function () {\r\n    function CodeLensViewZone(afterLineNumber, onHeight) {\r\n        this.afterLineNumber = afterLineNumber;\r\n        this._onHeight = onHeight;\r\n        this.heightInLines = 1;\r\n        this.suppressMouseDown = true;\r\n        this.domNode = document.createElement('div');\r\n    }\r\n    CodeLensViewZone.prototype.onComputedHeight = function (height) {\r\n        if (this._lastHeight === undefined) {\r\n            this._lastHeight = height;\r\n        }\r\n        else if (this._lastHeight !== height) {\r\n            this._lastHeight = height;\r\n            this._onHeight();\r\n        }\r\n    };\r\n    return CodeLensViewZone;\r\n}());\r\nvar CodeLensContentWidget = /** @class */ (function () {\r\n    function CodeLensContentWidget(editor, className, line) {\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = false;\r\n        this.suppressMouseDown = true;\r\n        this._commands = new Map();\r\n        this._isEmpty = true;\r\n        this._editor = editor;\r\n        this._id = \"codelens.widget-\" + (CodeLensContentWidget._idPool++);\r\n        this.updatePosition(line);\r\n        this._domNode = document.createElement('span');\r\n        this._domNode.className = \"codelens-decoration \" + className;\r\n    }\r\n    CodeLensContentWidget.prototype.withCommands = function (lenses, animate) {\r\n        this._commands.clear();\r\n        var innerHtml = '';\r\n        var hasSymbol = false;\r\n        for (var i = 0; i < lenses.length; i++) {\r\n            var lens = lenses[i];\r\n            if (!lens) {\r\n                continue;\r\n            }\r\n            hasSymbol = true;\r\n            if (lens.command) {\r\n                var title = renderCodicons(lens.command.title);\r\n                if (lens.command.id) {\r\n                    innerHtml += \"<a id=\" + i + \">\" + title + \"</a>\";\r\n                    this._commands.set(String(i), lens.command);\r\n                }\r\n                else {\r\n                    innerHtml += \"<span>\" + title + \"</span>\";\r\n                }\r\n                if (i + 1 < lenses.length) {\r\n                    innerHtml += '<span>&#160;|&#160;</span>';\r\n                }\r\n            }\r\n        }\r\n        if (!hasSymbol) {\r\n            // symbols but no commands\r\n            this._domNode.innerHTML = '<span>no commands</span>';\r\n        }\r\n        else {\r\n            // symbols and commands\r\n            if (!innerHtml) {\r\n                innerHtml = '&#160;';\r\n            }\r\n            this._domNode.innerHTML = innerHtml;\r\n            if (this._isEmpty && animate) {\r\n                dom.addClass(this._domNode, 'fadein');\r\n            }\r\n            this._isEmpty = false;\r\n        }\r\n    };\r\n    CodeLensContentWidget.prototype.getCommand = function (link) {\r\n        return link.parentElement === this._domNode\r\n            ? this._commands.get(link.id)\r\n            : undefined;\r\n    };\r\n    CodeLensContentWidget.prototype.getId = function () {\r\n        return this._id;\r\n    };\r\n    CodeLensContentWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    CodeLensContentWidget.prototype.updatePosition = function (line) {\r\n        var column = this._editor.getModel().getLineFirstNonWhitespaceColumn(line);\r\n        this._widgetPosition = {\r\n            position: { lineNumber: line, column: column },\r\n            preference: [1 /* ABOVE */]\r\n        };\r\n    };\r\n    CodeLensContentWidget.prototype.getPosition = function () {\r\n        return this._widgetPosition || null;\r\n    };\r\n    CodeLensContentWidget._idPool = 0;\r\n    return CodeLensContentWidget;\r\n}());\r\nvar CodeLensHelper = /** @class */ (function () {\r\n    function CodeLensHelper() {\r\n        this._removeDecorations = [];\r\n        this._addDecorations = [];\r\n        this._addDecorationsCallbacks = [];\r\n    }\r\n    CodeLensHelper.prototype.addDecoration = function (decoration, callback) {\r\n        this._addDecorations.push(decoration);\r\n        this._addDecorationsCallbacks.push(callback);\r\n    };\r\n    CodeLensHelper.prototype.removeDecoration = function (decorationId) {\r\n        this._removeDecorations.push(decorationId);\r\n    };\r\n    CodeLensHelper.prototype.commit = function (changeAccessor) {\r\n        var resultingDecorations = changeAccessor.deltaDecorations(this._removeDecorations, this._addDecorations);\r\n        for (var i = 0, len = resultingDecorations.length; i < len; i++) {\r\n            this._addDecorationsCallbacks[i](resultingDecorations[i]);\r\n        }\r\n    };\r\n    return CodeLensHelper;\r\n}());\r\nexport { CodeLensHelper };\r\nvar CodeLensWidget = /** @class */ (function () {\r\n    function CodeLensWidget(data, editor, className, helper, viewZoneChangeAccessor, updateCallback) {\r\n        var _this = this;\r\n        this._isDisposed = false;\r\n        this._editor = editor;\r\n        this._className = className;\r\n        this._data = data;\r\n        // create combined range, track all ranges with decorations,\r\n        // check if there is already something to render\r\n        this._decorationIds = [];\r\n        var range;\r\n        var lenses = [];\r\n        this._data.forEach(function (codeLensData, i) {\r\n            if (codeLensData.symbol.command) {\r\n                lenses.push(codeLensData.symbol);\r\n            }\r\n            helper.addDecoration({\r\n                range: codeLensData.symbol.range,\r\n                options: ModelDecorationOptions.EMPTY\r\n            }, function (id) { return _this._decorationIds[i] = id; });\r\n            // the range contains all lenses on this line\r\n            if (!range) {\r\n                range = Range.lift(codeLensData.symbol.range);\r\n            }\r\n            else {\r\n                range = Range.plusRange(range, codeLensData.symbol.range);\r\n            }\r\n        });\r\n        this._viewZone = new CodeLensViewZone(range.startLineNumber - 1, updateCallback);\r\n        this._viewZoneId = viewZoneChangeAccessor.addZone(this._viewZone);\r\n        if (lenses.length > 0) {\r\n            this._createContentWidgetIfNecessary();\r\n            this._contentWidget.withCommands(lenses, false);\r\n        }\r\n    }\r\n    CodeLensWidget.prototype._createContentWidgetIfNecessary = function () {\r\n        if (!this._contentWidget) {\r\n            this._contentWidget = new CodeLensContentWidget(this._editor, this._className, this._viewZone.afterLineNumber + 1);\r\n            this._editor.addContentWidget(this._contentWidget);\r\n        }\r\n    };\r\n    CodeLensWidget.prototype.dispose = function (helper, viewZoneChangeAccessor) {\r\n        this._decorationIds.forEach(helper.removeDecoration, helper);\r\n        this._decorationIds = [];\r\n        if (viewZoneChangeAccessor) {\r\n            viewZoneChangeAccessor.removeZone(this._viewZoneId);\r\n        }\r\n        if (this._contentWidget) {\r\n            this._editor.removeContentWidget(this._contentWidget);\r\n            this._contentWidget = undefined;\r\n        }\r\n        this._isDisposed = true;\r\n    };\r\n    CodeLensWidget.prototype.isDisposed = function () {\r\n        return this._isDisposed;\r\n    };\r\n    CodeLensWidget.prototype.isValid = function () {\r\n        var _this = this;\r\n        return this._decorationIds.some(function (id, i) {\r\n            var range = _this._editor.getModel().getDecorationRange(id);\r\n            var symbol = _this._data[i].symbol;\r\n            return !!(range && Range.isEmpty(symbol.range) === range.isEmpty());\r\n        });\r\n    };\r\n    CodeLensWidget.prototype.updateCodeLensSymbols = function (data, helper) {\r\n        var _this = this;\r\n        this._decorationIds.forEach(helper.removeDecoration, helper);\r\n        this._decorationIds = [];\r\n        this._data = data;\r\n        this._data.forEach(function (codeLensData, i) {\r\n            helper.addDecoration({\r\n                range: codeLensData.symbol.range,\r\n                options: ModelDecorationOptions.EMPTY\r\n            }, function (id) { return _this._decorationIds[i] = id; });\r\n        });\r\n    };\r\n    CodeLensWidget.prototype.computeIfNecessary = function (model) {\r\n        if (!this._viewZone.domNode.hasAttribute('monaco-visible-view-zone')) {\r\n            return null;\r\n        }\r\n        // Read editor current state\r\n        for (var i = 0; i < this._decorationIds.length; i++) {\r\n            var range = model.getDecorationRange(this._decorationIds[i]);\r\n            if (range) {\r\n                this._data[i].symbol.range = range;\r\n            }\r\n        }\r\n        return this._data;\r\n    };\r\n    CodeLensWidget.prototype.updateCommands = function (symbols) {\r\n        this._createContentWidgetIfNecessary();\r\n        this._contentWidget.withCommands(symbols, true);\r\n        for (var i = 0; i < this._data.length; i++) {\r\n            var resolved = symbols[i];\r\n            if (resolved) {\r\n                var symbol = this._data[i].symbol;\r\n                symbol.command = resolved.command || symbol.command;\r\n            }\r\n        }\r\n    };\r\n    CodeLensWidget.prototype.getCommand = function (link) {\r\n        var _a;\r\n        return (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.getCommand(link);\r\n    };\r\n    CodeLensWidget.prototype.getLineNumber = function () {\r\n        var range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\r\n        if (range) {\r\n            return range.startLineNumber;\r\n        }\r\n        return -1;\r\n    };\r\n    CodeLensWidget.prototype.update = function (viewZoneChangeAccessor) {\r\n        if (this.isValid()) {\r\n            var range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\r\n            if (range) {\r\n                this._viewZone.afterLineNumber = range.startLineNumber - 1;\r\n                viewZoneChangeAccessor.layoutZone(this._viewZoneId);\r\n                if (this._contentWidget) {\r\n                    this._contentWidget.updatePosition(range.startLineNumber);\r\n                    this._editor.layoutContentWidget(this._contentWidget);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return CodeLensWidget;\r\n}());\r\nexport { CodeLensWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var codeLensForeground = theme.getColor(editorCodeLensForeground);\r\n    if (codeLensForeground) {\r\n        collector.addRule(\".monaco-editor .codelens-decoration { color: \" + codeLensForeground + \"; }\");\r\n    }\r\n    var activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(\".monaco-editor .codelens-decoration > a:hover { color: \" + activeLinkForeground + \" !important; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { CodeLensModel } from './codelens.js';\r\nimport { LRUCache, values } from '../../../base/common/map.js';\r\nimport { IStorageService, WillSaveStateReason } from '../../../platform/storage/common/storage.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { runWhenIdle } from '../../../base/common/async.js';\r\nimport { once } from '../../../base/common/functional.js';\r\nexport var ICodeLensCache = createDecorator('ICodeLensCache');\r\nvar CacheItem = /** @class */ (function () {\r\n    function CacheItem(lineCount, data) {\r\n        this.lineCount = lineCount;\r\n        this.data = data;\r\n    }\r\n    return CacheItem;\r\n}());\r\nvar CodeLensCache = /** @class */ (function () {\r\n    function CodeLensCache(storageService) {\r\n        var _this = this;\r\n        this._fakeProvider = new /** @class */ (function () {\r\n            function class_1() {\r\n            }\r\n            class_1.prototype.provideCodeLenses = function () {\r\n                throw new Error('not supported');\r\n            };\r\n            return class_1;\r\n        }());\r\n        this._cache = new LRUCache(20, 0.75);\r\n        // remove old data\r\n        var oldkey = 'codelens/cache';\r\n        runWhenIdle(function () { return storageService.remove(oldkey, 1 /* WORKSPACE */); });\r\n        // restore lens data on start\r\n        var key = 'codelens/cache2';\r\n        var raw = storageService.get(key, 1 /* WORKSPACE */, '{}');\r\n        this._deserialize(raw);\r\n        // store lens data on shutdown\r\n        once(storageService.onWillSaveState)(function (e) {\r\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\r\n                storageService.store(key, _this._serialize(), 1 /* WORKSPACE */);\r\n            }\r\n        });\r\n    }\r\n    CodeLensCache.prototype.put = function (model, data) {\r\n        // create a copy of the model that is without command-ids\r\n        // but with comand-labels\r\n        var copyItems = data.lenses.map(function (item) {\r\n            var _a;\r\n            return {\r\n                range: item.symbol.range,\r\n                command: item.symbol.command && { id: '', title: (_a = item.symbol.command) === null || _a === void 0 ? void 0 : _a.title },\r\n            };\r\n        });\r\n        var copyModel = new CodeLensModel();\r\n        copyModel.add({ lenses: copyItems, dispose: function () { } }, this._fakeProvider);\r\n        var item = new CacheItem(model.getLineCount(), copyModel);\r\n        this._cache.set(model.uri.toString(), item);\r\n    };\r\n    CodeLensCache.prototype.get = function (model) {\r\n        var item = this._cache.get(model.uri.toString());\r\n        return item && item.lineCount === model.getLineCount() ? item.data : undefined;\r\n    };\r\n    CodeLensCache.prototype.delete = function (model) {\r\n        this._cache.delete(model.uri.toString());\r\n    };\r\n    // --- persistence\r\n    CodeLensCache.prototype._serialize = function () {\r\n        var data = Object.create(null);\r\n        this._cache.forEach(function (value, key) {\r\n            var lines = new Set();\r\n            for (var _i = 0, _a = value.data.lenses; _i < _a.length; _i++) {\r\n                var d = _a[_i];\r\n                lines.add(d.symbol.range.startLineNumber);\r\n            }\r\n            data[key] = {\r\n                lineCount: value.lineCount,\r\n                lines: values(lines)\r\n            };\r\n        });\r\n        return JSON.stringify(data);\r\n    };\r\n    CodeLensCache.prototype._deserialize = function (raw) {\r\n        try {\r\n            var data = JSON.parse(raw);\r\n            for (var key in data) {\r\n                var element = data[key];\r\n                var lenses = [];\r\n                for (var _i = 0, _a = element.lines; _i < _a.length; _i++) {\r\n                    var line = _a[_i];\r\n                    lenses.push({ range: new Range(line, 1, line, 11) });\r\n                }\r\n                var model = new CodeLensModel();\r\n                model.add({ lenses: lenses, dispose: function () { } }, this._fakeProvider);\r\n                this._cache.set(key, new CacheItem(element.lineCount, model));\r\n            }\r\n        }\r\n        catch (_b) {\r\n            // ignore...\r\n        }\r\n    };\r\n    CodeLensCache = __decorate([\r\n        __param(0, IStorageService)\r\n    ], CodeLensCache);\r\n    return CodeLensCache;\r\n}());\r\nexport { CodeLensCache };\r\nregisterSingleton(ICodeLensCache, CodeLensCache);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { RunOnceScheduler, createCancelablePromise, disposableTimeout } from '../../../base/common/async.js';\r\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { toDisposable, DisposableStore, dispose } from '../../../base/common/lifecycle.js';\r\nimport { StableEditorScrollState } from '../../browser/core/editorState.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { CodeLensProviderRegistry } from '../../common/modes.js';\r\nimport { getCodeLensData } from './codelens.js';\r\nimport { CodeLensWidget, CodeLensHelper } from './codelensWidget.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { ICodeLensCache } from './codeLensCache.js';\r\nimport { createStyleSheet } from '../../../base/browser/dom.js';\r\nimport { hash } from '../../../base/common/hash.js';\r\nvar CodeLensContribution = /** @class */ (function () {\r\n    function CodeLensContribution(_editor, _commandService, _notificationService, _codeLensCache) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._commandService = _commandService;\r\n        this._notificationService = _notificationService;\r\n        this._codeLensCache = _codeLensCache;\r\n        this._globalToDispose = new DisposableStore();\r\n        this._localToDispose = new DisposableStore();\r\n        this._lenses = [];\r\n        this._oldCodeLensModels = new DisposableStore();\r\n        this._modelChangeCounter = 0;\r\n        this._isEnabled = this._editor.getOption(11 /* codeLens */);\r\n        this._globalToDispose.add(this._editor.onDidChangeModel(function () { return _this._onModelChange(); }));\r\n        this._globalToDispose.add(this._editor.onDidChangeModelLanguage(function () { return _this._onModelChange(); }));\r\n        this._globalToDispose.add(this._editor.onDidChangeConfiguration(function () {\r\n            var prevIsEnabled = _this._isEnabled;\r\n            _this._isEnabled = _this._editor.getOption(11 /* codeLens */);\r\n            if (prevIsEnabled !== _this._isEnabled) {\r\n                _this._onModelChange();\r\n            }\r\n        }));\r\n        this._globalToDispose.add(CodeLensProviderRegistry.onDidChange(this._onModelChange, this));\r\n        this._globalToDispose.add(this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(32 /* fontInfo */)) {\r\n                _this._updateLensStyle();\r\n            }\r\n        }));\r\n        this._onModelChange();\r\n        this._styleClassName = hash(this._editor.getId()).toString(16);\r\n        this._styleElement = createStyleSheet();\r\n        this._updateLensStyle();\r\n    }\r\n    CodeLensContribution.prototype.dispose = function () {\r\n        this._localDispose();\r\n        this._globalToDispose.dispose();\r\n        this._oldCodeLensModels.dispose();\r\n        dispose(this._currentCodeLensModel);\r\n    };\r\n    CodeLensContribution.prototype._updateLensStyle = function () {\r\n        var options = this._editor.getOptions();\r\n        var fontInfo = options.get(32 /* fontInfo */);\r\n        var lineHeight = options.get(47 /* lineHeight */);\r\n        var newStyle = \".monaco-editor .codelens-decoration.\" + this._styleClassName + \" { height: \" + Math.round(lineHeight * 1.1) + \"px; line-height: \" + lineHeight + \"px; font-size: \" + Math.round(fontInfo.fontSize * 0.9) + \"px; padding-right: \" + Math.round(fontInfo.fontSize * 0.45) + \"px;}\";\r\n        this._styleElement.innerHTML = newStyle;\r\n    };\r\n    CodeLensContribution.prototype._localDispose = function () {\r\n        if (this._currentFindCodeLensSymbolsPromise) {\r\n            this._currentFindCodeLensSymbolsPromise.cancel();\r\n            this._currentFindCodeLensSymbolsPromise = undefined;\r\n            this._modelChangeCounter++;\r\n        }\r\n        if (this._currentResolveCodeLensSymbolsPromise) {\r\n            this._currentResolveCodeLensSymbolsPromise.cancel();\r\n            this._currentResolveCodeLensSymbolsPromise = undefined;\r\n        }\r\n        this._localToDispose.clear();\r\n        this._oldCodeLensModels.clear();\r\n        dispose(this._currentCodeLensModel);\r\n    };\r\n    CodeLensContribution.prototype._onModelChange = function () {\r\n        var _this = this;\r\n        this._localDispose();\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        if (!this._isEnabled) {\r\n            return;\r\n        }\r\n        var cachedLenses = this._codeLensCache.get(model);\r\n        if (cachedLenses) {\r\n            this._renderCodeLensSymbols(cachedLenses);\r\n        }\r\n        if (!CodeLensProviderRegistry.has(model)) {\r\n            // no provider -> return but check with\r\n            // cached lenses. they expire after 30 seconds\r\n            if (cachedLenses) {\r\n                this._localToDispose.add(disposableTimeout(function () {\r\n                    var cachedLensesNow = _this._codeLensCache.get(model);\r\n                    if (cachedLenses === cachedLensesNow) {\r\n                        _this._codeLensCache.delete(model);\r\n                        _this._onModelChange();\r\n                    }\r\n                }, 30 * 1000));\r\n            }\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = CodeLensProviderRegistry.all(model); _i < _a.length; _i++) {\r\n            var provider = _a[_i];\r\n            if (typeof provider.onDidChange === 'function') {\r\n                var registration = provider.onDidChange(function () { return scheduler.schedule(); });\r\n                this._localToDispose.add(registration);\r\n            }\r\n        }\r\n        var detectVisibleLenses = this._detectVisibleLenses = new RunOnceScheduler(function () { return _this._onViewportChanged(); }, 250);\r\n        var scheduler = new RunOnceScheduler(function () {\r\n            var counterValue = ++_this._modelChangeCounter;\r\n            if (_this._currentFindCodeLensSymbolsPromise) {\r\n                _this._currentFindCodeLensSymbolsPromise.cancel();\r\n            }\r\n            _this._currentFindCodeLensSymbolsPromise = createCancelablePromise(function (token) { return getCodeLensData(model, token); });\r\n            _this._currentFindCodeLensSymbolsPromise.then(function (result) {\r\n                if (counterValue === _this._modelChangeCounter) { // only the last one wins\r\n                    if (_this._currentCodeLensModel) {\r\n                        _this._oldCodeLensModels.add(_this._currentCodeLensModel);\r\n                    }\r\n                    _this._currentCodeLensModel = result;\r\n                    // cache model to reduce flicker\r\n                    _this._codeLensCache.put(model, result);\r\n                    // render lenses\r\n                    _this._renderCodeLensSymbols(result);\r\n                    detectVisibleLenses.schedule();\r\n                }\r\n            }, onUnexpectedError);\r\n        }, 250);\r\n        this._localToDispose.add(scheduler);\r\n        this._localToDispose.add(detectVisibleLenses);\r\n        this._localToDispose.add(this._editor.onDidChangeModelContent(function () {\r\n            _this._editor.changeDecorations(function (decorationsAccessor) {\r\n                _this._editor.changeViewZones(function (viewZonesAccessor) {\r\n                    var toDispose = [];\r\n                    var lastLensLineNumber = -1;\r\n                    _this._lenses.forEach(function (lens) {\r\n                        if (!lens.isValid() || lastLensLineNumber === lens.getLineNumber()) {\r\n                            // invalid -> lens collapsed, attach range doesn't exist anymore\r\n                            // line_number -> lenses should never be on the same line\r\n                            toDispose.push(lens);\r\n                        }\r\n                        else {\r\n                            lens.update(viewZonesAccessor);\r\n                            lastLensLineNumber = lens.getLineNumber();\r\n                        }\r\n                    });\r\n                    var helper = new CodeLensHelper();\r\n                    toDispose.forEach(function (l) {\r\n                        l.dispose(helper, viewZonesAccessor);\r\n                        _this._lenses.splice(_this._lenses.indexOf(l), 1);\r\n                    });\r\n                    helper.commit(decorationsAccessor);\r\n                });\r\n            });\r\n            // Compute new `visible` code lenses\r\n            detectVisibleLenses.schedule();\r\n            // Ask for all references again\r\n            scheduler.schedule();\r\n        }));\r\n        this._localToDispose.add(this._editor.onDidScrollChange(function (e) {\r\n            if (e.scrollTopChanged && _this._lenses.length > 0) {\r\n                detectVisibleLenses.schedule();\r\n            }\r\n        }));\r\n        this._localToDispose.add(this._editor.onDidLayoutChange(function () {\r\n            detectVisibleLenses.schedule();\r\n        }));\r\n        this._localToDispose.add(toDisposable(function () {\r\n            if (_this._editor.getModel()) {\r\n                var scrollState = StableEditorScrollState.capture(_this._editor);\r\n                _this._editor.changeDecorations(function (decorationsAccessor) {\r\n                    _this._editor.changeViewZones(function (viewZonesAccessor) {\r\n                        _this._disposeAllLenses(decorationsAccessor, viewZonesAccessor);\r\n                    });\r\n                });\r\n                scrollState.restore(_this._editor);\r\n            }\r\n            else {\r\n                // No accessors available\r\n                _this._disposeAllLenses(undefined, undefined);\r\n            }\r\n        }));\r\n        this._localToDispose.add(this._editor.onMouseUp(function (e) {\r\n            var _a;\r\n            var _b, _c;\r\n            if (e.target.type !== 9 /* CONTENT_WIDGET */) {\r\n                return;\r\n            }\r\n            var target = e.target.element;\r\n            if (((_b = target) === null || _b === void 0 ? void 0 : _b.tagName) === 'SPAN') {\r\n                target = target.parentElement;\r\n            }\r\n            if (((_c = target) === null || _c === void 0 ? void 0 : _c.tagName) === 'A') {\r\n                for (var _i = 0, _d = _this._lenses; _i < _d.length; _i++) {\r\n                    var lens = _d[_i];\r\n                    var command = lens.getCommand(target);\r\n                    if (command) {\r\n                        (_a = _this._commandService).executeCommand.apply(_a, __spreadArrays([command.id], (command.arguments || []))).catch(function (err) { return _this._notificationService.error(err); });\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }));\r\n        scheduler.schedule();\r\n    };\r\n    CodeLensContribution.prototype._disposeAllLenses = function (decChangeAccessor, viewZoneChangeAccessor) {\r\n        var helper = new CodeLensHelper();\r\n        for (var _i = 0, _a = this._lenses; _i < _a.length; _i++) {\r\n            var lens = _a[_i];\r\n            lens.dispose(helper, viewZoneChangeAccessor);\r\n        }\r\n        if (decChangeAccessor) {\r\n            helper.commit(decChangeAccessor);\r\n        }\r\n        this._lenses = [];\r\n    };\r\n    CodeLensContribution.prototype._renderCodeLensSymbols = function (symbols) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var maxLineNumber = this._editor.getModel().getLineCount();\r\n        var groups = [];\r\n        var lastGroup;\r\n        for (var _i = 0, _a = symbols.lenses; _i < _a.length; _i++) {\r\n            var symbol = _a[_i];\r\n            var line = symbol.symbol.range.startLineNumber;\r\n            if (line < 1 || line > maxLineNumber) {\r\n                // invalid code lens\r\n                continue;\r\n            }\r\n            else if (lastGroup && lastGroup[lastGroup.length - 1].symbol.range.startLineNumber === line) {\r\n                // on same line as previous\r\n                lastGroup.push(symbol);\r\n            }\r\n            else {\r\n                // on later line as previous\r\n                lastGroup = [symbol];\r\n                groups.push(lastGroup);\r\n            }\r\n        }\r\n        var scrollState = StableEditorScrollState.capture(this._editor);\r\n        this._editor.changeDecorations(function (decorationsAccessor) {\r\n            _this._editor.changeViewZones(function (viewZoneAccessor) {\r\n                var helper = new CodeLensHelper();\r\n                var codeLensIndex = 0;\r\n                var groupsIndex = 0;\r\n                while (groupsIndex < groups.length && codeLensIndex < _this._lenses.length) {\r\n                    var symbolsLineNumber = groups[groupsIndex][0].symbol.range.startLineNumber;\r\n                    var codeLensLineNumber = _this._lenses[codeLensIndex].getLineNumber();\r\n                    if (codeLensLineNumber < symbolsLineNumber) {\r\n                        _this._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\r\n                        _this._lenses.splice(codeLensIndex, 1);\r\n                    }\r\n                    else if (codeLensLineNumber === symbolsLineNumber) {\r\n                        _this._lenses[codeLensIndex].updateCodeLensSymbols(groups[groupsIndex], helper);\r\n                        groupsIndex++;\r\n                        codeLensIndex++;\r\n                    }\r\n                    else {\r\n                        _this._lenses.splice(codeLensIndex, 0, new CodeLensWidget(groups[groupsIndex], _this._editor, _this._styleClassName, helper, viewZoneAccessor, function () { return _this._detectVisibleLenses && _this._detectVisibleLenses.schedule(); }));\r\n                        codeLensIndex++;\r\n                        groupsIndex++;\r\n                    }\r\n                }\r\n                // Delete extra code lenses\r\n                while (codeLensIndex < _this._lenses.length) {\r\n                    _this._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\r\n                    _this._lenses.splice(codeLensIndex, 1);\r\n                }\r\n                // Create extra symbols\r\n                while (groupsIndex < groups.length) {\r\n                    _this._lenses.push(new CodeLensWidget(groups[groupsIndex], _this._editor, _this._styleClassName, helper, viewZoneAccessor, function () { return _this._detectVisibleLenses && _this._detectVisibleLenses.schedule(); }));\r\n                    groupsIndex++;\r\n                }\r\n                helper.commit(decorationsAccessor);\r\n            });\r\n        });\r\n        scrollState.restore(this._editor);\r\n    };\r\n    CodeLensContribution.prototype._onViewportChanged = function () {\r\n        var _this = this;\r\n        if (this._currentResolveCodeLensSymbolsPromise) {\r\n            this._currentResolveCodeLensSymbolsPromise.cancel();\r\n            this._currentResolveCodeLensSymbolsPromise = undefined;\r\n        }\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        var toResolve = [];\r\n        var lenses = [];\r\n        this._lenses.forEach(function (lens) {\r\n            var request = lens.computeIfNecessary(model);\r\n            if (request) {\r\n                toResolve.push(request);\r\n                lenses.push(lens);\r\n            }\r\n        });\r\n        if (toResolve.length === 0) {\r\n            return;\r\n        }\r\n        var resolvePromise = createCancelablePromise(function (token) {\r\n            var promises = toResolve.map(function (request, i) {\r\n                var resolvedSymbols = new Array(request.length);\r\n                var promises = request.map(function (request, i) {\r\n                    if (!request.symbol.command && typeof request.provider.resolveCodeLens === 'function') {\r\n                        return Promise.resolve(request.provider.resolveCodeLens(model, request.symbol, token)).then(function (symbol) {\r\n                            resolvedSymbols[i] = symbol;\r\n                        }, onUnexpectedExternalError);\r\n                    }\r\n                    else {\r\n                        resolvedSymbols[i] = request.symbol;\r\n                        return Promise.resolve(undefined);\r\n                    }\r\n                });\r\n                return Promise.all(promises).then(function () {\r\n                    if (!token.isCancellationRequested && !lenses[i].isDisposed()) {\r\n                        lenses[i].updateCommands(resolvedSymbols);\r\n                    }\r\n                });\r\n            });\r\n            return Promise.all(promises);\r\n        });\r\n        this._currentResolveCodeLensSymbolsPromise = resolvePromise;\r\n        this._currentResolveCodeLensSymbolsPromise.then(function () {\r\n            if (_this._currentCodeLensModel) { // update the cached state with new resolved items\r\n                _this._codeLensCache.put(model, _this._currentCodeLensModel);\r\n            }\r\n            _this._oldCodeLensModels.clear(); // dispose old models once we have updated the UI with the current model\r\n            if (resolvePromise === _this._currentResolveCodeLensSymbolsPromise) {\r\n                _this._currentResolveCodeLensSymbolsPromise = undefined;\r\n            }\r\n        }, function (err) {\r\n            onUnexpectedError(err); // can also be cancellation!\r\n            if (resolvePromise === _this._currentResolveCodeLensSymbolsPromise) {\r\n                _this._currentResolveCodeLensSymbolsPromise = undefined;\r\n            }\r\n        });\r\n    };\r\n    CodeLensContribution.ID = 'css.editor.codeLens';\r\n    CodeLensContribution = __decorate([\r\n        __param(1, ICommandService),\r\n        __param(2, INotificationService),\r\n        __param(3, ICodeLensCache)\r\n    ], CodeLensContribution);\r\n    return CodeLensContribution;\r\n}());\r\nexport { CodeLensContribution };\r\nregisterEditorContribution(CodeLensContribution.ID, CodeLensContribution);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { registerLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ColorProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nexport function getColors(model, token) {\r\n    var colors = [];\r\n    var providers = ColorProviderRegistry.ordered(model).reverse();\r\n    var promises = providers.map(function (provider) { return Promise.resolve(provider.provideDocumentColors(model, token)).then(function (result) {\r\n        if (Array.isArray(result)) {\r\n            for (var _i = 0, result_1 = result; _i < result_1.length; _i++) {\r\n                var colorInfo = result_1[_i];\r\n                colors.push({ colorInfo: colorInfo, provider: provider });\r\n            }\r\n        }\r\n    }); });\r\n    return Promise.all(promises).then(function () { return colors; });\r\n}\r\nexport function getColorPresentations(model, colorInfo, provider, token) {\r\n    return Promise.resolve(provider.provideColorPresentations(model, colorInfo, token));\r\n}\r\nregisterLanguageCommand('_executeDocumentColorProvider', function (accessor, args) {\r\n    var resource = args.resource;\r\n    if (!(resource instanceof URI)) {\r\n        throw illegalArgument();\r\n    }\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument();\r\n    }\r\n    var rawCIs = [];\r\n    var providers = ColorProviderRegistry.ordered(model).reverse();\r\n    var promises = providers.map(function (provider) { return Promise.resolve(provider.provideDocumentColors(model, CancellationToken.None)).then(function (result) {\r\n        if (Array.isArray(result)) {\r\n            for (var _i = 0, result_2 = result; _i < result_2.length; _i++) {\r\n                var ci = result_2[_i];\r\n                rawCIs.push({ range: ci.range, color: [ci.color.red, ci.color.green, ci.color.blue, ci.color.alpha] });\r\n            }\r\n        }\r\n    }); });\r\n    return Promise.all(promises).then(function () { return rawCIs; });\r\n});\r\nregisterLanguageCommand('_executeColorPresentationProvider', function (accessor, args) {\r\n    var resource = args.resource, color = args.color, range = args.range;\r\n    if (!(resource instanceof URI) || !Array.isArray(color) || color.length !== 4 || !Range.isIRange(range)) {\r\n        throw illegalArgument();\r\n    }\r\n    var red = color[0], green = color[1], blue = color[2], alpha = color[3];\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument();\r\n    }\r\n    var colorInfo = {\r\n        range: range,\r\n        color: { red: red, green: green, blue: blue, alpha: alpha }\r\n    };\r\n    var presentations = [];\r\n    var providers = ColorProviderRegistry.ordered(model).reverse();\r\n    var promises = providers.map(function (provider) { return Promise.resolve(provider.provideColorPresentations(model, colorInfo, CancellationToken.None)).then(function (result) {\r\n        if (Array.isArray(result)) {\r\n            presentations.push.apply(presentations, result);\r\n        }\r\n    }); });\r\n    return Promise.all(promises).then(function () { return presentations; });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { TimeoutTimer, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { RGBA } from '../../../base/common/color.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { hash } from '../../../base/common/hash.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { ColorProviderRegistry } from '../../common/modes.js';\r\nimport { getColors } from './color.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nvar MAX_DECORATORS = 500;\r\nvar ColorDetector = /** @class */ (function (_super) {\r\n    __extends(ColorDetector, _super);\r\n    function ColorDetector(_editor, _codeEditorService, _configurationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._codeEditorService = _codeEditorService;\r\n        _this._configurationService = _configurationService;\r\n        _this._localToDispose = _this._register(new DisposableStore());\r\n        _this._decorationsIds = [];\r\n        _this._colorDatas = new Map();\r\n        _this._colorDecoratorIds = [];\r\n        _this._decorationsTypes = new Set();\r\n        _this._register(_editor.onDidChangeModel(function (e) {\r\n            _this._isEnabled = _this.isEnabled();\r\n            _this.onModelChanged();\r\n        }));\r\n        _this._register(_editor.onDidChangeModelLanguage(function (e) { return _this.onModelChanged(); }));\r\n        _this._register(ColorProviderRegistry.onDidChange(function (e) { return _this.onModelChanged(); }));\r\n        _this._register(_editor.onDidChangeConfiguration(function (e) {\r\n            var prevIsEnabled = _this._isEnabled;\r\n            _this._isEnabled = _this.isEnabled();\r\n            if (prevIsEnabled !== _this._isEnabled) {\r\n                if (_this._isEnabled) {\r\n                    _this.onModelChanged();\r\n                }\r\n                else {\r\n                    _this.removeAllDecorations();\r\n                }\r\n            }\r\n        }));\r\n        _this._timeoutTimer = null;\r\n        _this._computePromise = null;\r\n        _this._isEnabled = _this.isEnabled();\r\n        _this.onModelChanged();\r\n        return _this;\r\n    }\r\n    ColorDetector.prototype.isEnabled = function () {\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return false;\r\n        }\r\n        var languageId = model.getLanguageIdentifier();\r\n        // handle deprecated settings. [languageId].colorDecorators.enable\r\n        var deprecatedConfig = this._configurationService.getValue(languageId.language);\r\n        if (deprecatedConfig) {\r\n            var colorDecorators = deprecatedConfig['colorDecorators']; // deprecatedConfig.valueOf('.colorDecorators.enable');\r\n            if (colorDecorators && colorDecorators['enable'] !== undefined && !colorDecorators['enable']) {\r\n                return colorDecorators['enable'];\r\n            }\r\n        }\r\n        return this._editor.getOption(12 /* colorDecorators */);\r\n    };\r\n    ColorDetector.get = function (editor) {\r\n        return editor.getContribution(this.ID);\r\n    };\r\n    ColorDetector.prototype.dispose = function () {\r\n        this.stop();\r\n        this.removeAllDecorations();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ColorDetector.prototype.onModelChanged = function () {\r\n        var _this = this;\r\n        this.stop();\r\n        if (!this._isEnabled) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        if (!model || !ColorProviderRegistry.has(model)) {\r\n            return;\r\n        }\r\n        this._localToDispose.add(this._editor.onDidChangeModelContent(function (e) {\r\n            if (!_this._timeoutTimer) {\r\n                _this._timeoutTimer = new TimeoutTimer();\r\n                _this._timeoutTimer.cancelAndSet(function () {\r\n                    _this._timeoutTimer = null;\r\n                    _this.beginCompute();\r\n                }, ColorDetector.RECOMPUTE_TIME);\r\n            }\r\n        }));\r\n        this.beginCompute();\r\n    };\r\n    ColorDetector.prototype.beginCompute = function () {\r\n        var _this = this;\r\n        this._computePromise = createCancelablePromise(function (token) {\r\n            var model = _this._editor.getModel();\r\n            if (!model) {\r\n                return Promise.resolve([]);\r\n            }\r\n            return getColors(model, token);\r\n        });\r\n        this._computePromise.then(function (colorInfos) {\r\n            _this.updateDecorations(colorInfos);\r\n            _this.updateColorDecorators(colorInfos);\r\n            _this._computePromise = null;\r\n        }, onUnexpectedError);\r\n    };\r\n    ColorDetector.prototype.stop = function () {\r\n        if (this._timeoutTimer) {\r\n            this._timeoutTimer.cancel();\r\n            this._timeoutTimer = null;\r\n        }\r\n        if (this._computePromise) {\r\n            this._computePromise.cancel();\r\n            this._computePromise = null;\r\n        }\r\n        this._localToDispose.clear();\r\n    };\r\n    ColorDetector.prototype.updateDecorations = function (colorDatas) {\r\n        var _this = this;\r\n        var decorations = colorDatas.map(function (c) { return ({\r\n            range: {\r\n                startLineNumber: c.colorInfo.range.startLineNumber,\r\n                startColumn: c.colorInfo.range.startColumn,\r\n                endLineNumber: c.colorInfo.range.endLineNumber,\r\n                endColumn: c.colorInfo.range.endColumn\r\n            },\r\n            options: ModelDecorationOptions.EMPTY\r\n        }); });\r\n        this._decorationsIds = this._editor.deltaDecorations(this._decorationsIds, decorations);\r\n        this._colorDatas = new Map();\r\n        this._decorationsIds.forEach(function (id, i) { return _this._colorDatas.set(id, colorDatas[i]); });\r\n    };\r\n    ColorDetector.prototype.updateColorDecorators = function (colorData) {\r\n        var _this = this;\r\n        var decorations = [];\r\n        var newDecorationsTypes = {};\r\n        for (var i = 0; i < colorData.length && decorations.length < MAX_DECORATORS; i++) {\r\n            var _a = colorData[i].colorInfo.color, red = _a.red, green = _a.green, blue = _a.blue, alpha = _a.alpha;\r\n            var rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\r\n            var subKey = hash(rgba).toString(16);\r\n            var color = \"rgba(\" + rgba.r + \", \" + rgba.g + \", \" + rgba.b + \", \" + rgba.a + \")\";\r\n            var key = 'colorBox-' + subKey;\r\n            if (!this._decorationsTypes.has(key) && !newDecorationsTypes[key]) {\r\n                this._codeEditorService.registerDecorationType(key, {\r\n                    before: {\r\n                        contentText: ' ',\r\n                        border: 'solid 0.1em #000',\r\n                        margin: '0.1em 0.2em 0 0.2em',\r\n                        width: '0.8em',\r\n                        height: '0.8em',\r\n                        backgroundColor: color\r\n                    },\r\n                    dark: {\r\n                        before: {\r\n                            border: 'solid 0.1em #eee'\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n            newDecorationsTypes[key] = true;\r\n            decorations.push({\r\n                range: {\r\n                    startLineNumber: colorData[i].colorInfo.range.startLineNumber,\r\n                    startColumn: colorData[i].colorInfo.range.startColumn,\r\n                    endLineNumber: colorData[i].colorInfo.range.endLineNumber,\r\n                    endColumn: colorData[i].colorInfo.range.endColumn\r\n                },\r\n                options: this._codeEditorService.resolveDecorationOptions(key, true)\r\n            });\r\n        }\r\n        this._decorationsTypes.forEach(function (subType) {\r\n            if (!newDecorationsTypes[subType]) {\r\n                _this._codeEditorService.removeDecorationType(subType);\r\n            }\r\n        });\r\n        this._colorDecoratorIds = this._editor.deltaDecorations(this._colorDecoratorIds, decorations);\r\n    };\r\n    ColorDetector.prototype.removeAllDecorations = function () {\r\n        var _this = this;\r\n        this._decorationsIds = this._editor.deltaDecorations(this._decorationsIds, []);\r\n        this._colorDecoratorIds = this._editor.deltaDecorations(this._colorDecoratorIds, []);\r\n        this._decorationsTypes.forEach(function (subType) {\r\n            _this._codeEditorService.removeDecorationType(subType);\r\n        });\r\n    };\r\n    ColorDetector.prototype.getColorData = function (position) {\r\n        var _this = this;\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return null;\r\n        }\r\n        var decorations = model\r\n            .getDecorationsInRange(Range.fromPositions(position, position))\r\n            .filter(function (d) { return _this._colorDatas.has(d.id); });\r\n        if (decorations.length === 0) {\r\n            return null;\r\n        }\r\n        return this._colorDatas.get(decorations[0].id);\r\n    };\r\n    ColorDetector.ID = 'editor.contrib.colorDetector';\r\n    ColorDetector.RECOMPUTE_TIME = 1000; // ms\r\n    ColorDetector = __decorate([\r\n        __param(1, ICodeEditorService),\r\n        __param(2, IConfigurationService)\r\n    ], ColorDetector);\r\n    return ColorDetector;\r\n}(Disposable));\r\nexport { ColorDetector };\r\nregisterEditorContribution(ColorDetector.ID, ColorDetector);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nvar BlockCommentCommand = /** @class */ (function () {\r\n    function BlockCommentCommand(selection) {\r\n        this._selection = selection;\r\n        this._usedEndToken = null;\r\n    }\r\n    BlockCommentCommand._haystackHasNeedleAtOffset = function (haystack, needle, offset) {\r\n        if (offset < 0) {\r\n            return false;\r\n        }\r\n        var needleLength = needle.length;\r\n        var haystackLength = haystack.length;\r\n        if (offset + needleLength > haystackLength) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < needleLength; i++) {\r\n            var codeA = haystack.charCodeAt(offset + i);\r\n            var codeB = needle.charCodeAt(i);\r\n            if (codeA === codeB) {\r\n                continue;\r\n            }\r\n            if (codeA >= 65 /* A */ && codeA <= 90 /* Z */ && codeA + 32 === codeB) {\r\n                // codeA is upper-case variant of codeB\r\n                continue;\r\n            }\r\n            if (codeB >= 65 /* A */ && codeB <= 90 /* Z */ && codeB + 32 === codeA) {\r\n                // codeB is upper-case variant of codeA\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    BlockCommentCommand.prototype._createOperationsForBlockComment = function (selection, startToken, endToken, model, builder) {\r\n        var startLineNumber = selection.startLineNumber;\r\n        var startColumn = selection.startColumn;\r\n        var endLineNumber = selection.endLineNumber;\r\n        var endColumn = selection.endColumn;\r\n        var startLineText = model.getLineContent(startLineNumber);\r\n        var endLineText = model.getLineContent(endLineNumber);\r\n        var startTokenIndex = startLineText.lastIndexOf(startToken, startColumn - 1 + startToken.length);\r\n        var endTokenIndex = endLineText.indexOf(endToken, endColumn - 1 - endToken.length);\r\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\r\n            if (startLineNumber === endLineNumber) {\r\n                var lineBetweenTokens = startLineText.substring(startTokenIndex + startToken.length, endTokenIndex);\r\n                if (lineBetweenTokens.indexOf(endToken) >= 0) {\r\n                    // force to add a block comment\r\n                    startTokenIndex = -1;\r\n                    endTokenIndex = -1;\r\n                }\r\n            }\r\n            else {\r\n                var startLineAfterStartToken = startLineText.substring(startTokenIndex + startToken.length);\r\n                var endLineBeforeEndToken = endLineText.substring(0, endTokenIndex);\r\n                if (startLineAfterStartToken.indexOf(endToken) >= 0 || endLineBeforeEndToken.indexOf(endToken) >= 0) {\r\n                    // force to add a block comment\r\n                    startTokenIndex = -1;\r\n                    endTokenIndex = -1;\r\n                }\r\n            }\r\n        }\r\n        var ops;\r\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\r\n            // Consider spaces as part of the comment tokens\r\n            if (startTokenIndex + startToken.length < startLineText.length) {\r\n                if (startLineText.charCodeAt(startTokenIndex + startToken.length) === 32 /* Space */) {\r\n                    // Pretend the start token contains a trailing space\r\n                    startToken = startToken + ' ';\r\n                }\r\n            }\r\n            if (endTokenIndex > 0) {\r\n                if (endLineText.charCodeAt(endTokenIndex - 1) === 32 /* Space */) {\r\n                    // Pretend the end token contains a leading space\r\n                    endToken = ' ' + endToken;\r\n                    endTokenIndex -= 1;\r\n                }\r\n            }\r\n            ops = BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\r\n        }\r\n        else {\r\n            ops = BlockCommentCommand._createAddBlockCommentOperations(selection, startToken, endToken);\r\n            this._usedEndToken = ops.length === 1 ? endToken : null;\r\n        }\r\n        for (var _i = 0, ops_1 = ops; _i < ops_1.length; _i++) {\r\n            var op = ops_1[_i];\r\n            builder.addTrackedEditOperation(op.range, op.text);\r\n        }\r\n    };\r\n    BlockCommentCommand._createRemoveBlockCommentOperations = function (r, startToken, endToken) {\r\n        var res = [];\r\n        if (!Range.isEmpty(r)) {\r\n            // Remove block comment start\r\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.startLineNumber, r.startColumn)));\r\n            // Remove block comment end\r\n            res.push(EditOperation.delete(new Range(r.endLineNumber, r.endColumn, r.endLineNumber, r.endColumn + endToken.length)));\r\n        }\r\n        else {\r\n            // Remove both continuously\r\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.endLineNumber, r.endColumn + endToken.length)));\r\n        }\r\n        return res;\r\n    };\r\n    BlockCommentCommand._createAddBlockCommentOperations = function (r, startToken, endToken) {\r\n        var res = [];\r\n        if (!Range.isEmpty(r)) {\r\n            // Insert block comment start\r\n            res.push(EditOperation.insert(new Position(r.startLineNumber, r.startColumn), startToken + ' '));\r\n            // Insert block comment end\r\n            res.push(EditOperation.insert(new Position(r.endLineNumber, r.endColumn), ' ' + endToken));\r\n        }\r\n        else {\r\n            // Insert both continuously\r\n            res.push(EditOperation.replace(new Range(r.startLineNumber, r.startColumn, r.endLineNumber, r.endColumn), startToken + '  ' + endToken));\r\n        }\r\n        return res;\r\n    };\r\n    BlockCommentCommand.prototype.getEditOperations = function (model, builder) {\r\n        var startLineNumber = this._selection.startLineNumber;\r\n        var startColumn = this._selection.startColumn;\r\n        model.tokenizeIfCheap(startLineNumber);\r\n        var languageId = model.getLanguageIdAtPosition(startLineNumber, startColumn);\r\n        var config = LanguageConfigurationRegistry.getComments(languageId);\r\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\r\n            // Mode does not support block comments\r\n            return;\r\n        }\r\n        this._createOperationsForBlockComment(this._selection, config.blockCommentStartToken, config.blockCommentEndToken, model, builder);\r\n    };\r\n    BlockCommentCommand.prototype.computeCursorState = function (model, helper) {\r\n        var inverseEditOperations = helper.getInverseEditOperations();\r\n        if (inverseEditOperations.length === 2) {\r\n            var startTokenEditOperation = inverseEditOperations[0];\r\n            var endTokenEditOperation = inverseEditOperations[1];\r\n            return new Selection(startTokenEditOperation.range.endLineNumber, startTokenEditOperation.range.endColumn, endTokenEditOperation.range.startLineNumber, endTokenEditOperation.range.startColumn);\r\n        }\r\n        else {\r\n            var srcRange = inverseEditOperations[0].range;\r\n            var deltaColumn = this._usedEndToken ? -this._usedEndToken.length - 1 : 0; // minus 1 space before endToken\r\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn + deltaColumn, srcRange.endLineNumber, srcRange.endColumn + deltaColumn);\r\n        }\r\n    };\r\n    return BlockCommentCommand;\r\n}());\r\nexport { BlockCommentCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { BlockCommentCommand } from './blockCommentCommand.js';\r\nvar LineCommentCommand = /** @class */ (function () {\r\n    function LineCommentCommand(selection, tabSize, type) {\r\n        this._selection = selection;\r\n        this._selectionId = null;\r\n        this._tabSize = tabSize;\r\n        this._type = type;\r\n        this._deltaColumn = 0;\r\n        this._moveEndPositionDown = false;\r\n    }\r\n    /**\r\n     * Do an initial pass over the lines and gather info about the line comment string.\r\n     * Returns null if any of the lines doesn't support a line comment string.\r\n     */\r\n    LineCommentCommand._gatherPreflightCommentStrings = function (model, startLineNumber, endLineNumber) {\r\n        model.tokenizeIfCheap(startLineNumber);\r\n        var languageId = model.getLanguageIdAtPosition(startLineNumber, 1);\r\n        var config = LanguageConfigurationRegistry.getComments(languageId);\r\n        var commentStr = (config ? config.lineCommentToken : null);\r\n        if (!commentStr) {\r\n            // Mode does not support line comments\r\n            return null;\r\n        }\r\n        var lines = [];\r\n        for (var i = 0, lineCount = endLineNumber - startLineNumber + 1; i < lineCount; i++) {\r\n            lines[i] = {\r\n                ignore: false,\r\n                commentStr: commentStr,\r\n                commentStrOffset: 0,\r\n                commentStrLength: commentStr.length\r\n            };\r\n        }\r\n        return lines;\r\n    };\r\n    /**\r\n     * Analyze lines and decide which lines are relevant and what the toggle should do.\r\n     * Also, build up several offsets and lengths useful in the generation of editor operations.\r\n     */\r\n    LineCommentCommand._analyzeLines = function (type, model, lines, startLineNumber) {\r\n        var onlyWhitespaceLines = true;\r\n        var shouldRemoveComments;\r\n        if (type === 0 /* Toggle */) {\r\n            shouldRemoveComments = true;\r\n        }\r\n        else if (type === 1 /* ForceAdd */) {\r\n            shouldRemoveComments = false;\r\n        }\r\n        else {\r\n            shouldRemoveComments = true;\r\n        }\r\n        for (var i = 0, lineCount = lines.length; i < lineCount; i++) {\r\n            var lineData = lines[i];\r\n            var lineNumber = startLineNumber + i;\r\n            var lineContent = model.getLineContent(lineNumber);\r\n            var lineContentStartOffset = strings.firstNonWhitespaceIndex(lineContent);\r\n            if (lineContentStartOffset === -1) {\r\n                // Empty or whitespace only line\r\n                if (type === 0 /* Toggle */) {\r\n                    lineData.ignore = true;\r\n                }\r\n                else if (type === 1 /* ForceAdd */) {\r\n                    lineData.ignore = true;\r\n                }\r\n                else {\r\n                    lineData.ignore = true;\r\n                }\r\n                lineData.commentStrOffset = lineContent.length;\r\n                continue;\r\n            }\r\n            onlyWhitespaceLines = false;\r\n            lineData.ignore = false;\r\n            lineData.commentStrOffset = lineContentStartOffset;\r\n            if (shouldRemoveComments && !BlockCommentCommand._haystackHasNeedleAtOffset(lineContent, lineData.commentStr, lineContentStartOffset)) {\r\n                if (type === 0 /* Toggle */) {\r\n                    // Every line so far has been a line comment, but this one is not\r\n                    shouldRemoveComments = false;\r\n                }\r\n                else if (type === 1 /* ForceAdd */) {\r\n                    // Will not happen\r\n                }\r\n                else {\r\n                    lineData.ignore = true;\r\n                }\r\n            }\r\n            if (shouldRemoveComments) {\r\n                var commentStrEndOffset = lineContentStartOffset + lineData.commentStrLength;\r\n                if (commentStrEndOffset < lineContent.length && lineContent.charCodeAt(commentStrEndOffset) === 32 /* Space */) {\r\n                    lineData.commentStrLength += 1;\r\n                }\r\n            }\r\n        }\r\n        if (type === 0 /* Toggle */ && onlyWhitespaceLines) {\r\n            // For only whitespace lines, we insert comments\r\n            shouldRemoveComments = false;\r\n            // Also, no longer ignore them\r\n            for (var i = 0, lineCount = lines.length; i < lineCount; i++) {\r\n                lines[i].ignore = false;\r\n            }\r\n        }\r\n        return {\r\n            supported: true,\r\n            shouldRemoveComments: shouldRemoveComments,\r\n            lines: lines\r\n        };\r\n    };\r\n    /**\r\n     * Analyze all lines and decide exactly what to do => not supported | insert line comments | remove line comments\r\n     */\r\n    LineCommentCommand._gatherPreflightData = function (type, model, startLineNumber, endLineNumber) {\r\n        var lines = LineCommentCommand._gatherPreflightCommentStrings(model, startLineNumber, endLineNumber);\r\n        if (lines === null) {\r\n            return {\r\n                supported: false\r\n            };\r\n        }\r\n        return LineCommentCommand._analyzeLines(type, model, lines, startLineNumber);\r\n    };\r\n    /**\r\n     * Given a successful analysis, execute either insert line comments, either remove line comments\r\n     */\r\n    LineCommentCommand.prototype._executeLineComments = function (model, builder, data, s) {\r\n        var ops;\r\n        if (data.shouldRemoveComments) {\r\n            ops = LineCommentCommand._createRemoveLineCommentsOperations(data.lines, s.startLineNumber);\r\n        }\r\n        else {\r\n            LineCommentCommand._normalizeInsertionPoint(model, data.lines, s.startLineNumber, this._tabSize);\r\n            ops = LineCommentCommand._createAddLineCommentsOperations(data.lines, s.startLineNumber);\r\n        }\r\n        var cursorPosition = new Position(s.positionLineNumber, s.positionColumn);\r\n        for (var i = 0, len = ops.length; i < len; i++) {\r\n            builder.addEditOperation(ops[i].range, ops[i].text);\r\n            if (ops[i].range.isEmpty() && ops[i].range.getStartPosition().equals(cursorPosition)) {\r\n                var lineContent = model.getLineContent(cursorPosition.lineNumber);\r\n                if (lineContent.length + 1 === cursorPosition.column) {\r\n                    this._deltaColumn = (ops[i].text || '').length;\r\n                }\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n    };\r\n    LineCommentCommand.prototype._attemptRemoveBlockComment = function (model, s, startToken, endToken) {\r\n        var startLineNumber = s.startLineNumber;\r\n        var endLineNumber = s.endLineNumber;\r\n        var startTokenAllowedBeforeColumn = endToken.length + Math.max(model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.startColumn);\r\n        var startTokenIndex = model.getLineContent(startLineNumber).lastIndexOf(startToken, startTokenAllowedBeforeColumn - 1);\r\n        var endTokenIndex = model.getLineContent(endLineNumber).indexOf(endToken, s.endColumn - 1 - startToken.length);\r\n        if (startTokenIndex !== -1 && endTokenIndex === -1) {\r\n            endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\r\n            endLineNumber = startLineNumber;\r\n        }\r\n        if (startTokenIndex === -1 && endTokenIndex !== -1) {\r\n            startTokenIndex = model.getLineContent(endLineNumber).lastIndexOf(startToken, endTokenIndex);\r\n            startLineNumber = endLineNumber;\r\n        }\r\n        if (s.isEmpty() && (startTokenIndex === -1 || endTokenIndex === -1)) {\r\n            startTokenIndex = model.getLineContent(startLineNumber).indexOf(startToken);\r\n            if (startTokenIndex !== -1) {\r\n                endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\r\n            }\r\n        }\r\n        // We have to adjust to possible inner white space.\r\n        // For Space after startToken, add Space to startToken - range math will work out.\r\n        if (startTokenIndex !== -1 && model.getLineContent(startLineNumber).charCodeAt(startTokenIndex + startToken.length) === 32 /* Space */) {\r\n            startToken += ' ';\r\n        }\r\n        // For Space before endToken, add Space before endToken and shift index one left.\r\n        if (endTokenIndex !== -1 && model.getLineContent(endLineNumber).charCodeAt(endTokenIndex - 1) === 32 /* Space */) {\r\n            endToken = ' ' + endToken;\r\n            endTokenIndex -= 1;\r\n        }\r\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\r\n            return BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\r\n        }\r\n        return null;\r\n    };\r\n    /**\r\n     * Given an unsuccessful analysis, delegate to the block comment command\r\n     */\r\n    LineCommentCommand.prototype._executeBlockComment = function (model, builder, s) {\r\n        model.tokenizeIfCheap(s.startLineNumber);\r\n        var languageId = model.getLanguageIdAtPosition(s.startLineNumber, 1);\r\n        var config = LanguageConfigurationRegistry.getComments(languageId);\r\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\r\n            // Mode does not support block comments\r\n            return;\r\n        }\r\n        var startToken = config.blockCommentStartToken;\r\n        var endToken = config.blockCommentEndToken;\r\n        var ops = this._attemptRemoveBlockComment(model, s, startToken, endToken);\r\n        if (!ops) {\r\n            if (s.isEmpty()) {\r\n                var lineContent = model.getLineContent(s.startLineNumber);\r\n                var firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\r\n                if (firstNonWhitespaceIndex === -1) {\r\n                    // Line is empty or contains only whitespace\r\n                    firstNonWhitespaceIndex = lineContent.length;\r\n                }\r\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, firstNonWhitespaceIndex + 1, s.startLineNumber, lineContent.length + 1), startToken, endToken);\r\n            }\r\n            else {\r\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), startToken, endToken);\r\n            }\r\n            if (ops.length === 1) {\r\n                // Leave cursor after token and Space\r\n                this._deltaColumn = startToken.length + 1;\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n        for (var _i = 0, ops_1 = ops; _i < ops_1.length; _i++) {\r\n            var op = ops_1[_i];\r\n            builder.addEditOperation(op.range, op.text);\r\n        }\r\n    };\r\n    LineCommentCommand.prototype.getEditOperations = function (model, builder) {\r\n        var s = this._selection;\r\n        this._moveEndPositionDown = false;\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._moveEndPositionDown = true;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        var data = LineCommentCommand._gatherPreflightData(this._type, model, s.startLineNumber, s.endLineNumber);\r\n        if (data.supported) {\r\n            return this._executeLineComments(model, builder, data, s);\r\n        }\r\n        return this._executeBlockComment(model, builder, s);\r\n    };\r\n    LineCommentCommand.prototype.computeCursorState = function (model, helper) {\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._moveEndPositionDown) {\r\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\r\n        }\r\n        return new Selection(result.selectionStartLineNumber, result.selectionStartColumn + this._deltaColumn, result.positionLineNumber, result.positionColumn + this._deltaColumn);\r\n    };\r\n    /**\r\n     * Generate edit operations in the remove line comment case\r\n     */\r\n    LineCommentCommand._createRemoveLineCommentsOperations = function (lines, startLineNumber) {\r\n        var res = [];\r\n        for (var i = 0, len = lines.length; i < len; i++) {\r\n            var lineData = lines[i];\r\n            if (lineData.ignore) {\r\n                continue;\r\n            }\r\n            res.push(EditOperation.delete(new Range(startLineNumber + i, lineData.commentStrOffset + 1, startLineNumber + i, lineData.commentStrOffset + lineData.commentStrLength + 1)));\r\n        }\r\n        return res;\r\n    };\r\n    /**\r\n     * Generate edit operations in the add line comment case\r\n     */\r\n    LineCommentCommand._createAddLineCommentsOperations = function (lines, startLineNumber) {\r\n        var res = [];\r\n        for (var i = 0, len = lines.length; i < len; i++) {\r\n            var lineData = lines[i];\r\n            if (lineData.ignore) {\r\n                continue;\r\n            }\r\n            res.push(EditOperation.insert(new Position(startLineNumber + i, lineData.commentStrOffset + 1), lineData.commentStr + ' '));\r\n        }\r\n        return res;\r\n    };\r\n    // TODO@Alex -> duplicated in characterHardWrappingLineMapper\r\n    LineCommentCommand.nextVisibleColumn = function (currentVisibleColumn, tabSize, isTab, columnSize) {\r\n        if (isTab) {\r\n            return currentVisibleColumn + (tabSize - (currentVisibleColumn % tabSize));\r\n        }\r\n        return currentVisibleColumn + columnSize;\r\n    };\r\n    /**\r\n     * Adjust insertion points to have them vertically aligned in the add line comment case\r\n     */\r\n    LineCommentCommand._normalizeInsertionPoint = function (model, lines, startLineNumber, tabSize) {\r\n        var minVisibleColumn = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n        var j;\r\n        var lenJ;\r\n        for (var i = 0, len = lines.length; i < len; i++) {\r\n            if (lines[i].ignore) {\r\n                continue;\r\n            }\r\n            var lineContent = model.getLineContent(startLineNumber + i);\r\n            var currentVisibleColumn = 0;\r\n            for (var j_1 = 0, lenJ_1 = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j_1 < lenJ_1; j_1++) {\r\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, tabSize, lineContent.charCodeAt(j_1) === 9 /* Tab */, 1);\r\n            }\r\n            if (currentVisibleColumn < minVisibleColumn) {\r\n                minVisibleColumn = currentVisibleColumn;\r\n            }\r\n        }\r\n        minVisibleColumn = Math.floor(minVisibleColumn / tabSize) * tabSize;\r\n        for (var i = 0, len = lines.length; i < len; i++) {\r\n            if (lines[i].ignore) {\r\n                continue;\r\n            }\r\n            var lineContent = model.getLineContent(startLineNumber + i);\r\n            var currentVisibleColumn = 0;\r\n            for (j = 0, lenJ = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j < lenJ; j++) {\r\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, tabSize, lineContent.charCodeAt(j) === 9 /* Tab */, 1);\r\n            }\r\n            if (currentVisibleColumn > minVisibleColumn) {\r\n                lines[i].commentStrOffset = j - 1;\r\n            }\r\n            else {\r\n                lines[i].commentStrOffset = j;\r\n            }\r\n        }\r\n    };\r\n    return LineCommentCommand;\r\n}());\r\nexport { LineCommentCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { BlockCommentCommand } from './blockCommentCommand.js';\r\nimport { LineCommentCommand } from './lineCommentCommand.js';\r\nvar CommentLineAction = /** @class */ (function (_super) {\r\n    __extends(CommentLineAction, _super);\r\n    function CommentLineAction(type, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._type = type;\r\n        return _this;\r\n    }\r\n    CommentLineAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        var opts = model.getOptions();\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var selection = selections_1[_i];\r\n            commands.push(new LineCommentCommand(selection, opts.tabSize, this._type));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return CommentLineAction;\r\n}(EditorAction));\r\nvar ToggleCommentLineAction = /** @class */ (function (_super) {\r\n    __extends(ToggleCommentLineAction, _super);\r\n    function ToggleCommentLineAction() {\r\n        return _super.call(this, 0 /* Toggle */, {\r\n            id: 'editor.action.commentLine',\r\n            label: nls.localize('comment.line', \"Toggle Line Comment\"),\r\n            alias: 'Toggle Line Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 85 /* US_SLASH */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 15 /* MenubarEditMenu */,\r\n                group: '5_insert',\r\n                title: nls.localize({ key: 'miToggleLineComment', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Line Comment\"),\r\n                order: 1\r\n            }\r\n        }) || this;\r\n    }\r\n    return ToggleCommentLineAction;\r\n}(CommentLineAction));\r\nvar AddLineCommentAction = /** @class */ (function (_super) {\r\n    __extends(AddLineCommentAction, _super);\r\n    function AddLineCommentAction() {\r\n        return _super.call(this, 1 /* ForceAdd */, {\r\n            id: 'editor.action.addCommentLine',\r\n            label: nls.localize('comment.line.add', \"Add Line Comment\"),\r\n            alias: 'Add Line Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 33 /* KEY_C */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return AddLineCommentAction;\r\n}(CommentLineAction));\r\nvar RemoveLineCommentAction = /** @class */ (function (_super) {\r\n    __extends(RemoveLineCommentAction, _super);\r\n    function RemoveLineCommentAction() {\r\n        return _super.call(this, 2 /* ForceRemove */, {\r\n            id: 'editor.action.removeCommentLine',\r\n            label: nls.localize('comment.line.remove', \"Remove Line Comment\"),\r\n            alias: 'Remove Line Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 51 /* KEY_U */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return RemoveLineCommentAction;\r\n}(CommentLineAction));\r\nvar BlockCommentAction = /** @class */ (function (_super) {\r\n    __extends(BlockCommentAction, _super);\r\n    function BlockCommentAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.blockComment',\r\n            label: nls.localize('comment.block', \"Toggle Block Comment\"),\r\n            alias: 'Toggle Block Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 31 /* KEY_A */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 31 /* KEY_A */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 15 /* MenubarEditMenu */,\r\n                group: '5_insert',\r\n                title: nls.localize({ key: 'miToggleBlockComment', comment: ['&& denotes a mnemonic'] }, \"Toggle &&Block Comment\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    BlockCommentAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        for (var _i = 0, selections_2 = selections; _i < selections_2.length; _i++) {\r\n            var selection = selections_2[_i];\r\n            commands.push(new BlockCommentCommand(selection));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return BlockCommentAction;\r\n}(EditorAction));\r\nregisterEditorAction(ToggleCommentLineAction);\r\nregisterEditorAction(AddLineCommentAction);\r\nregisterEditorAction(RemoveLineCommentAction);\r\nregisterEditorAction(BlockCommentAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { SubmenuAction } from './ui/menu/menu.js';\r\nvar ContextSubMenu = /** @class */ (function (_super) {\r\n    __extends(ContextSubMenu, _super);\r\n    function ContextSubMenu(label, entries) {\r\n        var _this = _super.call(this, label, entries, 'contextsubmenu') || this;\r\n        _this.entries = entries;\r\n        return _this;\r\n    }\r\n    return ContextSubMenu;\r\n}(SubmenuAction));\r\nexport { ContextSubMenu };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { ActionViewItem, Separator } from '../../../base/browser/ui/actionbar/actionbar.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { IMenuService, SubmenuItemAction } from '../../../platform/actions/common/actions.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IContextMenuService, IContextViewService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { ContextSubMenu } from '../../../base/browser/contextmenu.js';\r\nvar ContextMenuController = /** @class */ (function () {\r\n    function ContextMenuController(editor, _contextMenuService, _contextViewService, _contextKeyService, _keybindingService, _menuService) {\r\n        var _this = this;\r\n        this._contextMenuService = _contextMenuService;\r\n        this._contextViewService = _contextViewService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._keybindingService = _keybindingService;\r\n        this._menuService = _menuService;\r\n        this._toDispose = new DisposableStore();\r\n        this._contextMenuIsBeingShownCount = 0;\r\n        this._editor = editor;\r\n        this._toDispose.add(this._editor.onContextMenu(function (e) { return _this._onContextMenu(e); }));\r\n        this._toDispose.add(this._editor.onMouseWheel(function (e) {\r\n            if (_this._contextMenuIsBeingShownCount > 0) {\r\n                _this._contextViewService.hideContextView();\r\n            }\r\n        }));\r\n        this._toDispose.add(this._editor.onKeyDown(function (e) {\r\n            if (e.keyCode === 58 /* ContextMenu */) {\r\n                // Chrome is funny like that\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                _this.showContextMenu();\r\n            }\r\n        }));\r\n    }\r\n    ContextMenuController.get = function (editor) {\r\n        return editor.getContribution(ContextMenuController.ID);\r\n    };\r\n    ContextMenuController.prototype._onContextMenu = function (e) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this._editor.getOption(13 /* contextmenu */)) {\r\n            this._editor.focus();\r\n            // Ensure the cursor is at the position of the mouse click\r\n            if (e.target.position && !this._editor.getSelection().containsPosition(e.target.position)) {\r\n                this._editor.setPosition(e.target.position);\r\n            }\r\n            return; // Context menu is turned off through configuration\r\n        }\r\n        if (e.target.type === 12 /* OVERLAY_WIDGET */) {\r\n            return; // allow native menu on widgets to support right click on input field for example in find\r\n        }\r\n        e.event.preventDefault();\r\n        if (e.target.type !== 6 /* CONTENT_TEXT */ && e.target.type !== 7 /* CONTENT_EMPTY */ && e.target.type !== 1 /* TEXTAREA */) {\r\n            return; // only support mouse click into text or native context menu key for now\r\n        }\r\n        // Ensure the editor gets focus if it hasn't, so the right events are being sent to other contributions\r\n        this._editor.focus();\r\n        // Ensure the cursor is at the position of the mouse click\r\n        if (e.target.position) {\r\n            var hasSelectionAtPosition = false;\r\n            for (var _i = 0, _a = this._editor.getSelections(); _i < _a.length; _i++) {\r\n                var selection = _a[_i];\r\n                if (selection.containsPosition(e.target.position)) {\r\n                    hasSelectionAtPosition = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!hasSelectionAtPosition) {\r\n                this._editor.setPosition(e.target.position);\r\n            }\r\n        }\r\n        // Unless the user triggerd the context menu through Shift+F10, use the mouse position as menu position\r\n        var anchor = null;\r\n        if (e.target.type !== 1 /* TEXTAREA */) {\r\n            anchor = { x: e.event.posx - 1, width: 2, y: e.event.posy - 1, height: 2 };\r\n        }\r\n        // Show the context menu\r\n        this.showContextMenu(anchor);\r\n    };\r\n    ContextMenuController.prototype.showContextMenu = function (anchor) {\r\n        if (!this._editor.getOption(13 /* contextmenu */)) {\r\n            return; // Context menu is turned off through configuration\r\n        }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this._contextMenuService) {\r\n            this._editor.focus();\r\n            return; // We need the context menu service to function\r\n        }\r\n        // Find actions available for menu\r\n        var menuActions = this._getMenuActions(this._editor.getModel(), 7 /* EditorContext */);\r\n        // Show menu if we have actions to show\r\n        if (menuActions.length > 0) {\r\n            this._doShowContextMenu(menuActions, anchor);\r\n        }\r\n    };\r\n    ContextMenuController.prototype._getMenuActions = function (model, menuId) {\r\n        var result = [];\r\n        // get menu groups\r\n        var menu = this._menuService.createMenu(menuId, this._contextKeyService);\r\n        var groups = menu.getActions({ arg: model.uri });\r\n        menu.dispose();\r\n        // translate them into other actions\r\n        for (var _i = 0, groups_1 = groups; _i < groups_1.length; _i++) {\r\n            var group = groups_1[_i];\r\n            var actions = group[1];\r\n            var addedItems = 0;\r\n            for (var _a = 0, actions_1 = actions; _a < actions_1.length; _a++) {\r\n                var action = actions_1[_a];\r\n                if (action instanceof SubmenuItemAction) {\r\n                    var subActions = this._getMenuActions(model, action.item.submenu);\r\n                    if (subActions.length > 0) {\r\n                        result.push(new ContextSubMenu(action.label, subActions));\r\n                        addedItems++;\r\n                    }\r\n                }\r\n                else {\r\n                    result.push(action);\r\n                    addedItems++;\r\n                }\r\n            }\r\n            if (addedItems) {\r\n                result.push(new Separator());\r\n            }\r\n        }\r\n        if (result.length) {\r\n            result.pop(); // remove last separator\r\n        }\r\n        return result;\r\n    };\r\n    ContextMenuController.prototype._doShowContextMenu = function (actions, anchor) {\r\n        var _this = this;\r\n        if (anchor === void 0) { anchor = null; }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        // Disable hover\r\n        var oldHoverSetting = this._editor.getOption(42 /* hover */);\r\n        this._editor.updateOptions({\r\n            hover: {\r\n                enabled: false\r\n            }\r\n        });\r\n        if (!anchor) {\r\n            // Ensure selection is visible\r\n            this._editor.revealPosition(this._editor.getPosition(), 1 /* Immediate */);\r\n            this._editor.render();\r\n            var cursorCoords = this._editor.getScrolledVisiblePosition(this._editor.getPosition());\r\n            // Translate to absolute editor position\r\n            var editorCoords = dom.getDomNodePagePosition(this._editor.getDomNode());\r\n            var posx = editorCoords.left + cursorCoords.left;\r\n            var posy = editorCoords.top + cursorCoords.top + cursorCoords.height;\r\n            anchor = { x: posx, y: posy };\r\n        }\r\n        // Show menu\r\n        this._contextMenuIsBeingShownCount++;\r\n        this._contextMenuService.showContextMenu({\r\n            getAnchor: function () { return anchor; },\r\n            getActions: function () { return actions; },\r\n            getActionViewItem: function (action) {\r\n                var keybinding = _this._keybindingFor(action);\r\n                if (keybinding) {\r\n                    return new ActionViewItem(action, action, { label: true, keybinding: keybinding.getLabel(), isMenu: true });\r\n                }\r\n                var customActionViewItem = action;\r\n                if (typeof customActionViewItem.getActionViewItem === 'function') {\r\n                    return customActionViewItem.getActionViewItem();\r\n                }\r\n                return new ActionViewItem(action, action, { icon: true, label: true, isMenu: true });\r\n            },\r\n            getKeyBinding: function (action) {\r\n                return _this._keybindingFor(action);\r\n            },\r\n            onHide: function (wasCancelled) {\r\n                _this._contextMenuIsBeingShownCount--;\r\n                _this._editor.focus();\r\n                _this._editor.updateOptions({\r\n                    hover: oldHoverSetting\r\n                });\r\n            }\r\n        });\r\n    };\r\n    ContextMenuController.prototype._keybindingFor = function (action) {\r\n        return this._keybindingService.lookupKeybinding(action.id);\r\n    };\r\n    ContextMenuController.prototype.dispose = function () {\r\n        if (this._contextMenuIsBeingShownCount > 0) {\r\n            this._contextViewService.hideContextView();\r\n        }\r\n        this._toDispose.dispose();\r\n    };\r\n    ContextMenuController.ID = 'editor.contrib.contextmenu';\r\n    ContextMenuController = __decorate([\r\n        __param(1, IContextMenuService),\r\n        __param(2, IContextViewService),\r\n        __param(3, IContextKeyService),\r\n        __param(4, IKeybindingService),\r\n        __param(5, IMenuService)\r\n    ], ContextMenuController);\r\n    return ContextMenuController;\r\n}());\r\nexport { ContextMenuController };\r\nvar ShowContextMenu = /** @class */ (function (_super) {\r\n    __extends(ShowContextMenu, _super);\r\n    function ShowContextMenu() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.showContextMenu',\r\n            label: nls.localize('action.showContextMenu.label', \"Show Editor Context Menu\"),\r\n            alias: 'Show Editor Context Menu',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 1024 /* Shift */ | 68 /* F10 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ShowContextMenu.prototype.run = function (accessor, editor) {\r\n        var contribution = ContextMenuController.get(editor);\r\n        contribution.showContextMenu();\r\n    };\r\n    return ShowContextMenu;\r\n}(EditorAction));\r\nregisterEditorContribution(ContextMenuController.ID, ContextMenuController);\r\nregisterEditorAction(ShowContextMenu);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nvar CursorState = /** @class */ (function () {\r\n    function CursorState(selections) {\r\n        this.selections = selections;\r\n    }\r\n    CursorState.prototype.equals = function (other) {\r\n        var thisLen = this.selections.length;\r\n        var otherLen = other.selections.length;\r\n        if (thisLen !== otherLen) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < thisLen; i++) {\r\n            if (!this.selections[i].equalsSelection(other.selections[i])) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    return CursorState;\r\n}());\r\nvar CursorUndoRedoController = /** @class */ (function (_super) {\r\n    __extends(CursorUndoRedoController, _super);\r\n    function CursorUndoRedoController(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._isCursorUndoRedo = false;\r\n        _this._undoStack = [];\r\n        _this._redoStack = [];\r\n        _this._register(editor.onDidChangeModel(function (e) {\r\n            _this._undoStack = [];\r\n            _this._redoStack = [];\r\n        }));\r\n        _this._register(editor.onDidChangeModelContent(function (e) {\r\n            _this._undoStack = [];\r\n            _this._redoStack = [];\r\n        }));\r\n        _this._register(editor.onDidChangeCursorSelection(function (e) {\r\n            if (_this._isCursorUndoRedo) {\r\n                return;\r\n            }\r\n            if (!e.oldSelections) {\r\n                return;\r\n            }\r\n            if (e.oldModelVersionId !== e.modelVersionId) {\r\n                return;\r\n            }\r\n            var prevState = new CursorState(e.oldSelections);\r\n            var isEqualToLastUndoStack = (_this._undoStack.length > 0 && _this._undoStack[_this._undoStack.length - 1].equals(prevState));\r\n            if (!isEqualToLastUndoStack) {\r\n                _this._undoStack.push(prevState);\r\n                _this._redoStack = [];\r\n                if (_this._undoStack.length > 50) {\r\n                    // keep the cursor undo stack bounded\r\n                    _this._undoStack.shift();\r\n                }\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    CursorUndoRedoController.get = function (editor) {\r\n        return editor.getContribution(CursorUndoRedoController.ID);\r\n    };\r\n    CursorUndoRedoController.prototype.cursorUndo = function () {\r\n        if (!this._editor.hasModel() || this._undoStack.length === 0) {\r\n            return;\r\n        }\r\n        this._redoStack.push(new CursorState(this._editor.getSelections()));\r\n        this._applyState(this._undoStack.pop());\r\n    };\r\n    CursorUndoRedoController.prototype.cursorRedo = function () {\r\n        if (!this._editor.hasModel() || this._redoStack.length === 0) {\r\n            return;\r\n        }\r\n        this._undoStack.push(new CursorState(this._editor.getSelections()));\r\n        this._applyState(this._redoStack.pop());\r\n    };\r\n    CursorUndoRedoController.prototype._applyState = function (state) {\r\n        this._isCursorUndoRedo = true;\r\n        this._editor.setSelections(state.selections);\r\n        this._editor.revealRangeInCenterIfOutsideViewport(state.selections[0], 0 /* Smooth */);\r\n        this._isCursorUndoRedo = false;\r\n    };\r\n    CursorUndoRedoController.ID = 'editor.contrib.cursorUndoRedoController';\r\n    return CursorUndoRedoController;\r\n}(Disposable));\r\nexport { CursorUndoRedoController };\r\nvar CursorUndo = /** @class */ (function (_super) {\r\n    __extends(CursorUndo, _super);\r\n    function CursorUndo() {\r\n        return _super.call(this, {\r\n            id: 'cursorUndo',\r\n            label: nls.localize('cursor.undo', \"Cursor Undo\"),\r\n            alias: 'Cursor Undo',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 51 /* KEY_U */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorUndo.prototype.run = function (accessor, editor, args) {\r\n        CursorUndoRedoController.get(editor).cursorUndo();\r\n    };\r\n    return CursorUndo;\r\n}(EditorAction));\r\nexport { CursorUndo };\r\nvar CursorRedo = /** @class */ (function (_super) {\r\n    __extends(CursorRedo, _super);\r\n    function CursorRedo() {\r\n        return _super.call(this, {\r\n            id: 'cursorRedo',\r\n            label: nls.localize('cursor.redo', \"Cursor Redo\"),\r\n            alias: 'Cursor Redo',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    CursorRedo.prototype.run = function (accessor, editor, args) {\r\n        CursorUndoRedoController.get(editor).cursorRedo();\r\n    };\r\n    return CursorRedo;\r\n}(EditorAction));\r\nexport { CursorRedo };\r\nregisterEditorContribution(CursorUndoRedoController.ID, CursorUndoRedoController);\r\nregisterEditorAction(CursorUndo);\r\nregisterEditorAction(CursorRedo);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar DragAndDropCommand = /** @class */ (function () {\r\n    function DragAndDropCommand(selection, targetPosition, copy) {\r\n        this.selection = selection;\r\n        this.targetPosition = targetPosition;\r\n        this.copy = copy;\r\n        this.targetSelection = null;\r\n    }\r\n    DragAndDropCommand.prototype.getEditOperations = function (model, builder) {\r\n        var text = model.getValueInRange(this.selection);\r\n        if (!this.copy) {\r\n            builder.addEditOperation(this.selection, null);\r\n        }\r\n        builder.addEditOperation(new Range(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column), text);\r\n        if (this.selection.containsPosition(this.targetPosition) && !(this.copy && (this.selection.getEndPosition().equals(this.targetPosition) || this.selection.getStartPosition().equals(this.targetPosition)) // we allow users to paste content beside the selection\r\n        )) {\r\n            this.targetSelection = this.selection;\r\n            return;\r\n        }\r\n        if (this.copy) {\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.selection.endLineNumber - this.selection.startLineNumber + this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\r\n                this.selection.endColumn);\r\n            return;\r\n        }\r\n        if (this.targetPosition.lineNumber > this.selection.endLineNumber) {\r\n            // Drag the selection downwards\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\r\n                this.selection.endColumn);\r\n            return;\r\n        }\r\n        if (this.targetPosition.lineNumber < this.selection.endLineNumber) {\r\n            // Drag the selection upwards\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber + this.selection.endLineNumber - this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\r\n                this.selection.endColumn);\r\n            return;\r\n        }\r\n        // The target position is at the same line as the selection's end position.\r\n        if (this.selection.endColumn <= this.targetPosition.column) {\r\n            // The target position is after the selection's end position\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn :\r\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column :\r\n                this.selection.endColumn);\r\n        }\r\n        else {\r\n            // The target position is before the selection's end position. Since the selection doesn't contain the target position, the selection is one-line and target position is before this selection.\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column + this.selection.endColumn - this.selection.startColumn);\r\n        }\r\n    };\r\n    DragAndDropCommand.prototype.computeCursorState = function (model, helper) {\r\n        return this.targetSelection;\r\n    };\r\n    return DragAndDropCommand;\r\n}());\r\nexport { DragAndDropCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './dnd.css';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { isMacintosh } from '../../../base/common/platform.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { DragAndDropCommand } from './dragAndDropCommand.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nfunction hasTriggerModifier(e) {\r\n    if (isMacintosh) {\r\n        return e.altKey;\r\n    }\r\n    else {\r\n        return e.ctrlKey;\r\n    }\r\n}\r\nvar DragAndDropController = /** @class */ (function (_super) {\r\n    __extends(DragAndDropController, _super);\r\n    function DragAndDropController(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._register(_this._editor.onMouseDown(function (e) { return _this._onEditorMouseDown(e); }));\r\n        _this._register(_this._editor.onMouseUp(function (e) { return _this._onEditorMouseUp(e); }));\r\n        _this._register(_this._editor.onMouseDrag(function (e) { return _this._onEditorMouseDrag(e); }));\r\n        _this._register(_this._editor.onMouseDrop(function (e) { return _this._onEditorMouseDrop(e); }));\r\n        _this._register(_this._editor.onKeyDown(function (e) { return _this.onEditorKeyDown(e); }));\r\n        _this._register(_this._editor.onKeyUp(function (e) { return _this.onEditorKeyUp(e); }));\r\n        _this._register(_this._editor.onDidBlurEditorWidget(function () { return _this.onEditorBlur(); }));\r\n        _this._dndDecorationIds = [];\r\n        _this._mouseDown = false;\r\n        _this._modifierPressed = false;\r\n        _this._dragSelection = null;\r\n        return _this;\r\n    }\r\n    DragAndDropController.prototype.onEditorBlur = function () {\r\n        this._removeDecoration();\r\n        this._dragSelection = null;\r\n        this._mouseDown = false;\r\n        this._modifierPressed = false;\r\n    };\r\n    DragAndDropController.prototype.onEditorKeyDown = function (e) {\r\n        if (!this._editor.getOption(23 /* dragAndDrop */)) {\r\n            return;\r\n        }\r\n        if (hasTriggerModifier(e)) {\r\n            this._modifierPressed = true;\r\n        }\r\n        if (this._mouseDown && hasTriggerModifier(e)) {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'copy'\r\n            });\r\n        }\r\n    };\r\n    DragAndDropController.prototype.onEditorKeyUp = function (e) {\r\n        if (!this._editor.getOption(23 /* dragAndDrop */)) {\r\n            return;\r\n        }\r\n        if (hasTriggerModifier(e)) {\r\n            this._modifierPressed = false;\r\n        }\r\n        if (this._mouseDown && e.keyCode === DragAndDropController.TRIGGER_KEY_VALUE) {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'default'\r\n            });\r\n        }\r\n    };\r\n    DragAndDropController.prototype._onEditorMouseDown = function (mouseEvent) {\r\n        this._mouseDown = true;\r\n    };\r\n    DragAndDropController.prototype._onEditorMouseUp = function (mouseEvent) {\r\n        this._mouseDown = false;\r\n        // Whenever users release the mouse, the drag and drop operation should finish and the cursor should revert to text.\r\n        this._editor.updateOptions({\r\n            mouseStyle: 'text'\r\n        });\r\n    };\r\n    DragAndDropController.prototype._onEditorMouseDrag = function (mouseEvent) {\r\n        var target = mouseEvent.target;\r\n        if (this._dragSelection === null) {\r\n            var selections = this._editor.getSelections() || [];\r\n            var possibleSelections = selections.filter(function (selection) { return target.position && selection.containsPosition(target.position); });\r\n            if (possibleSelections.length === 1) {\r\n                this._dragSelection = possibleSelections[0];\r\n            }\r\n            else {\r\n                return;\r\n            }\r\n        }\r\n        if (hasTriggerModifier(mouseEvent.event)) {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'copy'\r\n            });\r\n        }\r\n        else {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'default'\r\n            });\r\n        }\r\n        if (target.position) {\r\n            if (this._dragSelection.containsPosition(target.position)) {\r\n                this._removeDecoration();\r\n            }\r\n            else {\r\n                this.showAt(target.position);\r\n            }\r\n        }\r\n    };\r\n    DragAndDropController.prototype._onEditorMouseDrop = function (mouseEvent) {\r\n        if (mouseEvent.target && (this._hitContent(mouseEvent.target) || this._hitMargin(mouseEvent.target)) && mouseEvent.target.position) {\r\n            var newCursorPosition_1 = new Position(mouseEvent.target.position.lineNumber, mouseEvent.target.position.column);\r\n            if (this._dragSelection === null) {\r\n                var newSelections = null;\r\n                if (mouseEvent.event.shiftKey) {\r\n                    var primarySelection = this._editor.getSelection();\r\n                    if (primarySelection) {\r\n                        var selectionStartLineNumber = primarySelection.selectionStartLineNumber, selectionStartColumn = primarySelection.selectionStartColumn;\r\n                        newSelections = [new Selection(selectionStartLineNumber, selectionStartColumn, newCursorPosition_1.lineNumber, newCursorPosition_1.column)];\r\n                    }\r\n                }\r\n                else {\r\n                    newSelections = (this._editor.getSelections() || []).map(function (selection) {\r\n                        if (selection.containsPosition(newCursorPosition_1)) {\r\n                            return new Selection(newCursorPosition_1.lineNumber, newCursorPosition_1.column, newCursorPosition_1.lineNumber, newCursorPosition_1.column);\r\n                        }\r\n                        else {\r\n                            return selection;\r\n                        }\r\n                    });\r\n                }\r\n                // Use `mouse` as the source instead of `api`.\r\n                this._editor.setSelections(newSelections || [], 'mouse');\r\n            }\r\n            else if (!this._dragSelection.containsPosition(newCursorPosition_1) ||\r\n                ((hasTriggerModifier(mouseEvent.event) ||\r\n                    this._modifierPressed) && (this._dragSelection.getEndPosition().equals(newCursorPosition_1) || this._dragSelection.getStartPosition().equals(newCursorPosition_1)) // we allow users to paste content beside the selection\r\n                )) {\r\n                this._editor.pushUndoStop();\r\n                this._editor.executeCommand(DragAndDropController.ID, new DragAndDropCommand(this._dragSelection, newCursorPosition_1, hasTriggerModifier(mouseEvent.event) || this._modifierPressed));\r\n                this._editor.pushUndoStop();\r\n            }\r\n        }\r\n        this._editor.updateOptions({\r\n            mouseStyle: 'text'\r\n        });\r\n        this._removeDecoration();\r\n        this._dragSelection = null;\r\n        this._mouseDown = false;\r\n    };\r\n    DragAndDropController.prototype.showAt = function (position) {\r\n        var newDecorations = [{\r\n                range: new Range(position.lineNumber, position.column, position.lineNumber, position.column),\r\n                options: DragAndDropController._DECORATION_OPTIONS\r\n            }];\r\n        this._dndDecorationIds = this._editor.deltaDecorations(this._dndDecorationIds, newDecorations);\r\n        this._editor.revealPosition(position, 1 /* Immediate */);\r\n    };\r\n    DragAndDropController.prototype._removeDecoration = function () {\r\n        this._dndDecorationIds = this._editor.deltaDecorations(this._dndDecorationIds, []);\r\n    };\r\n    DragAndDropController.prototype._hitContent = function (target) {\r\n        return target.type === 6 /* CONTENT_TEXT */ ||\r\n            target.type === 7 /* CONTENT_EMPTY */;\r\n    };\r\n    DragAndDropController.prototype._hitMargin = function (target) {\r\n        return target.type === 2 /* GUTTER_GLYPH_MARGIN */ ||\r\n            target.type === 3 /* GUTTER_LINE_NUMBERS */ ||\r\n            target.type === 4 /* GUTTER_LINE_DECORATIONS */;\r\n    };\r\n    DragAndDropController.prototype.dispose = function () {\r\n        this._removeDecoration();\r\n        this._dragSelection = null;\r\n        this._mouseDown = false;\r\n        this._modifierPressed = false;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    DragAndDropController.ID = 'editor.contrib.dragAndDrop';\r\n    DragAndDropController.TRIGGER_KEY_VALUE = isMacintosh ? 6 /* Alt */ : 5 /* Ctrl */;\r\n    DragAndDropController._DECORATION_OPTIONS = ModelDecorationOptions.register({\r\n        className: 'dnd-target'\r\n    });\r\n    return DragAndDropController;\r\n}(Disposable));\r\nexport { DragAndDropController };\r\nregisterEditorContribution(DragAndDropController.ID, DragAndDropController);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { OverviewRulerLane, MinimapPosition } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { overviewRulerFindMatchForeground, minimapFindMatch } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nvar FindDecorations = /** @class */ (function () {\r\n    function FindDecorations(editor) {\r\n        this._editor = editor;\r\n        this._decorations = [];\r\n        this._overviewRulerApproximateDecorations = [];\r\n        this._findScopeDecorationId = null;\r\n        this._rangeHighlightDecorationId = null;\r\n        this._highlightedDecorationId = null;\r\n        this._startPosition = this._editor.getPosition();\r\n    }\r\n    FindDecorations.prototype.dispose = function () {\r\n        this._editor.deltaDecorations(this._allDecorations(), []);\r\n        this._decorations = [];\r\n        this._overviewRulerApproximateDecorations = [];\r\n        this._findScopeDecorationId = null;\r\n        this._rangeHighlightDecorationId = null;\r\n        this._highlightedDecorationId = null;\r\n    };\r\n    FindDecorations.prototype.reset = function () {\r\n        this._decorations = [];\r\n        this._overviewRulerApproximateDecorations = [];\r\n        this._findScopeDecorationId = null;\r\n        this._rangeHighlightDecorationId = null;\r\n        this._highlightedDecorationId = null;\r\n    };\r\n    FindDecorations.prototype.getCount = function () {\r\n        return this._decorations.length;\r\n    };\r\n    FindDecorations.prototype.getFindScope = function () {\r\n        if (this._findScopeDecorationId) {\r\n            return this._editor.getModel().getDecorationRange(this._findScopeDecorationId);\r\n        }\r\n        return null;\r\n    };\r\n    FindDecorations.prototype.getStartPosition = function () {\r\n        return this._startPosition;\r\n    };\r\n    FindDecorations.prototype.setStartPosition = function (newStartPosition) {\r\n        this._startPosition = newStartPosition;\r\n        this.setCurrentFindMatch(null);\r\n    };\r\n    FindDecorations.prototype._getDecorationIndex = function (decorationId) {\r\n        var index = this._decorations.indexOf(decorationId);\r\n        if (index >= 0) {\r\n            return index + 1;\r\n        }\r\n        return 1;\r\n    };\r\n    FindDecorations.prototype.getCurrentMatchesPosition = function (desiredRange) {\r\n        var candidates = this._editor.getModel().getDecorationsInRange(desiredRange);\r\n        for (var _i = 0, candidates_1 = candidates; _i < candidates_1.length; _i++) {\r\n            var candidate = candidates_1[_i];\r\n            var candidateOpts = candidate.options;\r\n            if (candidateOpts === FindDecorations._FIND_MATCH_DECORATION || candidateOpts === FindDecorations._CURRENT_FIND_MATCH_DECORATION) {\r\n                return this._getDecorationIndex(candidate.id);\r\n            }\r\n        }\r\n        return 1;\r\n    };\r\n    FindDecorations.prototype.setCurrentFindMatch = function (nextMatch) {\r\n        var _this = this;\r\n        var newCurrentDecorationId = null;\r\n        var matchPosition = 0;\r\n        if (nextMatch) {\r\n            for (var i = 0, len = this._decorations.length; i < len; i++) {\r\n                var range = this._editor.getModel().getDecorationRange(this._decorations[i]);\r\n                if (nextMatch.equalsRange(range)) {\r\n                    newCurrentDecorationId = this._decorations[i];\r\n                    matchPosition = (i + 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (this._highlightedDecorationId !== null || newCurrentDecorationId !== null) {\r\n            this._editor.changeDecorations(function (changeAccessor) {\r\n                if (_this._highlightedDecorationId !== null) {\r\n                    changeAccessor.changeDecorationOptions(_this._highlightedDecorationId, FindDecorations._FIND_MATCH_DECORATION);\r\n                    _this._highlightedDecorationId = null;\r\n                }\r\n                if (newCurrentDecorationId !== null) {\r\n                    _this._highlightedDecorationId = newCurrentDecorationId;\r\n                    changeAccessor.changeDecorationOptions(_this._highlightedDecorationId, FindDecorations._CURRENT_FIND_MATCH_DECORATION);\r\n                }\r\n                if (_this._rangeHighlightDecorationId !== null) {\r\n                    changeAccessor.removeDecoration(_this._rangeHighlightDecorationId);\r\n                    _this._rangeHighlightDecorationId = null;\r\n                }\r\n                if (newCurrentDecorationId !== null) {\r\n                    var rng = _this._editor.getModel().getDecorationRange(newCurrentDecorationId);\r\n                    if (rng.startLineNumber !== rng.endLineNumber && rng.endColumn === 1) {\r\n                        var lineBeforeEnd = rng.endLineNumber - 1;\r\n                        var lineBeforeEndMaxColumn = _this._editor.getModel().getLineMaxColumn(lineBeforeEnd);\r\n                        rng = new Range(rng.startLineNumber, rng.startColumn, lineBeforeEnd, lineBeforeEndMaxColumn);\r\n                    }\r\n                    _this._rangeHighlightDecorationId = changeAccessor.addDecoration(rng, FindDecorations._RANGE_HIGHLIGHT_DECORATION);\r\n                }\r\n            });\r\n        }\r\n        return matchPosition;\r\n    };\r\n    FindDecorations.prototype.set = function (findMatches, findScope) {\r\n        var _this = this;\r\n        this._editor.changeDecorations(function (accessor) {\r\n            var findMatchesOptions = FindDecorations._FIND_MATCH_DECORATION;\r\n            var newOverviewRulerApproximateDecorations = [];\r\n            if (findMatches.length > 1000) {\r\n                // we go into a mode where the overview ruler gets \"approximate\" decorations\r\n                // the reason is that the overview ruler paints all the decorations in the file and we don't want to cause freezes\r\n                findMatchesOptions = FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;\r\n                // approximate a distance in lines where matches should be merged\r\n                var lineCount = _this._editor.getModel().getLineCount();\r\n                var height = _this._editor.getLayoutInfo().height;\r\n                var approxPixelsPerLine = height / lineCount;\r\n                var mergeLinesDelta = Math.max(2, Math.ceil(3 / approxPixelsPerLine));\r\n                // merge decorations as much as possible\r\n                var prevStartLineNumber = findMatches[0].range.startLineNumber;\r\n                var prevEndLineNumber = findMatches[0].range.endLineNumber;\r\n                for (var i = 1, len = findMatches.length; i < len; i++) {\r\n                    var range = findMatches[i].range;\r\n                    if (prevEndLineNumber + mergeLinesDelta >= range.startLineNumber) {\r\n                        if (range.endLineNumber > prevEndLineNumber) {\r\n                            prevEndLineNumber = range.endLineNumber;\r\n                        }\r\n                    }\r\n                    else {\r\n                        newOverviewRulerApproximateDecorations.push({\r\n                            range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\r\n                            options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\r\n                        });\r\n                        prevStartLineNumber = range.startLineNumber;\r\n                        prevEndLineNumber = range.endLineNumber;\r\n                    }\r\n                }\r\n                newOverviewRulerApproximateDecorations.push({\r\n                    range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\r\n                    options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\r\n                });\r\n            }\r\n            // Find matches\r\n            var newFindMatchesDecorations = new Array(findMatches.length);\r\n            for (var i = 0, len = findMatches.length; i < len; i++) {\r\n                newFindMatchesDecorations[i] = {\r\n                    range: findMatches[i].range,\r\n                    options: findMatchesOptions\r\n                };\r\n            }\r\n            _this._decorations = accessor.deltaDecorations(_this._decorations, newFindMatchesDecorations);\r\n            // Overview ruler approximate decorations\r\n            _this._overviewRulerApproximateDecorations = accessor.deltaDecorations(_this._overviewRulerApproximateDecorations, newOverviewRulerApproximateDecorations);\r\n            // Range highlight\r\n            if (_this._rangeHighlightDecorationId) {\r\n                accessor.removeDecoration(_this._rangeHighlightDecorationId);\r\n                _this._rangeHighlightDecorationId = null;\r\n            }\r\n            // Find scope\r\n            if (_this._findScopeDecorationId) {\r\n                accessor.removeDecoration(_this._findScopeDecorationId);\r\n                _this._findScopeDecorationId = null;\r\n            }\r\n            if (findScope) {\r\n                _this._findScopeDecorationId = accessor.addDecoration(findScope, FindDecorations._FIND_SCOPE_DECORATION);\r\n            }\r\n        });\r\n    };\r\n    FindDecorations.prototype.matchBeforePosition = function (position) {\r\n        if (this._decorations.length === 0) {\r\n            return null;\r\n        }\r\n        for (var i = this._decorations.length - 1; i >= 0; i--) {\r\n            var decorationId = this._decorations[i];\r\n            var r = this._editor.getModel().getDecorationRange(decorationId);\r\n            if (!r || r.endLineNumber > position.lineNumber) {\r\n                continue;\r\n            }\r\n            if (r.endLineNumber < position.lineNumber) {\r\n                return r;\r\n            }\r\n            if (r.endColumn > position.column) {\r\n                continue;\r\n            }\r\n            return r;\r\n        }\r\n        return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length - 1]);\r\n    };\r\n    FindDecorations.prototype.matchAfterPosition = function (position) {\r\n        if (this._decorations.length === 0) {\r\n            return null;\r\n        }\r\n        for (var i = 0, len = this._decorations.length; i < len; i++) {\r\n            var decorationId = this._decorations[i];\r\n            var r = this._editor.getModel().getDecorationRange(decorationId);\r\n            if (!r || r.startLineNumber < position.lineNumber) {\r\n                continue;\r\n            }\r\n            if (r.startLineNumber > position.lineNumber) {\r\n                return r;\r\n            }\r\n            if (r.startColumn < position.column) {\r\n                continue;\r\n            }\r\n            return r;\r\n        }\r\n        return this._editor.getModel().getDecorationRange(this._decorations[0]);\r\n    };\r\n    FindDecorations.prototype._allDecorations = function () {\r\n        var result = [];\r\n        result = result.concat(this._decorations);\r\n        result = result.concat(this._overviewRulerApproximateDecorations);\r\n        if (this._findScopeDecorationId) {\r\n            result.push(this._findScopeDecorationId);\r\n        }\r\n        if (this._rangeHighlightDecorationId) {\r\n            result.push(this._rangeHighlightDecorationId);\r\n        }\r\n        return result;\r\n    };\r\n    FindDecorations._CURRENT_FIND_MATCH_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        zIndex: 13,\r\n        className: 'currentFindMatch',\r\n        showIfCollapsed: true,\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerFindMatchForeground),\r\n            position: OverviewRulerLane.Center\r\n        },\r\n        minimap: {\r\n            color: themeColorFromId(minimapFindMatch),\r\n            position: MinimapPosition.Inline\r\n        }\r\n    });\r\n    FindDecorations._FIND_MATCH_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'findMatch',\r\n        showIfCollapsed: true,\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerFindMatchForeground),\r\n            position: OverviewRulerLane.Center\r\n        },\r\n        minimap: {\r\n            color: themeColorFromId(minimapFindMatch),\r\n            position: MinimapPosition.Inline\r\n        }\r\n    });\r\n    FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'findMatch',\r\n        showIfCollapsed: true\r\n    });\r\n    FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerFindMatchForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    FindDecorations._RANGE_HIGHLIGHT_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'rangeHighlight',\r\n        isWholeLine: true\r\n    });\r\n    FindDecorations._FIND_SCOPE_DECORATION = ModelDecorationOptions.register({\r\n        className: 'findScope',\r\n        isWholeLine: true\r\n    });\r\n    return FindDecorations;\r\n}());\r\nexport { FindDecorations };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nvar ReplaceAllCommand = /** @class */ (function () {\r\n    function ReplaceAllCommand(editorSelection, ranges, replaceStrings) {\r\n        this._editorSelection = editorSelection;\r\n        this._ranges = ranges;\r\n        this._replaceStrings = replaceStrings;\r\n        this._trackedEditorSelectionId = null;\r\n    }\r\n    ReplaceAllCommand.prototype.getEditOperations = function (model, builder) {\r\n        if (this._ranges.length > 0) {\r\n            // Collect all edit operations\r\n            var ops = [];\r\n            for (var i = 0; i < this._ranges.length; i++) {\r\n                ops.push({\r\n                    range: this._ranges[i],\r\n                    text: this._replaceStrings[i]\r\n                });\r\n            }\r\n            // Sort them in ascending order by range starts\r\n            ops.sort(function (o1, o2) {\r\n                return Range.compareRangesUsingStarts(o1.range, o2.range);\r\n            });\r\n            // Merge operations that touch each other\r\n            var resultOps = [];\r\n            var previousOp = ops[0];\r\n            for (var i = 1; i < ops.length; i++) {\r\n                if (previousOp.range.endLineNumber === ops[i].range.startLineNumber && previousOp.range.endColumn === ops[i].range.startColumn) {\r\n                    // These operations are one after another and can be merged\r\n                    previousOp.range = previousOp.range.plusRange(ops[i].range);\r\n                    previousOp.text = previousOp.text + ops[i].text;\r\n                }\r\n                else {\r\n                    resultOps.push(previousOp);\r\n                    previousOp = ops[i];\r\n                }\r\n            }\r\n            resultOps.push(previousOp);\r\n            for (var _i = 0, resultOps_1 = resultOps; _i < resultOps_1.length; _i++) {\r\n                var op = resultOps_1[_i];\r\n                builder.addEditOperation(op.range, op.text);\r\n            }\r\n        }\r\n        this._trackedEditorSelectionId = builder.trackSelection(this._editorSelection);\r\n    };\r\n    ReplaceAllCommand.prototype.computeCursorState = function (model, helper) {\r\n        return helper.getTrackedSelection(this._trackedEditorSelectionId);\r\n    };\r\n    return ReplaceAllCommand;\r\n}());\r\nexport { ReplaceAllCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from './strings.js';\r\nexport function buildReplaceStringWithCasePreserved(matches, pattern) {\r\n    if (matches && (matches[0] !== '')) {\r\n        var containsHyphens = validateSpecificSpecialCharacter(matches, pattern, '-');\r\n        var containsUnderscores = validateSpecificSpecialCharacter(matches, pattern, '_');\r\n        if (containsHyphens && !containsUnderscores) {\r\n            return buildReplaceStringForSpecificSpecialCharacter(matches, pattern, '-');\r\n        }\r\n        else if (!containsHyphens && containsUnderscores) {\r\n            return buildReplaceStringForSpecificSpecialCharacter(matches, pattern, '_');\r\n        }\r\n        if (matches[0].toUpperCase() === matches[0]) {\r\n            return pattern.toUpperCase();\r\n        }\r\n        else if (matches[0].toLowerCase() === matches[0]) {\r\n            return pattern.toLowerCase();\r\n        }\r\n        else if (strings.containsUppercaseCharacter(matches[0][0])) {\r\n            return pattern[0].toUpperCase() + pattern.substr(1);\r\n        }\r\n        else {\r\n            // we don't understand its pattern yet.\r\n            return pattern;\r\n        }\r\n    }\r\n    else {\r\n        return pattern;\r\n    }\r\n}\r\nfunction validateSpecificSpecialCharacter(matches, pattern, specialCharacter) {\r\n    var doesContainSpecialCharacter = matches[0].indexOf(specialCharacter) !== -1 && pattern.indexOf(specialCharacter) !== -1;\r\n    return doesContainSpecialCharacter && matches[0].split(specialCharacter).length === pattern.split(specialCharacter).length;\r\n}\r\nfunction buildReplaceStringForSpecificSpecialCharacter(matches, pattern, specialCharacter) {\r\n    var splitPatternAtSpecialCharacter = pattern.split(specialCharacter);\r\n    var splitMatchAtSpecialCharacter = matches[0].split(specialCharacter);\r\n    var replaceString = '';\r\n    splitPatternAtSpecialCharacter.forEach(function (splitValue, index) {\r\n        replaceString += buildReplaceStringWithCasePreserved([splitMatchAtSpecialCharacter[index]], splitValue) + specialCharacter;\r\n    });\r\n    return replaceString.slice(0, -1);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { buildReplaceStringWithCasePreserved } from '../../../base/common/search.js';\r\n/**\r\n * Assigned when the replace pattern is entirely static.\r\n */\r\nvar StaticValueReplacePattern = /** @class */ (function () {\r\n    function StaticValueReplacePattern(staticValue) {\r\n        this.staticValue = staticValue;\r\n        this.kind = 0 /* StaticValue */;\r\n    }\r\n    return StaticValueReplacePattern;\r\n}());\r\n/**\r\n * Assigned when the replace pattern has replacemend patterns.\r\n */\r\nvar DynamicPiecesReplacePattern = /** @class */ (function () {\r\n    function DynamicPiecesReplacePattern(pieces) {\r\n        this.pieces = pieces;\r\n        this.kind = 1 /* DynamicPieces */;\r\n    }\r\n    return DynamicPiecesReplacePattern;\r\n}());\r\nvar ReplacePattern = /** @class */ (function () {\r\n    function ReplacePattern(pieces) {\r\n        if (!pieces || pieces.length === 0) {\r\n            this._state = new StaticValueReplacePattern('');\r\n        }\r\n        else if (pieces.length === 1 && pieces[0].staticValue !== null) {\r\n            this._state = new StaticValueReplacePattern(pieces[0].staticValue);\r\n        }\r\n        else {\r\n            this._state = new DynamicPiecesReplacePattern(pieces);\r\n        }\r\n    }\r\n    ReplacePattern.fromStaticValue = function (value) {\r\n        return new ReplacePattern([ReplacePiece.staticValue(value)]);\r\n    };\r\n    Object.defineProperty(ReplacePattern.prototype, \"hasReplacementPatterns\", {\r\n        get: function () {\r\n            return (this._state.kind === 1 /* DynamicPieces */);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ReplacePattern.prototype.buildReplaceString = function (matches, preserveCase) {\r\n        if (this._state.kind === 0 /* StaticValue */) {\r\n            if (preserveCase) {\r\n                return buildReplaceStringWithCasePreserved(matches, this._state.staticValue);\r\n            }\r\n            else {\r\n                return this._state.staticValue;\r\n            }\r\n        }\r\n        var result = '';\r\n        for (var i = 0, len = this._state.pieces.length; i < len; i++) {\r\n            var piece = this._state.pieces[i];\r\n            if (piece.staticValue !== null) {\r\n                // static value ReplacePiece\r\n                result += piece.staticValue;\r\n                continue;\r\n            }\r\n            // match index ReplacePiece\r\n            result += ReplacePattern._substitute(piece.matchIndex, matches);\r\n        }\r\n        return result;\r\n    };\r\n    ReplacePattern._substitute = function (matchIndex, matches) {\r\n        if (matches === null) {\r\n            return '';\r\n        }\r\n        if (matchIndex === 0) {\r\n            return matches[0];\r\n        }\r\n        var remainder = '';\r\n        while (matchIndex > 0) {\r\n            if (matchIndex < matches.length) {\r\n                // A match can be undefined\r\n                var match = (matches[matchIndex] || '');\r\n                return match + remainder;\r\n            }\r\n            remainder = String(matchIndex % 10) + remainder;\r\n            matchIndex = Math.floor(matchIndex / 10);\r\n        }\r\n        return '$' + remainder;\r\n    };\r\n    return ReplacePattern;\r\n}());\r\nexport { ReplacePattern };\r\n/**\r\n * A replace piece can either be a static string or an index to a specific match.\r\n */\r\nvar ReplacePiece = /** @class */ (function () {\r\n    function ReplacePiece(staticValue, matchIndex) {\r\n        this.staticValue = staticValue;\r\n        this.matchIndex = matchIndex;\r\n    }\r\n    ReplacePiece.staticValue = function (value) {\r\n        return new ReplacePiece(value, -1);\r\n    };\r\n    ReplacePiece.matchIndex = function (index) {\r\n        return new ReplacePiece(null, index);\r\n    };\r\n    return ReplacePiece;\r\n}());\r\nexport { ReplacePiece };\r\nvar ReplacePieceBuilder = /** @class */ (function () {\r\n    function ReplacePieceBuilder(source) {\r\n        this._source = source;\r\n        this._lastCharIndex = 0;\r\n        this._result = [];\r\n        this._resultLen = 0;\r\n        this._currentStaticPiece = '';\r\n    }\r\n    ReplacePieceBuilder.prototype.emitUnchanged = function (toCharIndex) {\r\n        this._emitStatic(this._source.substring(this._lastCharIndex, toCharIndex));\r\n        this._lastCharIndex = toCharIndex;\r\n    };\r\n    ReplacePieceBuilder.prototype.emitStatic = function (value, toCharIndex) {\r\n        this._emitStatic(value);\r\n        this._lastCharIndex = toCharIndex;\r\n    };\r\n    ReplacePieceBuilder.prototype._emitStatic = function (value) {\r\n        if (value.length === 0) {\r\n            return;\r\n        }\r\n        this._currentStaticPiece += value;\r\n    };\r\n    ReplacePieceBuilder.prototype.emitMatchIndex = function (index, toCharIndex) {\r\n        if (this._currentStaticPiece.length !== 0) {\r\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\r\n            this._currentStaticPiece = '';\r\n        }\r\n        this._result[this._resultLen++] = ReplacePiece.matchIndex(index);\r\n        this._lastCharIndex = toCharIndex;\r\n    };\r\n    ReplacePieceBuilder.prototype.finalize = function () {\r\n        this.emitUnchanged(this._source.length);\r\n        if (this._currentStaticPiece.length !== 0) {\r\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\r\n            this._currentStaticPiece = '';\r\n        }\r\n        return new ReplacePattern(this._result);\r\n    };\r\n    return ReplacePieceBuilder;\r\n}());\r\n/**\r\n * \\n\t\t\t=> inserts a LF\r\n * \\t\t\t\t=> inserts a TAB\r\n * \\\\\t\t\t=> inserts a \"\\\".\r\n * $$\t\t\t=> inserts a \"$\".\r\n * $& and $0\t=> inserts the matched substring.\r\n * $n\t\t\t=> Where n is a non-negative integer lesser than 100, inserts the nth parenthesized submatch string\r\n * everything else stays untouched\r\n *\r\n * Also see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter\r\n */\r\nexport function parseReplaceString(replaceString) {\r\n    if (!replaceString || replaceString.length === 0) {\r\n        return new ReplacePattern(null);\r\n    }\r\n    var result = new ReplacePieceBuilder(replaceString);\r\n    for (var i = 0, len = replaceString.length; i < len; i++) {\r\n        var chCode = replaceString.charCodeAt(i);\r\n        if (chCode === 92 /* Backslash */) {\r\n            // move to next char\r\n            i++;\r\n            if (i >= len) {\r\n                // string ends with a \\\r\n                break;\r\n            }\r\n            var nextChCode = replaceString.charCodeAt(i);\r\n            // let replaceWithCharacter: string | null = null;\r\n            switch (nextChCode) {\r\n                case 92 /* Backslash */:\r\n                    // \\\\ => inserts a \"\\\"\r\n                    result.emitUnchanged(i - 1);\r\n                    result.emitStatic('\\\\', i + 1);\r\n                    break;\r\n                case 110 /* n */:\r\n                    // \\n => inserts a LF\r\n                    result.emitUnchanged(i - 1);\r\n                    result.emitStatic('\\n', i + 1);\r\n                    break;\r\n                case 116 /* t */:\r\n                    // \\t => inserts a TAB\r\n                    result.emitUnchanged(i - 1);\r\n                    result.emitStatic('\\t', i + 1);\r\n                    break;\r\n            }\r\n            continue;\r\n        }\r\n        if (chCode === 36 /* DollarSign */) {\r\n            // move to next char\r\n            i++;\r\n            if (i >= len) {\r\n                // string ends with a $\r\n                break;\r\n            }\r\n            var nextChCode = replaceString.charCodeAt(i);\r\n            if (nextChCode === 36 /* DollarSign */) {\r\n                // $$ => inserts a \"$\"\r\n                result.emitUnchanged(i - 1);\r\n                result.emitStatic('$', i + 1);\r\n                continue;\r\n            }\r\n            if (nextChCode === 48 /* Digit0 */ || nextChCode === 38 /* Ampersand */) {\r\n                // $& and $0 => inserts the matched substring.\r\n                result.emitUnchanged(i - 1);\r\n                result.emitMatchIndex(0, i + 1);\r\n                continue;\r\n            }\r\n            if (49 /* Digit1 */ <= nextChCode && nextChCode <= 57 /* Digit9 */) {\r\n                // $n\r\n                var matchIndex = nextChCode - 48 /* Digit0 */;\r\n                // peek next char to probe for $nn\r\n                if (i + 1 < len) {\r\n                    var nextNextChCode = replaceString.charCodeAt(i + 1);\r\n                    if (48 /* Digit0 */ <= nextNextChCode && nextNextChCode <= 57 /* Digit9 */) {\r\n                        // $nn\r\n                        // move to next char\r\n                        i++;\r\n                        matchIndex = matchIndex * 10 + (nextNextChCode - 48 /* Digit0 */);\r\n                        result.emitUnchanged(i - 2);\r\n                        result.emitMatchIndex(matchIndex, i + 1);\r\n                        continue;\r\n                    }\r\n                }\r\n                result.emitUnchanged(i - 1);\r\n                result.emitMatchIndex(matchIndex, i + 1);\r\n                continue;\r\n            }\r\n        }\r\n    }\r\n    return result.finalize();\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { RunOnceScheduler, TimeoutTimer } from '../../../base/common/async.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection } from '../../common/commands/replaceCommand.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { SearchParams } from '../../common/model/textModelSearch.js';\r\nimport { FindDecorations } from './findDecorations.js';\r\nimport { ReplaceAllCommand } from './replaceAllCommand.js';\r\nimport { ReplacePattern, parseReplaceString } from './replacePattern.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nexport var CONTEXT_FIND_WIDGET_VISIBLE = new RawContextKey('findWidgetVisible', false);\r\n// Keep ContextKey use of 'Focussed' to not break when clauses\r\nexport var CONTEXT_FIND_INPUT_FOCUSED = new RawContextKey('findInputFocussed', false);\r\nexport var CONTEXT_REPLACE_INPUT_FOCUSED = new RawContextKey('replaceInputFocussed', false);\r\nexport var ToggleCaseSensitiveKeybinding = {\r\n    primary: 512 /* Alt */ | 33 /* KEY_C */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 33 /* KEY_C */ }\r\n};\r\nexport var ToggleWholeWordKeybinding = {\r\n    primary: 512 /* Alt */ | 53 /* KEY_W */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 53 /* KEY_W */ }\r\n};\r\nexport var ToggleRegexKeybinding = {\r\n    primary: 512 /* Alt */ | 48 /* KEY_R */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 48 /* KEY_R */ }\r\n};\r\nexport var ToggleSearchScopeKeybinding = {\r\n    primary: 512 /* Alt */ | 42 /* KEY_L */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 42 /* KEY_L */ }\r\n};\r\nexport var FIND_IDS = {\r\n    StartFindAction: 'actions.find',\r\n    StartFindWithSelection: 'actions.findWithSelection',\r\n    NextMatchFindAction: 'editor.action.nextMatchFindAction',\r\n    PreviousMatchFindAction: 'editor.action.previousMatchFindAction',\r\n    NextSelectionMatchFindAction: 'editor.action.nextSelectionMatchFindAction',\r\n    PreviousSelectionMatchFindAction: 'editor.action.previousSelectionMatchFindAction',\r\n    StartFindReplaceAction: 'editor.action.startFindReplaceAction',\r\n    CloseFindWidgetCommand: 'closeFindWidget',\r\n    ToggleCaseSensitiveCommand: 'toggleFindCaseSensitive',\r\n    ToggleWholeWordCommand: 'toggleFindWholeWord',\r\n    ToggleRegexCommand: 'toggleFindRegex',\r\n    ToggleSearchScopeCommand: 'toggleFindInSelection',\r\n    TogglePreserveCaseCommand: 'togglePreserveCase',\r\n    ReplaceOneAction: 'editor.action.replaceOne',\r\n    ReplaceAllAction: 'editor.action.replaceAll',\r\n    SelectAllMatchesAction: 'editor.action.selectAllMatches'\r\n};\r\nexport var MATCHES_LIMIT = 19999;\r\nvar RESEARCH_DELAY = 240;\r\nvar FindModelBoundToEditorModel = /** @class */ (function () {\r\n    function FindModelBoundToEditorModel(editor, state) {\r\n        var _this = this;\r\n        this._toDispose = new DisposableStore();\r\n        this._editor = editor;\r\n        this._state = state;\r\n        this._isDisposed = false;\r\n        this._startSearchingTimer = new TimeoutTimer();\r\n        this._decorations = new FindDecorations(editor);\r\n        this._toDispose.add(this._decorations);\r\n        this._updateDecorationsScheduler = new RunOnceScheduler(function () { return _this.research(false); }, 100);\r\n        this._toDispose.add(this._updateDecorationsScheduler);\r\n        this._toDispose.add(this._editor.onDidChangeCursorPosition(function (e) {\r\n            if (e.reason === 3 /* Explicit */\r\n                || e.reason === 5 /* Undo */\r\n                || e.reason === 6 /* Redo */) {\r\n                _this._decorations.setStartPosition(_this._editor.getPosition());\r\n            }\r\n        }));\r\n        this._ignoreModelContentChanged = false;\r\n        this._toDispose.add(this._editor.onDidChangeModelContent(function (e) {\r\n            if (_this._ignoreModelContentChanged) {\r\n                return;\r\n            }\r\n            if (e.isFlush) {\r\n                // a model.setValue() was called\r\n                _this._decorations.reset();\r\n            }\r\n            _this._decorations.setStartPosition(_this._editor.getPosition());\r\n            _this._updateDecorationsScheduler.schedule();\r\n        }));\r\n        this._toDispose.add(this._state.onFindReplaceStateChange(function (e) { return _this._onStateChanged(e); }));\r\n        this.research(false, this._state.searchScope);\r\n    }\r\n    FindModelBoundToEditorModel.prototype.dispose = function () {\r\n        this._isDisposed = true;\r\n        dispose(this._startSearchingTimer);\r\n        this._toDispose.dispose();\r\n    };\r\n    FindModelBoundToEditorModel.prototype._onStateChanged = function (e) {\r\n        var _this = this;\r\n        if (this._isDisposed) {\r\n            // The find model is disposed during a find state changed event\r\n            return;\r\n        }\r\n        if (!this._editor.hasModel()) {\r\n            // The find model will be disposed momentarily\r\n            return;\r\n        }\r\n        if (e.searchString || e.isReplaceRevealed || e.isRegex || e.wholeWord || e.matchCase || e.searchScope) {\r\n            var model = this._editor.getModel();\r\n            if (model.isTooLargeForSyncing()) {\r\n                this._startSearchingTimer.cancel();\r\n                this._startSearchingTimer.setIfNotSet(function () {\r\n                    if (e.searchScope) {\r\n                        _this.research(e.moveCursor, _this._state.searchScope);\r\n                    }\r\n                    else {\r\n                        _this.research(e.moveCursor);\r\n                    }\r\n                }, RESEARCH_DELAY);\r\n            }\r\n            else {\r\n                if (e.searchScope) {\r\n                    this.research(e.moveCursor, this._state.searchScope);\r\n                }\r\n                else {\r\n                    this.research(e.moveCursor);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    FindModelBoundToEditorModel._getSearchRange = function (model, findScope) {\r\n        // If we have set now or before a find scope, use it for computing the search range\r\n        if (findScope) {\r\n            return findScope;\r\n        }\r\n        return model.getFullModelRange();\r\n    };\r\n    FindModelBoundToEditorModel.prototype.research = function (moveCursor, newFindScope) {\r\n        var findScope = null;\r\n        if (typeof newFindScope !== 'undefined') {\r\n            findScope = newFindScope;\r\n        }\r\n        else {\r\n            findScope = this._decorations.getFindScope();\r\n        }\r\n        if (findScope !== null) {\r\n            if (findScope.startLineNumber !== findScope.endLineNumber) {\r\n                if (findScope.endColumn === 1) {\r\n                    findScope = new Range(findScope.startLineNumber, 1, findScope.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(findScope.endLineNumber - 1));\r\n                }\r\n                else {\r\n                    // multiline find scope => expand to line starts / ends\r\n                    findScope = new Range(findScope.startLineNumber, 1, findScope.endLineNumber, this._editor.getModel().getLineMaxColumn(findScope.endLineNumber));\r\n                }\r\n            }\r\n        }\r\n        var findMatches = this._findMatches(findScope, false, MATCHES_LIMIT);\r\n        this._decorations.set(findMatches, findScope);\r\n        this._state.changeMatchInfo(this._decorations.getCurrentMatchesPosition(this._editor.getSelection()), this._decorations.getCount(), undefined);\r\n        if (moveCursor) {\r\n            this._moveToNextMatch(this._decorations.getStartPosition());\r\n        }\r\n    };\r\n    FindModelBoundToEditorModel.prototype._hasMatches = function () {\r\n        return (this._state.matchesCount > 0);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._cannotFind = function () {\r\n        if (!this._hasMatches()) {\r\n            var findScope = this._decorations.getFindScope();\r\n            if (findScope) {\r\n                // Reveal the selection so user is reminded that 'selection find' is on.\r\n                this._editor.revealRangeInCenterIfOutsideViewport(findScope, 0 /* Smooth */);\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    FindModelBoundToEditorModel.prototype._setCurrentFindMatch = function (match) {\r\n        var matchesPosition = this._decorations.setCurrentFindMatch(match);\r\n        this._state.changeMatchInfo(matchesPosition, this._decorations.getCount(), match);\r\n        this._editor.setSelection(match);\r\n        this._editor.revealRangeInCenterIfOutsideViewport(match, 0 /* Smooth */);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._prevSearchPosition = function (before) {\r\n        var isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\r\n            || this._state.searchString.indexOf('$') >= 0);\r\n        var lineNumber = before.lineNumber, column = before.column;\r\n        var model = this._editor.getModel();\r\n        if (isUsingLineStops || column === 1) {\r\n            if (lineNumber === 1) {\r\n                lineNumber = model.getLineCount();\r\n            }\r\n            else {\r\n                lineNumber--;\r\n            }\r\n            column = model.getLineMaxColumn(lineNumber);\r\n        }\r\n        else {\r\n            column--;\r\n        }\r\n        return new Position(lineNumber, column);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._moveToPrevMatch = function (before, isRecursed) {\r\n        if (isRecursed === void 0) { isRecursed = false; }\r\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\r\n            var prevMatchRange = this._decorations.matchBeforePosition(before);\r\n            if (prevMatchRange && prevMatchRange.isEmpty() && prevMatchRange.getStartPosition().equals(before)) {\r\n                before = this._prevSearchPosition(before);\r\n                prevMatchRange = this._decorations.matchBeforePosition(before);\r\n            }\r\n            if (prevMatchRange) {\r\n                this._setCurrentFindMatch(prevMatchRange);\r\n            }\r\n            return;\r\n        }\r\n        if (this._cannotFind()) {\r\n            return;\r\n        }\r\n        var findScope = this._decorations.getFindScope();\r\n        var searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\r\n        // ...(----)...|...\r\n        if (searchRange.getEndPosition().isBefore(before)) {\r\n            before = searchRange.getEndPosition();\r\n        }\r\n        // ...|...(----)...\r\n        if (before.isBefore(searchRange.getStartPosition())) {\r\n            before = searchRange.getEndPosition();\r\n        }\r\n        var lineNumber = before.lineNumber, column = before.column;\r\n        var model = this._editor.getModel();\r\n        var position = new Position(lineNumber, column);\r\n        var prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(92 /* wordSeparators */) : null, false);\r\n        if (prevMatch && prevMatch.range.isEmpty() && prevMatch.range.getStartPosition().equals(position)) {\r\n            // Looks like we're stuck at this position, unacceptable!\r\n            position = this._prevSearchPosition(position);\r\n            prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(92 /* wordSeparators */) : null, false);\r\n        }\r\n        if (!prevMatch) {\r\n            // there is precisely one match and selection is on top of it\r\n            return;\r\n        }\r\n        if (!isRecursed && !searchRange.containsRange(prevMatch.range)) {\r\n            return this._moveToPrevMatch(prevMatch.range.getStartPosition(), true);\r\n        }\r\n        this._setCurrentFindMatch(prevMatch.range);\r\n    };\r\n    FindModelBoundToEditorModel.prototype.moveToPrevMatch = function () {\r\n        this._moveToPrevMatch(this._editor.getSelection().getStartPosition());\r\n    };\r\n    FindModelBoundToEditorModel.prototype._nextSearchPosition = function (after) {\r\n        var isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\r\n            || this._state.searchString.indexOf('$') >= 0);\r\n        var lineNumber = after.lineNumber, column = after.column;\r\n        var model = this._editor.getModel();\r\n        if (isUsingLineStops || column === model.getLineMaxColumn(lineNumber)) {\r\n            if (lineNumber === model.getLineCount()) {\r\n                lineNumber = 1;\r\n            }\r\n            else {\r\n                lineNumber++;\r\n            }\r\n            column = 1;\r\n        }\r\n        else {\r\n            column++;\r\n        }\r\n        return new Position(lineNumber, column);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._moveToNextMatch = function (after) {\r\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\r\n            var nextMatchRange = this._decorations.matchAfterPosition(after);\r\n            if (nextMatchRange && nextMatchRange.isEmpty() && nextMatchRange.getStartPosition().equals(after)) {\r\n                // Looks like we're stuck at this position, unacceptable!\r\n                after = this._nextSearchPosition(after);\r\n                nextMatchRange = this._decorations.matchAfterPosition(after);\r\n            }\r\n            if (nextMatchRange) {\r\n                this._setCurrentFindMatch(nextMatchRange);\r\n            }\r\n            return;\r\n        }\r\n        var nextMatch = this._getNextMatch(after, false, true);\r\n        if (nextMatch) {\r\n            this._setCurrentFindMatch(nextMatch.range);\r\n        }\r\n    };\r\n    FindModelBoundToEditorModel.prototype._getNextMatch = function (after, captureMatches, forceMove, isRecursed) {\r\n        if (isRecursed === void 0) { isRecursed = false; }\r\n        if (this._cannotFind()) {\r\n            return null;\r\n        }\r\n        var findScope = this._decorations.getFindScope();\r\n        var searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\r\n        // ...(----)...|...\r\n        if (searchRange.getEndPosition().isBefore(after)) {\r\n            after = searchRange.getStartPosition();\r\n        }\r\n        // ...|...(----)...\r\n        if (after.isBefore(searchRange.getStartPosition())) {\r\n            after = searchRange.getStartPosition();\r\n        }\r\n        var lineNumber = after.lineNumber, column = after.column;\r\n        var model = this._editor.getModel();\r\n        var position = new Position(lineNumber, column);\r\n        var nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(92 /* wordSeparators */) : null, captureMatches);\r\n        if (forceMove && nextMatch && nextMatch.range.isEmpty() && nextMatch.range.getStartPosition().equals(position)) {\r\n            // Looks like we're stuck at this position, unacceptable!\r\n            position = this._nextSearchPosition(position);\r\n            nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(92 /* wordSeparators */) : null, captureMatches);\r\n        }\r\n        if (!nextMatch) {\r\n            // there is precisely one match and selection is on top of it\r\n            return null;\r\n        }\r\n        if (!isRecursed && !searchRange.containsRange(nextMatch.range)) {\r\n            return this._getNextMatch(nextMatch.range.getEndPosition(), captureMatches, forceMove, true);\r\n        }\r\n        return nextMatch;\r\n    };\r\n    FindModelBoundToEditorModel.prototype.moveToNextMatch = function () {\r\n        this._moveToNextMatch(this._editor.getSelection().getEndPosition());\r\n    };\r\n    FindModelBoundToEditorModel.prototype._getReplacePattern = function () {\r\n        if (this._state.isRegex) {\r\n            return parseReplaceString(this._state.replaceString);\r\n        }\r\n        return ReplacePattern.fromStaticValue(this._state.replaceString);\r\n    };\r\n    FindModelBoundToEditorModel.prototype.replace = function () {\r\n        if (!this._hasMatches()) {\r\n            return;\r\n        }\r\n        var replacePattern = this._getReplacePattern();\r\n        var selection = this._editor.getSelection();\r\n        var nextMatch = this._getNextMatch(selection.getStartPosition(), true, false);\r\n        if (nextMatch) {\r\n            if (selection.equalsRange(nextMatch.range)) {\r\n                // selection sits on a find match => replace it!\r\n                var replaceString = replacePattern.buildReplaceString(nextMatch.matches, this._state.preserveCase);\r\n                var command = new ReplaceCommand(selection, replaceString);\r\n                this._executeEditorCommand('replace', command);\r\n                this._decorations.setStartPosition(new Position(selection.startLineNumber, selection.startColumn + replaceString.length));\r\n                this.research(true);\r\n            }\r\n            else {\r\n                this._decorations.setStartPosition(this._editor.getPosition());\r\n                this._setCurrentFindMatch(nextMatch.range);\r\n            }\r\n        }\r\n    };\r\n    FindModelBoundToEditorModel.prototype._findMatches = function (findScope, captureMatches, limitResultCount) {\r\n        var searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\r\n        return this._editor.getModel().findMatches(this._state.searchString, searchRange, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(92 /* wordSeparators */) : null, captureMatches, limitResultCount);\r\n    };\r\n    FindModelBoundToEditorModel.prototype.replaceAll = function () {\r\n        if (!this._hasMatches()) {\r\n            return;\r\n        }\r\n        var findScope = this._decorations.getFindScope();\r\n        if (findScope === null && this._state.matchesCount >= MATCHES_LIMIT) {\r\n            // Doing a replace on the entire file that is over ${MATCHES_LIMIT} matches\r\n            this._largeReplaceAll();\r\n        }\r\n        else {\r\n            this._regularReplaceAll(findScope);\r\n        }\r\n        this.research(false);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._largeReplaceAll = function () {\r\n        var searchParams = new SearchParams(this._state.searchString, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(92 /* wordSeparators */) : null);\r\n        var searchData = searchParams.parseSearchRequest();\r\n        if (!searchData) {\r\n            return;\r\n        }\r\n        var searchRegex = searchData.regex;\r\n        if (!searchRegex.multiline) {\r\n            var mod = 'mu';\r\n            if (searchRegex.ignoreCase) {\r\n                mod += 'i';\r\n            }\r\n            if (searchRegex.global) {\r\n                mod += 'g';\r\n            }\r\n            searchRegex = new RegExp(searchRegex.source, mod);\r\n        }\r\n        var model = this._editor.getModel();\r\n        var modelText = model.getValue(1 /* LF */);\r\n        var fullModelRange = model.getFullModelRange();\r\n        var replacePattern = this._getReplacePattern();\r\n        var resultText;\r\n        var preserveCase = this._state.preserveCase;\r\n        if (replacePattern.hasReplacementPatterns || preserveCase) {\r\n            resultText = modelText.replace(searchRegex, function () {\r\n                return replacePattern.buildReplaceString(arguments, preserveCase);\r\n            });\r\n        }\r\n        else {\r\n            resultText = modelText.replace(searchRegex, replacePattern.buildReplaceString(null, preserveCase));\r\n        }\r\n        var command = new ReplaceCommandThatPreservesSelection(fullModelRange, resultText, this._editor.getSelection());\r\n        this._executeEditorCommand('replaceAll', command);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._regularReplaceAll = function (findScope) {\r\n        var replacePattern = this._getReplacePattern();\r\n        // Get all the ranges (even more than the highlighted ones)\r\n        var matches = this._findMatches(findScope, replacePattern.hasReplacementPatterns || this._state.preserveCase, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        var replaceStrings = [];\r\n        for (var i = 0, len = matches.length; i < len; i++) {\r\n            replaceStrings[i] = replacePattern.buildReplaceString(matches[i].matches, this._state.preserveCase);\r\n        }\r\n        var command = new ReplaceAllCommand(this._editor.getSelection(), matches.map(function (m) { return m.range; }), replaceStrings);\r\n        this._executeEditorCommand('replaceAll', command);\r\n    };\r\n    FindModelBoundToEditorModel.prototype.selectAllMatches = function () {\r\n        if (!this._hasMatches()) {\r\n            return;\r\n        }\r\n        var findScope = this._decorations.getFindScope();\r\n        // Get all the ranges (even more than the highlighted ones)\r\n        var matches = this._findMatches(findScope, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        var selections = matches.map(function (m) { return new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn); });\r\n        // If one of the ranges is the editor selection, then maintain it as primary\r\n        var editorSelection = this._editor.getSelection();\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var sel = selections[i];\r\n            if (sel.equalsRange(editorSelection)) {\r\n                selections = [editorSelection].concat(selections.slice(0, i)).concat(selections.slice(i + 1));\r\n                break;\r\n            }\r\n        }\r\n        this._editor.setSelections(selections);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._executeEditorCommand = function (source, command) {\r\n        try {\r\n            this._ignoreModelContentChanged = true;\r\n            this._editor.pushUndoStop();\r\n            this._editor.executeCommand(source, command);\r\n            this._editor.pushUndoStop();\r\n        }\r\n        finally {\r\n            this._ignoreModelContentChanged = false;\r\n        }\r\n    };\r\n    return FindModelBoundToEditorModel;\r\n}());\r\nexport { FindModelBoundToEditorModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './checkbox.css';\r\nimport * as DOM from '../../dom.js';\r\nimport { Widget } from '../widget.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport * as objects from '../../../common/objects.js';\r\nvar defaultOpts = {\r\n    inputActiveOptionBorder: Color.fromHex('#007ACC00'),\r\n    inputActiveOptionBackground: Color.fromHex('#0E639C50')\r\n};\r\nvar Checkbox = /** @class */ (function (_super) {\r\n    __extends(Checkbox, _super);\r\n    function Checkbox(opts) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onChange = _this._register(new Emitter());\r\n        _this.onChange = _this._onChange.event;\r\n        _this._onKeyDown = _this._register(new Emitter());\r\n        _this.onKeyDown = _this._onKeyDown.event;\r\n        _this._opts = objects.deepClone(opts);\r\n        objects.mixin(_this._opts, defaultOpts, false);\r\n        _this._checked = _this._opts.isChecked;\r\n        _this.domNode = document.createElement('div');\r\n        _this.domNode.title = _this._opts.title;\r\n        _this.domNode.className = 'monaco-custom-checkbox codicon ' + (_this._opts.actionClassName || '') + ' ' + (_this._checked ? 'checked' : 'unchecked');\r\n        _this.domNode.tabIndex = 0;\r\n        _this.domNode.setAttribute('role', 'checkbox');\r\n        _this.domNode.setAttribute('aria-checked', String(_this._checked));\r\n        _this.domNode.setAttribute('aria-label', _this._opts.title);\r\n        _this.applyStyles();\r\n        _this.onclick(_this.domNode, function (ev) {\r\n            _this.checked = !_this._checked;\r\n            _this._onChange.fire(false);\r\n            ev.preventDefault();\r\n        });\r\n        _this.ignoreGesture(_this.domNode);\r\n        _this.onkeydown(_this.domNode, function (keyboardEvent) {\r\n            if (keyboardEvent.keyCode === 10 /* Space */ || keyboardEvent.keyCode === 3 /* Enter */) {\r\n                _this.checked = !_this._checked;\r\n                _this._onChange.fire(true);\r\n                keyboardEvent.preventDefault();\r\n                return;\r\n            }\r\n            _this._onKeyDown.fire(keyboardEvent);\r\n        });\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Checkbox.prototype, \"enabled\", {\r\n        get: function () {\r\n            return this.domNode.getAttribute('aria-disabled') !== 'true';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Checkbox.prototype.focus = function () {\r\n        this.domNode.focus();\r\n    };\r\n    Object.defineProperty(Checkbox.prototype, \"checked\", {\r\n        get: function () {\r\n            return this._checked;\r\n        },\r\n        set: function (newIsChecked) {\r\n            this._checked = newIsChecked;\r\n            this.domNode.setAttribute('aria-checked', String(this._checked));\r\n            if (this._checked) {\r\n                this.domNode.classList.add('checked');\r\n            }\r\n            else {\r\n                this.domNode.classList.remove('checked');\r\n            }\r\n            this.applyStyles();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Checkbox.prototype.width = function () {\r\n        return 2 /*marginleft*/ + 2 /*border*/ + 2 /*padding*/ + 16 /* icon width */;\r\n    };\r\n    Checkbox.prototype.style = function (styles) {\r\n        if (styles.inputActiveOptionBorder) {\r\n            this._opts.inputActiveOptionBorder = styles.inputActiveOptionBorder;\r\n        }\r\n        if (styles.inputActiveOptionBackground) {\r\n            this._opts.inputActiveOptionBackground = styles.inputActiveOptionBackground;\r\n        }\r\n        this.applyStyles();\r\n    };\r\n    Checkbox.prototype.applyStyles = function () {\r\n        if (this.domNode) {\r\n            this.domNode.style.borderColor = this._checked && this._opts.inputActiveOptionBorder ? this._opts.inputActiveOptionBorder.toString() : 'transparent';\r\n            this.domNode.style.backgroundColor = this._checked && this._opts.inputActiveOptionBackground ? this._opts.inputActiveOptionBackground.toString() : 'transparent';\r\n        }\r\n    };\r\n    Checkbox.prototype.enable = function () {\r\n        this.domNode.tabIndex = 0;\r\n        this.domNode.setAttribute('aria-disabled', String(false));\r\n    };\r\n    Checkbox.prototype.disable = function () {\r\n        DOM.removeTabIndexAndUpdateFocus(this.domNode);\r\n        this.domNode.setAttribute('aria-disabled', String(true));\r\n    };\r\n    return Checkbox;\r\n}(Widget));\r\nexport { Checkbox };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Checkbox } from '../checkbox/checkbox.js';\r\nimport * as nls from '../../../../nls.js';\r\nvar NLS_CASE_SENSITIVE_CHECKBOX_LABEL = nls.localize('caseDescription', \"Match Case\");\r\nvar NLS_WHOLE_WORD_CHECKBOX_LABEL = nls.localize('wordsDescription', \"Match Whole Word\");\r\nvar NLS_REGEX_CHECKBOX_LABEL = nls.localize('regexDescription', \"Use Regular Expression\");\r\nvar CaseSensitiveCheckbox = /** @class */ (function (_super) {\r\n    __extends(CaseSensitiveCheckbox, _super);\r\n    function CaseSensitiveCheckbox(opts) {\r\n        return _super.call(this, {\r\n            actionClassName: 'codicon-case-sensitive',\r\n            title: NLS_CASE_SENSITIVE_CHECKBOX_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        }) || this;\r\n    }\r\n    return CaseSensitiveCheckbox;\r\n}(Checkbox));\r\nexport { CaseSensitiveCheckbox };\r\nvar WholeWordsCheckbox = /** @class */ (function (_super) {\r\n    __extends(WholeWordsCheckbox, _super);\r\n    function WholeWordsCheckbox(opts) {\r\n        return _super.call(this, {\r\n            actionClassName: 'codicon-whole-word',\r\n            title: NLS_WHOLE_WORD_CHECKBOX_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        }) || this;\r\n    }\r\n    return WholeWordsCheckbox;\r\n}(Checkbox));\r\nexport { WholeWordsCheckbox };\r\nvar RegexCheckbox = /** @class */ (function (_super) {\r\n    __extends(RegexCheckbox, _super);\r\n    function RegexCheckbox(opts) {\r\n        return _super.call(this, {\r\n            actionClassName: 'codicon-regex',\r\n            title: NLS_REGEX_CHECKBOX_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        }) || this;\r\n    }\r\n    return RegexCheckbox;\r\n}(Checkbox));\r\nexport { RegexCheckbox };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { CaseSensitiveCheckbox, RegexCheckbox, WholeWordsCheckbox } from '../../../base/browser/ui/findinput/findInputCheckboxes.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { FIND_IDS } from './findModel.js';\r\nimport { contrastBorder, editorWidgetBackground, inputActiveOptionBorder, inputActiveOptionBackground, widgetShadow, editorWidgetForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nvar FindOptionsWidget = /** @class */ (function (_super) {\r\n    __extends(FindOptionsWidget, _super);\r\n    function FindOptionsWidget(editor, state, keybindingService, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._hideSoon = _this._register(new RunOnceScheduler(function () { return _this._hide(); }, 2000));\r\n        _this._isVisible = false;\r\n        _this._editor = editor;\r\n        _this._state = state;\r\n        _this._keybindingService = keybindingService;\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'findOptionsWidget';\r\n        _this._domNode.style.display = 'none';\r\n        _this._domNode.style.top = '10px';\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        var inputActiveOptionBorderColor = themeService.getTheme().getColor(inputActiveOptionBorder);\r\n        var inputActiveOptionBackgroundColor = themeService.getTheme().getColor(inputActiveOptionBackground);\r\n        _this.caseSensitive = _this._register(new CaseSensitiveCheckbox({\r\n            appendTitle: _this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\r\n            isChecked: _this._state.matchCase,\r\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\r\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\r\n        }));\r\n        _this._domNode.appendChild(_this.caseSensitive.domNode);\r\n        _this._register(_this.caseSensitive.onChange(function () {\r\n            _this._state.change({\r\n                matchCase: _this.caseSensitive.checked\r\n            }, false);\r\n        }));\r\n        _this.wholeWords = _this._register(new WholeWordsCheckbox({\r\n            appendTitle: _this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\r\n            isChecked: _this._state.wholeWord,\r\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\r\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\r\n        }));\r\n        _this._domNode.appendChild(_this.wholeWords.domNode);\r\n        _this._register(_this.wholeWords.onChange(function () {\r\n            _this._state.change({\r\n                wholeWord: _this.wholeWords.checked\r\n            }, false);\r\n        }));\r\n        _this.regex = _this._register(new RegexCheckbox({\r\n            appendTitle: _this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\r\n            isChecked: _this._state.isRegex,\r\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\r\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\r\n        }));\r\n        _this._domNode.appendChild(_this.regex.domNode);\r\n        _this._register(_this.regex.onChange(function () {\r\n            _this._state.change({\r\n                isRegex: _this.regex.checked\r\n            }, false);\r\n        }));\r\n        _this._editor.addOverlayWidget(_this);\r\n        _this._register(_this._state.onFindReplaceStateChange(function (e) {\r\n            var somethingChanged = false;\r\n            if (e.isRegex) {\r\n                _this.regex.checked = _this._state.isRegex;\r\n                somethingChanged = true;\r\n            }\r\n            if (e.wholeWord) {\r\n                _this.wholeWords.checked = _this._state.wholeWord;\r\n                somethingChanged = true;\r\n            }\r\n            if (e.matchCase) {\r\n                _this.caseSensitive.checked = _this._state.matchCase;\r\n                somethingChanged = true;\r\n            }\r\n            if (!_this._state.isRevealed && somethingChanged) {\r\n                _this._revealTemporarily();\r\n            }\r\n        }));\r\n        _this._register(dom.addDisposableNonBubblingMouseOutListener(_this._domNode, function (e) { return _this._onMouseOut(); }));\r\n        _this._register(dom.addDisposableListener(_this._domNode, 'mouseover', function (e) { return _this._onMouseOver(); }));\r\n        _this._applyTheme(themeService.getTheme());\r\n        _this._register(themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        return _this;\r\n    }\r\n    FindOptionsWidget.prototype._keybindingLabelFor = function (actionId) {\r\n        var kb = this._keybindingService.lookupKeybinding(actionId);\r\n        if (!kb) {\r\n            return '';\r\n        }\r\n        return \" (\" + kb.getLabel() + \")\";\r\n    };\r\n    FindOptionsWidget.prototype.dispose = function () {\r\n        this._editor.removeOverlayWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // ----- IOverlayWidget API\r\n    FindOptionsWidget.prototype.getId = function () {\r\n        return FindOptionsWidget.ID;\r\n    };\r\n    FindOptionsWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    FindOptionsWidget.prototype.getPosition = function () {\r\n        return {\r\n            preference: 0 /* TOP_RIGHT_CORNER */\r\n        };\r\n    };\r\n    FindOptionsWidget.prototype.highlightFindOptions = function () {\r\n        this._revealTemporarily();\r\n    };\r\n    FindOptionsWidget.prototype._revealTemporarily = function () {\r\n        this._show();\r\n        this._hideSoon.schedule();\r\n    };\r\n    FindOptionsWidget.prototype._onMouseOut = function () {\r\n        this._hideSoon.schedule();\r\n    };\r\n    FindOptionsWidget.prototype._onMouseOver = function () {\r\n        this._hideSoon.cancel();\r\n    };\r\n    FindOptionsWidget.prototype._show = function () {\r\n        if (this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = true;\r\n        this._domNode.style.display = 'block';\r\n    };\r\n    FindOptionsWidget.prototype._hide = function () {\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = false;\r\n        this._domNode.style.display = 'none';\r\n    };\r\n    FindOptionsWidget.prototype._applyTheme = function (theme) {\r\n        var inputStyles = {\r\n            inputActiveOptionBorder: theme.getColor(inputActiveOptionBorder),\r\n            inputActiveOptionBackground: theme.getColor(inputActiveOptionBackground)\r\n        };\r\n        this.caseSensitive.style(inputStyles);\r\n        this.wholeWords.style(inputStyles);\r\n        this.regex.style(inputStyles);\r\n    };\r\n    FindOptionsWidget.ID = 'editor.contrib.findOptionsWidget';\r\n    return FindOptionsWidget;\r\n}(Widget));\r\nexport { FindOptionsWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var widgetBackground = theme.getColor(editorWidgetBackground);\r\n    if (widgetBackground) {\r\n        collector.addRule(\".monaco-editor .findOptionsWidget { background-color: \" + widgetBackground + \"; }\");\r\n    }\r\n    var widgetForeground = theme.getColor(editorWidgetForeground);\r\n    if (widgetForeground) {\r\n        collector.addRule(\".monaco-editor .findOptionsWidget { color: \" + widgetForeground + \"; }\");\r\n    }\r\n    var widgetShadowColor = theme.getColor(widgetShadow);\r\n    if (widgetShadowColor) {\r\n        collector.addRule(\".monaco-editor .findOptionsWidget { box-shadow: 0 2px 8px \" + widgetShadowColor + \"; }\");\r\n    }\r\n    var hcBorder = theme.getColor(contrastBorder);\r\n    if (hcBorder) {\r\n        collector.addRule(\".monaco-editor .findOptionsWidget { border: 2px solid \" + hcBorder + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nfunction effectiveOptionValue(override, value) {\r\n    if (override === 1 /* True */) {\r\n        return true;\r\n    }\r\n    if (override === 2 /* False */) {\r\n        return false;\r\n    }\r\n    return value;\r\n}\r\nvar FindReplaceState = /** @class */ (function (_super) {\r\n    __extends(FindReplaceState, _super);\r\n    function FindReplaceState() {\r\n        var _this = _super.call(this) || this;\r\n        _this._onFindReplaceStateChange = _this._register(new Emitter());\r\n        _this.onFindReplaceStateChange = _this._onFindReplaceStateChange.event;\r\n        _this._searchString = '';\r\n        _this._replaceString = '';\r\n        _this._isRevealed = false;\r\n        _this._isReplaceRevealed = false;\r\n        _this._isRegex = false;\r\n        _this._isRegexOverride = 0 /* NotSet */;\r\n        _this._wholeWord = false;\r\n        _this._wholeWordOverride = 0 /* NotSet */;\r\n        _this._matchCase = false;\r\n        _this._matchCaseOverride = 0 /* NotSet */;\r\n        _this._preserveCase = false;\r\n        _this._preserveCaseOverride = 0 /* NotSet */;\r\n        _this._searchScope = null;\r\n        _this._matchesPosition = 0;\r\n        _this._matchesCount = 0;\r\n        _this._currentMatch = null;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(FindReplaceState.prototype, \"searchString\", {\r\n        get: function () { return this._searchString; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"replaceString\", {\r\n        get: function () { return this._replaceString; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"isRevealed\", {\r\n        get: function () { return this._isRevealed; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"isReplaceRevealed\", {\r\n        get: function () { return this._isReplaceRevealed; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"isRegex\", {\r\n        get: function () { return effectiveOptionValue(this._isRegexOverride, this._isRegex); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"wholeWord\", {\r\n        get: function () { return effectiveOptionValue(this._wholeWordOverride, this._wholeWord); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"matchCase\", {\r\n        get: function () { return effectiveOptionValue(this._matchCaseOverride, this._matchCase); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"preserveCase\", {\r\n        get: function () { return effectiveOptionValue(this._preserveCaseOverride, this._preserveCase); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"actualIsRegex\", {\r\n        get: function () { return this._isRegex; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"actualWholeWord\", {\r\n        get: function () { return this._wholeWord; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"actualMatchCase\", {\r\n        get: function () { return this._matchCase; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"actualPreserveCase\", {\r\n        get: function () { return this._preserveCase; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"searchScope\", {\r\n        get: function () { return this._searchScope; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"matchesPosition\", {\r\n        get: function () { return this._matchesPosition; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"matchesCount\", {\r\n        get: function () { return this._matchesCount; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"currentMatch\", {\r\n        get: function () { return this._currentMatch; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FindReplaceState.prototype.changeMatchInfo = function (matchesPosition, matchesCount, currentMatch) {\r\n        var changeEvent = {\r\n            moveCursor: false,\r\n            updateHistory: false,\r\n            searchString: false,\r\n            replaceString: false,\r\n            isRevealed: false,\r\n            isReplaceRevealed: false,\r\n            isRegex: false,\r\n            wholeWord: false,\r\n            matchCase: false,\r\n            preserveCase: false,\r\n            searchScope: false,\r\n            matchesPosition: false,\r\n            matchesCount: false,\r\n            currentMatch: false\r\n        };\r\n        var somethingChanged = false;\r\n        if (matchesCount === 0) {\r\n            matchesPosition = 0;\r\n        }\r\n        if (matchesPosition > matchesCount) {\r\n            matchesPosition = matchesCount;\r\n        }\r\n        if (this._matchesPosition !== matchesPosition) {\r\n            this._matchesPosition = matchesPosition;\r\n            changeEvent.matchesPosition = true;\r\n            somethingChanged = true;\r\n        }\r\n        if (this._matchesCount !== matchesCount) {\r\n            this._matchesCount = matchesCount;\r\n            changeEvent.matchesCount = true;\r\n            somethingChanged = true;\r\n        }\r\n        if (typeof currentMatch !== 'undefined') {\r\n            if (!Range.equalsRange(this._currentMatch, currentMatch)) {\r\n                this._currentMatch = currentMatch;\r\n                changeEvent.currentMatch = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (somethingChanged) {\r\n            this._onFindReplaceStateChange.fire(changeEvent);\r\n        }\r\n    };\r\n    FindReplaceState.prototype.change = function (newState, moveCursor, updateHistory) {\r\n        if (updateHistory === void 0) { updateHistory = true; }\r\n        var changeEvent = {\r\n            moveCursor: moveCursor,\r\n            updateHistory: updateHistory,\r\n            searchString: false,\r\n            replaceString: false,\r\n            isRevealed: false,\r\n            isReplaceRevealed: false,\r\n            isRegex: false,\r\n            wholeWord: false,\r\n            matchCase: false,\r\n            preserveCase: false,\r\n            searchScope: false,\r\n            matchesPosition: false,\r\n            matchesCount: false,\r\n            currentMatch: false\r\n        };\r\n        var somethingChanged = false;\r\n        var oldEffectiveIsRegex = this.isRegex;\r\n        var oldEffectiveWholeWords = this.wholeWord;\r\n        var oldEffectiveMatchCase = this.matchCase;\r\n        var oldEffectivePreserveCase = this.preserveCase;\r\n        if (typeof newState.searchString !== 'undefined') {\r\n            if (this._searchString !== newState.searchString) {\r\n                this._searchString = newState.searchString;\r\n                changeEvent.searchString = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.replaceString !== 'undefined') {\r\n            if (this._replaceString !== newState.replaceString) {\r\n                this._replaceString = newState.replaceString;\r\n                changeEvent.replaceString = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.isRevealed !== 'undefined') {\r\n            if (this._isRevealed !== newState.isRevealed) {\r\n                this._isRevealed = newState.isRevealed;\r\n                changeEvent.isRevealed = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.isReplaceRevealed !== 'undefined') {\r\n            if (this._isReplaceRevealed !== newState.isReplaceRevealed) {\r\n                this._isReplaceRevealed = newState.isReplaceRevealed;\r\n                changeEvent.isReplaceRevealed = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.isRegex !== 'undefined') {\r\n            this._isRegex = newState.isRegex;\r\n        }\r\n        if (typeof newState.wholeWord !== 'undefined') {\r\n            this._wholeWord = newState.wholeWord;\r\n        }\r\n        if (typeof newState.matchCase !== 'undefined') {\r\n            this._matchCase = newState.matchCase;\r\n        }\r\n        if (typeof newState.preserveCase !== 'undefined') {\r\n            this._preserveCase = newState.preserveCase;\r\n        }\r\n        if (typeof newState.searchScope !== 'undefined') {\r\n            if (!Range.equalsRange(this._searchScope, newState.searchScope)) {\r\n                this._searchScope = newState.searchScope;\r\n                changeEvent.searchScope = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        // Overrides get set when they explicitly come in and get reset anytime something else changes\r\n        this._isRegexOverride = (typeof newState.isRegexOverride !== 'undefined' ? newState.isRegexOverride : 0 /* NotSet */);\r\n        this._wholeWordOverride = (typeof newState.wholeWordOverride !== 'undefined' ? newState.wholeWordOverride : 0 /* NotSet */);\r\n        this._matchCaseOverride = (typeof newState.matchCaseOverride !== 'undefined' ? newState.matchCaseOverride : 0 /* NotSet */);\r\n        this._preserveCaseOverride = (typeof newState.preserveCaseOverride !== 'undefined' ? newState.preserveCaseOverride : 0 /* NotSet */);\r\n        if (oldEffectiveIsRegex !== this.isRegex) {\r\n            somethingChanged = true;\r\n            changeEvent.isRegex = true;\r\n        }\r\n        if (oldEffectiveWholeWords !== this.wholeWord) {\r\n            somethingChanged = true;\r\n            changeEvent.wholeWord = true;\r\n        }\r\n        if (oldEffectiveMatchCase !== this.matchCase) {\r\n            somethingChanged = true;\r\n            changeEvent.matchCase = true;\r\n        }\r\n        if (oldEffectivePreserveCase !== this.preserveCase) {\r\n            somethingChanged = true;\r\n            changeEvent.preserveCase = true;\r\n        }\r\n        if (somethingChanged) {\r\n            this._onFindReplaceStateChange.fire(changeEvent);\r\n        }\r\n    };\r\n    return FindReplaceState;\r\n}(Disposable));\r\nexport { FindReplaceState };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as DOM from './dom.js';\r\nexport function renderText(text, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var element = createElement(options);\r\n    element.textContent = text;\r\n    return element;\r\n}\r\nexport function renderFormattedText(formattedText, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var element = createElement(options);\r\n    _renderFormattedText(element, parseFormattedText(formattedText), options.actionHandler);\r\n    return element;\r\n}\r\nexport function createElement(options) {\r\n    var tagName = options.inline ? 'span' : 'div';\r\n    var element = document.createElement(tagName);\r\n    if (options.className) {\r\n        element.className = options.className;\r\n    }\r\n    return element;\r\n}\r\nvar StringStream = /** @class */ (function () {\r\n    function StringStream(source) {\r\n        this.source = source;\r\n        this.index = 0;\r\n    }\r\n    StringStream.prototype.eos = function () {\r\n        return this.index >= this.source.length;\r\n    };\r\n    StringStream.prototype.next = function () {\r\n        var next = this.peek();\r\n        this.advance();\r\n        return next;\r\n    };\r\n    StringStream.prototype.peek = function () {\r\n        return this.source[this.index];\r\n    };\r\n    StringStream.prototype.advance = function () {\r\n        this.index++;\r\n    };\r\n    return StringStream;\r\n}());\r\nfunction _renderFormattedText(element, treeNode, actionHandler) {\r\n    var child;\r\n    if (treeNode.type === 2 /* Text */) {\r\n        child = document.createTextNode(treeNode.content || '');\r\n    }\r\n    else if (treeNode.type === 3 /* Bold */) {\r\n        child = document.createElement('b');\r\n    }\r\n    else if (treeNode.type === 4 /* Italics */) {\r\n        child = document.createElement('i');\r\n    }\r\n    else if (treeNode.type === 5 /* Action */ && actionHandler) {\r\n        var a = document.createElement('a');\r\n        a.href = '#';\r\n        actionHandler.disposeables.add(DOM.addStandardDisposableListener(a, 'click', function (event) {\r\n            actionHandler.callback(String(treeNode.index), event);\r\n        }));\r\n        child = a;\r\n    }\r\n    else if (treeNode.type === 7 /* NewLine */) {\r\n        child = document.createElement('br');\r\n    }\r\n    else if (treeNode.type === 1 /* Root */) {\r\n        child = element;\r\n    }\r\n    if (child && element !== child) {\r\n        element.appendChild(child);\r\n    }\r\n    if (child && Array.isArray(treeNode.children)) {\r\n        treeNode.children.forEach(function (nodeChild) {\r\n            _renderFormattedText(child, nodeChild, actionHandler);\r\n        });\r\n    }\r\n}\r\nfunction parseFormattedText(content) {\r\n    var root = {\r\n        type: 1 /* Root */,\r\n        children: []\r\n    };\r\n    var actionViewItemIndex = 0;\r\n    var current = root;\r\n    var stack = [];\r\n    var stream = new StringStream(content);\r\n    while (!stream.eos()) {\r\n        var next = stream.next();\r\n        var isEscapedFormatType = (next === '\\\\' && formatTagType(stream.peek()) !== 0 /* Invalid */);\r\n        if (isEscapedFormatType) {\r\n            next = stream.next(); // unread the backslash if it escapes a format tag type\r\n        }\r\n        if (!isEscapedFormatType && isFormatTag(next) && next === stream.peek()) {\r\n            stream.advance();\r\n            if (current.type === 2 /* Text */) {\r\n                current = stack.pop();\r\n            }\r\n            var type = formatTagType(next);\r\n            if (current.type === type || (current.type === 5 /* Action */ && type === 6 /* ActionClose */)) {\r\n                current = stack.pop();\r\n            }\r\n            else {\r\n                var newCurrent = {\r\n                    type: type,\r\n                    children: []\r\n                };\r\n                if (type === 5 /* Action */) {\r\n                    newCurrent.index = actionViewItemIndex;\r\n                    actionViewItemIndex++;\r\n                }\r\n                current.children.push(newCurrent);\r\n                stack.push(current);\r\n                current = newCurrent;\r\n            }\r\n        }\r\n        else if (next === '\\n') {\r\n            if (current.type === 2 /* Text */) {\r\n                current = stack.pop();\r\n            }\r\n            current.children.push({\r\n                type: 7 /* NewLine */\r\n            });\r\n        }\r\n        else {\r\n            if (current.type !== 2 /* Text */) {\r\n                var textCurrent = {\r\n                    type: 2 /* Text */,\r\n                    content: next\r\n                };\r\n                current.children.push(textCurrent);\r\n                stack.push(current);\r\n                current = textCurrent;\r\n            }\r\n            else {\r\n                current.content += next;\r\n            }\r\n        }\r\n    }\r\n    if (current.type === 2 /* Text */) {\r\n        current = stack.pop();\r\n    }\r\n    if (stack.length) {\r\n        // incorrectly formatted string literal\r\n    }\r\n    return root;\r\n}\r\nfunction isFormatTag(char) {\r\n    return formatTagType(char) !== 0 /* Invalid */;\r\n}\r\nfunction formatTagType(char) {\r\n    switch (char) {\r\n        case '*':\r\n            return 3 /* Bold */;\r\n        case '_':\r\n            return 4 /* Italics */;\r\n        case '[':\r\n            return 5 /* Action */;\r\n        case ']':\r\n            return 6 /* ActionClose */;\r\n        default:\r\n            return 0 /* Invalid */;\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { ArrayNavigator } from './iterator.js';\r\nvar HistoryNavigator = /** @class */ (function () {\r\n    function HistoryNavigator(history, limit) {\r\n        if (history === void 0) { history = []; }\r\n        if (limit === void 0) { limit = 10; }\r\n        this._initialize(history);\r\n        this._limit = limit;\r\n        this._onChange();\r\n    }\r\n    HistoryNavigator.prototype.add = function (t) {\r\n        this._history.delete(t);\r\n        this._history.add(t);\r\n        this._onChange();\r\n    };\r\n    HistoryNavigator.prototype.next = function () {\r\n        return this._navigator.next();\r\n    };\r\n    HistoryNavigator.prototype.previous = function () {\r\n        return this._navigator.previous();\r\n    };\r\n    HistoryNavigator.prototype.current = function () {\r\n        return this._navigator.current();\r\n    };\r\n    HistoryNavigator.prototype.parent = function () {\r\n        return null;\r\n    };\r\n    HistoryNavigator.prototype.first = function () {\r\n        return this._navigator.first();\r\n    };\r\n    HistoryNavigator.prototype.last = function () {\r\n        return this._navigator.last();\r\n    };\r\n    HistoryNavigator.prototype.has = function (t) {\r\n        return this._history.has(t);\r\n    };\r\n    HistoryNavigator.prototype._onChange = function () {\r\n        this._reduceToLimit();\r\n        var elements = this._elements;\r\n        this._navigator = new ArrayNavigator(elements, 0, elements.length, elements.length);\r\n    };\r\n    HistoryNavigator.prototype._reduceToLimit = function () {\r\n        var data = this._elements;\r\n        if (data.length > this._limit) {\r\n            this._initialize(data.slice(data.length - this._limit));\r\n        }\r\n    };\r\n    HistoryNavigator.prototype._initialize = function (history) {\r\n        this._history = new Set();\r\n        for (var _i = 0, history_1 = history; _i < history_1.length; _i++) {\r\n            var entry = history_1[_i];\r\n            this._history.add(entry);\r\n        }\r\n    };\r\n    Object.defineProperty(HistoryNavigator.prototype, \"_elements\", {\r\n        get: function () {\r\n            var elements = [];\r\n            this._history.forEach(function (e) { return elements.push(e); });\r\n            return elements;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return HistoryNavigator;\r\n}());\r\nexport { HistoryNavigator };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './inputBox.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as Bal from '../../browser.js';\r\nimport * as dom from '../../dom.js';\r\nimport { renderFormattedText, renderText } from '../../formattedTextRenderer.js';\r\nimport * as aria from '../aria/aria.js';\r\nimport { ActionBar } from '../actionbar/actionbar.js';\r\nimport { Event, Emitter } from '../../../common/event.js';\r\nimport { Widget } from '../widget.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nimport { HistoryNavigator } from '../../../common/history.js';\r\nimport { ScrollableElement } from '../scrollbar/scrollableElement.js';\r\nimport { domEvent } from '../../event.js';\r\nvar $ = dom.$;\r\nvar defaultOpts = {\r\n    inputBackground: Color.fromHex('#3C3C3C'),\r\n    inputForeground: Color.fromHex('#CCCCCC'),\r\n    inputValidationInfoBorder: Color.fromHex('#55AAFF'),\r\n    inputValidationInfoBackground: Color.fromHex('#063B49'),\r\n    inputValidationWarningBorder: Color.fromHex('#B89500'),\r\n    inputValidationWarningBackground: Color.fromHex('#352A05'),\r\n    inputValidationErrorBorder: Color.fromHex('#BE1100'),\r\n    inputValidationErrorBackground: Color.fromHex('#5A1D1D')\r\n};\r\nvar InputBox = /** @class */ (function (_super) {\r\n    __extends(InputBox, _super);\r\n    function InputBox(container, contextViewProvider, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this.state = 'idle';\r\n        _this.maxHeight = Number.POSITIVE_INFINITY;\r\n        _this._onDidChange = _this._register(new Emitter());\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._onDidHeightChange = _this._register(new Emitter());\r\n        _this.onDidHeightChange = _this._onDidHeightChange.event;\r\n        _this.contextViewProvider = contextViewProvider;\r\n        _this.options = options || Object.create(null);\r\n        mixin(_this.options, defaultOpts, false);\r\n        _this.message = null;\r\n        _this.placeholder = _this.options.placeholder || '';\r\n        _this.ariaLabel = _this.options.ariaLabel || '';\r\n        _this.inputBackground = _this.options.inputBackground;\r\n        _this.inputForeground = _this.options.inputForeground;\r\n        _this.inputBorder = _this.options.inputBorder;\r\n        _this.inputValidationInfoBorder = _this.options.inputValidationInfoBorder;\r\n        _this.inputValidationInfoBackground = _this.options.inputValidationInfoBackground;\r\n        _this.inputValidationInfoForeground = _this.options.inputValidationInfoForeground;\r\n        _this.inputValidationWarningBorder = _this.options.inputValidationWarningBorder;\r\n        _this.inputValidationWarningBackground = _this.options.inputValidationWarningBackground;\r\n        _this.inputValidationWarningForeground = _this.options.inputValidationWarningForeground;\r\n        _this.inputValidationErrorBorder = _this.options.inputValidationErrorBorder;\r\n        _this.inputValidationErrorBackground = _this.options.inputValidationErrorBackground;\r\n        _this.inputValidationErrorForeground = _this.options.inputValidationErrorForeground;\r\n        if (_this.options.validationOptions) {\r\n            _this.validation = _this.options.validationOptions.validation;\r\n        }\r\n        _this.element = dom.append(container, $('.monaco-inputbox.idle'));\r\n        var tagName = _this.options.flexibleHeight ? 'textarea' : 'input';\r\n        var wrapper = dom.append(_this.element, $('.wrapper'));\r\n        _this.input = dom.append(wrapper, $(tagName + '.input.empty'));\r\n        _this.input.setAttribute('autocorrect', 'off');\r\n        _this.input.setAttribute('autocapitalize', 'off');\r\n        _this.input.setAttribute('spellcheck', 'false');\r\n        _this.onfocus(_this.input, function () { return dom.addClass(_this.element, 'synthetic-focus'); });\r\n        _this.onblur(_this.input, function () { return dom.removeClass(_this.element, 'synthetic-focus'); });\r\n        if (_this.options.flexibleHeight) {\r\n            _this.maxHeight = typeof _this.options.flexibleMaxHeight === 'number' ? _this.options.flexibleMaxHeight : Number.POSITIVE_INFINITY;\r\n            _this.mirror = dom.append(wrapper, $('div.mirror'));\r\n            _this.mirror.innerHTML = '&#160;';\r\n            _this.scrollableElement = new ScrollableElement(_this.element, { vertical: 1 /* Auto */ });\r\n            if (_this.options.flexibleWidth) {\r\n                _this.input.setAttribute('wrap', 'off');\r\n                _this.mirror.style.whiteSpace = 'pre';\r\n                _this.mirror.style.wordWrap = 'initial';\r\n            }\r\n            dom.append(container, _this.scrollableElement.getDomNode());\r\n            _this._register(_this.scrollableElement);\r\n            // from ScrollableElement to DOM\r\n            _this._register(_this.scrollableElement.onScroll(function (e) { return _this.input.scrollTop = e.scrollTop; }));\r\n            var onSelectionChange = Event.filter(domEvent(document, 'selectionchange'), function () {\r\n                var _a;\r\n                var selection = document.getSelection();\r\n                return ((_a = selection) === null || _a === void 0 ? void 0 : _a.anchorNode) === wrapper;\r\n            });\r\n            // from DOM to ScrollableElement\r\n            _this._register(onSelectionChange(_this.updateScrollDimensions, _this));\r\n            _this._register(_this.onDidHeightChange(_this.updateScrollDimensions, _this));\r\n        }\r\n        else {\r\n            _this.input.type = _this.options.type || 'text';\r\n            _this.input.setAttribute('wrap', 'off');\r\n        }\r\n        if (_this.ariaLabel) {\r\n            _this.input.setAttribute('aria-label', _this.ariaLabel);\r\n        }\r\n        if (_this.placeholder) {\r\n            _this.setPlaceHolder(_this.placeholder);\r\n        }\r\n        _this.oninput(_this.input, function () { return _this.onValueChange(); });\r\n        _this.onblur(_this.input, function () { return _this.onBlur(); });\r\n        _this.onfocus(_this.input, function () { return _this.onFocus(); });\r\n        // Add placeholder shim for IE because IE decides to hide the placeholder on focus (we dont want that!)\r\n        if (_this.placeholder && Bal.isIE) {\r\n            _this.onclick(_this.input, function (e) {\r\n                dom.EventHelper.stop(e, true);\r\n                _this.input.focus();\r\n            });\r\n        }\r\n        _this.ignoreGesture(_this.input);\r\n        setTimeout(function () { return _this.updateMirror(); }, 0);\r\n        // Support actions\r\n        if (_this.options.actions) {\r\n            _this.actionbar = _this._register(new ActionBar(_this.element));\r\n            _this.actionbar.push(_this.options.actions, { icon: true, label: false });\r\n        }\r\n        _this.applyStyles();\r\n        return _this;\r\n    }\r\n    InputBox.prototype.onBlur = function () {\r\n        this._hideMessage();\r\n    };\r\n    InputBox.prototype.onFocus = function () {\r\n        this._showMessage();\r\n    };\r\n    InputBox.prototype.setPlaceHolder = function (placeHolder) {\r\n        this.placeholder = placeHolder;\r\n        this.input.setAttribute('placeholder', placeHolder);\r\n        this.input.title = placeHolder;\r\n    };\r\n    InputBox.prototype.setAriaLabel = function (label) {\r\n        this.ariaLabel = label;\r\n        if (label) {\r\n            this.input.setAttribute('aria-label', this.ariaLabel);\r\n        }\r\n        else {\r\n            this.input.removeAttribute('aria-label');\r\n        }\r\n    };\r\n    Object.defineProperty(InputBox.prototype, \"inputElement\", {\r\n        get: function () {\r\n            return this.input;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InputBox.prototype, \"value\", {\r\n        get: function () {\r\n            return this.input.value;\r\n        },\r\n        set: function (newValue) {\r\n            if (this.input.value !== newValue) {\r\n                this.input.value = newValue;\r\n                this.onValueChange();\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InputBox.prototype, \"height\", {\r\n        get: function () {\r\n            return typeof this.cachedHeight === 'number' ? this.cachedHeight : dom.getTotalHeight(this.element);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    InputBox.prototype.focus = function () {\r\n        this.input.focus();\r\n    };\r\n    InputBox.prototype.blur = function () {\r\n        this.input.blur();\r\n    };\r\n    InputBox.prototype.hasFocus = function () {\r\n        return document.activeElement === this.input;\r\n    };\r\n    InputBox.prototype.select = function (range) {\r\n        if (range === void 0) { range = null; }\r\n        this.input.select();\r\n        if (range) {\r\n            this.input.setSelectionRange(range.start, range.end);\r\n        }\r\n    };\r\n    InputBox.prototype.enable = function () {\r\n        this.input.removeAttribute('disabled');\r\n    };\r\n    InputBox.prototype.disable = function () {\r\n        this.blur();\r\n        this.input.disabled = true;\r\n        this._hideMessage();\r\n    };\r\n    Object.defineProperty(InputBox.prototype, \"width\", {\r\n        get: function () {\r\n            return dom.getTotalWidth(this.input);\r\n        },\r\n        set: function (width) {\r\n            if (this.options.flexibleHeight && this.options.flexibleWidth) {\r\n                // textarea with horizontal scrolling\r\n                var horizontalPadding = 0;\r\n                if (this.mirror) {\r\n                    var paddingLeft = parseFloat(this.mirror.style.paddingLeft || '') || 0;\r\n                    var paddingRight = parseFloat(this.mirror.style.paddingRight || '') || 0;\r\n                    horizontalPadding = paddingLeft + paddingRight;\r\n                }\r\n                this.input.style.width = (width - horizontalPadding) + 'px';\r\n            }\r\n            else {\r\n                this.input.style.width = width + 'px';\r\n            }\r\n            if (this.mirror) {\r\n                this.mirror.style.width = width + 'px';\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InputBox.prototype, \"paddingRight\", {\r\n        set: function (paddingRight) {\r\n            if (this.options.flexibleHeight && this.options.flexibleWidth) {\r\n                this.input.style.width = \"calc(100% - \" + paddingRight + \"px)\";\r\n            }\r\n            else {\r\n                this.input.style.paddingRight = paddingRight + 'px';\r\n            }\r\n            if (this.mirror) {\r\n                this.mirror.style.paddingRight = paddingRight + 'px';\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    InputBox.prototype.updateScrollDimensions = function () {\r\n        if (typeof this.cachedContentHeight !== 'number' || typeof this.cachedHeight !== 'number' || !this.scrollableElement) {\r\n            return;\r\n        }\r\n        var scrollHeight = this.cachedContentHeight;\r\n        var height = this.cachedHeight;\r\n        var scrollTop = this.input.scrollTop;\r\n        this.scrollableElement.setScrollDimensions({ scrollHeight: scrollHeight, height: height });\r\n        this.scrollableElement.setScrollPosition({ scrollTop: scrollTop });\r\n    };\r\n    InputBox.prototype.showMessage = function (message, force) {\r\n        this.message = message;\r\n        dom.removeClass(this.element, 'idle');\r\n        dom.removeClass(this.element, 'info');\r\n        dom.removeClass(this.element, 'warning');\r\n        dom.removeClass(this.element, 'error');\r\n        dom.addClass(this.element, this.classForType(message.type));\r\n        var styles = this.stylesForType(this.message.type);\r\n        this.element.style.border = styles.border ? \"1px solid \" + styles.border : '';\r\n        // ARIA Support\r\n        var alertText;\r\n        if (message.type === 3 /* ERROR */) {\r\n            alertText = nls.localize('alertErrorMessage', \"Error: {0}\", message.content);\r\n        }\r\n        else if (message.type === 2 /* WARNING */) {\r\n            alertText = nls.localize('alertWarningMessage', \"Warning: {0}\", message.content);\r\n        }\r\n        else {\r\n            alertText = nls.localize('alertInfoMessage', \"Info: {0}\", message.content);\r\n        }\r\n        aria.alert(alertText);\r\n        if (this.hasFocus() || force) {\r\n            this._showMessage();\r\n        }\r\n    };\r\n    InputBox.prototype.hideMessage = function () {\r\n        this.message = null;\r\n        dom.removeClass(this.element, 'info');\r\n        dom.removeClass(this.element, 'warning');\r\n        dom.removeClass(this.element, 'error');\r\n        dom.addClass(this.element, 'idle');\r\n        this._hideMessage();\r\n        this.applyStyles();\r\n    };\r\n    InputBox.prototype.validate = function () {\r\n        var errorMsg = null;\r\n        if (this.validation) {\r\n            errorMsg = this.validation(this.value);\r\n            if (errorMsg) {\r\n                this.inputElement.setAttribute('aria-invalid', 'true');\r\n                this.showMessage(errorMsg);\r\n            }\r\n            else if (this.inputElement.hasAttribute('aria-invalid')) {\r\n                this.inputElement.removeAttribute('aria-invalid');\r\n                this.hideMessage();\r\n            }\r\n        }\r\n        return !errorMsg;\r\n    };\r\n    InputBox.prototype.stylesForType = function (type) {\r\n        switch (type) {\r\n            case 1 /* INFO */: return { border: this.inputValidationInfoBorder, background: this.inputValidationInfoBackground, foreground: this.inputValidationInfoForeground };\r\n            case 2 /* WARNING */: return { border: this.inputValidationWarningBorder, background: this.inputValidationWarningBackground, foreground: this.inputValidationWarningForeground };\r\n            default: return { border: this.inputValidationErrorBorder, background: this.inputValidationErrorBackground, foreground: this.inputValidationErrorForeground };\r\n        }\r\n    };\r\n    InputBox.prototype.classForType = function (type) {\r\n        switch (type) {\r\n            case 1 /* INFO */: return 'info';\r\n            case 2 /* WARNING */: return 'warning';\r\n            default: return 'error';\r\n        }\r\n    };\r\n    InputBox.prototype._showMessage = function () {\r\n        var _this = this;\r\n        if (!this.contextViewProvider || !this.message) {\r\n            return;\r\n        }\r\n        var div;\r\n        var layout = function () { return div.style.width = dom.getTotalWidth(_this.element) + 'px'; };\r\n        this.contextViewProvider.showContextView({\r\n            getAnchor: function () { return _this.element; },\r\n            anchorAlignment: 1 /* RIGHT */,\r\n            render: function (container) {\r\n                if (!_this.message) {\r\n                    return null;\r\n                }\r\n                div = dom.append(container, $('.monaco-inputbox-container'));\r\n                layout();\r\n                var renderOptions = {\r\n                    inline: true,\r\n                    className: 'monaco-inputbox-message'\r\n                };\r\n                var spanElement = (_this.message.formatContent\r\n                    ? renderFormattedText(_this.message.content, renderOptions)\r\n                    : renderText(_this.message.content, renderOptions));\r\n                dom.addClass(spanElement, _this.classForType(_this.message.type));\r\n                var styles = _this.stylesForType(_this.message.type);\r\n                spanElement.style.backgroundColor = styles.background ? styles.background.toString() : '';\r\n                spanElement.style.color = styles.foreground ? styles.foreground.toString() : null;\r\n                spanElement.style.border = styles.border ? \"1px solid \" + styles.border : '';\r\n                dom.append(div, spanElement);\r\n                return null;\r\n            },\r\n            onHide: function () {\r\n                _this.state = 'closed';\r\n            },\r\n            layout: layout\r\n        });\r\n        this.state = 'open';\r\n    };\r\n    InputBox.prototype._hideMessage = function () {\r\n        if (!this.contextViewProvider) {\r\n            return;\r\n        }\r\n        if (this.state === 'open') {\r\n            this.contextViewProvider.hideContextView();\r\n        }\r\n        this.state = 'idle';\r\n    };\r\n    InputBox.prototype.onValueChange = function () {\r\n        this._onDidChange.fire(this.value);\r\n        this.validate();\r\n        this.updateMirror();\r\n        dom.toggleClass(this.input, 'empty', !this.value);\r\n        if (this.state === 'open' && this.contextViewProvider) {\r\n            this.contextViewProvider.layout();\r\n        }\r\n    };\r\n    InputBox.prototype.updateMirror = function () {\r\n        if (!this.mirror) {\r\n            return;\r\n        }\r\n        var value = this.value;\r\n        var lastCharCode = value.charCodeAt(value.length - 1);\r\n        var suffix = lastCharCode === 10 ? ' ' : '';\r\n        var mirrorTextContent = value + suffix;\r\n        if (mirrorTextContent) {\r\n            this.mirror.textContent = value + suffix;\r\n        }\r\n        else {\r\n            this.mirror.innerHTML = '&#160;';\r\n        }\r\n        this.layout();\r\n    };\r\n    InputBox.prototype.style = function (styles) {\r\n        this.inputBackground = styles.inputBackground;\r\n        this.inputForeground = styles.inputForeground;\r\n        this.inputBorder = styles.inputBorder;\r\n        this.inputValidationInfoBackground = styles.inputValidationInfoBackground;\r\n        this.inputValidationInfoForeground = styles.inputValidationInfoForeground;\r\n        this.inputValidationInfoBorder = styles.inputValidationInfoBorder;\r\n        this.inputValidationWarningBackground = styles.inputValidationWarningBackground;\r\n        this.inputValidationWarningForeground = styles.inputValidationWarningForeground;\r\n        this.inputValidationWarningBorder = styles.inputValidationWarningBorder;\r\n        this.inputValidationErrorBackground = styles.inputValidationErrorBackground;\r\n        this.inputValidationErrorForeground = styles.inputValidationErrorForeground;\r\n        this.inputValidationErrorBorder = styles.inputValidationErrorBorder;\r\n        this.applyStyles();\r\n    };\r\n    InputBox.prototype.applyStyles = function () {\r\n        var background = this.inputBackground ? this.inputBackground.toString() : '';\r\n        var foreground = this.inputForeground ? this.inputForeground.toString() : '';\r\n        var border = this.inputBorder ? this.inputBorder.toString() : '';\r\n        this.element.style.backgroundColor = background;\r\n        this.element.style.color = foreground;\r\n        this.input.style.backgroundColor = background;\r\n        this.input.style.color = foreground;\r\n        this.element.style.borderWidth = border ? '1px' : '';\r\n        this.element.style.borderStyle = border ? 'solid' : '';\r\n        this.element.style.borderColor = border;\r\n    };\r\n    InputBox.prototype.layout = function () {\r\n        if (!this.mirror) {\r\n            return;\r\n        }\r\n        var previousHeight = this.cachedContentHeight;\r\n        this.cachedContentHeight = dom.getTotalHeight(this.mirror);\r\n        if (previousHeight !== this.cachedContentHeight) {\r\n            this.cachedHeight = Math.min(this.cachedContentHeight, this.maxHeight);\r\n            this.input.style.height = this.cachedHeight + 'px';\r\n            this._onDidHeightChange.fire(this.cachedContentHeight);\r\n        }\r\n    };\r\n    InputBox.prototype.insertAtCursor = function (text) {\r\n        var inputElement = this.inputElement;\r\n        var start = inputElement.selectionStart;\r\n        var end = inputElement.selectionEnd;\r\n        var content = inputElement.value;\r\n        if (start !== null && end !== null) {\r\n            this.value = content.substr(0, start) + text + content.substr(end);\r\n            inputElement.setSelectionRange(start + 1, start + 1);\r\n            this.layout();\r\n        }\r\n    };\r\n    InputBox.prototype.dispose = function () {\r\n        this._hideMessage();\r\n        this.message = null;\r\n        if (this.actionbar) {\r\n            this.actionbar.dispose();\r\n        }\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return InputBox;\r\n}(Widget));\r\nexport { InputBox };\r\nvar HistoryInputBox = /** @class */ (function (_super) {\r\n    __extends(HistoryInputBox, _super);\r\n    function HistoryInputBox(container, contextViewProvider, options) {\r\n        var _this = _super.call(this, container, contextViewProvider, options) || this;\r\n        _this.history = new HistoryNavigator(options.history, 100);\r\n        return _this;\r\n    }\r\n    HistoryInputBox.prototype.addToHistory = function () {\r\n        if (this.value && this.value !== this.getCurrentValue()) {\r\n            this.history.add(this.value);\r\n        }\r\n    };\r\n    HistoryInputBox.prototype.showNextValue = function () {\r\n        if (!this.history.has(this.value)) {\r\n            this.addToHistory();\r\n        }\r\n        var next = this.getNextValue();\r\n        if (next) {\r\n            next = next === this.value ? this.getNextValue() : next;\r\n        }\r\n        if (next) {\r\n            this.value = next;\r\n            aria.status(this.value);\r\n        }\r\n    };\r\n    HistoryInputBox.prototype.showPreviousValue = function () {\r\n        if (!this.history.has(this.value)) {\r\n            this.addToHistory();\r\n        }\r\n        var previous = this.getPreviousValue();\r\n        if (previous) {\r\n            previous = previous === this.value ? this.getPreviousValue() : previous;\r\n        }\r\n        if (previous) {\r\n            this.value = previous;\r\n            aria.status(this.value);\r\n        }\r\n    };\r\n    HistoryInputBox.prototype.getCurrentValue = function () {\r\n        var currentValue = this.history.current();\r\n        if (!currentValue) {\r\n            currentValue = this.history.last();\r\n            this.history.next();\r\n        }\r\n        return currentValue;\r\n    };\r\n    HistoryInputBox.prototype.getPreviousValue = function () {\r\n        return this.history.previous() || this.history.first();\r\n    };\r\n    HistoryInputBox.prototype.getNextValue = function () {\r\n        return this.history.next() || this.history.last();\r\n    };\r\n    return HistoryInputBox;\r\n}(InputBox));\r\nexport { HistoryInputBox };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './findInput.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as dom from '../../dom.js';\r\nimport { HistoryInputBox } from '../inputbox/inputBox.js';\r\nimport { Widget } from '../widget.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { CaseSensitiveCheckbox, WholeWordsCheckbox, RegexCheckbox } from './findInputCheckboxes.js';\r\nvar NLS_DEFAULT_LABEL = nls.localize('defaultLabel', \"input\");\r\nvar FindInput = /** @class */ (function (_super) {\r\n    __extends(FindInput, _super);\r\n    function FindInput(parent, contextViewProvider, _showOptionButtons, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this._showOptionButtons = _showOptionButtons;\r\n        _this.fixFocusOnOptionClickEnabled = true;\r\n        _this._onDidOptionChange = _this._register(new Emitter());\r\n        _this.onDidOptionChange = _this._onDidOptionChange.event;\r\n        _this._onKeyDown = _this._register(new Emitter());\r\n        _this.onKeyDown = _this._onKeyDown.event;\r\n        _this._onMouseDown = _this._register(new Emitter());\r\n        _this.onMouseDown = _this._onMouseDown.event;\r\n        _this._onInput = _this._register(new Emitter());\r\n        _this._onKeyUp = _this._register(new Emitter());\r\n        _this._onCaseSensitiveKeyDown = _this._register(new Emitter());\r\n        _this.onCaseSensitiveKeyDown = _this._onCaseSensitiveKeyDown.event;\r\n        _this._onRegexKeyDown = _this._register(new Emitter());\r\n        _this.onRegexKeyDown = _this._onRegexKeyDown.event;\r\n        _this._lastHighlightFindOptions = 0;\r\n        _this.contextViewProvider = contextViewProvider;\r\n        _this.placeholder = options.placeholder || '';\r\n        _this.validation = options.validation;\r\n        _this.label = options.label || NLS_DEFAULT_LABEL;\r\n        _this.inputActiveOptionBorder = options.inputActiveOptionBorder;\r\n        _this.inputActiveOptionBackground = options.inputActiveOptionBackground;\r\n        _this.inputBackground = options.inputBackground;\r\n        _this.inputForeground = options.inputForeground;\r\n        _this.inputBorder = options.inputBorder;\r\n        _this.inputValidationInfoBorder = options.inputValidationInfoBorder;\r\n        _this.inputValidationInfoBackground = options.inputValidationInfoBackground;\r\n        _this.inputValidationInfoForeground = options.inputValidationInfoForeground;\r\n        _this.inputValidationWarningBorder = options.inputValidationWarningBorder;\r\n        _this.inputValidationWarningBackground = options.inputValidationWarningBackground;\r\n        _this.inputValidationWarningForeground = options.inputValidationWarningForeground;\r\n        _this.inputValidationErrorBorder = options.inputValidationErrorBorder;\r\n        _this.inputValidationErrorBackground = options.inputValidationErrorBackground;\r\n        _this.inputValidationErrorForeground = options.inputValidationErrorForeground;\r\n        var appendCaseSensitiveLabel = options.appendCaseSensitiveLabel || '';\r\n        var appendWholeWordsLabel = options.appendWholeWordsLabel || '';\r\n        var appendRegexLabel = options.appendRegexLabel || '';\r\n        var history = options.history || [];\r\n        var flexibleHeight = !!options.flexibleHeight;\r\n        var flexibleWidth = !!options.flexibleWidth;\r\n        var flexibleMaxHeight = options.flexibleMaxHeight;\r\n        _this.domNode = document.createElement('div');\r\n        dom.addClass(_this.domNode, 'monaco-findInput');\r\n        _this.inputBox = _this._register(new HistoryInputBox(_this.domNode, _this.contextViewProvider, {\r\n            placeholder: _this.placeholder || '',\r\n            ariaLabel: _this.label || '',\r\n            validationOptions: {\r\n                validation: _this.validation\r\n            },\r\n            inputBackground: _this.inputBackground,\r\n            inputForeground: _this.inputForeground,\r\n            inputBorder: _this.inputBorder,\r\n            inputValidationInfoBackground: _this.inputValidationInfoBackground,\r\n            inputValidationInfoForeground: _this.inputValidationInfoForeground,\r\n            inputValidationInfoBorder: _this.inputValidationInfoBorder,\r\n            inputValidationWarningBackground: _this.inputValidationWarningBackground,\r\n            inputValidationWarningForeground: _this.inputValidationWarningForeground,\r\n            inputValidationWarningBorder: _this.inputValidationWarningBorder,\r\n            inputValidationErrorBackground: _this.inputValidationErrorBackground,\r\n            inputValidationErrorForeground: _this.inputValidationErrorForeground,\r\n            inputValidationErrorBorder: _this.inputValidationErrorBorder,\r\n            history: history,\r\n            flexibleHeight: flexibleHeight,\r\n            flexibleWidth: flexibleWidth,\r\n            flexibleMaxHeight: flexibleMaxHeight\r\n        }));\r\n        _this.regex = _this._register(new RegexCheckbox({\r\n            appendTitle: appendRegexLabel,\r\n            isChecked: false,\r\n            inputActiveOptionBorder: _this.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: _this.inputActiveOptionBackground\r\n        }));\r\n        _this._register(_this.regex.onChange(function (viaKeyboard) {\r\n            _this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && _this.fixFocusOnOptionClickEnabled) {\r\n                _this.inputBox.focus();\r\n            }\r\n            _this.validate();\r\n        }));\r\n        _this._register(_this.regex.onKeyDown(function (e) {\r\n            _this._onRegexKeyDown.fire(e);\r\n        }));\r\n        _this.wholeWords = _this._register(new WholeWordsCheckbox({\r\n            appendTitle: appendWholeWordsLabel,\r\n            isChecked: false,\r\n            inputActiveOptionBorder: _this.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: _this.inputActiveOptionBackground\r\n        }));\r\n        _this._register(_this.wholeWords.onChange(function (viaKeyboard) {\r\n            _this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && _this.fixFocusOnOptionClickEnabled) {\r\n                _this.inputBox.focus();\r\n            }\r\n            _this.validate();\r\n        }));\r\n        _this.caseSensitive = _this._register(new CaseSensitiveCheckbox({\r\n            appendTitle: appendCaseSensitiveLabel,\r\n            isChecked: false,\r\n            inputActiveOptionBorder: _this.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: _this.inputActiveOptionBackground\r\n        }));\r\n        _this._register(_this.caseSensitive.onChange(function (viaKeyboard) {\r\n            _this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && _this.fixFocusOnOptionClickEnabled) {\r\n                _this.inputBox.focus();\r\n            }\r\n            _this.validate();\r\n        }));\r\n        _this._register(_this.caseSensitive.onKeyDown(function (e) {\r\n            _this._onCaseSensitiveKeyDown.fire(e);\r\n        }));\r\n        if (_this._showOptionButtons) {\r\n            _this.inputBox.paddingRight = _this.caseSensitive.width() + _this.wholeWords.width() + _this.regex.width();\r\n        }\r\n        // Arrow-Key support to navigate between options\r\n        var indexes = [_this.caseSensitive.domNode, _this.wholeWords.domNode, _this.regex.domNode];\r\n        _this.onkeydown(_this.domNode, function (event) {\r\n            if (event.equals(15 /* LeftArrow */) || event.equals(17 /* RightArrow */) || event.equals(9 /* Escape */)) {\r\n                var index = indexes.indexOf(document.activeElement);\r\n                if (index >= 0) {\r\n                    var newIndex = -1;\r\n                    if (event.equals(17 /* RightArrow */)) {\r\n                        newIndex = (index + 1) % indexes.length;\r\n                    }\r\n                    else if (event.equals(15 /* LeftArrow */)) {\r\n                        if (index === 0) {\r\n                            newIndex = indexes.length - 1;\r\n                        }\r\n                        else {\r\n                            newIndex = index - 1;\r\n                        }\r\n                    }\r\n                    if (event.equals(9 /* Escape */)) {\r\n                        indexes[index].blur();\r\n                    }\r\n                    else if (newIndex >= 0) {\r\n                        indexes[newIndex].focus();\r\n                    }\r\n                    dom.EventHelper.stop(event, true);\r\n                }\r\n            }\r\n        });\r\n        var controls = document.createElement('div');\r\n        controls.className = 'controls';\r\n        controls.style.display = _this._showOptionButtons ? 'block' : 'none';\r\n        controls.appendChild(_this.caseSensitive.domNode);\r\n        controls.appendChild(_this.wholeWords.domNode);\r\n        controls.appendChild(_this.regex.domNode);\r\n        _this.domNode.appendChild(controls);\r\n        if (parent) {\r\n            parent.appendChild(_this.domNode);\r\n        }\r\n        _this.onkeydown(_this.inputBox.inputElement, function (e) { return _this._onKeyDown.fire(e); });\r\n        _this.onkeyup(_this.inputBox.inputElement, function (e) { return _this._onKeyUp.fire(e); });\r\n        _this.oninput(_this.inputBox.inputElement, function (e) { return _this._onInput.fire(); });\r\n        _this.onmousedown(_this.inputBox.inputElement, function (e) { return _this._onMouseDown.fire(e); });\r\n        return _this;\r\n    }\r\n    FindInput.prototype.enable = function () {\r\n        dom.removeClass(this.domNode, 'disabled');\r\n        this.inputBox.enable();\r\n        this.regex.enable();\r\n        this.wholeWords.enable();\r\n        this.caseSensitive.enable();\r\n    };\r\n    FindInput.prototype.disable = function () {\r\n        dom.addClass(this.domNode, 'disabled');\r\n        this.inputBox.disable();\r\n        this.regex.disable();\r\n        this.wholeWords.disable();\r\n        this.caseSensitive.disable();\r\n    };\r\n    FindInput.prototype.setFocusInputOnOptionClick = function (value) {\r\n        this.fixFocusOnOptionClickEnabled = value;\r\n    };\r\n    FindInput.prototype.setEnabled = function (enabled) {\r\n        if (enabled) {\r\n            this.enable();\r\n        }\r\n        else {\r\n            this.disable();\r\n        }\r\n    };\r\n    FindInput.prototype.getValue = function () {\r\n        return this.inputBox.value;\r\n    };\r\n    FindInput.prototype.setValue = function (value) {\r\n        if (this.inputBox.value !== value) {\r\n            this.inputBox.value = value;\r\n        }\r\n    };\r\n    FindInput.prototype.style = function (styles) {\r\n        this.inputActiveOptionBorder = styles.inputActiveOptionBorder;\r\n        this.inputActiveOptionBackground = styles.inputActiveOptionBackground;\r\n        this.inputBackground = styles.inputBackground;\r\n        this.inputForeground = styles.inputForeground;\r\n        this.inputBorder = styles.inputBorder;\r\n        this.inputValidationInfoBackground = styles.inputValidationInfoBackground;\r\n        this.inputValidationInfoForeground = styles.inputValidationInfoForeground;\r\n        this.inputValidationInfoBorder = styles.inputValidationInfoBorder;\r\n        this.inputValidationWarningBackground = styles.inputValidationWarningBackground;\r\n        this.inputValidationWarningForeground = styles.inputValidationWarningForeground;\r\n        this.inputValidationWarningBorder = styles.inputValidationWarningBorder;\r\n        this.inputValidationErrorBackground = styles.inputValidationErrorBackground;\r\n        this.inputValidationErrorForeground = styles.inputValidationErrorForeground;\r\n        this.inputValidationErrorBorder = styles.inputValidationErrorBorder;\r\n        this.applyStyles();\r\n    };\r\n    FindInput.prototype.applyStyles = function () {\r\n        if (this.domNode) {\r\n            var checkBoxStyles = {\r\n                inputActiveOptionBorder: this.inputActiveOptionBorder,\r\n                inputActiveOptionBackground: this.inputActiveOptionBackground,\r\n            };\r\n            this.regex.style(checkBoxStyles);\r\n            this.wholeWords.style(checkBoxStyles);\r\n            this.caseSensitive.style(checkBoxStyles);\r\n            var inputBoxStyles = {\r\n                inputBackground: this.inputBackground,\r\n                inputForeground: this.inputForeground,\r\n                inputBorder: this.inputBorder,\r\n                inputValidationInfoBackground: this.inputValidationInfoBackground,\r\n                inputValidationInfoForeground: this.inputValidationInfoForeground,\r\n                inputValidationInfoBorder: this.inputValidationInfoBorder,\r\n                inputValidationWarningBackground: this.inputValidationWarningBackground,\r\n                inputValidationWarningForeground: this.inputValidationWarningForeground,\r\n                inputValidationWarningBorder: this.inputValidationWarningBorder,\r\n                inputValidationErrorBackground: this.inputValidationErrorBackground,\r\n                inputValidationErrorForeground: this.inputValidationErrorForeground,\r\n                inputValidationErrorBorder: this.inputValidationErrorBorder\r\n            };\r\n            this.inputBox.style(inputBoxStyles);\r\n        }\r\n    };\r\n    FindInput.prototype.select = function () {\r\n        this.inputBox.select();\r\n    };\r\n    FindInput.prototype.focus = function () {\r\n        this.inputBox.focus();\r\n    };\r\n    FindInput.prototype.getCaseSensitive = function () {\r\n        return this.caseSensitive.checked;\r\n    };\r\n    FindInput.prototype.setCaseSensitive = function (value) {\r\n        this.caseSensitive.checked = value;\r\n    };\r\n    FindInput.prototype.getWholeWords = function () {\r\n        return this.wholeWords.checked;\r\n    };\r\n    FindInput.prototype.setWholeWords = function (value) {\r\n        this.wholeWords.checked = value;\r\n    };\r\n    FindInput.prototype.getRegex = function () {\r\n        return this.regex.checked;\r\n    };\r\n    FindInput.prototype.setRegex = function (value) {\r\n        this.regex.checked = value;\r\n        this.validate();\r\n    };\r\n    FindInput.prototype.focusOnCaseSensitive = function () {\r\n        this.caseSensitive.focus();\r\n    };\r\n    FindInput.prototype.highlightFindOptions = function () {\r\n        dom.removeClass(this.domNode, 'highlight-' + (this._lastHighlightFindOptions));\r\n        this._lastHighlightFindOptions = 1 - this._lastHighlightFindOptions;\r\n        dom.addClass(this.domNode, 'highlight-' + (this._lastHighlightFindOptions));\r\n    };\r\n    FindInput.prototype.validate = function () {\r\n        this.inputBox.validate();\r\n    };\r\n    FindInput.prototype.clearMessage = function () {\r\n        this.inputBox.hideMessage();\r\n    };\r\n    return FindInput;\r\n}(Widget));\r\nexport { FindInput };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './findInput.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as dom from '../../dom.js';\r\nimport { HistoryInputBox } from '../inputbox/inputBox.js';\r\nimport { Widget } from '../widget.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { Checkbox } from '../checkbox/checkbox.js';\r\nvar NLS_DEFAULT_LABEL = nls.localize('defaultLabel', \"input\");\r\nvar NLS_PRESERVE_CASE_LABEL = nls.localize('label.preserveCaseCheckbox', \"Preserve Case\");\r\nvar PreserveCaseCheckbox = /** @class */ (function (_super) {\r\n    __extends(PreserveCaseCheckbox, _super);\r\n    function PreserveCaseCheckbox(opts) {\r\n        return _super.call(this, {\r\n            // TODO: does this need its own icon?\r\n            actionClassName: 'codicon-preserve-case',\r\n            title: NLS_PRESERVE_CASE_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        }) || this;\r\n    }\r\n    return PreserveCaseCheckbox;\r\n}(Checkbox));\r\nexport { PreserveCaseCheckbox };\r\nvar ReplaceInput = /** @class */ (function (_super) {\r\n    __extends(ReplaceInput, _super);\r\n    function ReplaceInput(parent, contextViewProvider, _showOptionButtons, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this._showOptionButtons = _showOptionButtons;\r\n        _this.fixFocusOnOptionClickEnabled = true;\r\n        _this.cachedOptionsWidth = 0;\r\n        _this._onDidOptionChange = _this._register(new Emitter());\r\n        _this.onDidOptionChange = _this._onDidOptionChange.event;\r\n        _this._onKeyDown = _this._register(new Emitter());\r\n        _this.onKeyDown = _this._onKeyDown.event;\r\n        _this._onMouseDown = _this._register(new Emitter());\r\n        _this._onInput = _this._register(new Emitter());\r\n        _this._onKeyUp = _this._register(new Emitter());\r\n        _this._onPreserveCaseKeyDown = _this._register(new Emitter());\r\n        _this.onPreserveCaseKeyDown = _this._onPreserveCaseKeyDown.event;\r\n        _this.contextViewProvider = contextViewProvider;\r\n        _this.placeholder = options.placeholder || '';\r\n        _this.validation = options.validation;\r\n        _this.label = options.label || NLS_DEFAULT_LABEL;\r\n        _this.inputActiveOptionBorder = options.inputActiveOptionBorder;\r\n        _this.inputActiveOptionBackground = options.inputActiveOptionBackground;\r\n        _this.inputBackground = options.inputBackground;\r\n        _this.inputForeground = options.inputForeground;\r\n        _this.inputBorder = options.inputBorder;\r\n        _this.inputValidationInfoBorder = options.inputValidationInfoBorder;\r\n        _this.inputValidationInfoBackground = options.inputValidationInfoBackground;\r\n        _this.inputValidationInfoForeground = options.inputValidationInfoForeground;\r\n        _this.inputValidationWarningBorder = options.inputValidationWarningBorder;\r\n        _this.inputValidationWarningBackground = options.inputValidationWarningBackground;\r\n        _this.inputValidationWarningForeground = options.inputValidationWarningForeground;\r\n        _this.inputValidationErrorBorder = options.inputValidationErrorBorder;\r\n        _this.inputValidationErrorBackground = options.inputValidationErrorBackground;\r\n        _this.inputValidationErrorForeground = options.inputValidationErrorForeground;\r\n        var history = options.history || [];\r\n        var flexibleHeight = !!options.flexibleHeight;\r\n        var flexibleWidth = !!options.flexibleWidth;\r\n        var flexibleMaxHeight = options.flexibleMaxHeight;\r\n        _this.domNode = document.createElement('div');\r\n        dom.addClass(_this.domNode, 'monaco-findInput');\r\n        _this.inputBox = _this._register(new HistoryInputBox(_this.domNode, _this.contextViewProvider, {\r\n            ariaLabel: _this.label || '',\r\n            placeholder: _this.placeholder || '',\r\n            validationOptions: {\r\n                validation: _this.validation\r\n            },\r\n            inputBackground: _this.inputBackground,\r\n            inputForeground: _this.inputForeground,\r\n            inputBorder: _this.inputBorder,\r\n            inputValidationInfoBackground: _this.inputValidationInfoBackground,\r\n            inputValidationInfoForeground: _this.inputValidationInfoForeground,\r\n            inputValidationInfoBorder: _this.inputValidationInfoBorder,\r\n            inputValidationWarningBackground: _this.inputValidationWarningBackground,\r\n            inputValidationWarningForeground: _this.inputValidationWarningForeground,\r\n            inputValidationWarningBorder: _this.inputValidationWarningBorder,\r\n            inputValidationErrorBackground: _this.inputValidationErrorBackground,\r\n            inputValidationErrorForeground: _this.inputValidationErrorForeground,\r\n            inputValidationErrorBorder: _this.inputValidationErrorBorder,\r\n            history: history,\r\n            flexibleHeight: flexibleHeight,\r\n            flexibleWidth: flexibleWidth,\r\n            flexibleMaxHeight: flexibleMaxHeight\r\n        }));\r\n        _this.preserveCase = _this._register(new PreserveCaseCheckbox({\r\n            appendTitle: '',\r\n            isChecked: false,\r\n            inputActiveOptionBorder: _this.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: _this.inputActiveOptionBackground,\r\n        }));\r\n        _this._register(_this.preserveCase.onChange(function (viaKeyboard) {\r\n            _this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && _this.fixFocusOnOptionClickEnabled) {\r\n                _this.inputBox.focus();\r\n            }\r\n            _this.validate();\r\n        }));\r\n        _this._register(_this.preserveCase.onKeyDown(function (e) {\r\n            _this._onPreserveCaseKeyDown.fire(e);\r\n        }));\r\n        if (_this._showOptionButtons) {\r\n            _this.cachedOptionsWidth = _this.preserveCase.width();\r\n        }\r\n        else {\r\n            _this.cachedOptionsWidth = 0;\r\n        }\r\n        // Arrow-Key support to navigate between options\r\n        var indexes = [_this.preserveCase.domNode];\r\n        _this.onkeydown(_this.domNode, function (event) {\r\n            if (event.equals(15 /* LeftArrow */) || event.equals(17 /* RightArrow */) || event.equals(9 /* Escape */)) {\r\n                var index = indexes.indexOf(document.activeElement);\r\n                if (index >= 0) {\r\n                    var newIndex = -1;\r\n                    if (event.equals(17 /* RightArrow */)) {\r\n                        newIndex = (index + 1) % indexes.length;\r\n                    }\r\n                    else if (event.equals(15 /* LeftArrow */)) {\r\n                        if (index === 0) {\r\n                            newIndex = indexes.length - 1;\r\n                        }\r\n                        else {\r\n                            newIndex = index - 1;\r\n                        }\r\n                    }\r\n                    if (event.equals(9 /* Escape */)) {\r\n                        indexes[index].blur();\r\n                    }\r\n                    else if (newIndex >= 0) {\r\n                        indexes[newIndex].focus();\r\n                    }\r\n                    dom.EventHelper.stop(event, true);\r\n                }\r\n            }\r\n        });\r\n        var controls = document.createElement('div');\r\n        controls.className = 'controls';\r\n        controls.style.display = _this._showOptionButtons ? 'block' : 'none';\r\n        controls.appendChild(_this.preserveCase.domNode);\r\n        _this.domNode.appendChild(controls);\r\n        if (parent) {\r\n            parent.appendChild(_this.domNode);\r\n        }\r\n        _this.onkeydown(_this.inputBox.inputElement, function (e) { return _this._onKeyDown.fire(e); });\r\n        _this.onkeyup(_this.inputBox.inputElement, function (e) { return _this._onKeyUp.fire(e); });\r\n        _this.oninput(_this.inputBox.inputElement, function (e) { return _this._onInput.fire(); });\r\n        _this.onmousedown(_this.inputBox.inputElement, function (e) { return _this._onMouseDown.fire(e); });\r\n        return _this;\r\n    }\r\n    ReplaceInput.prototype.enable = function () {\r\n        dom.removeClass(this.domNode, 'disabled');\r\n        this.inputBox.enable();\r\n        this.preserveCase.enable();\r\n    };\r\n    ReplaceInput.prototype.disable = function () {\r\n        dom.addClass(this.domNode, 'disabled');\r\n        this.inputBox.disable();\r\n        this.preserveCase.disable();\r\n    };\r\n    ReplaceInput.prototype.setEnabled = function (enabled) {\r\n        if (enabled) {\r\n            this.enable();\r\n        }\r\n        else {\r\n            this.disable();\r\n        }\r\n    };\r\n    ReplaceInput.prototype.style = function (styles) {\r\n        this.inputActiveOptionBorder = styles.inputActiveOptionBorder;\r\n        this.inputActiveOptionBackground = styles.inputActiveOptionBackground;\r\n        this.inputBackground = styles.inputBackground;\r\n        this.inputForeground = styles.inputForeground;\r\n        this.inputBorder = styles.inputBorder;\r\n        this.inputValidationInfoBackground = styles.inputValidationInfoBackground;\r\n        this.inputValidationInfoForeground = styles.inputValidationInfoForeground;\r\n        this.inputValidationInfoBorder = styles.inputValidationInfoBorder;\r\n        this.inputValidationWarningBackground = styles.inputValidationWarningBackground;\r\n        this.inputValidationWarningForeground = styles.inputValidationWarningForeground;\r\n        this.inputValidationWarningBorder = styles.inputValidationWarningBorder;\r\n        this.inputValidationErrorBackground = styles.inputValidationErrorBackground;\r\n        this.inputValidationErrorForeground = styles.inputValidationErrorForeground;\r\n        this.inputValidationErrorBorder = styles.inputValidationErrorBorder;\r\n        this.applyStyles();\r\n    };\r\n    ReplaceInput.prototype.applyStyles = function () {\r\n        if (this.domNode) {\r\n            var checkBoxStyles = {\r\n                inputActiveOptionBorder: this.inputActiveOptionBorder,\r\n                inputActiveOptionBackground: this.inputActiveOptionBackground,\r\n            };\r\n            this.preserveCase.style(checkBoxStyles);\r\n            var inputBoxStyles = {\r\n                inputBackground: this.inputBackground,\r\n                inputForeground: this.inputForeground,\r\n                inputBorder: this.inputBorder,\r\n                inputValidationInfoBackground: this.inputValidationInfoBackground,\r\n                inputValidationInfoForeground: this.inputValidationInfoForeground,\r\n                inputValidationInfoBorder: this.inputValidationInfoBorder,\r\n                inputValidationWarningBackground: this.inputValidationWarningBackground,\r\n                inputValidationWarningForeground: this.inputValidationWarningForeground,\r\n                inputValidationWarningBorder: this.inputValidationWarningBorder,\r\n                inputValidationErrorBackground: this.inputValidationErrorBackground,\r\n                inputValidationErrorForeground: this.inputValidationErrorForeground,\r\n                inputValidationErrorBorder: this.inputValidationErrorBorder\r\n            };\r\n            this.inputBox.style(inputBoxStyles);\r\n        }\r\n    };\r\n    ReplaceInput.prototype.select = function () {\r\n        this.inputBox.select();\r\n    };\r\n    ReplaceInput.prototype.focus = function () {\r\n        this.inputBox.focus();\r\n    };\r\n    ReplaceInput.prototype.getPreserveCase = function () {\r\n        return this.preserveCase.checked;\r\n    };\r\n    ReplaceInput.prototype.setPreserveCase = function (value) {\r\n        this.preserveCase.checked = value;\r\n    };\r\n    ReplaceInput.prototype.focusOnPreserve = function () {\r\n        this.preserveCase.focus();\r\n    };\r\n    ReplaceInput.prototype.validate = function () {\r\n        if (this.inputBox) {\r\n            this.inputBox.validate();\r\n        }\r\n    };\r\n    Object.defineProperty(ReplaceInput.prototype, \"width\", {\r\n        set: function (newWidth) {\r\n            this.inputBox.paddingRight = this.cachedOptionsWidth;\r\n            this.inputBox.width = newWidth;\r\n            this.domNode.style.width = newWidth + 'px';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ReplaceInput.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return ReplaceInput;\r\n}(Widget));\r\nexport { ReplaceInput };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { IContextKeyService, ContextKeyExpr, RawContextKey } from '../contextkey/common/contextkey.js';\r\nimport { FindInput } from '../../base/browser/ui/findinput/findInput.js';\r\nimport { KeybindingsRegistry } from '../keybinding/common/keybindingsRegistry.js';\r\nimport { ReplaceInput } from '../../base/browser/ui/findinput/replaceInput.js';\r\nexport var HistoryNavigationWidgetContext = 'historyNavigationWidget';\r\nexport var HistoryNavigationEnablementContext = 'historyNavigationEnabled';\r\nfunction bindContextScopedWidget(contextKeyService, widget, contextKey) {\r\n    new RawContextKey(contextKey, widget).bindTo(contextKeyService);\r\n}\r\nfunction createWidgetScopedContextKeyService(contextKeyService, widget) {\r\n    return contextKeyService.createScoped(widget.target);\r\n}\r\nfunction getContextScopedWidget(contextKeyService, contextKey) {\r\n    return contextKeyService.getContext(document.activeElement).getValue(contextKey);\r\n}\r\nexport function createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService, widget) {\r\n    var scopedContextKeyService = createWidgetScopedContextKeyService(contextKeyService, widget);\r\n    bindContextScopedWidget(scopedContextKeyService, widget, HistoryNavigationWidgetContext);\r\n    var historyNavigationEnablement = new RawContextKey(HistoryNavigationEnablementContext, true).bindTo(scopedContextKeyService);\r\n    return { scopedContextKeyService: scopedContextKeyService, historyNavigationEnablement: historyNavigationEnablement };\r\n}\r\nvar ContextScopedFindInput = /** @class */ (function (_super) {\r\n    __extends(ContextScopedFindInput, _super);\r\n    function ContextScopedFindInput(container, contextViewProvider, options, contextKeyService, showFindOptions) {\r\n        if (showFindOptions === void 0) { showFindOptions = false; }\r\n        var _this = _super.call(this, container, contextViewProvider, showFindOptions, options) || this;\r\n        _this._register(createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService, { target: _this.inputBox.element, historyNavigator: _this.inputBox }).scopedContextKeyService);\r\n        return _this;\r\n    }\r\n    ContextScopedFindInput = __decorate([\r\n        __param(3, IContextKeyService)\r\n    ], ContextScopedFindInput);\r\n    return ContextScopedFindInput;\r\n}(FindInput));\r\nexport { ContextScopedFindInput };\r\nvar ContextScopedReplaceInput = /** @class */ (function (_super) {\r\n    __extends(ContextScopedReplaceInput, _super);\r\n    function ContextScopedReplaceInput(container, contextViewProvider, options, contextKeyService, showReplaceOptions) {\r\n        if (showReplaceOptions === void 0) { showReplaceOptions = false; }\r\n        var _this = _super.call(this, container, contextViewProvider, showReplaceOptions, options) || this;\r\n        _this._register(createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService, { target: _this.inputBox.element, historyNavigator: _this.inputBox }).scopedContextKeyService);\r\n        return _this;\r\n    }\r\n    ContextScopedReplaceInput = __decorate([\r\n        __param(3, IContextKeyService)\r\n    ], ContextScopedReplaceInput);\r\n    return ContextScopedReplaceInput;\r\n}(ReplaceInput));\r\nexport { ContextScopedReplaceInput };\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'history.showPrevious',\r\n    weight: 200 /* WorkbenchContrib */,\r\n    when: ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetContext), ContextKeyExpr.equals(HistoryNavigationEnablementContext, true)),\r\n    primary: 16 /* UpArrow */,\r\n    secondary: [512 /* Alt */ | 16 /* UpArrow */],\r\n    handler: function (accessor, arg2) {\r\n        var widget = getContextScopedWidget(accessor.get(IContextKeyService), HistoryNavigationWidgetContext);\r\n        if (widget) {\r\n            var historyInputBox = widget.historyNavigator;\r\n            historyInputBox.showPreviousValue();\r\n        }\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'history.showNext',\r\n    weight: 200 /* WorkbenchContrib */,\r\n    when: ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetContext), ContextKeyExpr.equals(HistoryNavigationEnablementContext, true)),\r\n    primary: 18 /* DownArrow */,\r\n    secondary: [512 /* Alt */ | 18 /* DownArrow */],\r\n    handler: function (accessor, arg2) {\r\n        var widget = getContextScopedWidget(accessor.get(IContextKeyService), HistoryNavigationWidgetContext);\r\n        if (widget) {\r\n            var historyInputBox = widget.historyNavigator;\r\n            historyInputBox.showNextValue();\r\n        }\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './findWidget.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { alert as alertFn } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Checkbox } from '../../../base/browser/ui/checkbox/checkbox.js';\r\nimport { Sash } from '../../../base/browser/ui/sash/sash.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nimport { Delayer } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { toDisposable } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_REPLACE_INPUT_FOCUSED, FIND_IDS, MATCHES_LIMIT } from './findModel.js';\r\nimport { contrastBorder, editorFindMatch, editorFindMatchBorder, editorFindMatchHighlight, editorFindMatchHighlightBorder, editorFindRangeHighlight, editorFindRangeHighlightBorder, editorWidgetBackground, editorWidgetBorder, editorWidgetResizeBorder, errorForeground, inputActiveOptionBorder, inputActiveOptionBackground, inputBackground, inputBorder, inputForeground, inputValidationErrorBackground, inputValidationErrorBorder, inputValidationErrorForeground, inputValidationInfoBackground, inputValidationInfoBorder, inputValidationInfoForeground, inputValidationWarningBackground, inputValidationWarningBorder, inputValidationWarningForeground, widgetShadow, editorWidgetForeground, focusBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { ContextScopedFindInput, ContextScopedReplaceInput } from '../../../platform/browser/contextScopedHistoryWidget.js';\r\nvar NLS_FIND_INPUT_LABEL = nls.localize('label.find', \"Find\");\r\nvar NLS_FIND_INPUT_PLACEHOLDER = nls.localize('placeholder.find', \"Find\");\r\nvar NLS_PREVIOUS_MATCH_BTN_LABEL = nls.localize('label.previousMatchButton', \"Previous match\");\r\nvar NLS_NEXT_MATCH_BTN_LABEL = nls.localize('label.nextMatchButton', \"Next match\");\r\nvar NLS_TOGGLE_SELECTION_FIND_TITLE = nls.localize('label.toggleSelectionFind', \"Find in selection\");\r\nvar NLS_CLOSE_BTN_LABEL = nls.localize('label.closeButton', \"Close\");\r\nvar NLS_REPLACE_INPUT_LABEL = nls.localize('label.replace', \"Replace\");\r\nvar NLS_REPLACE_INPUT_PLACEHOLDER = nls.localize('placeholder.replace', \"Replace\");\r\nvar NLS_REPLACE_BTN_LABEL = nls.localize('label.replaceButton', \"Replace\");\r\nvar NLS_REPLACE_ALL_BTN_LABEL = nls.localize('label.replaceAllButton', \"Replace All\");\r\nvar NLS_TOGGLE_REPLACE_MODE_BTN_LABEL = nls.localize('label.toggleReplaceButton', \"Toggle Replace mode\");\r\nvar NLS_MATCHES_COUNT_LIMIT_TITLE = nls.localize('title.matchesCountLimit', \"Only the first {0} results are highlighted, but all find operations work on the entire text.\", MATCHES_LIMIT);\r\nvar NLS_MATCHES_LOCATION = nls.localize('label.matchesLocation', \"{0} of {1}\");\r\nvar NLS_NO_RESULTS = nls.localize('label.noResults', \"No Results\");\r\nvar FIND_WIDGET_INITIAL_WIDTH = 419;\r\nvar PART_WIDTH = 275;\r\nvar FIND_INPUT_AREA_WIDTH = PART_WIDTH - 54;\r\nvar MAX_MATCHES_COUNT_WIDTH = 69;\r\n// let FIND_ALL_CONTROLS_WIDTH = 17/** Find Input margin-left */ + (MAX_MATCHES_COUNT_WIDTH + 3 + 1) /** Match Results */ + 23 /** Button */ * 4 + 2/** sash */;\r\nvar FIND_INPUT_AREA_HEIGHT = 33; // The height of Find Widget when Replace Input is not visible.\r\nvar ctrlEnterReplaceAllWarningPromptedKey = 'ctrlEnterReplaceAll.windows.donotask';\r\nvar ctrlKeyMod = (platform.isMacintosh ? 256 /* WinCtrl */ : 2048 /* CtrlCmd */);\r\nvar FindWidgetViewZone = /** @class */ (function () {\r\n    function FindWidgetViewZone(afterLineNumber) {\r\n        this.afterLineNumber = afterLineNumber;\r\n        this.heightInPx = FIND_INPUT_AREA_HEIGHT;\r\n        this.suppressMouseDown = false;\r\n        this.domNode = document.createElement('div');\r\n        this.domNode.className = 'dock-find-viewzone';\r\n    }\r\n    return FindWidgetViewZone;\r\n}());\r\nexport { FindWidgetViewZone };\r\nfunction stopPropagationForMultiLineUpwards(event, value, textarea) {\r\n    var isMultiline = !!value.match(/\\n/);\r\n    if (textarea && isMultiline && textarea.selectionStart > 0) {\r\n        event.stopPropagation();\r\n        return;\r\n    }\r\n}\r\nfunction stopPropagationForMultiLineDownwards(event, value, textarea) {\r\n    var isMultiline = !!value.match(/\\n/);\r\n    if (textarea && isMultiline && textarea.selectionEnd < textarea.value.length) {\r\n        event.stopPropagation();\r\n        return;\r\n    }\r\n}\r\nvar FindWidget = /** @class */ (function (_super) {\r\n    __extends(FindWidget, _super);\r\n    function FindWidget(codeEditor, controller, state, contextViewProvider, keybindingService, contextKeyService, themeService, storageService, notificationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._cachedHeight = null;\r\n        _this._codeEditor = codeEditor;\r\n        _this._controller = controller;\r\n        _this._state = state;\r\n        _this._contextViewProvider = contextViewProvider;\r\n        _this._keybindingService = keybindingService;\r\n        _this._contextKeyService = contextKeyService;\r\n        _this._storageService = storageService;\r\n        _this._notificationService = notificationService;\r\n        _this._ctrlEnterReplaceAllWarningPrompted = !!storageService.getBoolean(ctrlEnterReplaceAllWarningPromptedKey, 0 /* GLOBAL */);\r\n        _this._isVisible = false;\r\n        _this._isReplaceVisible = false;\r\n        _this._ignoreChangeEvent = false;\r\n        _this._updateHistoryDelayer = new Delayer(500);\r\n        _this._register(toDisposable(function () { return _this._updateHistoryDelayer.cancel(); }));\r\n        _this._register(_this._state.onFindReplaceStateChange(function (e) { return _this._onStateChanged(e); }));\r\n        _this._buildDomNode();\r\n        _this._updateButtons();\r\n        _this._tryUpdateWidgetWidth();\r\n        _this._findInput.inputBox.layout();\r\n        _this._register(_this._codeEditor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(65 /* readOnly */)) {\r\n                if (_this._codeEditor.getOption(65 /* readOnly */)) {\r\n                    // Hide replace part if editor becomes read only\r\n                    _this._state.change({ isReplaceRevealed: false }, false);\r\n                }\r\n                _this._updateButtons();\r\n            }\r\n            if (e.hasChanged(103 /* layoutInfo */)) {\r\n                _this._tryUpdateWidgetWidth();\r\n            }\r\n            if (e.hasChanged(2 /* accessibilitySupport */)) {\r\n                _this.updateAccessibilitySupport();\r\n            }\r\n            if (e.hasChanged(27 /* find */)) {\r\n                var addExtraSpaceOnTop = _this._codeEditor.getOption(27 /* find */).addExtraSpaceOnTop;\r\n                if (addExtraSpaceOnTop && !_this._viewZone) {\r\n                    _this._viewZone = new FindWidgetViewZone(0);\r\n                    _this._showViewZone();\r\n                }\r\n                if (!addExtraSpaceOnTop && _this._viewZone) {\r\n                    _this._removeViewZone();\r\n                }\r\n            }\r\n        }));\r\n        _this.updateAccessibilitySupport();\r\n        _this._register(_this._codeEditor.onDidChangeCursorSelection(function () {\r\n            if (_this._isVisible) {\r\n                _this._updateToggleSelectionFindButton();\r\n            }\r\n        }));\r\n        _this._register(_this._codeEditor.onDidFocusEditorWidget(function () {\r\n            if (_this._isVisible) {\r\n                var globalBufferTerm = _this._controller.getGlobalBufferTerm();\r\n                if (globalBufferTerm && globalBufferTerm !== _this._state.searchString) {\r\n                    _this._state.change({ searchString: globalBufferTerm }, true);\r\n                    _this._findInput.select();\r\n                }\r\n            }\r\n        }));\r\n        _this._findInputFocused = CONTEXT_FIND_INPUT_FOCUSED.bindTo(contextKeyService);\r\n        _this._findFocusTracker = _this._register(dom.trackFocus(_this._findInput.inputBox.inputElement));\r\n        _this._register(_this._findFocusTracker.onDidFocus(function () {\r\n            _this._findInputFocused.set(true);\r\n            _this._updateSearchScope();\r\n        }));\r\n        _this._register(_this._findFocusTracker.onDidBlur(function () {\r\n            _this._findInputFocused.set(false);\r\n        }));\r\n        _this._replaceInputFocused = CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(contextKeyService);\r\n        _this._replaceFocusTracker = _this._register(dom.trackFocus(_this._replaceInput.inputBox.inputElement));\r\n        _this._register(_this._replaceFocusTracker.onDidFocus(function () {\r\n            _this._replaceInputFocused.set(true);\r\n            _this._updateSearchScope();\r\n        }));\r\n        _this._register(_this._replaceFocusTracker.onDidBlur(function () {\r\n            _this._replaceInputFocused.set(false);\r\n        }));\r\n        _this._codeEditor.addOverlayWidget(_this);\r\n        if (_this._codeEditor.getOption(27 /* find */).addExtraSpaceOnTop) {\r\n            _this._viewZone = new FindWidgetViewZone(0); // Put it before the first line then users can scroll beyond the first line.\r\n        }\r\n        _this._applyTheme(themeService.getTheme());\r\n        _this._register(themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        _this._register(_this._codeEditor.onDidChangeModel(function () {\r\n            if (!_this._isVisible) {\r\n                return;\r\n            }\r\n            _this._viewZoneId = undefined;\r\n        }));\r\n        _this._register(_this._codeEditor.onDidScrollChange(function (e) {\r\n            if (e.scrollTopChanged) {\r\n                _this._layoutViewZone();\r\n                return;\r\n            }\r\n            // for other scroll changes, layout the viewzone in next tick to avoid ruining current rendering.\r\n            setTimeout(function () {\r\n                _this._layoutViewZone();\r\n            }, 0);\r\n        }));\r\n        return _this;\r\n    }\r\n    // ----- IOverlayWidget API\r\n    FindWidget.prototype.getId = function () {\r\n        return FindWidget.ID;\r\n    };\r\n    FindWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    FindWidget.prototype.getPosition = function () {\r\n        if (this._isVisible) {\r\n            return {\r\n                preference: 0 /* TOP_RIGHT_CORNER */\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    // ----- React to state changes\r\n    FindWidget.prototype._onStateChanged = function (e) {\r\n        if (e.searchString) {\r\n            try {\r\n                this._ignoreChangeEvent = true;\r\n                this._findInput.setValue(this._state.searchString);\r\n            }\r\n            finally {\r\n                this._ignoreChangeEvent = false;\r\n            }\r\n            this._updateButtons();\r\n        }\r\n        if (e.replaceString) {\r\n            this._replaceInput.inputBox.value = this._state.replaceString;\r\n        }\r\n        if (e.isRevealed) {\r\n            if (this._state.isRevealed) {\r\n                this._reveal();\r\n            }\r\n            else {\r\n                this._hide(true);\r\n            }\r\n        }\r\n        if (e.isReplaceRevealed) {\r\n            if (this._state.isReplaceRevealed) {\r\n                if (!this._codeEditor.getOption(65 /* readOnly */) && !this._isReplaceVisible) {\r\n                    this._isReplaceVisible = true;\r\n                    this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n                    this._updateButtons();\r\n                    this._replaceInput.inputBox.layout();\r\n                }\r\n            }\r\n            else {\r\n                if (this._isReplaceVisible) {\r\n                    this._isReplaceVisible = false;\r\n                    this._updateButtons();\r\n                }\r\n            }\r\n        }\r\n        if ((e.isRevealed || e.isReplaceRevealed) && (this._state.isRevealed || this._state.isReplaceRevealed)) {\r\n            if (this._tryUpdateHeight()) {\r\n                this._showViewZone();\r\n            }\r\n        }\r\n        if (e.isRegex) {\r\n            this._findInput.setRegex(this._state.isRegex);\r\n        }\r\n        if (e.wholeWord) {\r\n            this._findInput.setWholeWords(this._state.wholeWord);\r\n        }\r\n        if (e.matchCase) {\r\n            this._findInput.setCaseSensitive(this._state.matchCase);\r\n        }\r\n        if (e.searchScope) {\r\n            if (this._state.searchScope) {\r\n                this._toggleSelectionFind.checked = true;\r\n            }\r\n            else {\r\n                this._toggleSelectionFind.checked = false;\r\n            }\r\n            this._updateToggleSelectionFindButton();\r\n        }\r\n        if (e.searchString || e.matchesCount || e.matchesPosition) {\r\n            var showRedOutline = (this._state.searchString.length > 0 && this._state.matchesCount === 0);\r\n            dom.toggleClass(this._domNode, 'no-results', showRedOutline);\r\n            this._updateMatchesCount();\r\n            this._updateButtons();\r\n        }\r\n        if (e.searchString || e.currentMatch) {\r\n            this._layoutViewZone();\r\n        }\r\n        if (e.updateHistory) {\r\n            this._delayedUpdateHistory();\r\n        }\r\n    };\r\n    FindWidget.prototype._delayedUpdateHistory = function () {\r\n        this._updateHistoryDelayer.trigger(this._updateHistory.bind(this));\r\n    };\r\n    FindWidget.prototype._updateHistory = function () {\r\n        if (this._state.searchString) {\r\n            this._findInput.inputBox.addToHistory();\r\n        }\r\n        if (this._state.replaceString) {\r\n            this._replaceInput.inputBox.addToHistory();\r\n        }\r\n    };\r\n    FindWidget.prototype._updateMatchesCount = function () {\r\n        this._matchesCount.style.minWidth = MAX_MATCHES_COUNT_WIDTH + 'px';\r\n        if (this._state.matchesCount >= MATCHES_LIMIT) {\r\n            this._matchesCount.title = NLS_MATCHES_COUNT_LIMIT_TITLE;\r\n        }\r\n        else {\r\n            this._matchesCount.title = '';\r\n        }\r\n        // remove previous content\r\n        if (this._matchesCount.firstChild) {\r\n            this._matchesCount.removeChild(this._matchesCount.firstChild);\r\n        }\r\n        var label;\r\n        if (this._state.matchesCount > 0) {\r\n            var matchesCount = String(this._state.matchesCount);\r\n            if (this._state.matchesCount >= MATCHES_LIMIT) {\r\n                matchesCount += '+';\r\n            }\r\n            var matchesPosition = String(this._state.matchesPosition);\r\n            if (matchesPosition === '0') {\r\n                matchesPosition = '?';\r\n            }\r\n            label = strings.format(NLS_MATCHES_LOCATION, matchesPosition, matchesCount);\r\n        }\r\n        else {\r\n            label = NLS_NO_RESULTS;\r\n        }\r\n        this._matchesCount.appendChild(document.createTextNode(label));\r\n        alertFn(this._getAriaLabel(label, this._state.currentMatch, this._state.searchString), true);\r\n        MAX_MATCHES_COUNT_WIDTH = Math.max(MAX_MATCHES_COUNT_WIDTH, this._matchesCount.clientWidth);\r\n    };\r\n    // ----- actions\r\n    FindWidget.prototype._getAriaLabel = function (label, currentMatch, searchString) {\r\n        if (label === NLS_NO_RESULTS) {\r\n            return searchString === ''\r\n                ? nls.localize('ariaSearchNoResultEmpty', \"{0} found\", label)\r\n                : nls.localize('ariaSearchNoResult', \"{0} found for {1}\", label, searchString);\r\n        }\r\n        return currentMatch\r\n            ? nls.localize('ariaSearchNoResultWithLineNum', \"{0} found for {1} at {2}\", label, searchString, currentMatch.startLineNumber + ':' + currentMatch.startColumn)\r\n            : nls.localize('ariaSearchNoResultWithLineNumNoCurrentMatch', \"{0} found for {1}\", label, searchString);\r\n    };\r\n    /**\r\n     * If 'selection find' is ON we should not disable the button (its function is to cancel 'selection find').\r\n     * If 'selection find' is OFF we enable the button only if there is a selection.\r\n     */\r\n    FindWidget.prototype._updateToggleSelectionFindButton = function () {\r\n        var selection = this._codeEditor.getSelection();\r\n        var isSelection = selection ? (selection.startLineNumber !== selection.endLineNumber || selection.startColumn !== selection.endColumn) : false;\r\n        var isChecked = this._toggleSelectionFind.checked;\r\n        if (this._isVisible && (isChecked || isSelection)) {\r\n            this._toggleSelectionFind.enable();\r\n        }\r\n        else {\r\n            this._toggleSelectionFind.disable();\r\n        }\r\n    };\r\n    FindWidget.prototype._updateButtons = function () {\r\n        this._findInput.setEnabled(this._isVisible);\r\n        this._replaceInput.setEnabled(this._isVisible && this._isReplaceVisible);\r\n        this._updateToggleSelectionFindButton();\r\n        this._closeBtn.setEnabled(this._isVisible);\r\n        var findInputIsNonEmpty = (this._state.searchString.length > 0);\r\n        var matchesCount = this._state.matchesCount ? true : false;\r\n        this._prevBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount);\r\n        this._nextBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount);\r\n        this._replaceBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\r\n        this._replaceAllBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\r\n        dom.toggleClass(this._domNode, 'replaceToggled', this._isReplaceVisible);\r\n        this._toggleReplaceBtn.toggleClass('codicon-chevron-right', !this._isReplaceVisible);\r\n        this._toggleReplaceBtn.toggleClass('codicon-chevron-down', this._isReplaceVisible);\r\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\r\n        var canReplace = !this._codeEditor.getOption(65 /* readOnly */);\r\n        this._toggleReplaceBtn.setEnabled(this._isVisible && canReplace);\r\n    };\r\n    FindWidget.prototype._reveal = function () {\r\n        var _this = this;\r\n        if (!this._isVisible) {\r\n            this._isVisible = true;\r\n            var selection = this._codeEditor.getSelection();\r\n            switch (this._codeEditor.getOption(27 /* find */).autoFindInSelection) {\r\n                case 'always':\r\n                    this._toggleSelectionFind.checked = true;\r\n                    break;\r\n                case 'never':\r\n                    this._toggleSelectionFind.checked = false;\r\n                    break;\r\n                case 'multiline':\r\n                    var isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\r\n                    this._toggleSelectionFind.checked = isSelectionMultipleLine;\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            this._tryUpdateWidgetWidth();\r\n            this._updateButtons();\r\n            setTimeout(function () {\r\n                dom.addClass(_this._domNode, 'visible');\r\n                _this._domNode.setAttribute('aria-hidden', 'false');\r\n            }, 0);\r\n            // validate query again as it's being dismissed when we hide the find widget.\r\n            setTimeout(function () {\r\n                _this._findInput.validate();\r\n            }, 200);\r\n            this._codeEditor.layoutOverlayWidget(this);\r\n            var adjustEditorScrollTop = true;\r\n            if (this._codeEditor.getOption(27 /* find */).seedSearchStringFromSelection && selection) {\r\n                var domNode = this._codeEditor.getDomNode();\r\n                if (domNode) {\r\n                    var editorCoords = dom.getDomNodePagePosition(domNode);\r\n                    var startCoords = this._codeEditor.getScrolledVisiblePosition(selection.getStartPosition());\r\n                    var startLeft = editorCoords.left + (startCoords ? startCoords.left : 0);\r\n                    var startTop = startCoords ? startCoords.top : 0;\r\n                    if (this._viewZone && startTop < this._viewZone.heightInPx) {\r\n                        if (selection.endLineNumber > selection.startLineNumber) {\r\n                            adjustEditorScrollTop = false;\r\n                        }\r\n                        var leftOfFindWidget = dom.getTopLeftOffset(this._domNode).left;\r\n                        if (startLeft > leftOfFindWidget) {\r\n                            adjustEditorScrollTop = false;\r\n                        }\r\n                        var endCoords = this._codeEditor.getScrolledVisiblePosition(selection.getEndPosition());\r\n                        var endLeft = editorCoords.left + (endCoords ? endCoords.left : 0);\r\n                        if (endLeft > leftOfFindWidget) {\r\n                            adjustEditorScrollTop = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._showViewZone(adjustEditorScrollTop);\r\n        }\r\n    };\r\n    FindWidget.prototype._hide = function (focusTheEditor) {\r\n        if (this._isVisible) {\r\n            this._isVisible = false;\r\n            this._updateButtons();\r\n            dom.removeClass(this._domNode, 'visible');\r\n            this._domNode.setAttribute('aria-hidden', 'true');\r\n            this._findInput.clearMessage();\r\n            if (focusTheEditor) {\r\n                this._codeEditor.focus();\r\n            }\r\n            this._codeEditor.layoutOverlayWidget(this);\r\n            this._removeViewZone();\r\n        }\r\n    };\r\n    FindWidget.prototype._layoutViewZone = function () {\r\n        var _this = this;\r\n        var addExtraSpaceOnTop = this._codeEditor.getOption(27 /* find */).addExtraSpaceOnTop;\r\n        if (!addExtraSpaceOnTop) {\r\n            this._removeViewZone();\r\n            return;\r\n        }\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        var viewZone = this._viewZone;\r\n        if (this._viewZoneId !== undefined || !viewZone) {\r\n            return;\r\n        }\r\n        this._codeEditor.changeViewZones(function (accessor) {\r\n            viewZone.heightInPx = _this._getHeight();\r\n            _this._viewZoneId = accessor.addZone(viewZone);\r\n            // scroll top adjust to make sure the editor doesn't scroll when adding viewzone at the beginning.\r\n            _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() + viewZone.heightInPx);\r\n        });\r\n    };\r\n    FindWidget.prototype._showViewZone = function (adjustScroll) {\r\n        var _this = this;\r\n        if (adjustScroll === void 0) { adjustScroll = true; }\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        var addExtraSpaceOnTop = this._codeEditor.getOption(27 /* find */).addExtraSpaceOnTop;\r\n        if (!addExtraSpaceOnTop) {\r\n            return;\r\n        }\r\n        if (this._viewZone === undefined) {\r\n            this._viewZone = new FindWidgetViewZone(0);\r\n        }\r\n        var viewZone = this._viewZone;\r\n        this._codeEditor.changeViewZones(function (accessor) {\r\n            if (_this._viewZoneId !== undefined) {\r\n                // the view zone already exists, we need to update the height\r\n                var newHeight = _this._getHeight();\r\n                if (newHeight === viewZone.heightInPx) {\r\n                    return;\r\n                }\r\n                var scrollAdjustment = newHeight - viewZone.heightInPx;\r\n                viewZone.heightInPx = newHeight;\r\n                accessor.layoutZone(_this._viewZoneId);\r\n                if (adjustScroll) {\r\n                    _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() + scrollAdjustment);\r\n                }\r\n                return;\r\n            }\r\n            else {\r\n                var scrollAdjustment = _this._getHeight();\r\n                viewZone.heightInPx = scrollAdjustment;\r\n                _this._viewZoneId = accessor.addZone(viewZone);\r\n                if (adjustScroll) {\r\n                    _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() + scrollAdjustment);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    FindWidget.prototype._removeViewZone = function () {\r\n        var _this = this;\r\n        this._codeEditor.changeViewZones(function (accessor) {\r\n            if (_this._viewZoneId !== undefined) {\r\n                accessor.removeZone(_this._viewZoneId);\r\n                _this._viewZoneId = undefined;\r\n                if (_this._viewZone) {\r\n                    _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() - _this._viewZone.heightInPx);\r\n                    _this._viewZone = undefined;\r\n                }\r\n            }\r\n        });\r\n    };\r\n    FindWidget.prototype._applyTheme = function (theme) {\r\n        var inputStyles = {\r\n            inputActiveOptionBorder: theme.getColor(inputActiveOptionBorder),\r\n            inputActiveOptionBackground: theme.getColor(inputActiveOptionBackground),\r\n            inputBackground: theme.getColor(inputBackground),\r\n            inputForeground: theme.getColor(inputForeground),\r\n            inputBorder: theme.getColor(inputBorder),\r\n            inputValidationInfoBackground: theme.getColor(inputValidationInfoBackground),\r\n            inputValidationInfoForeground: theme.getColor(inputValidationInfoForeground),\r\n            inputValidationInfoBorder: theme.getColor(inputValidationInfoBorder),\r\n            inputValidationWarningBackground: theme.getColor(inputValidationWarningBackground),\r\n            inputValidationWarningForeground: theme.getColor(inputValidationWarningForeground),\r\n            inputValidationWarningBorder: theme.getColor(inputValidationWarningBorder),\r\n            inputValidationErrorBackground: theme.getColor(inputValidationErrorBackground),\r\n            inputValidationErrorForeground: theme.getColor(inputValidationErrorForeground),\r\n            inputValidationErrorBorder: theme.getColor(inputValidationErrorBorder),\r\n        };\r\n        this._findInput.style(inputStyles);\r\n        this._replaceInput.style(inputStyles);\r\n        this._toggleSelectionFind.style(inputStyles);\r\n    };\r\n    FindWidget.prototype._tryUpdateWidgetWidth = function () {\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        if (!dom.isInDOM(this._domNode)) {\r\n            // the widget is not in the DOM\r\n            return;\r\n        }\r\n        var layoutInfo = this._codeEditor.getLayoutInfo();\r\n        var editorContentWidth = layoutInfo.contentWidth;\r\n        if (editorContentWidth <= 0) {\r\n            // for example, diff view original editor\r\n            dom.addClass(this._domNode, 'hiddenEditor');\r\n            return;\r\n        }\r\n        else if (dom.hasClass(this._domNode, 'hiddenEditor')) {\r\n            dom.removeClass(this._domNode, 'hiddenEditor');\r\n        }\r\n        var editorWidth = layoutInfo.width;\r\n        var minimapWidth = layoutInfo.minimapWidth;\r\n        var collapsedFindWidget = false;\r\n        var reducedFindWidget = false;\r\n        var narrowFindWidget = false;\r\n        if (this._resized) {\r\n            var widgetWidth = dom.getTotalWidth(this._domNode);\r\n            if (widgetWidth > FIND_WIDGET_INITIAL_WIDTH) {\r\n                // as the widget is resized by users, we may need to change the max width of the widget as the editor width changes.\r\n                this._domNode.style.maxWidth = editorWidth - 28 - minimapWidth - 15 + \"px\";\r\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n                return;\r\n            }\r\n        }\r\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth >= editorWidth) {\r\n            reducedFindWidget = true;\r\n        }\r\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth) {\r\n            narrowFindWidget = true;\r\n        }\r\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth + 50) {\r\n            collapsedFindWidget = true;\r\n        }\r\n        dom.toggleClass(this._domNode, 'collapsed-find-widget', collapsedFindWidget);\r\n        dom.toggleClass(this._domNode, 'narrow-find-widget', narrowFindWidget);\r\n        dom.toggleClass(this._domNode, 'reduced-find-widget', reducedFindWidget);\r\n        if (!narrowFindWidget && !collapsedFindWidget) {\r\n            // the minimal left offset of findwidget is 15px.\r\n            this._domNode.style.maxWidth = editorWidth - 28 - minimapWidth - 15 + \"px\";\r\n        }\r\n        if (this._resized) {\r\n            this._findInput.inputBox.layout();\r\n            var findInputWidth = this._findInput.inputBox.element.clientWidth;\r\n            if (findInputWidth > 0) {\r\n                this._replaceInput.width = findInputWidth;\r\n            }\r\n        }\r\n        else if (this._isReplaceVisible) {\r\n            this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n        }\r\n    };\r\n    FindWidget.prototype._getHeight = function () {\r\n        var totalheight = 0;\r\n        // find input margin top\r\n        totalheight += 4;\r\n        // find input height\r\n        totalheight += this._findInput.inputBox.height + 2 /** input box border */;\r\n        if (this._isReplaceVisible) {\r\n            // replace input margin\r\n            totalheight += 4;\r\n            totalheight += this._replaceInput.inputBox.height + 2 /** input box border */;\r\n        }\r\n        // margin bottom\r\n        totalheight += 4;\r\n        return totalheight;\r\n    };\r\n    FindWidget.prototype._tryUpdateHeight = function () {\r\n        var totalHeight = this._getHeight();\r\n        if (this._cachedHeight !== null && this._cachedHeight === totalHeight) {\r\n            return false;\r\n        }\r\n        this._cachedHeight = totalHeight;\r\n        this._domNode.style.height = totalHeight + \"px\";\r\n        return true;\r\n    };\r\n    // ----- Public\r\n    FindWidget.prototype.focusFindInput = function () {\r\n        this._findInput.select();\r\n        // Edge browser requires focus() in addition to select()\r\n        this._findInput.focus();\r\n    };\r\n    FindWidget.prototype.focusReplaceInput = function () {\r\n        this._replaceInput.select();\r\n        // Edge browser requires focus() in addition to select()\r\n        this._replaceInput.focus();\r\n    };\r\n    FindWidget.prototype.highlightFindOptions = function () {\r\n        this._findInput.highlightFindOptions();\r\n    };\r\n    FindWidget.prototype._updateSearchScope = function () {\r\n        if (!this._codeEditor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this._toggleSelectionFind.checked) {\r\n            var selection = this._codeEditor.getSelection();\r\n            if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\r\n                selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\r\n            }\r\n            var currentMatch = this._state.currentMatch;\r\n            if (selection.startLineNumber !== selection.endLineNumber) {\r\n                if (!Range.equalsRange(selection, currentMatch)) {\r\n                    // Reseed find scope\r\n                    this._state.change({ searchScope: selection }, true);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    FindWidget.prototype._onFindInputMouseDown = function (e) {\r\n        // on linux, middle key does pasting.\r\n        if (e.middleButton) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    FindWidget.prototype._onFindInputKeyDown = function (e) {\r\n        if (e.equals(ctrlKeyMod | 3 /* Enter */)) {\r\n            this._findInput.inputBox.insertAtCursor('\\n');\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2 /* Tab */)) {\r\n            if (this._isReplaceVisible) {\r\n                this._replaceInput.focus();\r\n            }\r\n            else {\r\n                this._findInput.focusOnCaseSensitive();\r\n            }\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2048 /* CtrlCmd */ | 18 /* DownArrow */)) {\r\n            this._codeEditor.focus();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(16 /* UpArrow */)) {\r\n            return stopPropagationForMultiLineUpwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\r\n        }\r\n        if (e.equals(18 /* DownArrow */)) {\r\n            return stopPropagationForMultiLineDownwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\r\n        }\r\n    };\r\n    FindWidget.prototype._onReplaceInputKeyDown = function (e) {\r\n        if (e.equals(ctrlKeyMod | 3 /* Enter */)) {\r\n            if (platform.isWindows && platform.isNative && !this._ctrlEnterReplaceAllWarningPrompted) {\r\n                // this is the first time when users press Ctrl + Enter to replace all\r\n                this._notificationService.info(nls.localize('ctrlEnter.keybindingChanged', 'Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.'));\r\n                this._ctrlEnterReplaceAllWarningPrompted = true;\r\n                this._storageService.store(ctrlEnterReplaceAllWarningPromptedKey, true, 0 /* GLOBAL */);\r\n            }\r\n            this._replaceInput.inputBox.insertAtCursor('\\n');\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2 /* Tab */)) {\r\n            this._findInput.focusOnCaseSensitive();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n            this._findInput.focus();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2048 /* CtrlCmd */ | 18 /* DownArrow */)) {\r\n            this._codeEditor.focus();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(16 /* UpArrow */)) {\r\n            return stopPropagationForMultiLineUpwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\r\n        }\r\n        if (e.equals(18 /* DownArrow */)) {\r\n            return stopPropagationForMultiLineDownwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\r\n        }\r\n    };\r\n    // ----- sash\r\n    FindWidget.prototype.getHorizontalSashTop = function (_sash) {\r\n        return 0;\r\n    };\r\n    FindWidget.prototype.getHorizontalSashLeft = function (_sash) {\r\n        return 0;\r\n    };\r\n    FindWidget.prototype.getHorizontalSashWidth = function (_sash) {\r\n        return 500;\r\n    };\r\n    // ----- initialization\r\n    FindWidget.prototype._keybindingLabelFor = function (actionId) {\r\n        var kb = this._keybindingService.lookupKeybinding(actionId);\r\n        if (!kb) {\r\n            return '';\r\n        }\r\n        return \" (\" + kb.getLabel() + \")\";\r\n    };\r\n    FindWidget.prototype._buildDomNode = function () {\r\n        var _this = this;\r\n        var flexibleHeight = true;\r\n        var flexibleWidth = true;\r\n        // Find input\r\n        this._findInput = this._register(new ContextScopedFindInput(null, this._contextViewProvider, {\r\n            width: FIND_INPUT_AREA_WIDTH,\r\n            label: NLS_FIND_INPUT_LABEL,\r\n            placeholder: NLS_FIND_INPUT_PLACEHOLDER,\r\n            appendCaseSensitiveLabel: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\r\n            appendWholeWordsLabel: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\r\n            appendRegexLabel: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\r\n            validation: function (value) {\r\n                if (value.length === 0 || !_this._findInput.getRegex()) {\r\n                    return null;\r\n                }\r\n                try {\r\n                    /* tslint:disable-next-line:no-unused-expression */\r\n                    new RegExp(value);\r\n                    return null;\r\n                }\r\n                catch (e) {\r\n                    return { content: e.message };\r\n                }\r\n            },\r\n            flexibleHeight: flexibleHeight,\r\n            flexibleWidth: flexibleWidth,\r\n            flexibleMaxHeight: 118\r\n        }, this._contextKeyService, true));\r\n        this._findInput.setRegex(!!this._state.isRegex);\r\n        this._findInput.setCaseSensitive(!!this._state.matchCase);\r\n        this._findInput.setWholeWords(!!this._state.wholeWord);\r\n        this._register(this._findInput.onKeyDown(function (e) { return _this._onFindInputKeyDown(e); }));\r\n        this._register(this._findInput.inputBox.onDidChange(function () {\r\n            if (_this._ignoreChangeEvent) {\r\n                return;\r\n            }\r\n            _this._state.change({ searchString: _this._findInput.getValue() }, true);\r\n        }));\r\n        this._register(this._findInput.onDidOptionChange(function () {\r\n            _this._state.change({\r\n                isRegex: _this._findInput.getRegex(),\r\n                wholeWord: _this._findInput.getWholeWords(),\r\n                matchCase: _this._findInput.getCaseSensitive()\r\n            }, true);\r\n        }));\r\n        this._register(this._findInput.onCaseSensitiveKeyDown(function (e) {\r\n            if (e.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n                if (_this._isReplaceVisible) {\r\n                    _this._replaceInput.focus();\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        }));\r\n        this._register(this._findInput.onRegexKeyDown(function (e) {\r\n            if (e.equals(2 /* Tab */)) {\r\n                if (_this._isReplaceVisible) {\r\n                    _this._replaceInput.focusOnPreserve();\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        }));\r\n        this._register(this._findInput.inputBox.onDidHeightChange(function (e) {\r\n            if (_this._tryUpdateHeight()) {\r\n                _this._showViewZone();\r\n            }\r\n        }));\r\n        if (platform.isLinux) {\r\n            this._register(this._findInput.onMouseDown(function (e) { return _this._onFindInputMouseDown(e); }));\r\n        }\r\n        this._matchesCount = document.createElement('div');\r\n        this._matchesCount.className = 'matchesCount';\r\n        this._updateMatchesCount();\r\n        // Previous button\r\n        this._prevBtn = this._register(new SimpleButton({\r\n            label: NLS_PREVIOUS_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.PreviousMatchFindAction),\r\n            className: 'codicon codicon-arrow-up',\r\n            onTrigger: function () {\r\n                _this._codeEditor.getAction(FIND_IDS.PreviousMatchFindAction).run().then(undefined, onUnexpectedError);\r\n            }\r\n        }));\r\n        // Next button\r\n        this._nextBtn = this._register(new SimpleButton({\r\n            label: NLS_NEXT_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.NextMatchFindAction),\r\n            className: 'codicon codicon-arrow-down',\r\n            onTrigger: function () {\r\n                _this._codeEditor.getAction(FIND_IDS.NextMatchFindAction).run().then(undefined, onUnexpectedError);\r\n            }\r\n        }));\r\n        var findPart = document.createElement('div');\r\n        findPart.className = 'find-part';\r\n        findPart.appendChild(this._findInput.domNode);\r\n        var actionsContainer = document.createElement('div');\r\n        actionsContainer.className = 'find-actions';\r\n        findPart.appendChild(actionsContainer);\r\n        actionsContainer.appendChild(this._matchesCount);\r\n        actionsContainer.appendChild(this._prevBtn.domNode);\r\n        actionsContainer.appendChild(this._nextBtn.domNode);\r\n        // Toggle selection button\r\n        this._toggleSelectionFind = this._register(new Checkbox({\r\n            actionClassName: 'codicon codicon-selection',\r\n            title: NLS_TOGGLE_SELECTION_FIND_TITLE + this._keybindingLabelFor(FIND_IDS.ToggleSearchScopeCommand),\r\n            isChecked: false\r\n        }));\r\n        this._register(this._toggleSelectionFind.onChange(function () {\r\n            if (_this._toggleSelectionFind.checked) {\r\n                if (_this._codeEditor.hasModel()) {\r\n                    var selection = _this._codeEditor.getSelection();\r\n                    if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\r\n                        selection = selection.setEndPosition(selection.endLineNumber - 1, _this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\r\n                    }\r\n                    if (!selection.isEmpty()) {\r\n                        _this._state.change({ searchScope: selection }, true);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                _this._state.change({ searchScope: null }, true);\r\n            }\r\n        }));\r\n        actionsContainer.appendChild(this._toggleSelectionFind.domNode);\r\n        // Close button\r\n        this._closeBtn = this._register(new SimpleButton({\r\n            label: NLS_CLOSE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.CloseFindWidgetCommand),\r\n            className: 'codicon codicon-close',\r\n            onTrigger: function () {\r\n                _this._state.change({ isRevealed: false, searchScope: null }, false);\r\n            },\r\n            onKeyDown: function (e) {\r\n                if (e.equals(2 /* Tab */)) {\r\n                    if (_this._isReplaceVisible) {\r\n                        if (_this._replaceBtn.isEnabled()) {\r\n                            _this._replaceBtn.focus();\r\n                        }\r\n                        else {\r\n                            _this._codeEditor.focus();\r\n                        }\r\n                        e.preventDefault();\r\n                    }\r\n                }\r\n            }\r\n        }));\r\n        actionsContainer.appendChild(this._closeBtn.domNode);\r\n        // Replace input\r\n        this._replaceInput = this._register(new ContextScopedReplaceInput(null, undefined, {\r\n            label: NLS_REPLACE_INPUT_LABEL,\r\n            placeholder: NLS_REPLACE_INPUT_PLACEHOLDER,\r\n            history: [],\r\n            flexibleHeight: flexibleHeight,\r\n            flexibleWidth: flexibleWidth,\r\n            flexibleMaxHeight: 118\r\n        }, this._contextKeyService, true));\r\n        this._replaceInput.setPreserveCase(!!this._state.preserveCase);\r\n        this._register(this._replaceInput.onKeyDown(function (e) { return _this._onReplaceInputKeyDown(e); }));\r\n        this._register(this._replaceInput.inputBox.onDidChange(function () {\r\n            _this._state.change({ replaceString: _this._replaceInput.inputBox.value }, false);\r\n        }));\r\n        this._register(this._replaceInput.inputBox.onDidHeightChange(function (e) {\r\n            if (_this._isReplaceVisible && _this._tryUpdateHeight()) {\r\n                _this._showViewZone();\r\n            }\r\n        }));\r\n        this._register(this._replaceInput.onDidOptionChange(function () {\r\n            _this._state.change({\r\n                preserveCase: _this._replaceInput.getPreserveCase()\r\n            }, true);\r\n        }));\r\n        this._register(this._replaceInput.onPreserveCaseKeyDown(function (e) {\r\n            if (e.equals(2 /* Tab */)) {\r\n                if (_this._prevBtn.isEnabled()) {\r\n                    _this._prevBtn.focus();\r\n                }\r\n                else if (_this._nextBtn.isEnabled()) {\r\n                    _this._nextBtn.focus();\r\n                }\r\n                else if (_this._toggleSelectionFind.enabled) {\r\n                    _this._toggleSelectionFind.focus();\r\n                }\r\n                else if (_this._closeBtn.isEnabled()) {\r\n                    _this._closeBtn.focus();\r\n                }\r\n                e.preventDefault();\r\n            }\r\n        }));\r\n        // Replace one button\r\n        this._replaceBtn = this._register(new SimpleButton({\r\n            label: NLS_REPLACE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceOneAction),\r\n            className: 'codicon codicon-replace',\r\n            onTrigger: function () {\r\n                _this._controller.replace();\r\n            },\r\n            onKeyDown: function (e) {\r\n                if (e.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n                    _this._closeBtn.focus();\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        }));\r\n        // Replace all button\r\n        this._replaceAllBtn = this._register(new SimpleButton({\r\n            label: NLS_REPLACE_ALL_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceAllAction),\r\n            className: 'codicon codicon-replace-all',\r\n            onTrigger: function () {\r\n                _this._controller.replaceAll();\r\n            }\r\n        }));\r\n        var replacePart = document.createElement('div');\r\n        replacePart.className = 'replace-part';\r\n        replacePart.appendChild(this._replaceInput.domNode);\r\n        var replaceActionsContainer = document.createElement('div');\r\n        replaceActionsContainer.className = 'replace-actions';\r\n        replacePart.appendChild(replaceActionsContainer);\r\n        replaceActionsContainer.appendChild(this._replaceBtn.domNode);\r\n        replaceActionsContainer.appendChild(this._replaceAllBtn.domNode);\r\n        // Toggle replace button\r\n        this._toggleReplaceBtn = this._register(new SimpleButton({\r\n            label: NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,\r\n            className: 'codicon toggle left',\r\n            onTrigger: function () {\r\n                _this._state.change({ isReplaceRevealed: !_this._isReplaceVisible }, false);\r\n                if (_this._isReplaceVisible) {\r\n                    _this._replaceInput.width = dom.getTotalWidth(_this._findInput.domNode);\r\n                    _this._replaceInput.inputBox.layout();\r\n                }\r\n                _this._showViewZone();\r\n            }\r\n        }));\r\n        this._toggleReplaceBtn.toggleClass('codicon-chevron-down', this._isReplaceVisible);\r\n        this._toggleReplaceBtn.toggleClass('codicon-chevron-right', !this._isReplaceVisible);\r\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\r\n        // Widget\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.className = 'editor-widget find-widget';\r\n        this._domNode.setAttribute('aria-hidden', 'true');\r\n        // We need to set this explicitly, otherwise on IE11, the width inheritence of flex doesn't work.\r\n        this._domNode.style.width = FIND_WIDGET_INITIAL_WIDTH + \"px\";\r\n        this._domNode.appendChild(this._toggleReplaceBtn.domNode);\r\n        this._domNode.appendChild(findPart);\r\n        this._domNode.appendChild(replacePart);\r\n        this._resizeSash = new Sash(this._domNode, this, { orientation: 0 /* VERTICAL */ });\r\n        this._resized = false;\r\n        var originalWidth = FIND_WIDGET_INITIAL_WIDTH;\r\n        this._register(this._resizeSash.onDidStart(function () {\r\n            originalWidth = dom.getTotalWidth(_this._domNode);\r\n        }));\r\n        this._register(this._resizeSash.onDidChange(function (evt) {\r\n            _this._resized = true;\r\n            var width = originalWidth + evt.startX - evt.currentX;\r\n            if (width < FIND_WIDGET_INITIAL_WIDTH) {\r\n                // narrow down the find widget should be handled by CSS.\r\n                return;\r\n            }\r\n            var maxWidth = parseFloat(dom.getComputedStyle(_this._domNode).maxWidth) || 0;\r\n            if (width > maxWidth) {\r\n                return;\r\n            }\r\n            _this._domNode.style.width = width + \"px\";\r\n            if (_this._isReplaceVisible) {\r\n                _this._replaceInput.width = dom.getTotalWidth(_this._findInput.domNode);\r\n            }\r\n            _this._findInput.inputBox.layout();\r\n            _this._tryUpdateHeight();\r\n        }));\r\n        this._register(this._resizeSash.onDidReset(function () {\r\n            // users double click on the sash\r\n            var currentWidth = dom.getTotalWidth(_this._domNode);\r\n            if (currentWidth < FIND_WIDGET_INITIAL_WIDTH) {\r\n                // The editor is narrow and the width of the find widget is controlled fully by CSS.\r\n                return;\r\n            }\r\n            var width = FIND_WIDGET_INITIAL_WIDTH;\r\n            if (!_this._resized || currentWidth === FIND_WIDGET_INITIAL_WIDTH) {\r\n                // 1. never resized before, double click should maximizes it\r\n                // 2. users resized it already but its width is the same as default\r\n                var layoutInfo = _this._codeEditor.getLayoutInfo();\r\n                width = layoutInfo.width - 28 - layoutInfo.minimapWidth - 15;\r\n                _this._resized = true;\r\n            }\r\n            else {\r\n                /**\r\n                 * no op, the find widget should be shrinked to its default size.\r\n                 */\r\n            }\r\n            _this._domNode.style.width = width + \"px\";\r\n            if (_this._isReplaceVisible) {\r\n                _this._replaceInput.width = dom.getTotalWidth(_this._findInput.domNode);\r\n            }\r\n            _this._findInput.inputBox.layout();\r\n        }));\r\n    };\r\n    FindWidget.prototype.updateAccessibilitySupport = function () {\r\n        var value = this._codeEditor.getOption(2 /* accessibilitySupport */);\r\n        this._findInput.setFocusInputOnOptionClick(value !== 2 /* Enabled */);\r\n    };\r\n    FindWidget.ID = 'editor.contrib.findWidget';\r\n    return FindWidget;\r\n}(Widget));\r\nexport { FindWidget };\r\nvar SimpleButton = /** @class */ (function (_super) {\r\n    __extends(SimpleButton, _super);\r\n    function SimpleButton(opts) {\r\n        var _this = _super.call(this) || this;\r\n        _this._opts = opts;\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.title = _this._opts.label;\r\n        _this._domNode.tabIndex = 0;\r\n        _this._domNode.className = 'button ' + _this._opts.className;\r\n        _this._domNode.setAttribute('role', 'button');\r\n        _this._domNode.setAttribute('aria-label', _this._opts.label);\r\n        _this.onclick(_this._domNode, function (e) {\r\n            _this._opts.onTrigger();\r\n            e.preventDefault();\r\n        });\r\n        _this.onkeydown(_this._domNode, function (e) {\r\n            if (e.equals(10 /* Space */) || e.equals(3 /* Enter */)) {\r\n                _this._opts.onTrigger();\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            if (_this._opts.onKeyDown) {\r\n                _this._opts.onKeyDown(e);\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SimpleButton.prototype, \"domNode\", {\r\n        get: function () {\r\n            return this._domNode;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SimpleButton.prototype.isEnabled = function () {\r\n        return (this._domNode.tabIndex >= 0);\r\n    };\r\n    SimpleButton.prototype.focus = function () {\r\n        this._domNode.focus();\r\n    };\r\n    SimpleButton.prototype.setEnabled = function (enabled) {\r\n        dom.toggleClass(this._domNode, 'disabled', !enabled);\r\n        this._domNode.setAttribute('aria-disabled', String(!enabled));\r\n        this._domNode.tabIndex = enabled ? 0 : -1;\r\n    };\r\n    SimpleButton.prototype.setExpanded = function (expanded) {\r\n        this._domNode.setAttribute('aria-expanded', String(!!expanded));\r\n    };\r\n    SimpleButton.prototype.toggleClass = function (className, shouldHaveIt) {\r\n        dom.toggleClass(this._domNode, className, shouldHaveIt);\r\n    };\r\n    return SimpleButton;\r\n}(Widget));\r\nexport { SimpleButton };\r\n// theming\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var addBackgroundColorRule = function (selector, color) {\r\n        if (color) {\r\n            collector.addRule(\".monaco-editor \" + selector + \" { background-color: \" + color + \"; }\");\r\n        }\r\n    };\r\n    addBackgroundColorRule('.findMatch', theme.getColor(editorFindMatchHighlight));\r\n    addBackgroundColorRule('.currentFindMatch', theme.getColor(editorFindMatch));\r\n    addBackgroundColorRule('.findScope', theme.getColor(editorFindRangeHighlight));\r\n    var widgetBackground = theme.getColor(editorWidgetBackground);\r\n    addBackgroundColorRule('.find-widget', widgetBackground);\r\n    var widgetShadowColor = theme.getColor(widgetShadow);\r\n    if (widgetShadowColor) {\r\n        collector.addRule(\".monaco-editor .find-widget { box-shadow: 0 2px 8px \" + widgetShadowColor + \"; }\");\r\n    }\r\n    var findMatchHighlightBorder = theme.getColor(editorFindMatchHighlightBorder);\r\n    if (findMatchHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .findMatch { border: 1px \" + (theme.type === 'hc' ? 'dotted' : 'solid') + \" \" + findMatchHighlightBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n    var findMatchBorder = theme.getColor(editorFindMatchBorder);\r\n    if (findMatchBorder) {\r\n        collector.addRule(\".monaco-editor .currentFindMatch { border: 2px solid \" + findMatchBorder + \"; padding: 1px; box-sizing: border-box; }\");\r\n    }\r\n    var findRangeHighlightBorder = theme.getColor(editorFindRangeHighlightBorder);\r\n    if (findRangeHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .findScope { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + findRangeHighlightBorder + \"; }\");\r\n    }\r\n    var hcBorder = theme.getColor(contrastBorder);\r\n    if (hcBorder) {\r\n        collector.addRule(\".monaco-editor .find-widget { border: 1px solid \" + hcBorder + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(editorWidgetForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .find-widget { color: \" + foreground + \"; }\");\r\n    }\r\n    var error = theme.getColor(errorForeground);\r\n    if (error) {\r\n        collector.addRule(\".monaco-editor .find-widget.no-results .matchesCount { color: \" + error + \"; }\");\r\n    }\r\n    var resizeBorderBackground = theme.getColor(editorWidgetResizeBorder);\r\n    if (resizeBorderBackground) {\r\n        collector.addRule(\".monaco-editor .find-widget .monaco-sash { background-color: \" + resizeBorderBackground + \"; width: 3px !important; margin-left: -4px;}\");\r\n    }\r\n    else {\r\n        var border = theme.getColor(editorWidgetBorder);\r\n        if (border) {\r\n            collector.addRule(\".monaco-editor .find-widget .monaco-sash { background-color: \" + border + \"; width: 3px !important; margin-left: -4px;}\");\r\n        }\r\n    }\r\n    // This rule is used to override the outline color for synthetic-focus find input.\r\n    var focusOutline = theme.getColor(focusBorder);\r\n    if (focusOutline) {\r\n        collector.addRule(\".monaco-workbench .monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: \" + focusOutline + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Delayer } from '../../../base/common/async.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_FIND_WIDGET_VISIBLE, FIND_IDS, FindModelBoundToEditorModel, ToggleCaseSensitiveKeybinding, ToggleRegexKeybinding, ToggleSearchScopeKeybinding, ToggleWholeWordKeybinding, CONTEXT_REPLACE_INPUT_FOCUSED } from './findModel.js';\r\nimport { FindOptionsWidget } from './findOptionsWidget.js';\r\nimport { FindReplaceState } from './findState.js';\r\nimport { FindWidget } from './findWidget.js';\r\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\r\nimport { IContextKeyService, ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IContextViewService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { optional } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { IStorageService } from '../../../platform/storage/common/storage.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nvar SEARCH_STRING_MAX_LENGTH = 524288;\r\nexport function getSelectionSearchString(editor) {\r\n    if (!editor.hasModel()) {\r\n        return null;\r\n    }\r\n    var selection = editor.getSelection();\r\n    // if selection spans multiple lines, default search string to empty\r\n    if (selection.startLineNumber === selection.endLineNumber) {\r\n        if (selection.isEmpty()) {\r\n            var wordAtPosition = editor.getModel().getWordAtPosition(selection.getStartPosition());\r\n            if (wordAtPosition) {\r\n                return wordAtPosition.word;\r\n            }\r\n        }\r\n        else {\r\n            if (editor.getModel().getValueLengthInRange(selection) < SEARCH_STRING_MAX_LENGTH) {\r\n                return editor.getModel().getValueInRange(selection);\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\nvar CommonFindController = /** @class */ (function (_super) {\r\n    __extends(CommonFindController, _super);\r\n    function CommonFindController(editor, contextKeyService, storageService, clipboardService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._findWidgetVisible = CONTEXT_FIND_WIDGET_VISIBLE.bindTo(contextKeyService);\r\n        _this._contextKeyService = contextKeyService;\r\n        _this._storageService = storageService;\r\n        _this._clipboardService = clipboardService;\r\n        _this._updateHistoryDelayer = new Delayer(500);\r\n        _this._state = _this._register(new FindReplaceState());\r\n        _this.loadQueryState();\r\n        _this._register(_this._state.onFindReplaceStateChange(function (e) { return _this._onStateChanged(e); }));\r\n        _this._model = null;\r\n        _this._register(_this._editor.onDidChangeModel(function () {\r\n            var shouldRestartFind = (_this._editor.getModel() && _this._state.isRevealed);\r\n            _this.disposeModel();\r\n            _this._state.change({\r\n                searchScope: null,\r\n                matchCase: _this._storageService.getBoolean('editor.matchCase', 1 /* WORKSPACE */, false),\r\n                wholeWord: _this._storageService.getBoolean('editor.wholeWord', 1 /* WORKSPACE */, false),\r\n                isRegex: _this._storageService.getBoolean('editor.isRegex', 1 /* WORKSPACE */, false),\r\n                preserveCase: _this._storageService.getBoolean('editor.preserveCase', 1 /* WORKSPACE */, false)\r\n            }, false);\r\n            if (shouldRestartFind) {\r\n                _this._start({\r\n                    forceRevealReplace: false,\r\n                    seedSearchStringFromSelection: false && _this._editor.getOption(27 /* find */).seedSearchStringFromSelection,\r\n                    seedSearchStringFromGlobalClipboard: false,\r\n                    shouldFocus: 0 /* NoFocusChange */,\r\n                    shouldAnimate: false,\r\n                    updateSearchScope: false\r\n                });\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    CommonFindController.get = function (editor) {\r\n        return editor.getContribution(CommonFindController.ID);\r\n    };\r\n    CommonFindController.prototype.dispose = function () {\r\n        this.disposeModel();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    CommonFindController.prototype.disposeModel = function () {\r\n        if (this._model) {\r\n            this._model.dispose();\r\n            this._model = null;\r\n        }\r\n    };\r\n    CommonFindController.prototype._onStateChanged = function (e) {\r\n        this.saveQueryState(e);\r\n        if (e.isRevealed) {\r\n            if (this._state.isRevealed) {\r\n                this._findWidgetVisible.set(true);\r\n            }\r\n            else {\r\n                this._findWidgetVisible.reset();\r\n                this.disposeModel();\r\n            }\r\n        }\r\n        if (e.searchString) {\r\n            this.setGlobalBufferTerm(this._state.searchString);\r\n        }\r\n    };\r\n    CommonFindController.prototype.saveQueryState = function (e) {\r\n        if (e.isRegex) {\r\n            this._storageService.store('editor.isRegex', this._state.actualIsRegex, 1 /* WORKSPACE */);\r\n        }\r\n        if (e.wholeWord) {\r\n            this._storageService.store('editor.wholeWord', this._state.actualWholeWord, 1 /* WORKSPACE */);\r\n        }\r\n        if (e.matchCase) {\r\n            this._storageService.store('editor.matchCase', this._state.actualMatchCase, 1 /* WORKSPACE */);\r\n        }\r\n        if (e.preserveCase) {\r\n            this._storageService.store('editor.preserveCase', this._state.actualPreserveCase, 1 /* WORKSPACE */);\r\n        }\r\n    };\r\n    CommonFindController.prototype.loadQueryState = function () {\r\n        this._state.change({\r\n            matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* WORKSPACE */, this._state.matchCase),\r\n            wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* WORKSPACE */, this._state.wholeWord),\r\n            isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* WORKSPACE */, this._state.isRegex),\r\n            preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* WORKSPACE */, this._state.preserveCase)\r\n        }, false);\r\n    };\r\n    CommonFindController.prototype.isFindInputFocused = function () {\r\n        return !!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService);\r\n    };\r\n    CommonFindController.prototype.getState = function () {\r\n        return this._state;\r\n    };\r\n    CommonFindController.prototype.closeFindWidget = function () {\r\n        this._state.change({\r\n            isRevealed: false,\r\n            searchScope: null\r\n        }, false);\r\n        this._editor.focus();\r\n    };\r\n    CommonFindController.prototype.toggleCaseSensitive = function () {\r\n        this._state.change({ matchCase: !this._state.matchCase }, false);\r\n        if (!this._state.isRevealed) {\r\n            this.highlightFindOptions();\r\n        }\r\n    };\r\n    CommonFindController.prototype.toggleWholeWords = function () {\r\n        this._state.change({ wholeWord: !this._state.wholeWord }, false);\r\n        if (!this._state.isRevealed) {\r\n            this.highlightFindOptions();\r\n        }\r\n    };\r\n    CommonFindController.prototype.toggleRegex = function () {\r\n        this._state.change({ isRegex: !this._state.isRegex }, false);\r\n        if (!this._state.isRevealed) {\r\n            this.highlightFindOptions();\r\n        }\r\n    };\r\n    CommonFindController.prototype.toggleSearchScope = function () {\r\n        if (this._state.searchScope) {\r\n            this._state.change({ searchScope: null }, true);\r\n        }\r\n        else {\r\n            if (this._editor.hasModel()) {\r\n                var selection = this._editor.getSelection();\r\n                if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\r\n                    selection = selection.setEndPosition(selection.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\r\n                }\r\n                if (!selection.isEmpty()) {\r\n                    this._state.change({ searchScope: selection }, true);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    CommonFindController.prototype.setSearchString = function (searchString) {\r\n        if (this._state.isRegex) {\r\n            searchString = strings.escapeRegExpCharacters(searchString);\r\n        }\r\n        this._state.change({ searchString: searchString }, false);\r\n    };\r\n    CommonFindController.prototype.highlightFindOptions = function () {\r\n        // overwritten in subclass\r\n    };\r\n    CommonFindController.prototype._start = function (opts) {\r\n        this.disposeModel();\r\n        if (!this._editor.hasModel()) {\r\n            // cannot do anything with an editor that doesn't have a model...\r\n            return;\r\n        }\r\n        var stateChanges = {\r\n            isRevealed: true\r\n        };\r\n        if (opts.seedSearchStringFromSelection) {\r\n            var selectionSearchString = getSelectionSearchString(this._editor);\r\n            if (selectionSearchString) {\r\n                if (this._state.isRegex) {\r\n                    stateChanges.searchString = strings.escapeRegExpCharacters(selectionSearchString);\r\n                }\r\n                else {\r\n                    stateChanges.searchString = selectionSearchString;\r\n                }\r\n            }\r\n        }\r\n        if (!stateChanges.searchString && opts.seedSearchStringFromGlobalClipboard) {\r\n            var selectionSearchString = this.getGlobalBufferTerm();\r\n            if (selectionSearchString) {\r\n                stateChanges.searchString = selectionSearchString;\r\n            }\r\n        }\r\n        // Overwrite isReplaceRevealed\r\n        if (opts.forceRevealReplace) {\r\n            stateChanges.isReplaceRevealed = true;\r\n        }\r\n        else if (!this._findWidgetVisible.get()) {\r\n            stateChanges.isReplaceRevealed = false;\r\n        }\r\n        if (opts.updateSearchScope) {\r\n            var currentSelection = this._editor.getSelection();\r\n            if (!currentSelection.isEmpty()) {\r\n                stateChanges.searchScope = currentSelection;\r\n            }\r\n        }\r\n        this._state.change(stateChanges, false);\r\n        if (!this._model) {\r\n            this._model = new FindModelBoundToEditorModel(this._editor, this._state);\r\n        }\r\n    };\r\n    CommonFindController.prototype.start = function (opts) {\r\n        this._start(opts);\r\n    };\r\n    CommonFindController.prototype.moveToNextMatch = function () {\r\n        if (this._model) {\r\n            this._model.moveToNextMatch();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CommonFindController.prototype.moveToPrevMatch = function () {\r\n        if (this._model) {\r\n            this._model.moveToPrevMatch();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CommonFindController.prototype.replace = function () {\r\n        if (this._model) {\r\n            this._model.replace();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CommonFindController.prototype.replaceAll = function () {\r\n        if (this._model) {\r\n            this._model.replaceAll();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CommonFindController.prototype.selectAllMatches = function () {\r\n        if (this._model) {\r\n            this._model.selectAllMatches();\r\n            this._editor.focus();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CommonFindController.prototype.getGlobalBufferTerm = function () {\r\n        if (this._editor.getOption(27 /* find */).globalFindClipboard\r\n            && this._clipboardService\r\n            && this._editor.hasModel()\r\n            && !this._editor.getModel().isTooLargeForSyncing()) {\r\n            return this._clipboardService.readFindText();\r\n        }\r\n        return '';\r\n    };\r\n    CommonFindController.prototype.setGlobalBufferTerm = function (text) {\r\n        if (this._editor.getOption(27 /* find */).globalFindClipboard\r\n            && this._clipboardService\r\n            && this._editor.hasModel()\r\n            && !this._editor.getModel().isTooLargeForSyncing()) {\r\n            this._clipboardService.writeFindText(text);\r\n        }\r\n    };\r\n    CommonFindController.ID = 'editor.contrib.findController';\r\n    CommonFindController = __decorate([\r\n        __param(1, IContextKeyService),\r\n        __param(2, IStorageService),\r\n        __param(3, IClipboardService)\r\n    ], CommonFindController);\r\n    return CommonFindController;\r\n}(Disposable));\r\nexport { CommonFindController };\r\nvar FindController = /** @class */ (function (_super) {\r\n    __extends(FindController, _super);\r\n    function FindController(editor, _contextViewService, _contextKeyService, _keybindingService, _themeService, _notificationService, _storageService, clipboardService) {\r\n        var _this = _super.call(this, editor, _contextKeyService, _storageService, clipboardService) || this;\r\n        _this._contextViewService = _contextViewService;\r\n        _this._keybindingService = _keybindingService;\r\n        _this._themeService = _themeService;\r\n        _this._notificationService = _notificationService;\r\n        _this._widget = null;\r\n        _this._findOptionsWidget = null;\r\n        return _this;\r\n    }\r\n    FindController.prototype._start = function (opts) {\r\n        if (!this._widget) {\r\n            this._createFindWidget();\r\n        }\r\n        var selection = this._editor.getSelection();\r\n        var updateSearchScope = false;\r\n        switch (this._editor.getOption(27 /* find */).autoFindInSelection) {\r\n            case 'always':\r\n                updateSearchScope = true;\r\n                break;\r\n            case 'never':\r\n                updateSearchScope = false;\r\n                break;\r\n            case 'multiline':\r\n                var isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\r\n                updateSearchScope = isSelectionMultipleLine;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        opts.updateSearchScope = updateSearchScope;\r\n        _super.prototype._start.call(this, opts);\r\n        if (opts.shouldFocus === 2 /* FocusReplaceInput */) {\r\n            this._widget.focusReplaceInput();\r\n        }\r\n        else if (opts.shouldFocus === 1 /* FocusFindInput */) {\r\n            this._widget.focusFindInput();\r\n        }\r\n    };\r\n    FindController.prototype.highlightFindOptions = function () {\r\n        if (!this._widget) {\r\n            this._createFindWidget();\r\n        }\r\n        if (this._state.isRevealed) {\r\n            this._widget.highlightFindOptions();\r\n        }\r\n        else {\r\n            this._findOptionsWidget.highlightFindOptions();\r\n        }\r\n    };\r\n    FindController.prototype._createFindWidget = function () {\r\n        this._widget = this._register(new FindWidget(this._editor, this, this._state, this._contextViewService, this._keybindingService, this._contextKeyService, this._themeService, this._storageService, this._notificationService));\r\n        this._findOptionsWidget = this._register(new FindOptionsWidget(this._editor, this._state, this._keybindingService, this._themeService));\r\n    };\r\n    FindController = __decorate([\r\n        __param(1, IContextViewService),\r\n        __param(2, IContextKeyService),\r\n        __param(3, IKeybindingService),\r\n        __param(4, IThemeService),\r\n        __param(5, INotificationService),\r\n        __param(6, IStorageService),\r\n        __param(7, optional(IClipboardService))\r\n    ], FindController);\r\n    return FindController;\r\n}(CommonFindController));\r\nexport { FindController };\r\nvar StartFindAction = /** @class */ (function (_super) {\r\n    __extends(StartFindAction, _super);\r\n    function StartFindAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.StartFindAction,\r\n            label: nls.localize('startFindAction', \"Find\"),\r\n            alias: 'Find',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 2048 /* CtrlCmd */ | 36 /* KEY_F */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 15 /* MenubarEditMenu */,\r\n                group: '3_find',\r\n                title: nls.localize({ key: 'miFind', comment: ['&& denotes a mnemonic'] }, \"&&Find\"),\r\n                order: 1\r\n            }\r\n        }) || this;\r\n    }\r\n    StartFindAction.prototype.run = function (accessor, editor) {\r\n        var controller = CommonFindController.get(editor);\r\n        if (controller) {\r\n            controller.start({\r\n                forceRevealReplace: false,\r\n                seedSearchStringFromSelection: editor.getOption(27 /* find */).seedSearchStringFromSelection,\r\n                seedSearchStringFromGlobalClipboard: editor.getOption(27 /* find */).globalFindClipboard,\r\n                shouldFocus: 1 /* FocusFindInput */,\r\n                shouldAnimate: true,\r\n                updateSearchScope: false\r\n            });\r\n        }\r\n    };\r\n    return StartFindAction;\r\n}(EditorAction));\r\nexport { StartFindAction };\r\nvar StartFindWithSelectionAction = /** @class */ (function (_super) {\r\n    __extends(StartFindWithSelectionAction, _super);\r\n    function StartFindWithSelectionAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.StartFindWithSelection,\r\n            label: nls.localize('startFindWithSelectionAction', \"Find With Selection\"),\r\n            alias: 'Find With Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 0,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 35 /* KEY_E */,\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    StartFindWithSelectionAction.prototype.run = function (accessor, editor) {\r\n        var controller = CommonFindController.get(editor);\r\n        if (controller) {\r\n            controller.start({\r\n                forceRevealReplace: false,\r\n                seedSearchStringFromSelection: true,\r\n                seedSearchStringFromGlobalClipboard: false,\r\n                shouldFocus: 0 /* NoFocusChange */,\r\n                shouldAnimate: true,\r\n                updateSearchScope: false\r\n            });\r\n            controller.setGlobalBufferTerm(controller.getState().searchString);\r\n        }\r\n    };\r\n    return StartFindWithSelectionAction;\r\n}(EditorAction));\r\nexport { StartFindWithSelectionAction };\r\nvar MatchFindAction = /** @class */ (function (_super) {\r\n    __extends(MatchFindAction, _super);\r\n    function MatchFindAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MatchFindAction.prototype.run = function (accessor, editor) {\r\n        var controller = CommonFindController.get(editor);\r\n        if (controller && !this._run(controller)) {\r\n            controller.start({\r\n                forceRevealReplace: false,\r\n                seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(27 /* find */).seedSearchStringFromSelection,\r\n                seedSearchStringFromGlobalClipboard: true,\r\n                shouldFocus: 0 /* NoFocusChange */,\r\n                shouldAnimate: true,\r\n                updateSearchScope: false\r\n            });\r\n            this._run(controller);\r\n        }\r\n    };\r\n    return MatchFindAction;\r\n}(EditorAction));\r\nexport { MatchFindAction };\r\nvar NextMatchFindAction = /** @class */ (function (_super) {\r\n    __extends(NextMatchFindAction, _super);\r\n    function NextMatchFindAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.NextMatchFindAction,\r\n            label: nls.localize('findNextMatchAction', \"Find Next\"),\r\n            alias: 'Find Next',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 61 /* F3 */,\r\n                mac: { primary: 2048 /* CtrlCmd */ | 37 /* KEY_G */, secondary: [61 /* F3 */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    NextMatchFindAction.prototype._run = function (controller) {\r\n        return controller.moveToNextMatch();\r\n    };\r\n    return NextMatchFindAction;\r\n}(MatchFindAction));\r\nexport { NextMatchFindAction };\r\nvar NextMatchFindAction2 = /** @class */ (function (_super) {\r\n    __extends(NextMatchFindAction2, _super);\r\n    function NextMatchFindAction2() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.NextMatchFindAction,\r\n            label: nls.localize('findNextMatchAction', \"Find Next\"),\r\n            alias: 'Find Next',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\r\n                primary: 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    NextMatchFindAction2.prototype._run = function (controller) {\r\n        return controller.moveToNextMatch();\r\n    };\r\n    return NextMatchFindAction2;\r\n}(MatchFindAction));\r\nexport { NextMatchFindAction2 };\r\nvar PreviousMatchFindAction = /** @class */ (function (_super) {\r\n    __extends(PreviousMatchFindAction, _super);\r\n    function PreviousMatchFindAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.PreviousMatchFindAction,\r\n            label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\r\n            alias: 'Find Previous',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 1024 /* Shift */ | 61 /* F3 */,\r\n                mac: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 37 /* KEY_G */, secondary: [1024 /* Shift */ | 61 /* F3 */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    PreviousMatchFindAction.prototype._run = function (controller) {\r\n        return controller.moveToPrevMatch();\r\n    };\r\n    return PreviousMatchFindAction;\r\n}(MatchFindAction));\r\nexport { PreviousMatchFindAction };\r\nvar PreviousMatchFindAction2 = /** @class */ (function (_super) {\r\n    __extends(PreviousMatchFindAction2, _super);\r\n    function PreviousMatchFindAction2() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.PreviousMatchFindAction,\r\n            label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\r\n            alias: 'Find Previous',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\r\n                primary: 1024 /* Shift */ | 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    PreviousMatchFindAction2.prototype._run = function (controller) {\r\n        return controller.moveToPrevMatch();\r\n    };\r\n    return PreviousMatchFindAction2;\r\n}(MatchFindAction));\r\nexport { PreviousMatchFindAction2 };\r\nvar SelectionMatchFindAction = /** @class */ (function (_super) {\r\n    __extends(SelectionMatchFindAction, _super);\r\n    function SelectionMatchFindAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SelectionMatchFindAction.prototype.run = function (accessor, editor) {\r\n        var controller = CommonFindController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        var selectionSearchString = getSelectionSearchString(editor);\r\n        if (selectionSearchString) {\r\n            controller.setSearchString(selectionSearchString);\r\n        }\r\n        if (!this._run(controller)) {\r\n            controller.start({\r\n                forceRevealReplace: false,\r\n                seedSearchStringFromSelection: editor.getOption(27 /* find */).seedSearchStringFromSelection,\r\n                seedSearchStringFromGlobalClipboard: false,\r\n                shouldFocus: 0 /* NoFocusChange */,\r\n                shouldAnimate: true,\r\n                updateSearchScope: false\r\n            });\r\n            this._run(controller);\r\n        }\r\n    };\r\n    return SelectionMatchFindAction;\r\n}(EditorAction));\r\nexport { SelectionMatchFindAction };\r\nvar NextSelectionMatchFindAction = /** @class */ (function (_super) {\r\n    __extends(NextSelectionMatchFindAction, _super);\r\n    function NextSelectionMatchFindAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.NextSelectionMatchFindAction,\r\n            label: nls.localize('nextSelectionMatchFindAction', \"Find Next Selection\"),\r\n            alias: 'Find Next Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 61 /* F3 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    NextSelectionMatchFindAction.prototype._run = function (controller) {\r\n        return controller.moveToNextMatch();\r\n    };\r\n    return NextSelectionMatchFindAction;\r\n}(SelectionMatchFindAction));\r\nexport { NextSelectionMatchFindAction };\r\nvar PreviousSelectionMatchFindAction = /** @class */ (function (_super) {\r\n    __extends(PreviousSelectionMatchFindAction, _super);\r\n    function PreviousSelectionMatchFindAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.PreviousSelectionMatchFindAction,\r\n            label: nls.localize('previousSelectionMatchFindAction', \"Find Previous Selection\"),\r\n            alias: 'Find Previous Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 61 /* F3 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    PreviousSelectionMatchFindAction.prototype._run = function (controller) {\r\n        return controller.moveToPrevMatch();\r\n    };\r\n    return PreviousSelectionMatchFindAction;\r\n}(SelectionMatchFindAction));\r\nexport { PreviousSelectionMatchFindAction };\r\nvar StartFindReplaceAction = /** @class */ (function (_super) {\r\n    __extends(StartFindReplaceAction, _super);\r\n    function StartFindReplaceAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.StartFindReplaceAction,\r\n            label: nls.localize('startReplace', \"Replace\"),\r\n            alias: 'Replace',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 2048 /* CtrlCmd */ | 38 /* KEY_H */,\r\n                mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 36 /* KEY_F */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 15 /* MenubarEditMenu */,\r\n                group: '3_find',\r\n                title: nls.localize({ key: 'miReplace', comment: ['&& denotes a mnemonic'] }, \"&&Replace\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    StartFindReplaceAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel() || editor.getOption(65 /* readOnly */)) {\r\n            return;\r\n        }\r\n        var controller = CommonFindController.get(editor);\r\n        var currentSelection = editor.getSelection();\r\n        var findInputFocused = controller.isFindInputFocused();\r\n        // we only seed search string from selection when the current selection is single line and not empty,\r\n        // + the find input is not focused\r\n        var seedSearchStringFromSelection = !currentSelection.isEmpty()\r\n            && currentSelection.startLineNumber === currentSelection.endLineNumber && editor.getOption(27 /* find */).seedSearchStringFromSelection\r\n            && !findInputFocused;\r\n        /*\r\n         * if the existing search string in find widget is empty and we don't seed search string from selection, it means the Find Input is still empty, so we should focus the Find Input instead of Replace Input.\r\n\r\n         * findInputFocused true -> seedSearchStringFromSelection false, FocusReplaceInput\r\n         * findInputFocused false, seedSearchStringFromSelection true FocusReplaceInput\r\n         * findInputFocused false seedSearchStringFromSelection false FocusFindInput\r\n         */\r\n        var shouldFocus = (findInputFocused || seedSearchStringFromSelection) ?\r\n            2 /* FocusReplaceInput */ : 1 /* FocusFindInput */;\r\n        if (controller) {\r\n            controller.start({\r\n                forceRevealReplace: true,\r\n                seedSearchStringFromSelection: seedSearchStringFromSelection,\r\n                seedSearchStringFromGlobalClipboard: editor.getOption(27 /* find */).seedSearchStringFromSelection,\r\n                shouldFocus: shouldFocus,\r\n                shouldAnimate: true,\r\n                updateSearchScope: false\r\n            });\r\n        }\r\n    };\r\n    return StartFindReplaceAction;\r\n}(EditorAction));\r\nexport { StartFindReplaceAction };\r\nregisterEditorContribution(CommonFindController.ID, FindController);\r\nregisterEditorAction(StartFindAction);\r\nregisterEditorAction(StartFindWithSelectionAction);\r\nregisterEditorAction(NextMatchFindAction);\r\nregisterEditorAction(NextMatchFindAction2);\r\nregisterEditorAction(PreviousMatchFindAction);\r\nregisterEditorAction(PreviousMatchFindAction2);\r\nregisterEditorAction(NextSelectionMatchFindAction);\r\nregisterEditorAction(PreviousSelectionMatchFindAction);\r\nregisterEditorAction(StartFindReplaceAction);\r\nvar FindCommand = EditorCommand.bindToContribution(CommonFindController.get);\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.CloseFindWidgetCommand,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.closeFindWidget(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleCaseSensitiveCommand,\r\n    precondition: undefined,\r\n    handler: function (x) { return x.toggleCaseSensitive(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleCaseSensitiveKeybinding.primary,\r\n        mac: ToggleCaseSensitiveKeybinding.mac,\r\n        win: ToggleCaseSensitiveKeybinding.win,\r\n        linux: ToggleCaseSensitiveKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleWholeWordCommand,\r\n    precondition: undefined,\r\n    handler: function (x) { return x.toggleWholeWords(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleWholeWordKeybinding.primary,\r\n        mac: ToggleWholeWordKeybinding.mac,\r\n        win: ToggleWholeWordKeybinding.win,\r\n        linux: ToggleWholeWordKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleRegexCommand,\r\n    precondition: undefined,\r\n    handler: function (x) { return x.toggleRegex(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleRegexKeybinding.primary,\r\n        mac: ToggleRegexKeybinding.mac,\r\n        win: ToggleRegexKeybinding.win,\r\n        linux: ToggleRegexKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleSearchScopeCommand,\r\n    precondition: undefined,\r\n    handler: function (x) { return x.toggleSearchScope(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleSearchScopeKeybinding.primary,\r\n        mac: ToggleSearchScopeKeybinding.mac,\r\n        win: ToggleSearchScopeKeybinding.win,\r\n        linux: ToggleSearchScopeKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceOneAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.replace(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 22 /* KEY_1 */\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceOneAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.replace(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\r\n        primary: 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceAllAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.replaceAll(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceAllAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.replaceAll(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\r\n        primary: undefined,\r\n        mac: {\r\n            primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n        }\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.SelectAllMatchesAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.selectAllMatches(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 512 /* Alt */ | 3 /* Enter */\r\n    }\r\n}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport var MAX_FOLDING_REGIONS = 0xFFFF;\r\nexport var MAX_LINE_NUMBER = 0xFFFFFF;\r\nvar MASK_INDENT = 0xFF000000;\r\nvar FoldingRegions = /** @class */ (function () {\r\n    function FoldingRegions(startIndexes, endIndexes, types) {\r\n        if (startIndexes.length !== endIndexes.length || startIndexes.length > MAX_FOLDING_REGIONS) {\r\n            throw new Error('invalid startIndexes or endIndexes size');\r\n        }\r\n        this._startIndexes = startIndexes;\r\n        this._endIndexes = endIndexes;\r\n        this._collapseStates = new Uint32Array(Math.ceil(startIndexes.length / 32));\r\n        this._types = types;\r\n        this._parentsComputed = false;\r\n    }\r\n    FoldingRegions.prototype.ensureParentIndices = function () {\r\n        var _this = this;\r\n        if (!this._parentsComputed) {\r\n            this._parentsComputed = true;\r\n            var parentIndexes_1 = [];\r\n            var isInsideLast = function (startLineNumber, endLineNumber) {\r\n                var index = parentIndexes_1[parentIndexes_1.length - 1];\r\n                return _this.getStartLineNumber(index) <= startLineNumber && _this.getEndLineNumber(index) >= endLineNumber;\r\n            };\r\n            for (var i = 0, len = this._startIndexes.length; i < len; i++) {\r\n                var startLineNumber = this._startIndexes[i];\r\n                var endLineNumber = this._endIndexes[i];\r\n                if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\r\n                    throw new Error('startLineNumber or endLineNumber must not exceed ' + MAX_LINE_NUMBER);\r\n                }\r\n                while (parentIndexes_1.length > 0 && !isInsideLast(startLineNumber, endLineNumber)) {\r\n                    parentIndexes_1.pop();\r\n                }\r\n                var parentIndex = parentIndexes_1.length > 0 ? parentIndexes_1[parentIndexes_1.length - 1] : -1;\r\n                parentIndexes_1.push(i);\r\n                this._startIndexes[i] = startLineNumber + ((parentIndex & 0xFF) << 24);\r\n                this._endIndexes[i] = endLineNumber + ((parentIndex & 0xFF00) << 16);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(FoldingRegions.prototype, \"length\", {\r\n        get: function () {\r\n            return this._startIndexes.length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FoldingRegions.prototype.getStartLineNumber = function (index) {\r\n        return this._startIndexes[index] & MAX_LINE_NUMBER;\r\n    };\r\n    FoldingRegions.prototype.getEndLineNumber = function (index) {\r\n        return this._endIndexes[index] & MAX_LINE_NUMBER;\r\n    };\r\n    FoldingRegions.prototype.getType = function (index) {\r\n        return this._types ? this._types[index] : undefined;\r\n    };\r\n    FoldingRegions.prototype.hasTypes = function () {\r\n        return !!this._types;\r\n    };\r\n    FoldingRegions.prototype.isCollapsed = function (index) {\r\n        var arrayIndex = (index / 32) | 0;\r\n        var bit = index % 32;\r\n        return (this._collapseStates[arrayIndex] & (1 << bit)) !== 0;\r\n    };\r\n    FoldingRegions.prototype.setCollapsed = function (index, newState) {\r\n        var arrayIndex = (index / 32) | 0;\r\n        var bit = index % 32;\r\n        var value = this._collapseStates[arrayIndex];\r\n        if (newState) {\r\n            this._collapseStates[arrayIndex] = value | (1 << bit);\r\n        }\r\n        else {\r\n            this._collapseStates[arrayIndex] = value & ~(1 << bit);\r\n        }\r\n    };\r\n    FoldingRegions.prototype.toRegion = function (index) {\r\n        return new FoldingRegion(this, index);\r\n    };\r\n    FoldingRegions.prototype.getParentIndex = function (index) {\r\n        this.ensureParentIndices();\r\n        var parent = ((this._startIndexes[index] & MASK_INDENT) >>> 24) + ((this._endIndexes[index] & MASK_INDENT) >>> 16);\r\n        if (parent === MAX_FOLDING_REGIONS) {\r\n            return -1;\r\n        }\r\n        return parent;\r\n    };\r\n    FoldingRegions.prototype.contains = function (index, line) {\r\n        return this.getStartLineNumber(index) <= line && this.getEndLineNumber(index) >= line;\r\n    };\r\n    FoldingRegions.prototype.findIndex = function (line) {\r\n        var low = 0, high = this._startIndexes.length;\r\n        if (high === 0) {\r\n            return -1; // no children\r\n        }\r\n        while (low < high) {\r\n            var mid = Math.floor((low + high) / 2);\r\n            if (line < this.getStartLineNumber(mid)) {\r\n                high = mid;\r\n            }\r\n            else {\r\n                low = mid + 1;\r\n            }\r\n        }\r\n        return low - 1;\r\n    };\r\n    FoldingRegions.prototype.findRange = function (line) {\r\n        var index = this.findIndex(line);\r\n        if (index >= 0) {\r\n            var endLineNumber = this.getEndLineNumber(index);\r\n            if (endLineNumber >= line) {\r\n                return index;\r\n            }\r\n            index = this.getParentIndex(index);\r\n            while (index !== -1) {\r\n                if (this.contains(index, line)) {\r\n                    return index;\r\n                }\r\n                index = this.getParentIndex(index);\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n    FoldingRegions.prototype.toString = function () {\r\n        var res = [];\r\n        for (var i = 0; i < this.length; i++) {\r\n            res[i] = \"[\" + (this.isCollapsed(i) ? '+' : '-') + \"] \" + this.getStartLineNumber(i) + \"/\" + this.getEndLineNumber(i);\r\n        }\r\n        return res.join(', ');\r\n    };\r\n    return FoldingRegions;\r\n}());\r\nexport { FoldingRegions };\r\nvar FoldingRegion = /** @class */ (function () {\r\n    function FoldingRegion(ranges, index) {\r\n        this.ranges = ranges;\r\n        this.index = index;\r\n    }\r\n    Object.defineProperty(FoldingRegion.prototype, \"startLineNumber\", {\r\n        get: function () {\r\n            return this.ranges.getStartLineNumber(this.index);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingRegion.prototype, \"endLineNumber\", {\r\n        get: function () {\r\n            return this.ranges.getEndLineNumber(this.index);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingRegion.prototype, \"regionIndex\", {\r\n        get: function () {\r\n            return this.index;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingRegion.prototype, \"parentIndex\", {\r\n        get: function () {\r\n            return this.ranges.getParentIndex(this.index);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingRegion.prototype, \"isCollapsed\", {\r\n        get: function () {\r\n            return this.ranges.isCollapsed(this.index);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FoldingRegion.prototype.containedBy = function (range) {\r\n        return range.startLineNumber <= this.startLineNumber && range.endLineNumber >= this.endLineNumber;\r\n    };\r\n    FoldingRegion.prototype.containsLine = function (lineNumber) {\r\n        return this.startLineNumber <= lineNumber && lineNumber <= this.endLineNumber;\r\n    };\r\n    return FoldingRegion;\r\n}());\r\nexport { FoldingRegion };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { FoldingRegions } from './foldingRanges.js';\r\nvar FoldingModel = /** @class */ (function () {\r\n    function FoldingModel(textModel, decorationProvider) {\r\n        this._updateEventEmitter = new Emitter();\r\n        this.onDidChange = this._updateEventEmitter.event;\r\n        this._textModel = textModel;\r\n        this._decorationProvider = decorationProvider;\r\n        this._regions = new FoldingRegions(new Uint32Array(0), new Uint32Array(0));\r\n        this._editorDecorationIds = [];\r\n        this._isInitialized = false;\r\n    }\r\n    Object.defineProperty(FoldingModel.prototype, \"regions\", {\r\n        get: function () { return this._regions; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingModel.prototype, \"textModel\", {\r\n        get: function () { return this._textModel; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingModel.prototype, \"isInitialized\", {\r\n        get: function () { return this._isInitialized; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FoldingModel.prototype.toggleCollapseState = function (regions) {\r\n        var _this = this;\r\n        if (!regions.length) {\r\n            return;\r\n        }\r\n        var processed = {};\r\n        this._decorationProvider.changeDecorations(function (accessor) {\r\n            for (var _i = 0, regions_1 = regions; _i < regions_1.length; _i++) {\r\n                var region = regions_1[_i];\r\n                var index = region.regionIndex;\r\n                var editorDecorationId = _this._editorDecorationIds[index];\r\n                if (editorDecorationId && !processed[editorDecorationId]) {\r\n                    processed[editorDecorationId] = true;\r\n                    var newCollapseState = !_this._regions.isCollapsed(index);\r\n                    _this._regions.setCollapsed(index, newCollapseState);\r\n                    accessor.changeDecorationOptions(editorDecorationId, _this._decorationProvider.getDecorationOption(newCollapseState));\r\n                }\r\n            }\r\n        });\r\n        this._updateEventEmitter.fire({ model: this, collapseStateChanged: regions });\r\n    };\r\n    FoldingModel.prototype.update = function (newRegions, blockedLineNumers) {\r\n        var _this = this;\r\n        if (blockedLineNumers === void 0) { blockedLineNumers = []; }\r\n        var newEditorDecorations = [];\r\n        var isBlocked = function (startLineNumber, endLineNumber) {\r\n            for (var _i = 0, blockedLineNumers_1 = blockedLineNumers; _i < blockedLineNumers_1.length; _i++) {\r\n                var blockedLineNumber = blockedLineNumers_1[_i];\r\n                if (startLineNumber < blockedLineNumber && blockedLineNumber <= endLineNumber) { // first line is visible\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        var initRange = function (index, isCollapsed) {\r\n            var startLineNumber = newRegions.getStartLineNumber(index);\r\n            if (isCollapsed && isBlocked(startLineNumber, newRegions.getEndLineNumber(index))) {\r\n                isCollapsed = false;\r\n            }\r\n            newRegions.setCollapsed(index, isCollapsed);\r\n            var maxColumn = _this._textModel.getLineMaxColumn(startLineNumber);\r\n            var decorationRange = {\r\n                startLineNumber: startLineNumber,\r\n                startColumn: maxColumn,\r\n                endLineNumber: startLineNumber,\r\n                endColumn: maxColumn\r\n            };\r\n            newEditorDecorations.push({ range: decorationRange, options: _this._decorationProvider.getDecorationOption(isCollapsed) });\r\n        };\r\n        var i = 0;\r\n        var nextCollapsed = function () {\r\n            while (i < _this._regions.length) {\r\n                var isCollapsed = _this._regions.isCollapsed(i);\r\n                i++;\r\n                if (isCollapsed) {\r\n                    return i - 1;\r\n                }\r\n            }\r\n            return -1;\r\n        };\r\n        var k = 0;\r\n        var collapsedIndex = nextCollapsed();\r\n        while (collapsedIndex !== -1 && k < newRegions.length) {\r\n            // get the latest range\r\n            var decRange = this._textModel.getDecorationRange(this._editorDecorationIds[collapsedIndex]);\r\n            if (decRange) {\r\n                var collapsedStartLineNumber = decRange.startLineNumber;\r\n                if (this._textModel.getLineMaxColumn(collapsedStartLineNumber) === decRange.startColumn) { // test that the decoration is still at the end otherwise it got deleted\r\n                    while (k < newRegions.length) {\r\n                        var startLineNumber = newRegions.getStartLineNumber(k);\r\n                        if (collapsedStartLineNumber >= startLineNumber) {\r\n                            initRange(k, collapsedStartLineNumber === startLineNumber);\r\n                            k++;\r\n                        }\r\n                        else {\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            collapsedIndex = nextCollapsed();\r\n        }\r\n        while (k < newRegions.length) {\r\n            initRange(k, false);\r\n            k++;\r\n        }\r\n        this._editorDecorationIds = this._decorationProvider.deltaDecorations(this._editorDecorationIds, newEditorDecorations);\r\n        this._regions = newRegions;\r\n        this._isInitialized = true;\r\n        this._updateEventEmitter.fire({ model: this });\r\n    };\r\n    /**\r\n     * Collapse state memento, for persistence only\r\n     */\r\n    FoldingModel.prototype.getMemento = function () {\r\n        var collapsedRanges = [];\r\n        for (var i = 0; i < this._regions.length; i++) {\r\n            if (this._regions.isCollapsed(i)) {\r\n                var range = this._textModel.getDecorationRange(this._editorDecorationIds[i]);\r\n                if (range) {\r\n                    var startLineNumber = range.startLineNumber;\r\n                    var endLineNumber = range.endLineNumber + this._regions.getEndLineNumber(i) - this._regions.getStartLineNumber(i);\r\n                    collapsedRanges.push({ startLineNumber: startLineNumber, endLineNumber: endLineNumber });\r\n                }\r\n            }\r\n        }\r\n        if (collapsedRanges.length > 0) {\r\n            return collapsedRanges;\r\n        }\r\n        return undefined;\r\n    };\r\n    /**\r\n     * Apply persisted state, for persistence only\r\n     */\r\n    FoldingModel.prototype.applyMemento = function (state) {\r\n        if (!Array.isArray(state)) {\r\n            return;\r\n        }\r\n        var toToogle = [];\r\n        for (var _i = 0, state_1 = state; _i < state_1.length; _i++) {\r\n            var range = state_1[_i];\r\n            var region = this.getRegionAtLine(range.startLineNumber);\r\n            if (region && !region.isCollapsed) {\r\n                toToogle.push(region);\r\n            }\r\n        }\r\n        this.toggleCollapseState(toToogle);\r\n    };\r\n    FoldingModel.prototype.dispose = function () {\r\n        this._decorationProvider.deltaDecorations(this._editorDecorationIds, []);\r\n    };\r\n    FoldingModel.prototype.getAllRegionsAtLine = function (lineNumber, filter) {\r\n        var result = [];\r\n        if (this._regions) {\r\n            var index = this._regions.findRange(lineNumber);\r\n            var level = 1;\r\n            while (index >= 0) {\r\n                var current = this._regions.toRegion(index);\r\n                if (!filter || filter(current, level)) {\r\n                    result.push(current);\r\n                }\r\n                level++;\r\n                index = current.parentIndex;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    FoldingModel.prototype.getRegionAtLine = function (lineNumber) {\r\n        if (this._regions) {\r\n            var index = this._regions.findRange(lineNumber);\r\n            if (index >= 0) {\r\n                return this._regions.toRegion(index);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    FoldingModel.prototype.getRegionsInside = function (region, filter) {\r\n        var result = [];\r\n        var index = region ? region.regionIndex + 1 : 0;\r\n        var endLineNumber = region ? region.endLineNumber : Number.MAX_VALUE;\r\n        if (filter && filter.length === 2) {\r\n            var levelStack = [];\r\n            for (var i = index, len = this._regions.length; i < len; i++) {\r\n                var current = this._regions.toRegion(i);\r\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\r\n                    while (levelStack.length > 0 && !current.containedBy(levelStack[levelStack.length - 1])) {\r\n                        levelStack.pop();\r\n                    }\r\n                    levelStack.push(current);\r\n                    if (filter(current, levelStack.length)) {\r\n                        result.push(current);\r\n                    }\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (var i = index, len = this._regions.length; i < len; i++) {\r\n                var current = this._regions.toRegion(i);\r\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\r\n                    if (!filter || filter(current)) {\r\n                        result.push(current);\r\n                    }\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    return FoldingModel;\r\n}());\r\nexport { FoldingModel };\r\n/**\r\n * Collapse or expand the regions at the given locations\r\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\r\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\r\n */\r\nexport function toggleCollapseState(foldingModel, levels, lineNumbers) {\r\n    var toToggle = [];\r\n    var _loop_1 = function (lineNumber) {\r\n        var region = foldingModel.getRegionAtLine(lineNumber);\r\n        if (region) {\r\n            var doCollapse_1 = !region.isCollapsed;\r\n            toToggle.push(region);\r\n            if (levels > 1) {\r\n                var regionsInside = foldingModel.getRegionsInside(region, function (r, level) { return r.isCollapsed !== doCollapse_1 && level < levels; });\r\n                toToggle.push.apply(toToggle, regionsInside);\r\n            }\r\n        }\r\n    };\r\n    for (var _i = 0, lineNumbers_1 = lineNumbers; _i < lineNumbers_1.length; _i++) {\r\n        var lineNumber = lineNumbers_1[_i];\r\n        _loop_1(lineNumber);\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Collapse or expand the regions at the given locations including all children.\r\n * @param doCollapse Wheter to collase or expand\r\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\r\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\r\n */\r\nexport function setCollapseStateLevelsDown(foldingModel, doCollapse, levels, lineNumbers) {\r\n    if (levels === void 0) { levels = Number.MAX_VALUE; }\r\n    var toToggle = [];\r\n    if (lineNumbers && lineNumbers.length > 0) {\r\n        for (var _i = 0, lineNumbers_2 = lineNumbers; _i < lineNumbers_2.length; _i++) {\r\n            var lineNumber = lineNumbers_2[_i];\r\n            var region = foldingModel.getRegionAtLine(lineNumber);\r\n            if (region) {\r\n                if (region.isCollapsed !== doCollapse) {\r\n                    toToggle.push(region);\r\n                }\r\n                if (levels > 1) {\r\n                    var regionsInside = foldingModel.getRegionsInside(region, function (r, level) { return r.isCollapsed !== doCollapse && level < levels; });\r\n                    toToggle.push.apply(toToggle, regionsInside);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        var regionsInside = foldingModel.getRegionsInside(null, function (r, level) { return r.isCollapsed !== doCollapse && level < levels; });\r\n        toToggle.push.apply(toToggle, regionsInside);\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Collapse or expand the regions at the given locations including all parents.\r\n * @param doCollapse Wheter to collase or expand\r\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\r\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\r\n */\r\nexport function setCollapseStateLevelsUp(foldingModel, doCollapse, levels, lineNumbers) {\r\n    var toToggle = [];\r\n    for (var _i = 0, lineNumbers_3 = lineNumbers; _i < lineNumbers_3.length; _i++) {\r\n        var lineNumber = lineNumbers_3[_i];\r\n        var regions = foldingModel.getAllRegionsAtLine(lineNumber, function (region, level) { return region.isCollapsed !== doCollapse && level <= levels; });\r\n        toToggle.push.apply(toToggle, regions);\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Folds or unfolds all regions that have a given level, except if they contain one of the blocked lines.\r\n * @param foldLevel level. Level == 1 is the top level\r\n * @param doCollapse Wheter to collase or expand\r\n*/\r\nexport function setCollapseStateAtLevel(foldingModel, foldLevel, doCollapse, blockedLineNumbers) {\r\n    var filter = function (region, level) { return level === foldLevel && region.isCollapsed !== doCollapse && !blockedLineNumbers.some(function (line) { return region.containsLine(line); }); };\r\n    var toToggle = foldingModel.getRegionsInside(null, filter);\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Folds all regions for which the lines start with a given regex\r\n * @param foldingModel the folding model\r\n */\r\nexport function setCollapseStateForMatchingLines(foldingModel, regExp, doCollapse) {\r\n    var editorModel = foldingModel.textModel;\r\n    var regions = foldingModel.regions;\r\n    var toToggle = [];\r\n    for (var i = regions.length - 1; i >= 0; i--) {\r\n        if (doCollapse !== regions.isCollapsed(i)) {\r\n            var startLineNumber = regions.getStartLineNumber(i);\r\n            if (regExp.test(editorModel.getLineContent(startLineNumber))) {\r\n                toToggle.push(regions.toRegion(i));\r\n            }\r\n        }\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Folds all regions of the given type\r\n * @param foldingModel the folding model\r\n */\r\nexport function setCollapseStateForType(foldingModel, type, doCollapse) {\r\n    var regions = foldingModel.regions;\r\n    var toToggle = [];\r\n    for (var i = regions.length - 1; i >= 0; i--) {\r\n        if (doCollapse !== regions.isCollapsed(i) && type === regions.getType(i)) {\r\n            toToggle.push(regions.toRegion(i));\r\n        }\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nvar FoldingDecorationProvider = /** @class */ (function () {\r\n    function FoldingDecorationProvider(editor) {\r\n        this.editor = editor;\r\n        this.autoHideFoldingControls = true;\r\n    }\r\n    FoldingDecorationProvider.prototype.getDecorationOption = function (isCollapsed) {\r\n        if (isCollapsed) {\r\n            return FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION;\r\n        }\r\n        else if (this.autoHideFoldingControls) {\r\n            return FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION;\r\n        }\r\n        else {\r\n            return FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION;\r\n        }\r\n    };\r\n    FoldingDecorationProvider.prototype.deltaDecorations = function (oldDecorations, newDecorations) {\r\n        return this.editor.deltaDecorations(oldDecorations, newDecorations);\r\n    };\r\n    FoldingDecorationProvider.prototype.changeDecorations = function (callback) {\r\n        return this.editor.changeDecorations(callback);\r\n    };\r\n    FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        afterContentClassName: 'inline-folded',\r\n        linesDecorationsClassName: 'codicon codicon-chevron-right'\r\n    });\r\n    FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        linesDecorationsClassName: 'codicon codicon-chevron-down'\r\n    });\r\n    FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        linesDecorationsClassName: 'codicon codicon-chevron-down alwaysShowFoldIcons'\r\n    });\r\n    return FoldingDecorationProvider;\r\n}());\r\nexport { FoldingDecorationProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { findFirstInSorted } from '../../../base/common/arrays.js';\r\nvar HiddenRangeModel = /** @class */ (function () {\r\n    function HiddenRangeModel(model) {\r\n        var _this = this;\r\n        this._updateEventEmitter = new Emitter();\r\n        this._foldingModel = model;\r\n        this._foldingModelListener = model.onDidChange(function (_) { return _this.updateHiddenRanges(); });\r\n        this._hiddenRanges = [];\r\n        if (model.regions.length) {\r\n            this.updateHiddenRanges();\r\n        }\r\n    }\r\n    Object.defineProperty(HiddenRangeModel.prototype, \"onDidChange\", {\r\n        get: function () { return this._updateEventEmitter.event; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(HiddenRangeModel.prototype, \"hiddenRanges\", {\r\n        get: function () { return this._hiddenRanges; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    HiddenRangeModel.prototype.updateHiddenRanges = function () {\r\n        var updateHiddenAreas = false;\r\n        var newHiddenAreas = [];\r\n        var i = 0; // index into hidden\r\n        var k = 0;\r\n        var lastCollapsedStart = Number.MAX_VALUE;\r\n        var lastCollapsedEnd = -1;\r\n        var ranges = this._foldingModel.regions;\r\n        for (; i < ranges.length; i++) {\r\n            if (!ranges.isCollapsed(i)) {\r\n                continue;\r\n            }\r\n            var startLineNumber = ranges.getStartLineNumber(i) + 1; // the first line is not hidden\r\n            var endLineNumber = ranges.getEndLineNumber(i);\r\n            if (lastCollapsedStart <= startLineNumber && endLineNumber <= lastCollapsedEnd) {\r\n                // ignore ranges contained in collapsed regions\r\n                continue;\r\n            }\r\n            if (!updateHiddenAreas && k < this._hiddenRanges.length && this._hiddenRanges[k].startLineNumber === startLineNumber && this._hiddenRanges[k].endLineNumber === endLineNumber) {\r\n                // reuse the old ranges\r\n                newHiddenAreas.push(this._hiddenRanges[k]);\r\n                k++;\r\n            }\r\n            else {\r\n                updateHiddenAreas = true;\r\n                newHiddenAreas.push(new Range(startLineNumber, 1, endLineNumber, 1));\r\n            }\r\n            lastCollapsedStart = startLineNumber;\r\n            lastCollapsedEnd = endLineNumber;\r\n        }\r\n        if (updateHiddenAreas || k < this._hiddenRanges.length) {\r\n            this.applyHiddenRanges(newHiddenAreas);\r\n        }\r\n    };\r\n    HiddenRangeModel.prototype.applyMemento = function (state) {\r\n        if (!Array.isArray(state) || state.length === 0) {\r\n            return false;\r\n        }\r\n        var hiddenRanges = [];\r\n        for (var _i = 0, state_1 = state; _i < state_1.length; _i++) {\r\n            var r = state_1[_i];\r\n            if (!r.startLineNumber || !r.endLineNumber) {\r\n                return false;\r\n            }\r\n            hiddenRanges.push(new Range(r.startLineNumber + 1, 1, r.endLineNumber, 1));\r\n        }\r\n        this.applyHiddenRanges(hiddenRanges);\r\n        return true;\r\n    };\r\n    /**\r\n     * Collapse state memento, for persistence only, only used if folding model is not yet initialized\r\n     */\r\n    HiddenRangeModel.prototype.getMemento = function () {\r\n        return this._hiddenRanges.map(function (r) { return ({ startLineNumber: r.startLineNumber - 1, endLineNumber: r.endLineNumber }); });\r\n    };\r\n    HiddenRangeModel.prototype.applyHiddenRanges = function (newHiddenAreas) {\r\n        this._hiddenRanges = newHiddenAreas;\r\n        this._updateEventEmitter.fire(newHiddenAreas);\r\n    };\r\n    HiddenRangeModel.prototype.hasRanges = function () {\r\n        return this._hiddenRanges.length > 0;\r\n    };\r\n    HiddenRangeModel.prototype.isHidden = function (line) {\r\n        return findRange(this._hiddenRanges, line) !== null;\r\n    };\r\n    HiddenRangeModel.prototype.adjustSelections = function (selections) {\r\n        var _this = this;\r\n        var hasChanges = false;\r\n        var editorModel = this._foldingModel.textModel;\r\n        var lastRange = null;\r\n        var adjustLine = function (line) {\r\n            if (!lastRange || !isInside(line, lastRange)) {\r\n                lastRange = findRange(_this._hiddenRanges, line);\r\n            }\r\n            if (lastRange) {\r\n                return lastRange.startLineNumber - 1;\r\n            }\r\n            return null;\r\n        };\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            var adjustedStartLine = adjustLine(selection.startLineNumber);\r\n            if (adjustedStartLine) {\r\n                selection = selection.setStartPosition(adjustedStartLine, editorModel.getLineMaxColumn(adjustedStartLine));\r\n                hasChanges = true;\r\n            }\r\n            var adjustedEndLine = adjustLine(selection.endLineNumber);\r\n            if (adjustedEndLine) {\r\n                selection = selection.setEndPosition(adjustedEndLine, editorModel.getLineMaxColumn(adjustedEndLine));\r\n                hasChanges = true;\r\n            }\r\n            selections[i] = selection;\r\n        }\r\n        return hasChanges;\r\n    };\r\n    HiddenRangeModel.prototype.dispose = function () {\r\n        if (this.hiddenRanges.length > 0) {\r\n            this._hiddenRanges = [];\r\n            this._updateEventEmitter.fire(this._hiddenRanges);\r\n        }\r\n        if (this._foldingModelListener) {\r\n            this._foldingModelListener.dispose();\r\n            this._foldingModelListener = null;\r\n        }\r\n    };\r\n    return HiddenRangeModel;\r\n}());\r\nexport { HiddenRangeModel };\r\nfunction isInside(line, range) {\r\n    return line >= range.startLineNumber && line <= range.endLineNumber;\r\n}\r\nfunction findRange(ranges, line) {\r\n    var i = findFirstInSorted(ranges, function (r) { return line < r.startLineNumber; }) - 1;\r\n    if (i >= 0 && ranges[i].endLineNumber >= line) {\r\n        return ranges[i];\r\n    }\r\n    return null;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\r\nimport { TextModel } from '../../common/model/textModel.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nvar MAX_FOLDING_REGIONS_FOR_INDENT_LIMIT = 5000;\r\nexport var ID_INDENT_PROVIDER = 'indent';\r\nvar IndentRangeProvider = /** @class */ (function () {\r\n    function IndentRangeProvider(editorModel) {\r\n        this.editorModel = editorModel;\r\n        this.id = ID_INDENT_PROVIDER;\r\n    }\r\n    IndentRangeProvider.prototype.dispose = function () {\r\n    };\r\n    IndentRangeProvider.prototype.compute = function (cancelationToken) {\r\n        var foldingRules = LanguageConfigurationRegistry.getFoldingRules(this.editorModel.getLanguageIdentifier().id);\r\n        var offSide = foldingRules && !!foldingRules.offSide;\r\n        var markers = foldingRules && foldingRules.markers;\r\n        return Promise.resolve(computeRanges(this.editorModel, offSide, markers));\r\n    };\r\n    return IndentRangeProvider;\r\n}());\r\nexport { IndentRangeProvider };\r\n// public only for testing\r\nvar RangesCollector = /** @class */ (function () {\r\n    function RangesCollector(foldingRangesLimit) {\r\n        this._startIndexes = [];\r\n        this._endIndexes = [];\r\n        this._indentOccurrences = [];\r\n        this._length = 0;\r\n        this._foldingRangesLimit = foldingRangesLimit;\r\n    }\r\n    RangesCollector.prototype.insertFirst = function (startLineNumber, endLineNumber, indent) {\r\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\r\n            return;\r\n        }\r\n        var index = this._length;\r\n        this._startIndexes[index] = startLineNumber;\r\n        this._endIndexes[index] = endLineNumber;\r\n        this._length++;\r\n        if (indent < 1000) {\r\n            this._indentOccurrences[indent] = (this._indentOccurrences[indent] || 0) + 1;\r\n        }\r\n    };\r\n    RangesCollector.prototype.toIndentRanges = function (model) {\r\n        if (this._length <= this._foldingRangesLimit) {\r\n            // reverse and create arrays of the exact length\r\n            var startIndexes = new Uint32Array(this._length);\r\n            var endIndexes = new Uint32Array(this._length);\r\n            for (var i = this._length - 1, k = 0; i >= 0; i--, k++) {\r\n                startIndexes[k] = this._startIndexes[i];\r\n                endIndexes[k] = this._endIndexes[i];\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes);\r\n        }\r\n        else {\r\n            var entries = 0;\r\n            var maxIndent = this._indentOccurrences.length;\r\n            for (var i = 0; i < this._indentOccurrences.length; i++) {\r\n                var n = this._indentOccurrences[i];\r\n                if (n) {\r\n                    if (n + entries > this._foldingRangesLimit) {\r\n                        maxIndent = i;\r\n                        break;\r\n                    }\r\n                    entries += n;\r\n                }\r\n            }\r\n            var tabSize = model.getOptions().tabSize;\r\n            // reverse and create arrays of the exact length\r\n            var startIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            var endIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            for (var i = this._length - 1, k = 0; i >= 0; i--) {\r\n                var startIndex = this._startIndexes[i];\r\n                var lineContent = model.getLineContent(startIndex);\r\n                var indent = TextModel.computeIndentLevel(lineContent, tabSize);\r\n                if (indent < maxIndent || (indent === maxIndent && entries++ < this._foldingRangesLimit)) {\r\n                    startIndexes[k] = startIndex;\r\n                    endIndexes[k] = this._endIndexes[i];\r\n                    k++;\r\n                }\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes);\r\n        }\r\n    };\r\n    return RangesCollector;\r\n}());\r\nexport { RangesCollector };\r\nexport function computeRanges(model, offSide, markers, foldingRangesLimit) {\r\n    if (foldingRangesLimit === void 0) { foldingRangesLimit = MAX_FOLDING_REGIONS_FOR_INDENT_LIMIT; }\r\n    var tabSize = model.getOptions().tabSize;\r\n    var result = new RangesCollector(foldingRangesLimit);\r\n    var pattern = undefined;\r\n    if (markers) {\r\n        pattern = new RegExp(\"(\" + markers.start.source + \")|(?:\" + markers.end.source + \")\");\r\n    }\r\n    var previousRegions = [];\r\n    var line = model.getLineCount() + 1;\r\n    previousRegions.push({ indent: -1, endAbove: line, line: line }); // sentinel, to make sure there's at least one entry\r\n    for (var line_1 = model.getLineCount(); line_1 > 0; line_1--) {\r\n        var lineContent = model.getLineContent(line_1);\r\n        var indent = TextModel.computeIndentLevel(lineContent, tabSize);\r\n        var previous = previousRegions[previousRegions.length - 1];\r\n        if (indent === -1) {\r\n            if (offSide) {\r\n                // for offSide languages, empty lines are associated to the previous block\r\n                // note: the next block is already written to the results, so this only\r\n                // impacts the end position of the block before\r\n                previous.endAbove = line_1;\r\n            }\r\n            continue; // only whitespace\r\n        }\r\n        var m = void 0;\r\n        if (pattern && (m = lineContent.match(pattern))) {\r\n            // folding pattern match\r\n            if (m[1]) { // start pattern match\r\n                // discard all regions until the folding pattern\r\n                var i = previousRegions.length - 1;\r\n                while (i > 0 && previousRegions[i].indent !== -2) {\r\n                    i--;\r\n                }\r\n                if (i > 0) {\r\n                    previousRegions.length = i + 1;\r\n                    previous = previousRegions[i];\r\n                    // new folding range from pattern, includes the end line\r\n                    result.insertFirst(line_1, previous.line, indent);\r\n                    previous.line = line_1;\r\n                    previous.indent = indent;\r\n                    previous.endAbove = line_1;\r\n                    continue;\r\n                }\r\n                else {\r\n                    // no end marker found, treat line as a regular line\r\n                }\r\n            }\r\n            else { // end pattern match\r\n                previousRegions.push({ indent: -2, endAbove: line_1, line: line_1 });\r\n                continue;\r\n            }\r\n        }\r\n        if (previous.indent > indent) {\r\n            // discard all regions with larger indent\r\n            do {\r\n                previousRegions.pop();\r\n                previous = previousRegions[previousRegions.length - 1];\r\n            } while (previous.indent > indent);\r\n            // new folding range\r\n            var endLineNumber = previous.endAbove - 1;\r\n            if (endLineNumber - line_1 >= 1) { // needs at east size 1\r\n                result.insertFirst(line_1, endLineNumber, indent);\r\n            }\r\n        }\r\n        if (previous.indent === indent) {\r\n            previous.endAbove = line_1;\r\n        }\r\n        else { // previous.indent < indent\r\n            // new region with a bigger indent\r\n            previousRegions.push({ indent: indent, endAbove: line_1, line: line_1 });\r\n        }\r\n    }\r\n    return result.toIndentRanges(model);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { MAX_LINE_NUMBER, FoldingRegions } from './foldingRanges.js';\r\nvar MAX_FOLDING_REGIONS = 5000;\r\nvar foldingContext = {};\r\nexport var ID_SYNTAX_PROVIDER = 'syntax';\r\nvar SyntaxRangeProvider = /** @class */ (function () {\r\n    function SyntaxRangeProvider(editorModel, providers, limit) {\r\n        if (limit === void 0) { limit = MAX_FOLDING_REGIONS; }\r\n        this.editorModel = editorModel;\r\n        this.providers = providers;\r\n        this.limit = limit;\r\n        this.id = ID_SYNTAX_PROVIDER;\r\n    }\r\n    SyntaxRangeProvider.prototype.compute = function (cancellationToken) {\r\n        var _this = this;\r\n        return collectSyntaxRanges(this.providers, this.editorModel, cancellationToken).then(function (ranges) {\r\n            if (ranges) {\r\n                var res = sanitizeRanges(ranges, _this.limit);\r\n                return res;\r\n            }\r\n            return null;\r\n        });\r\n    };\r\n    SyntaxRangeProvider.prototype.dispose = function () {\r\n    };\r\n    return SyntaxRangeProvider;\r\n}());\r\nexport { SyntaxRangeProvider };\r\nfunction collectSyntaxRanges(providers, model, cancellationToken) {\r\n    var rangeData = null;\r\n    var promises = providers.map(function (provider, i) {\r\n        return Promise.resolve(provider.provideFoldingRanges(model, foldingContext, cancellationToken)).then(function (ranges) {\r\n            if (cancellationToken.isCancellationRequested) {\r\n                return;\r\n            }\r\n            if (Array.isArray(ranges)) {\r\n                if (!Array.isArray(rangeData)) {\r\n                    rangeData = [];\r\n                }\r\n                var nLines = model.getLineCount();\r\n                for (var _i = 0, ranges_1 = ranges; _i < ranges_1.length; _i++) {\r\n                    var r = ranges_1[_i];\r\n                    if (r.start > 0 && r.end > r.start && r.end <= nLines) {\r\n                        rangeData.push({ start: r.start, end: r.end, rank: i, kind: r.kind });\r\n                    }\r\n                }\r\n            }\r\n        }, onUnexpectedExternalError);\r\n    });\r\n    return Promise.all(promises).then(function (_) {\r\n        return rangeData;\r\n    });\r\n}\r\nvar RangesCollector = /** @class */ (function () {\r\n    function RangesCollector(foldingRangesLimit) {\r\n        this._startIndexes = [];\r\n        this._endIndexes = [];\r\n        this._nestingLevels = [];\r\n        this._nestingLevelCounts = [];\r\n        this._types = [];\r\n        this._length = 0;\r\n        this._foldingRangesLimit = foldingRangesLimit;\r\n    }\r\n    RangesCollector.prototype.add = function (startLineNumber, endLineNumber, type, nestingLevel) {\r\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\r\n            return;\r\n        }\r\n        var index = this._length;\r\n        this._startIndexes[index] = startLineNumber;\r\n        this._endIndexes[index] = endLineNumber;\r\n        this._nestingLevels[index] = nestingLevel;\r\n        this._types[index] = type;\r\n        this._length++;\r\n        if (nestingLevel < 30) {\r\n            this._nestingLevelCounts[nestingLevel] = (this._nestingLevelCounts[nestingLevel] || 0) + 1;\r\n        }\r\n    };\r\n    RangesCollector.prototype.toIndentRanges = function () {\r\n        if (this._length <= this._foldingRangesLimit) {\r\n            var startIndexes = new Uint32Array(this._length);\r\n            var endIndexes = new Uint32Array(this._length);\r\n            for (var i = 0; i < this._length; i++) {\r\n                startIndexes[i] = this._startIndexes[i];\r\n                endIndexes[i] = this._endIndexes[i];\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes, this._types);\r\n        }\r\n        else {\r\n            var entries = 0;\r\n            var maxLevel = this._nestingLevelCounts.length;\r\n            for (var i = 0; i < this._nestingLevelCounts.length; i++) {\r\n                var n = this._nestingLevelCounts[i];\r\n                if (n) {\r\n                    if (n + entries > this._foldingRangesLimit) {\r\n                        maxLevel = i;\r\n                        break;\r\n                    }\r\n                    entries += n;\r\n                }\r\n            }\r\n            var startIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            var endIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            var types = [];\r\n            for (var i = 0, k = 0; i < this._length; i++) {\r\n                var level = this._nestingLevels[i];\r\n                if (level < maxLevel || (level === maxLevel && entries++ < this._foldingRangesLimit)) {\r\n                    startIndexes[k] = this._startIndexes[i];\r\n                    endIndexes[k] = this._endIndexes[i];\r\n                    types[k] = this._types[i];\r\n                    k++;\r\n                }\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes, types);\r\n        }\r\n    };\r\n    return RangesCollector;\r\n}());\r\nexport { RangesCollector };\r\nexport function sanitizeRanges(rangeData, limit) {\r\n    var sorted = rangeData.sort(function (d1, d2) {\r\n        var diff = d1.start - d2.start;\r\n        if (diff === 0) {\r\n            diff = d1.rank - d2.rank;\r\n        }\r\n        return diff;\r\n    });\r\n    var collector = new RangesCollector(limit);\r\n    var top = undefined;\r\n    var previous = [];\r\n    for (var _i = 0, sorted_1 = sorted; _i < sorted_1.length; _i++) {\r\n        var entry = sorted_1[_i];\r\n        if (!top) {\r\n            top = entry;\r\n            collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\r\n        }\r\n        else {\r\n            if (entry.start > top.start) {\r\n                if (entry.end <= top.end) {\r\n                    previous.push(top);\r\n                    top = entry;\r\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\r\n                }\r\n                else {\r\n                    if (entry.start > top.end) {\r\n                        do {\r\n                            top = previous.pop();\r\n                        } while (top && entry.start > top.end);\r\n                        if (top) {\r\n                            previous.push(top);\r\n                        }\r\n                        top = entry;\r\n                    }\r\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return collector.toIndentRanges();\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { sanitizeRanges } from './syntaxRangeProvider.js';\r\nexport var ID_INIT_PROVIDER = 'init';\r\nvar InitializingRangeProvider = /** @class */ (function () {\r\n    function InitializingRangeProvider(editorModel, initialRanges, onTimeout, timeoutTime) {\r\n        this.editorModel = editorModel;\r\n        this.id = ID_INIT_PROVIDER;\r\n        if (initialRanges.length) {\r\n            var toDecorationRange = function (range) {\r\n                return {\r\n                    range: {\r\n                        startLineNumber: range.startLineNumber,\r\n                        startColumn: 0,\r\n                        endLineNumber: range.endLineNumber,\r\n                        endColumn: editorModel.getLineLength(range.endLineNumber)\r\n                    },\r\n                    options: {\r\n                        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */\r\n                    }\r\n                };\r\n            };\r\n            this.decorationIds = editorModel.deltaDecorations([], initialRanges.map(toDecorationRange));\r\n            this.timeout = setTimeout(onTimeout, timeoutTime);\r\n        }\r\n    }\r\n    InitializingRangeProvider.prototype.dispose = function () {\r\n        if (this.decorationIds) {\r\n            this.editorModel.deltaDecorations(this.decorationIds, []);\r\n            this.decorationIds = undefined;\r\n        }\r\n        if (typeof this.timeout === 'number') {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = undefined;\r\n        }\r\n    };\r\n    InitializingRangeProvider.prototype.compute = function (cancelationToken) {\r\n        var foldingRangeData = [];\r\n        if (this.decorationIds) {\r\n            for (var _i = 0, _a = this.decorationIds; _i < _a.length; _i++) {\r\n                var id = _a[_i];\r\n                var range = this.editorModel.getDecorationRange(id);\r\n                if (range) {\r\n                    foldingRangeData.push({ start: range.startLineNumber, end: range.endLineNumber, rank: 1 });\r\n                }\r\n            }\r\n        }\r\n        return Promise.resolve(sanitizeRanges(foldingRangeData, Number.MAX_VALUE));\r\n    };\r\n    return InitializingRangeProvider;\r\n}());\r\nexport { InitializingRangeProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './folding.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as types from '../../../base/common/types.js';\r\nimport { escapeRegExpCharacters } from '../../../base/common/strings.js';\r\nimport { RunOnceScheduler, Delayer, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, registerInstantiatedEditorAction } from '../../browser/editorExtensions.js';\r\nimport { FoldingModel, setCollapseStateAtLevel, setCollapseStateLevelsDown, setCollapseStateLevelsUp, setCollapseStateForMatchingLines, setCollapseStateForType, toggleCollapseState } from './foldingModel.js';\r\nimport { FoldingDecorationProvider } from './foldingDecorations.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { HiddenRangeModel } from './hiddenRangeModel.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { IndentRangeProvider } from './indentRangeProvider.js';\r\nimport { FoldingRangeProviderRegistry, FoldingRangeKind } from '../../common/modes.js';\r\nimport { SyntaxRangeProvider, ID_SYNTAX_PROVIDER } from './syntaxRangeProvider.js';\r\nimport { InitializingRangeProvider, ID_INIT_PROVIDER } from './intializingRangeProvider.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nvar CONTEXT_FOLDING_ENABLED = new RawContextKey('foldingEnabled', false);\r\nvar FoldingController = /** @class */ (function (_super) {\r\n    __extends(FoldingController, _super);\r\n    function FoldingController(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.contextKeyService = contextKeyService;\r\n        _this.localToDispose = _this._register(new DisposableStore());\r\n        _this.editor = editor;\r\n        var options = _this.editor.getOptions();\r\n        _this._isEnabled = options.get(29 /* folding */);\r\n        _this._autoHideFoldingControls = options.get(80 /* showFoldingControls */) === 'mouseover';\r\n        _this._useFoldingProviders = options.get(30 /* foldingStrategy */) !== 'indentation';\r\n        _this.foldingModel = null;\r\n        _this.hiddenRangeModel = null;\r\n        _this.rangeProvider = null;\r\n        _this.foldingRegionPromise = null;\r\n        _this.foldingStateMemento = null;\r\n        _this.foldingModelPromise = null;\r\n        _this.updateScheduler = null;\r\n        _this.cursorChangedScheduler = null;\r\n        _this.mouseDownInfo = null;\r\n        _this.foldingDecorationProvider = new FoldingDecorationProvider(editor);\r\n        _this.foldingDecorationProvider.autoHideFoldingControls = _this._autoHideFoldingControls;\r\n        _this.foldingEnabled = CONTEXT_FOLDING_ENABLED.bindTo(_this.contextKeyService);\r\n        _this.foldingEnabled.set(_this._isEnabled);\r\n        _this._register(_this.editor.onDidChangeModel(function () { return _this.onModelChanged(); }));\r\n        _this._register(_this.editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(29 /* folding */) || e.hasChanged(80 /* showFoldingControls */) || e.hasChanged(30 /* foldingStrategy */)) {\r\n                var oldIsEnabled = _this._isEnabled;\r\n                var options_1 = _this.editor.getOptions();\r\n                _this._isEnabled = options_1.get(29 /* folding */);\r\n                _this.foldingEnabled.set(_this._isEnabled);\r\n                if (oldIsEnabled !== _this._isEnabled) {\r\n                    _this.onModelChanged();\r\n                }\r\n                var oldShowFoldingControls = _this._autoHideFoldingControls;\r\n                _this._autoHideFoldingControls = options_1.get(80 /* showFoldingControls */) === 'mouseover';\r\n                if (oldShowFoldingControls !== _this._autoHideFoldingControls) {\r\n                    _this.foldingDecorationProvider.autoHideFoldingControls = _this._autoHideFoldingControls;\r\n                    _this.onModelContentChanged();\r\n                }\r\n                var oldUseFoldingProviders = _this._useFoldingProviders;\r\n                _this._useFoldingProviders = options_1.get(30 /* foldingStrategy */) !== 'indentation';\r\n                if (oldUseFoldingProviders !== _this._useFoldingProviders) {\r\n                    _this.onFoldingStrategyChanged();\r\n                }\r\n            }\r\n        }));\r\n        _this.onModelChanged();\r\n        return _this;\r\n    }\r\n    FoldingController.get = function (editor) {\r\n        return editor.getContribution(FoldingController.ID);\r\n    };\r\n    /**\r\n     * Store view state.\r\n     */\r\n    FoldingController.prototype.saveViewState = function () {\r\n        var model = this.editor.getModel();\r\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization()) {\r\n            return {};\r\n        }\r\n        if (this.foldingModel) { // disposed ?\r\n            var collapsedRegions = this.foldingModel.isInitialized ? this.foldingModel.getMemento() : this.hiddenRangeModel.getMemento();\r\n            var provider = this.rangeProvider ? this.rangeProvider.id : undefined;\r\n            return { collapsedRegions: collapsedRegions, lineCount: model.getLineCount(), provider: provider };\r\n        }\r\n        return undefined;\r\n    };\r\n    /**\r\n     * Restore view state.\r\n     */\r\n    FoldingController.prototype.restoreViewState = function (state) {\r\n        var model = this.editor.getModel();\r\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization() || !this.hiddenRangeModel) {\r\n            return;\r\n        }\r\n        if (!state || !state.collapsedRegions || state.lineCount !== model.getLineCount()) {\r\n            return;\r\n        }\r\n        if (state.provider === ID_SYNTAX_PROVIDER || state.provider === ID_INIT_PROVIDER) {\r\n            this.foldingStateMemento = state;\r\n        }\r\n        var collapsedRegions = state.collapsedRegions;\r\n        // set the hidden ranges right away, before waiting for the folding model.\r\n        if (this.hiddenRangeModel.applyMemento(collapsedRegions)) {\r\n            var foldingModel = this.getFoldingModel();\r\n            if (foldingModel) {\r\n                foldingModel.then(function (foldingModel) {\r\n                    if (foldingModel) {\r\n                        foldingModel.applyMemento(collapsedRegions);\r\n                    }\r\n                }).then(undefined, onUnexpectedError);\r\n            }\r\n        }\r\n    };\r\n    FoldingController.prototype.onModelChanged = function () {\r\n        var _this = this;\r\n        this.localToDispose.clear();\r\n        var model = this.editor.getModel();\r\n        if (!this._isEnabled || !model || model.isTooLargeForTokenization()) {\r\n            // huge files get no view model, so they cannot support hidden areas\r\n            return;\r\n        }\r\n        this.foldingModel = new FoldingModel(model, this.foldingDecorationProvider);\r\n        this.localToDispose.add(this.foldingModel);\r\n        this.hiddenRangeModel = new HiddenRangeModel(this.foldingModel);\r\n        this.localToDispose.add(this.hiddenRangeModel);\r\n        this.localToDispose.add(this.hiddenRangeModel.onDidChange(function (hr) { return _this.onHiddenRangesChanges(hr); }));\r\n        this.updateScheduler = new Delayer(200);\r\n        this.cursorChangedScheduler = new RunOnceScheduler(function () { return _this.revealCursor(); }, 200);\r\n        this.localToDispose.add(this.cursorChangedScheduler);\r\n        this.localToDispose.add(FoldingRangeProviderRegistry.onDidChange(function () { return _this.onFoldingStrategyChanged(); }));\r\n        this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(function () { return _this.onFoldingStrategyChanged(); })); // covers model language changes as well\r\n        this.localToDispose.add(this.editor.onDidChangeModelContent(function () { return _this.onModelContentChanged(); }));\r\n        this.localToDispose.add(this.editor.onDidChangeCursorPosition(function () { return _this.onCursorPositionChanged(); }));\r\n        this.localToDispose.add(this.editor.onMouseDown(function (e) { return _this.onEditorMouseDown(e); }));\r\n        this.localToDispose.add(this.editor.onMouseUp(function (e) { return _this.onEditorMouseUp(e); }));\r\n        this.localToDispose.add({\r\n            dispose: function () {\r\n                if (_this.foldingRegionPromise) {\r\n                    _this.foldingRegionPromise.cancel();\r\n                    _this.foldingRegionPromise = null;\r\n                }\r\n                if (_this.updateScheduler) {\r\n                    _this.updateScheduler.cancel();\r\n                }\r\n                _this.updateScheduler = null;\r\n                _this.foldingModel = null;\r\n                _this.foldingModelPromise = null;\r\n                _this.hiddenRangeModel = null;\r\n                _this.cursorChangedScheduler = null;\r\n                _this.foldingStateMemento = null;\r\n                if (_this.rangeProvider) {\r\n                    _this.rangeProvider.dispose();\r\n                }\r\n                _this.rangeProvider = null;\r\n            }\r\n        });\r\n        this.onModelContentChanged();\r\n    };\r\n    FoldingController.prototype.onFoldingStrategyChanged = function () {\r\n        if (this.rangeProvider) {\r\n            this.rangeProvider.dispose();\r\n        }\r\n        this.rangeProvider = null;\r\n        this.onModelContentChanged();\r\n    };\r\n    FoldingController.prototype.getRangeProvider = function (editorModel) {\r\n        var _this = this;\r\n        if (this.rangeProvider) {\r\n            return this.rangeProvider;\r\n        }\r\n        this.rangeProvider = new IndentRangeProvider(editorModel); // fallback\r\n        if (this._useFoldingProviders && this.foldingModel) {\r\n            var foldingProviders = FoldingRangeProviderRegistry.ordered(this.foldingModel.textModel);\r\n            if (foldingProviders.length === 0 && this.foldingStateMemento && this.foldingStateMemento.collapsedRegions) {\r\n                var rangeProvider = this.rangeProvider = new InitializingRangeProvider(editorModel, this.foldingStateMemento.collapsedRegions, function () {\r\n                    // if after 30 the InitializingRangeProvider is still not replaced, force a refresh\r\n                    _this.foldingStateMemento = null;\r\n                    _this.onFoldingStrategyChanged();\r\n                }, 30000);\r\n                return rangeProvider; // keep memento in case there are still no foldingProviders on the next request.\r\n            }\r\n            else if (foldingProviders.length > 0) {\r\n                this.rangeProvider = new SyntaxRangeProvider(editorModel, foldingProviders);\r\n            }\r\n        }\r\n        this.foldingStateMemento = null;\r\n        return this.rangeProvider;\r\n    };\r\n    FoldingController.prototype.getFoldingModel = function () {\r\n        return this.foldingModelPromise;\r\n    };\r\n    FoldingController.prototype.onModelContentChanged = function () {\r\n        var _this = this;\r\n        if (this.updateScheduler) {\r\n            if (this.foldingRegionPromise) {\r\n                this.foldingRegionPromise.cancel();\r\n                this.foldingRegionPromise = null;\r\n            }\r\n            this.foldingModelPromise = this.updateScheduler.trigger(function () {\r\n                var foldingModel = _this.foldingModel;\r\n                if (!foldingModel) { // null if editor has been disposed, or folding turned off\r\n                    return null;\r\n                }\r\n                var foldingRegionPromise = _this.foldingRegionPromise = createCancelablePromise(function (token) { return _this.getRangeProvider(foldingModel.textModel).compute(token); });\r\n                return foldingRegionPromise.then(function (foldingRanges) {\r\n                    if (foldingRanges && foldingRegionPromise === _this.foldingRegionPromise) { // new request or cancelled in the meantime?\r\n                        // some cursors might have moved into hidden regions, make sure they are in expanded regions\r\n                        var selections = _this.editor.getSelections();\r\n                        var selectionLineNumbers = selections ? selections.map(function (s) { return s.startLineNumber; }) : [];\r\n                        foldingModel.update(foldingRanges, selectionLineNumbers);\r\n                    }\r\n                    return foldingModel;\r\n                });\r\n            }).then(undefined, function (err) {\r\n                onUnexpectedError(err);\r\n                return null;\r\n            });\r\n        }\r\n    };\r\n    FoldingController.prototype.onHiddenRangesChanges = function (hiddenRanges) {\r\n        if (this.hiddenRangeModel && hiddenRanges.length) {\r\n            var selections = this.editor.getSelections();\r\n            if (selections) {\r\n                if (this.hiddenRangeModel.adjustSelections(selections)) {\r\n                    this.editor.setSelections(selections);\r\n                }\r\n            }\r\n        }\r\n        this.editor.setHiddenAreas(hiddenRanges);\r\n    };\r\n    FoldingController.prototype.onCursorPositionChanged = function () {\r\n        if (this.hiddenRangeModel && this.hiddenRangeModel.hasRanges()) {\r\n            this.cursorChangedScheduler.schedule();\r\n        }\r\n    };\r\n    FoldingController.prototype.revealCursor = function () {\r\n        var _this = this;\r\n        var foldingModel = this.getFoldingModel();\r\n        if (!foldingModel) {\r\n            return;\r\n        }\r\n        foldingModel.then(function (foldingModel) {\r\n            if (foldingModel) {\r\n                var selections = _this.editor.getSelections();\r\n                if (selections && selections.length > 0) {\r\n                    var toToggle = [];\r\n                    var _loop_1 = function (selection) {\r\n                        var lineNumber = selection.selectionStartLineNumber;\r\n                        if (_this.hiddenRangeModel && _this.hiddenRangeModel.isHidden(lineNumber)) {\r\n                            toToggle.push.apply(toToggle, foldingModel.getAllRegionsAtLine(lineNumber, function (r) { return r.isCollapsed && lineNumber > r.startLineNumber; }));\r\n                        }\r\n                    };\r\n                    for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n                        var selection = selections_1[_i];\r\n                        _loop_1(selection);\r\n                    }\r\n                    if (toToggle.length) {\r\n                        foldingModel.toggleCollapseState(toToggle);\r\n                        _this.reveal(selections[0].getPosition());\r\n                    }\r\n                }\r\n            }\r\n        }).then(undefined, onUnexpectedError);\r\n    };\r\n    FoldingController.prototype.onEditorMouseDown = function (e) {\r\n        this.mouseDownInfo = null;\r\n        if (!this.hiddenRangeModel || !e.target || !e.target.range) {\r\n            return;\r\n        }\r\n        if (!e.event.leftButton && !e.event.middleButton) {\r\n            return;\r\n        }\r\n        var range = e.target.range;\r\n        var iconClicked = false;\r\n        switch (e.target.type) {\r\n            case 4 /* GUTTER_LINE_DECORATIONS */:\r\n                var data = e.target.detail;\r\n                var offsetLeftInGutter = e.target.element.offsetLeft;\r\n                var gutterOffsetX = data.offsetX - offsetLeftInGutter;\r\n                // const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\r\n                // TODO@joao TODO@alex TODO@martin this is such that we don't collide with dirty diff\r\n                if (gutterOffsetX < 5) { // the whitespace between the border and the real folding icon border is 5px\r\n                    return;\r\n                }\r\n                iconClicked = true;\r\n                break;\r\n            case 7 /* CONTENT_EMPTY */: {\r\n                if (this.hiddenRangeModel.hasRanges()) {\r\n                    var data_1 = e.target.detail;\r\n                    if (!data_1.isAfterLines) {\r\n                        break;\r\n                    }\r\n                }\r\n                return;\r\n            }\r\n            case 6 /* CONTENT_TEXT */: {\r\n                if (this.hiddenRangeModel.hasRanges()) {\r\n                    var model = this.editor.getModel();\r\n                    if (model && range.startColumn === model.getLineMaxColumn(range.startLineNumber)) {\r\n                        break;\r\n                    }\r\n                }\r\n                return;\r\n            }\r\n            default:\r\n                return;\r\n        }\r\n        this.mouseDownInfo = { lineNumber: range.startLineNumber, iconClicked: iconClicked };\r\n    };\r\n    FoldingController.prototype.onEditorMouseUp = function (e) {\r\n        var _this = this;\r\n        var foldingModel = this.getFoldingModel();\r\n        if (!foldingModel || !this.mouseDownInfo || !e.target) {\r\n            return;\r\n        }\r\n        var lineNumber = this.mouseDownInfo.lineNumber;\r\n        var iconClicked = this.mouseDownInfo.iconClicked;\r\n        var range = e.target.range;\r\n        if (!range || range.startLineNumber !== lineNumber) {\r\n            return;\r\n        }\r\n        if (iconClicked) {\r\n            if (e.target.type !== 4 /* GUTTER_LINE_DECORATIONS */) {\r\n                return;\r\n            }\r\n        }\r\n        else {\r\n            var model = this.editor.getModel();\r\n            if (!model || range.startColumn !== model.getLineMaxColumn(lineNumber)) {\r\n                return;\r\n            }\r\n        }\r\n        foldingModel.then(function (foldingModel) {\r\n            if (foldingModel) {\r\n                var region = foldingModel.getRegionAtLine(lineNumber);\r\n                if (region && region.startLineNumber === lineNumber) {\r\n                    var isCollapsed_1 = region.isCollapsed;\r\n                    if (iconClicked || isCollapsed_1) {\r\n                        var toToggle = [region];\r\n                        if (e.event.middleButton || e.event.shiftKey) {\r\n                            toToggle.push.apply(toToggle, foldingModel.getRegionsInside(region, function (r) { return r.isCollapsed === isCollapsed_1; }));\r\n                        }\r\n                        foldingModel.toggleCollapseState(toToggle);\r\n                        _this.reveal({ lineNumber: lineNumber, column: 1 });\r\n                    }\r\n                }\r\n            }\r\n        }).then(undefined, onUnexpectedError);\r\n    };\r\n    FoldingController.prototype.reveal = function (position) {\r\n        this.editor.revealPositionInCenterIfOutsideViewport(position, 0 /* Smooth */);\r\n    };\r\n    FoldingController.ID = 'editor.contrib.folding';\r\n    FoldingController = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], FoldingController);\r\n    return FoldingController;\r\n}(Disposable));\r\nexport { FoldingController };\r\nvar FoldingAction = /** @class */ (function (_super) {\r\n    __extends(FoldingAction, _super);\r\n    function FoldingAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FoldingAction.prototype.runEditorCommand = function (accessor, editor, args) {\r\n        var _this = this;\r\n        var foldingController = FoldingController.get(editor);\r\n        if (!foldingController) {\r\n            return;\r\n        }\r\n        var foldingModelPromise = foldingController.getFoldingModel();\r\n        if (foldingModelPromise) {\r\n            this.reportTelemetry(accessor, editor);\r\n            return foldingModelPromise.then(function (foldingModel) {\r\n                if (foldingModel) {\r\n                    _this.invoke(foldingController, foldingModel, editor, args);\r\n                    var selection = editor.getSelection();\r\n                    if (selection) {\r\n                        foldingController.reveal(selection.getStartPosition());\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    FoldingAction.prototype.getSelectedLines = function (editor) {\r\n        var selections = editor.getSelections();\r\n        return selections ? selections.map(function (s) { return s.startLineNumber; }) : [];\r\n    };\r\n    FoldingAction.prototype.getLineNumbers = function (args, editor) {\r\n        if (args && args.selectionLines) {\r\n            return args.selectionLines.map(function (l) { return l + 1; }); // to 0-bases line numbers\r\n        }\r\n        return this.getSelectedLines(editor);\r\n    };\r\n    FoldingAction.prototype.run = function (_accessor, _editor) {\r\n    };\r\n    return FoldingAction;\r\n}(EditorAction));\r\nfunction foldingArgumentsConstraint(args) {\r\n    if (!types.isUndefined(args)) {\r\n        if (!types.isObject(args)) {\r\n            return false;\r\n        }\r\n        var foldingArgs = args;\r\n        if (!types.isUndefined(foldingArgs.levels) && !types.isNumber(foldingArgs.levels)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(foldingArgs.direction) && !types.isString(foldingArgs.direction)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(foldingArgs.selectionLines) && (!types.isArray(foldingArgs.selectionLines) || !foldingArgs.selectionLines.every(types.isNumber))) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nvar UnfoldAction = /** @class */ (function (_super) {\r\n    __extends(UnfoldAction, _super);\r\n    function UnfoldAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.unfold',\r\n            label: nls.localize('unfoldAction.label', \"Unfold\"),\r\n            alias: 'Unfold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 89 /* US_CLOSE_SQUARE_BRACKET */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 89 /* US_CLOSE_SQUARE_BRACKET */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            description: {\r\n                description: 'Unfold the content in the editor',\r\n                args: [\r\n                    {\r\n                        name: 'Unfold editor argument',\r\n                        description: \"Property-value pairs that can be passed through this argument:\\n\\t\\t\\t\\t\\t\\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\\n\\t\\t\\t\\t\\t\\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\\n\\t\\t\\t\\t\\t\\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\\n\\t\\t\\t\\t\\t\\t\",\r\n                        constraint: foldingArgumentsConstraint,\r\n                        schema: {\r\n                            'type': 'object',\r\n                            'properties': {\r\n                                'levels': {\r\n                                    'type': 'number',\r\n                                    'default': 1\r\n                                },\r\n                                'direction': {\r\n                                    'type': 'string',\r\n                                    'enum': ['up', 'down'],\r\n                                    'default': 'down'\r\n                                },\r\n                                'selectionLines': {\r\n                                    'type': 'array',\r\n                                    'items': {\r\n                                        'type': 'number'\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        }) || this;\r\n    }\r\n    UnfoldAction.prototype.invoke = function (_foldingController, foldingModel, editor, args) {\r\n        var levels = args && args.levels || 1;\r\n        var lineNumbers = this.getLineNumbers(args, editor);\r\n        if (args && args.direction === 'up') {\r\n            setCollapseStateLevelsUp(foldingModel, false, levels, lineNumbers);\r\n        }\r\n        else {\r\n            setCollapseStateLevelsDown(foldingModel, false, levels, lineNumbers);\r\n        }\r\n    };\r\n    return UnfoldAction;\r\n}(FoldingAction));\r\nvar UnFoldRecursivelyAction = /** @class */ (function (_super) {\r\n    __extends(UnFoldRecursivelyAction, _super);\r\n    function UnFoldRecursivelyAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.unfoldRecursively',\r\n            label: nls.localize('unFoldRecursivelyAction.label', \"Unfold Recursively\"),\r\n            alias: 'Unfold Recursively',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 89 /* US_CLOSE_SQUARE_BRACKET */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    UnFoldRecursivelyAction.prototype.invoke = function (_foldingController, foldingModel, editor, _args) {\r\n        setCollapseStateLevelsDown(foldingModel, false, Number.MAX_VALUE, this.getSelectedLines(editor));\r\n    };\r\n    return UnFoldRecursivelyAction;\r\n}(FoldingAction));\r\nvar FoldAction = /** @class */ (function (_super) {\r\n    __extends(FoldAction, _super);\r\n    function FoldAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.fold',\r\n            label: nls.localize('foldAction.label', \"Fold\"),\r\n            alias: 'Fold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 87 /* US_OPEN_SQUARE_BRACKET */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 87 /* US_OPEN_SQUARE_BRACKET */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            description: {\r\n                description: 'Fold the content in the editor',\r\n                args: [\r\n                    {\r\n                        name: 'Fold editor argument',\r\n                        description: \"Property-value pairs that can be passed through this argument:\\n\\t\\t\\t\\t\\t\\t\\t* 'levels': Number of levels to fold. Defaults to 1.\\n\\t\\t\\t\\t\\t\\t\\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\\n\\t\\t\\t\\t\\t\\t\\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\\n\\t\\t\\t\\t\\t\\t\",\r\n                        constraint: foldingArgumentsConstraint,\r\n                        schema: {\r\n                            'type': 'object',\r\n                            'properties': {\r\n                                'levels': {\r\n                                    'type': 'number',\r\n                                    'default': 1\r\n                                },\r\n                                'direction': {\r\n                                    'type': 'string',\r\n                                    'enum': ['up', 'down'],\r\n                                    'default': 'down'\r\n                                },\r\n                                'selectionLines': {\r\n                                    'type': 'array',\r\n                                    'items': {\r\n                                        'type': 'number'\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        }) || this;\r\n    }\r\n    FoldAction.prototype.invoke = function (_foldingController, foldingModel, editor, args) {\r\n        var levels = args && args.levels || 1;\r\n        var lineNumbers = this.getLineNumbers(args, editor);\r\n        if (args && args.direction === 'up') {\r\n            setCollapseStateLevelsUp(foldingModel, true, levels, lineNumbers);\r\n        }\r\n        else {\r\n            setCollapseStateLevelsDown(foldingModel, true, levels, lineNumbers);\r\n        }\r\n    };\r\n    return FoldAction;\r\n}(FoldingAction));\r\nvar ToggleFoldAction = /** @class */ (function (_super) {\r\n    __extends(ToggleFoldAction, _super);\r\n    function ToggleFoldAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.toggleFold',\r\n            label: nls.localize('toggleFoldAction.label', \"Toggle Fold\"),\r\n            alias: 'Toggle Fold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 42 /* KEY_L */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ToggleFoldAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        var selectedLines = this.getSelectedLines(editor);\r\n        toggleCollapseState(foldingModel, 1, selectedLines);\r\n    };\r\n    return ToggleFoldAction;\r\n}(FoldingAction));\r\nvar FoldRecursivelyAction = /** @class */ (function (_super) {\r\n    __extends(FoldRecursivelyAction, _super);\r\n    function FoldRecursivelyAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.foldRecursively',\r\n            label: nls.localize('foldRecursivelyAction.label', \"Fold Recursively\"),\r\n            alias: 'Fold Recursively',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 87 /* US_OPEN_SQUARE_BRACKET */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    FoldRecursivelyAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        var selectedLines = this.getSelectedLines(editor);\r\n        setCollapseStateLevelsDown(foldingModel, true, Number.MAX_VALUE, selectedLines);\r\n    };\r\n    return FoldRecursivelyAction;\r\n}(FoldingAction));\r\nvar FoldAllBlockCommentsAction = /** @class */ (function (_super) {\r\n    __extends(FoldAllBlockCommentsAction, _super);\r\n    function FoldAllBlockCommentsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.foldAllBlockComments',\r\n            label: nls.localize('foldAllBlockComments.label', \"Fold All Block Comments\"),\r\n            alias: 'Fold All Block Comments',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 85 /* US_SLASH */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    FoldAllBlockCommentsAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        if (foldingModel.regions.hasTypes()) {\r\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Comment.value, true);\r\n        }\r\n        else {\r\n            var editorModel = editor.getModel();\r\n            if (!editorModel) {\r\n                return;\r\n            }\r\n            var comments = LanguageConfigurationRegistry.getComments(editorModel.getLanguageIdentifier().id);\r\n            if (comments && comments.blockCommentStartToken) {\r\n                var regExp = new RegExp('^\\\\s*' + escapeRegExpCharacters(comments.blockCommentStartToken));\r\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\r\n            }\r\n        }\r\n    };\r\n    return FoldAllBlockCommentsAction;\r\n}(FoldingAction));\r\nvar FoldAllRegionsAction = /** @class */ (function (_super) {\r\n    __extends(FoldAllRegionsAction, _super);\r\n    function FoldAllRegionsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.foldAllMarkerRegions',\r\n            label: nls.localize('foldAllMarkerRegions.label', \"Fold All Regions\"),\r\n            alias: 'Fold All Regions',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 29 /* KEY_8 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    FoldAllRegionsAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        if (foldingModel.regions.hasTypes()) {\r\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, true);\r\n        }\r\n        else {\r\n            var editorModel = editor.getModel();\r\n            if (!editorModel) {\r\n                return;\r\n            }\r\n            var foldingRules = LanguageConfigurationRegistry.getFoldingRules(editorModel.getLanguageIdentifier().id);\r\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\r\n                var regExp = new RegExp(foldingRules.markers.start);\r\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\r\n            }\r\n        }\r\n    };\r\n    return FoldAllRegionsAction;\r\n}(FoldingAction));\r\nvar UnfoldAllRegionsAction = /** @class */ (function (_super) {\r\n    __extends(UnfoldAllRegionsAction, _super);\r\n    function UnfoldAllRegionsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.unfoldAllMarkerRegions',\r\n            label: nls.localize('unfoldAllMarkerRegions.label', \"Unfold All Regions\"),\r\n            alias: 'Unfold All Regions',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 30 /* KEY_9 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    UnfoldAllRegionsAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        if (foldingModel.regions.hasTypes()) {\r\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, false);\r\n        }\r\n        else {\r\n            var editorModel = editor.getModel();\r\n            if (!editorModel) {\r\n                return;\r\n            }\r\n            var foldingRules = LanguageConfigurationRegistry.getFoldingRules(editorModel.getLanguageIdentifier().id);\r\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\r\n                var regExp = new RegExp(foldingRules.markers.start);\r\n                setCollapseStateForMatchingLines(foldingModel, regExp, false);\r\n            }\r\n        }\r\n    };\r\n    return UnfoldAllRegionsAction;\r\n}(FoldingAction));\r\nvar FoldAllAction = /** @class */ (function (_super) {\r\n    __extends(FoldAllAction, _super);\r\n    function FoldAllAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.foldAll',\r\n            label: nls.localize('foldAllAction.label', \"Fold All\"),\r\n            alias: 'Fold All',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 21 /* KEY_0 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    FoldAllAction.prototype.invoke = function (_foldingController, foldingModel, _editor) {\r\n        setCollapseStateLevelsDown(foldingModel, true);\r\n    };\r\n    return FoldAllAction;\r\n}(FoldingAction));\r\nvar UnfoldAllAction = /** @class */ (function (_super) {\r\n    __extends(UnfoldAllAction, _super);\r\n    function UnfoldAllAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.unfoldAll',\r\n            label: nls.localize('unfoldAllAction.label', \"Unfold All\"),\r\n            alias: 'Unfold All',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 40 /* KEY_J */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    UnfoldAllAction.prototype.invoke = function (_foldingController, foldingModel, _editor) {\r\n        setCollapseStateLevelsDown(foldingModel, false);\r\n    };\r\n    return UnfoldAllAction;\r\n}(FoldingAction));\r\nvar FoldLevelAction = /** @class */ (function (_super) {\r\n    __extends(FoldLevelAction, _super);\r\n    function FoldLevelAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FoldLevelAction.prototype.getFoldingLevel = function () {\r\n        return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length));\r\n    };\r\n    FoldLevelAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        setCollapseStateAtLevel(foldingModel, this.getFoldingLevel(), true, this.getSelectedLines(editor));\r\n    };\r\n    FoldLevelAction.ID_PREFIX = 'editor.foldLevel';\r\n    FoldLevelAction.ID = function (level) { return FoldLevelAction.ID_PREFIX + level; };\r\n    return FoldLevelAction;\r\n}(FoldingAction));\r\nregisterEditorContribution(FoldingController.ID, FoldingController);\r\nregisterEditorAction(UnfoldAction);\r\nregisterEditorAction(UnFoldRecursivelyAction);\r\nregisterEditorAction(FoldAction);\r\nregisterEditorAction(FoldRecursivelyAction);\r\nregisterEditorAction(FoldAllAction);\r\nregisterEditorAction(UnfoldAllAction);\r\nregisterEditorAction(FoldAllBlockCommentsAction);\r\nregisterEditorAction(FoldAllRegionsAction);\r\nregisterEditorAction(UnfoldAllRegionsAction);\r\nregisterEditorAction(ToggleFoldAction);\r\nfor (var i = 1; i <= 7; i++) {\r\n    registerInstantiatedEditorAction(new FoldLevelAction({\r\n        id: FoldLevelAction.ID(i),\r\n        label: nls.localize('foldLevelAction.label', \"Fold Level {0}\", i),\r\n        alias: \"Fold Level \" + i,\r\n        precondition: CONTEXT_FOLDING_ENABLED,\r\n        kbOpts: {\r\n            kbExpr: EditorContextKeys.editorTextFocus,\r\n            primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | (21 /* KEY_0 */ + i)),\r\n            weight: 100 /* EditorContrib */\r\n        }\r\n    }));\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { EditorZoom } from '../../common/config/editorZoom.js';\r\nvar EditorFontZoomIn = /** @class */ (function (_super) {\r\n    __extends(EditorFontZoomIn, _super);\r\n    function EditorFontZoomIn() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.fontZoomIn',\r\n            label: nls.localize('EditorFontZoomIn.label', \"Editor Font Zoom In\"),\r\n            alias: 'Editor Font Zoom In',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    EditorFontZoomIn.prototype.run = function (accessor, editor) {\r\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\r\n    };\r\n    return EditorFontZoomIn;\r\n}(EditorAction));\r\nvar EditorFontZoomOut = /** @class */ (function (_super) {\r\n    __extends(EditorFontZoomOut, _super);\r\n    function EditorFontZoomOut() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.fontZoomOut',\r\n            label: nls.localize('EditorFontZoomOut.label', \"Editor Font Zoom Out\"),\r\n            alias: 'Editor Font Zoom Out',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    EditorFontZoomOut.prototype.run = function (accessor, editor) {\r\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\r\n    };\r\n    return EditorFontZoomOut;\r\n}(EditorAction));\r\nvar EditorFontZoomReset = /** @class */ (function (_super) {\r\n    __extends(EditorFontZoomReset, _super);\r\n    function EditorFontZoomReset() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.fontZoomReset',\r\n            label: nls.localize('EditorFontZoomReset.label', \"Editor Font Zoom Reset\"),\r\n            alias: 'Editor Font Zoom Reset',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    EditorFontZoomReset.prototype.run = function (accessor, editor) {\r\n        EditorZoom.setZoomLevel(0);\r\n    };\r\n    return EditorFontZoomReset;\r\n}(EditorAction));\r\nregisterEditorAction(EditorFontZoomIn);\r\nregisterEditorAction(EditorFontZoomOut);\r\nregisterEditorAction(EditorFontZoomReset);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar FormattingEdit = /** @class */ (function () {\r\n    function FormattingEdit() {\r\n    }\r\n    FormattingEdit._handleEolEdits = function (editor, edits) {\r\n        var newEol = undefined;\r\n        var singleEdits = [];\r\n        for (var _i = 0, edits_1 = edits; _i < edits_1.length; _i++) {\r\n            var edit = edits_1[_i];\r\n            if (typeof edit.eol === 'number') {\r\n                newEol = edit.eol;\r\n            }\r\n            if (edit.range && typeof edit.text === 'string') {\r\n                singleEdits.push(edit);\r\n            }\r\n        }\r\n        if (typeof newEol === 'number') {\r\n            if (editor.hasModel()) {\r\n                editor.getModel().pushEOL(newEol);\r\n            }\r\n        }\r\n        return singleEdits;\r\n    };\r\n    FormattingEdit._isFullModelReplaceEdit = function (editor, edit) {\r\n        if (!editor.hasModel()) {\r\n            return false;\r\n        }\r\n        var model = editor.getModel();\r\n        var editRange = model.validateRange(edit.range);\r\n        var fullModelRange = model.getFullModelRange();\r\n        return fullModelRange.equalsRange(editRange);\r\n    };\r\n    FormattingEdit.execute = function (editor, _edits) {\r\n        editor.pushUndoStop();\r\n        var edits = FormattingEdit._handleEolEdits(editor, _edits);\r\n        if (edits.length === 1 && FormattingEdit._isFullModelReplaceEdit(editor, edits[0])) {\r\n            // We use replace semantics and hope that markers stay put...\r\n            editor.executeEdits('formatEditsCommand', edits.map(function (edit) { return EditOperation.replace(Range.lift(edit.range), edit.text); }));\r\n        }\r\n        else {\r\n            editor.executeEdits('formatEditsCommand', edits.map(function (edit) { return EditOperation.replaceMove(Range.lift(edit.range), edit.text); }));\r\n        }\r\n        editor.pushUndoStop();\r\n    };\r\n    return FormattingEdit;\r\n}());\r\nexport { FormattingEdit };\r\n","/**\r\n * **!Do not construct directly!**\r\n *\r\n * **!Only static methods because it gets serialized!**\r\n *\r\n * This represents the \"canonical\" version for an extension identifier. Extension ids\r\n * have to be case-insensitive (due to the marketplace), but we must ensure case\r\n * preservation because the extension API is already public at this time.\r\n *\r\n * For example, given an extension with the publisher `\"Hello\"` and the name `\"World\"`,\r\n * its canonical extension identifier is `\"Hello.World\"`. This extension could be\r\n * referenced in some other extension's dependencies using the string `\"hello.world\"`.\r\n *\r\n * To make matters more complicated, an extension can optionally have an UUID. When two\r\n * extensions have the same UUID, they are considered equal even if their identifier is different.\r\n */\r\nvar ExtensionIdentifier = /** @class */ (function () {\r\n    function ExtensionIdentifier(value) {\r\n        this.value = value;\r\n        this._lower = value.toLowerCase();\r\n    }\r\n    /**\r\n     * Gives the value by which to index (for equality).\r\n     */\r\n    ExtensionIdentifier.toKey = function (id) {\r\n        if (typeof id === 'string') {\r\n            return id.toLowerCase();\r\n        }\r\n        return id._lower;\r\n    };\r\n    return ExtensionIdentifier;\r\n}());\r\nexport { ExtensionIdentifier };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { isCodeEditor } from '../../browser/editorBrowser.js';\r\nimport { registerLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { DocumentFormattingEditProviderRegistry, DocumentRangeFormattingEditProviderRegistry, OnTypeFormattingEditProviderRegistry } from '../../common/modes.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { FormattingEdit } from './formattingEdit.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nexport function alertFormattingEdits(edits) {\r\n    edits = edits.filter(function (edit) { return edit.range; });\r\n    if (!edits.length) {\r\n        return;\r\n    }\r\n    var range = edits[0].range;\r\n    for (var i = 1; i < edits.length; i++) {\r\n        range = Range.plusRange(range, edits[i].range);\r\n    }\r\n    var startLineNumber = range.startLineNumber, endLineNumber = range.endLineNumber;\r\n    if (startLineNumber === endLineNumber) {\r\n        if (edits.length === 1) {\r\n            alert(nls.localize('hint11', \"Made 1 formatting edit on line {0}\", startLineNumber));\r\n        }\r\n        else {\r\n            alert(nls.localize('hintn1', \"Made {0} formatting edits on line {1}\", edits.length, startLineNumber));\r\n        }\r\n    }\r\n    else {\r\n        if (edits.length === 1) {\r\n            alert(nls.localize('hint1n', \"Made 1 formatting edit between lines {0} and {1}\", startLineNumber, endLineNumber));\r\n        }\r\n        else {\r\n            alert(nls.localize('hintnn', \"Made {0} formatting edits between lines {1} and {2}\", edits.length, startLineNumber, endLineNumber));\r\n        }\r\n    }\r\n}\r\nexport function getRealAndSyntheticDocumentFormattersOrdered(model) {\r\n    var result = [];\r\n    var seen = new Set();\r\n    // (1) add all document formatter\r\n    var docFormatter = DocumentFormattingEditProviderRegistry.ordered(model);\r\n    for (var _i = 0, docFormatter_1 = docFormatter; _i < docFormatter_1.length; _i++) {\r\n        var formatter = docFormatter_1[_i];\r\n        result.push(formatter);\r\n        if (formatter.extensionId) {\r\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\r\n        }\r\n    }\r\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\r\n    var rangeFormatter = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n    var _loop_1 = function (formatter) {\r\n        if (formatter.extensionId) {\r\n            if (seen.has(ExtensionIdentifier.toKey(formatter.extensionId))) {\r\n                return \"continue\";\r\n            }\r\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\r\n        }\r\n        result.push({\r\n            displayName: formatter.displayName,\r\n            extensionId: formatter.extensionId,\r\n            provideDocumentFormattingEdits: function (model, options, token) {\r\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\r\n            }\r\n        });\r\n    };\r\n    for (var _a = 0, rangeFormatter_1 = rangeFormatter; _a < rangeFormatter_1.length; _a++) {\r\n        var formatter = rangeFormatter_1[_a];\r\n        _loop_1(formatter);\r\n    }\r\n    return result;\r\n}\r\nvar FormattingConflicts = /** @class */ (function () {\r\n    function FormattingConflicts() {\r\n    }\r\n    FormattingConflicts.select = function (formatter, document, mode) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var selector;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (formatter.length === 0) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        selector = FormattingConflicts._selectors.iterator().next().value;\r\n                        if (!selector) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, selector(formatter, document, mode)];\r\n                    case 1: return [2 /*return*/, _a.sent()];\r\n                    case 2: return [2 /*return*/, formatter[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FormattingConflicts._selectors = new LinkedList();\r\n    return FormattingConflicts;\r\n}());\r\nexport { FormattingConflicts };\r\nexport function formatDocumentRangeWithSelectedProvider(accessor, editorOrModel, range, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var instaService, model, provider, selected;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    instaService = accessor.get(IInstantiationService);\r\n                    model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\r\n                    provider = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n                    return [4 /*yield*/, FormattingConflicts.select(provider, model, mode)];\r\n                case 1:\r\n                    selected = _a.sent();\r\n                    if (!selected) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, instaService.invokeFunction(formatDocumentRangeWithProvider, selected, editorOrModel, range, token)];\r\n                case 2:\r\n                    _a.sent();\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentRangeWithProvider(accessor, provider, editorOrModel, range, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var workerService, model, cts, edits, rawEdits, range_1, initialSelection_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    workerService = accessor.get(IEditorWorkerService);\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        model = editorOrModel.getModel();\r\n                        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* Value */ | 4 /* Position */, token);\r\n                    }\r\n                    else {\r\n                        model = editorOrModel;\r\n                        cts = new TextModelCancellationTokenSource(editorOrModel, token);\r\n                    }\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, , 4, 5]);\r\n                    return [4 /*yield*/, provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3:\r\n                    edits = _a.sent();\r\n                    if (cts.token.isCancellationRequested) {\r\n                        return [2 /*return*/, true];\r\n                    }\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    cts.dispose();\r\n                    return [7 /*endfinally*/];\r\n                case 5:\r\n                    if (!edits || edits.length === 0) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        // use editor to apply edits\r\n                        FormattingEdit.execute(editorOrModel, edits);\r\n                        alertFormattingEdits(edits);\r\n                        editorOrModel.pushUndoStop();\r\n                        editorOrModel.focus();\r\n                        editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* Immediate */);\r\n                    }\r\n                    else {\r\n                        range_1 = edits[0].range;\r\n                        initialSelection_1 = new Selection(range_1.startLineNumber, range_1.startColumn, range_1.endLineNumber, range_1.endColumn);\r\n                        model.pushEditOperations([initialSelection_1], edits.map(function (edit) {\r\n                            return {\r\n                                text: edit.text,\r\n                                range: Range.lift(edit.range),\r\n                                forceMoveMarkers: true\r\n                            };\r\n                        }), function (undoEdits) {\r\n                            for (var _i = 0, undoEdits_1 = undoEdits; _i < undoEdits_1.length; _i++) {\r\n                                var range_2 = undoEdits_1[_i].range;\r\n                                if (Range.areIntersectingOrTouching(range_2, initialSelection_1)) {\r\n                                    return [new Selection(range_2.startLineNumber, range_2.startColumn, range_2.endLineNumber, range_2.endColumn)];\r\n                                }\r\n                            }\r\n                            return null;\r\n                        });\r\n                    }\r\n                    return [2 /*return*/, true];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var instaService, model, provider, selected;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    instaService = accessor.get(IInstantiationService);\r\n                    model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\r\n                    provider = getRealAndSyntheticDocumentFormattersOrdered(model);\r\n                    return [4 /*yield*/, FormattingConflicts.select(provider, model, mode)];\r\n                case 1:\r\n                    selected = _a.sent();\r\n                    if (!selected) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token)];\r\n                case 2:\r\n                    _a.sent();\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var workerService, model, cts, edits, rawEdits, range, initialSelection_2;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    workerService = accessor.get(IEditorWorkerService);\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        model = editorOrModel.getModel();\r\n                        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* Value */ | 4 /* Position */, token);\r\n                    }\r\n                    else {\r\n                        model = editorOrModel;\r\n                        cts = new TextModelCancellationTokenSource(editorOrModel, token);\r\n                    }\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, , 4, 5]);\r\n                    return [4 /*yield*/, provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3:\r\n                    edits = _a.sent();\r\n                    if (cts.token.isCancellationRequested) {\r\n                        return [2 /*return*/, true];\r\n                    }\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    cts.dispose();\r\n                    return [7 /*endfinally*/];\r\n                case 5:\r\n                    if (!edits || edits.length === 0) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        // use editor to apply edits\r\n                        FormattingEdit.execute(editorOrModel, edits);\r\n                        if (mode !== 2 /* Silent */) {\r\n                            alertFormattingEdits(edits);\r\n                            editorOrModel.pushUndoStop();\r\n                            editorOrModel.focus();\r\n                            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* Immediate */);\r\n                        }\r\n                    }\r\n                    else {\r\n                        range = edits[0].range;\r\n                        initialSelection_2 = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\r\n                        model.pushEditOperations([initialSelection_2], edits.map(function (edit) {\r\n                            return {\r\n                                text: edit.text,\r\n                                range: Range.lift(edit.range),\r\n                                forceMoveMarkers: true\r\n                            };\r\n                        }), function (undoEdits) {\r\n                            for (var _i = 0, undoEdits_2 = undoEdits; _i < undoEdits_2.length; _i++) {\r\n                                var range_3 = undoEdits_2[_i].range;\r\n                                if (Range.areIntersectingOrTouching(range_3, initialSelection_2)) {\r\n                                    return [new Selection(range_3.startLineNumber, range_3.startColumn, range_3.endLineNumber, range_3.endColumn)];\r\n                                }\r\n                            }\r\n                            return null;\r\n                        });\r\n                    }\r\n                    return [2 /*return*/, true];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getDocumentRangeFormattingEditsUntilResult(workerService, model, range, options, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var providers, _i, providers_1, provider, rawEdits;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    providers = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n                    _i = 0, providers_1 = providers;\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(_i < providers_1.length)) return [3 /*break*/, 5];\r\n                    provider = providers_1[_i];\r\n                    return [4 /*yield*/, Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    if (!isNonEmptyArray(rawEdits)) return [3 /*break*/, 4];\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3: return [2 /*return*/, _a.sent()];\r\n                case 4:\r\n                    _i++;\r\n                    return [3 /*break*/, 1];\r\n                case 5: return [2 /*return*/, undefined];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getDocumentFormattingEditsUntilResult(workerService, model, options, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var providers, _i, providers_2, provider, rawEdits;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    providers = getRealAndSyntheticDocumentFormattersOrdered(model);\r\n                    _i = 0, providers_2 = providers;\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(_i < providers_2.length)) return [3 /*break*/, 5];\r\n                    provider = providers_2[_i];\r\n                    return [4 /*yield*/, Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    if (!isNonEmptyArray(rawEdits)) return [3 /*break*/, 4];\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3: return [2 /*return*/, _a.sent()];\r\n                case 4:\r\n                    _i++;\r\n                    return [3 /*break*/, 1];\r\n                case 5: return [2 /*return*/, undefined];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getOnTypeFormattingEdits(workerService, model, position, ch, options) {\r\n    var providers = OnTypeFormattingEditProviderRegistry.ordered(model);\r\n    if (providers.length === 0) {\r\n        return Promise.resolve(undefined);\r\n    }\r\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\r\n        return Promise.resolve(undefined);\r\n    }\r\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, CancellationToken.None)).catch(onUnexpectedExternalError).then(function (edits) {\r\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\r\n    });\r\n}\r\nregisterLanguageCommand('_executeFormatRangeProvider', function (accessor, args) {\r\n    var resource = args.resource, range = args.range, options = args.options;\r\n    if (!(resource instanceof URI) || !Range.isIRange(range)) {\r\n        throw illegalArgument();\r\n    }\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getDocumentRangeFormattingEditsUntilResult(accessor.get(IEditorWorkerService), model, Range.lift(range), options, CancellationToken.None);\r\n});\r\nregisterLanguageCommand('_executeFormatDocumentProvider', function (accessor, args) {\r\n    var resource = args.resource, options = args.options;\r\n    if (!(resource instanceof URI)) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getDocumentFormattingEditsUntilResult(accessor.get(IEditorWorkerService), model, options, CancellationToken.None);\r\n});\r\nregisterLanguageCommand('_executeFormatOnTypeProvider', function (accessor, args) {\r\n    var resource = args.resource, position = args.position, ch = args.ch, options = args.options;\r\n    if (!(resource instanceof URI) || !Position.isIPosition(position) || typeof ch !== 'string') {\r\n        throw illegalArgument();\r\n    }\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getOnTypeFormattingEdits(accessor.get(IEditorWorkerService), model, Position.lift(position), ch, options);\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { DocumentRangeFormattingEditProviderRegistry, OnTypeFormattingEditProviderRegistry } from '../../common/modes.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { getOnTypeFormattingEdits, alertFormattingEdits, formatDocumentRangeWithSelectedProvider, formatDocumentWithSelectedProvider } from './format.js';\r\nimport { FormattingEdit } from './formattingEdit.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nvar FormatOnType = /** @class */ (function () {\r\n    function FormatOnType(editor, _workerService) {\r\n        var _this = this;\r\n        this._workerService = _workerService;\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModel = new DisposableStore();\r\n        this._editor = editor;\r\n        this._callOnDispose.add(editor.onDidChangeConfiguration(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModel(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(function () { return _this._update(); }));\r\n        this._callOnDispose.add(OnTypeFormattingEditProviderRegistry.onDidChange(this._update, this));\r\n    }\r\n    FormatOnType.prototype.dispose = function () {\r\n        this._callOnDispose.dispose();\r\n        this._callOnModel.dispose();\r\n    };\r\n    FormatOnType.prototype._update = function () {\r\n        var _this = this;\r\n        // clean up\r\n        this._callOnModel.clear();\r\n        // we are disabled\r\n        if (!this._editor.getOption(37 /* formatOnType */)) {\r\n            return;\r\n        }\r\n        // no model\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        // no support\r\n        var support = OnTypeFormattingEditProviderRegistry.ordered(model)[0];\r\n        if (!support || !support.autoFormatTriggerCharacters) {\r\n            return;\r\n        }\r\n        // register typing listeners that will trigger the format\r\n        var triggerChars = new CharacterSet();\r\n        for (var _i = 0, _a = support.autoFormatTriggerCharacters; _i < _a.length; _i++) {\r\n            var ch = _a[_i];\r\n            triggerChars.add(ch.charCodeAt(0));\r\n        }\r\n        this._callOnModel.add(this._editor.onDidType(function (text) {\r\n            var lastCharCode = text.charCodeAt(text.length - 1);\r\n            if (triggerChars.has(lastCharCode)) {\r\n                _this._trigger(String.fromCharCode(lastCharCode));\r\n            }\r\n        }));\r\n    };\r\n    FormatOnType.prototype._trigger = function (ch) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this._editor.getSelections().length > 1) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var position = this._editor.getPosition();\r\n        var canceled = false;\r\n        // install a listener that checks if edits happens before the\r\n        // position on which we format right now. If so, we won't\r\n        // apply the format edits\r\n        var unbind = this._editor.onDidChangeModelContent(function (e) {\r\n            if (e.isFlush) {\r\n                // a model.setValue() was called\r\n                // cancel only once\r\n                canceled = true;\r\n                unbind.dispose();\r\n                return;\r\n            }\r\n            for (var i = 0, len = e.changes.length; i < len; i++) {\r\n                var change = e.changes[i];\r\n                if (change.range.endLineNumber <= position.lineNumber) {\r\n                    // cancel only once\r\n                    canceled = true;\r\n                    unbind.dispose();\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n        getOnTypeFormattingEdits(this._workerService, model, position, ch, model.getFormattingOptions()).then(function (edits) {\r\n            unbind.dispose();\r\n            if (canceled) {\r\n                return;\r\n            }\r\n            if (isNonEmptyArray(edits)) {\r\n                FormattingEdit.execute(_this._editor, edits);\r\n                alertFormattingEdits(edits);\r\n            }\r\n        }, function (err) {\r\n            unbind.dispose();\r\n            throw err;\r\n        });\r\n    };\r\n    FormatOnType.ID = 'editor.contrib.autoFormat';\r\n    FormatOnType = __decorate([\r\n        __param(1, IEditorWorkerService)\r\n    ], FormatOnType);\r\n    return FormatOnType;\r\n}());\r\nvar FormatOnPaste = /** @class */ (function () {\r\n    function FormatOnPaste(editor, _instantiationService) {\r\n        var _this = this;\r\n        this.editor = editor;\r\n        this._instantiationService = _instantiationService;\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModel = new DisposableStore();\r\n        this._callOnDispose.add(editor.onDidChangeConfiguration(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModel(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(function () { return _this._update(); }));\r\n        this._callOnDispose.add(DocumentRangeFormattingEditProviderRegistry.onDidChange(this._update, this));\r\n    }\r\n    FormatOnPaste.prototype.dispose = function () {\r\n        this._callOnDispose.dispose();\r\n        this._callOnModel.dispose();\r\n    };\r\n    FormatOnPaste.prototype._update = function () {\r\n        var _this = this;\r\n        // clean up\r\n        this._callOnModel.clear();\r\n        // we are disabled\r\n        if (!this.editor.getOption(36 /* formatOnPaste */)) {\r\n            return;\r\n        }\r\n        // no model\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        // no formatter\r\n        if (!DocumentRangeFormattingEditProviderRegistry.has(this.editor.getModel())) {\r\n            return;\r\n        }\r\n        this._callOnModel.add(this.editor.onDidPaste(function (range) { return _this._trigger(range); }));\r\n    };\r\n    FormatOnPaste.prototype._trigger = function (range) {\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this.editor.getSelections().length > 1) {\r\n            return;\r\n        }\r\n        this._instantiationService.invokeFunction(formatDocumentRangeWithSelectedProvider, this.editor, range, 2 /* Silent */, CancellationToken.None).catch(onUnexpectedError);\r\n    };\r\n    FormatOnPaste.ID = 'editor.contrib.formatOnPaste';\r\n    FormatOnPaste = __decorate([\r\n        __param(1, IInstantiationService)\r\n    ], FormatOnPaste);\r\n    return FormatOnPaste;\r\n}());\r\nvar FormatDocumentAction = /** @class */ (function (_super) {\r\n    __extends(FormatDocumentAction, _super);\r\n    function FormatDocumentAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.formatDocument',\r\n            label: nls.localize('formatDocument.label', \"Format Document\"),\r\n            alias: 'Format Document',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.hasDocumentFormattingProvider),\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 36 /* KEY_F */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 39 /* KEY_I */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                when: EditorContextKeys.hasDocumentFormattingProvider,\r\n                group: '1_modification',\r\n                order: 1.3\r\n            }\r\n        }) || this;\r\n    }\r\n    FormatDocumentAction.prototype.run = function (accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var instaService;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!editor.hasModel()) return [3 /*break*/, 2];\r\n                        instaService = accessor.get(IInstantiationService);\r\n                        return [4 /*yield*/, instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* Explicit */, CancellationToken.None)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return FormatDocumentAction;\r\n}(EditorAction));\r\nvar FormatSelectionAction = /** @class */ (function (_super) {\r\n    __extends(FormatSelectionAction, _super);\r\n    function FormatSelectionAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.formatSelection',\r\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\r\n            alias: 'Format Selection',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.hasDocumentSelectionFormattingProvider),\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 36 /* KEY_F */),\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                when: ContextKeyExpr.and(EditorContextKeys.hasDocumentSelectionFormattingProvider, EditorContextKeys.hasNonEmptySelection),\r\n                group: '1_modification',\r\n                order: 1.31\r\n            }\r\n        }) || this;\r\n    }\r\n    FormatSelectionAction.prototype.run = function (accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var instaService, model, range;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!editor.hasModel()) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        instaService = accessor.get(IInstantiationService);\r\n                        model = editor.getModel();\r\n                        range = editor.getSelection();\r\n                        if (range.isEmpty()) {\r\n                            range = new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber));\r\n                        }\r\n                        return [4 /*yield*/, instaService.invokeFunction(formatDocumentRangeWithSelectedProvider, editor, range, 1 /* Explicit */, CancellationToken.None)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return FormatSelectionAction;\r\n}(EditorAction));\r\nregisterEditorContribution(FormatOnType.ID, FormatOnType);\r\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste);\r\nregisterEditorAction(FormatDocumentAction);\r\nregisterEditorAction(FormatSelectionAction);\r\n// this is the old format action that does both (format document OR format selection)\r\n// and we keep it here such that existing keybinding configurations etc will still work\r\nCommandsRegistry.registerCommand('editor.action.format', function (accessor) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var editor, commandService;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0:\r\n                editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n                if (!editor || !editor.hasModel()) {\r\n                    return [2 /*return*/];\r\n                }\r\n                commandService = accessor.get(ICommandService);\r\n                if (!editor.getSelection().isEmpty()) return [3 /*break*/, 2];\r\n                return [4 /*yield*/, commandService.executeCommand('editor.action.formatDocument')];\r\n            case 1:\r\n                _a.sent();\r\n                return [3 /*break*/, 4];\r\n            case 2: return [4 /*yield*/, commandService.executeCommand('editor.action.formatSelection')];\r\n            case 3:\r\n                _a.sent();\r\n                _a.label = 4;\r\n            case 4: return [2 /*return*/];\r\n        }\r\n    });\r\n}); });\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './media/peekViewWidget.css';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { ActionBar } from '../../../base/browser/ui/actionbar/actionbar.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../browser/widget/embeddedCodeEditorWidget.js';\r\nimport { ZoneWidget } from '../zoneWidget/zoneWidget.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { registerColor, contrastBorder, activeContrastBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nexport var IPeekViewService = createDecorator('IPeekViewService');\r\nregisterSingleton(IPeekViewService, /** @class */ (function () {\r\n    function class_1() {\r\n        this._widgets = new Map();\r\n    }\r\n    class_1.prototype.addExclusiveWidget = function (editor, widget) {\r\n        var _this = this;\r\n        var existing = this._widgets.get(editor);\r\n        if (existing) {\r\n            existing.listener.dispose();\r\n            existing.widget.dispose();\r\n        }\r\n        var remove = function () {\r\n            var data = _this._widgets.get(editor);\r\n            if (data && data.widget === widget) {\r\n                data.listener.dispose();\r\n                _this._widgets.delete(editor);\r\n            }\r\n        };\r\n        this._widgets.set(editor, { widget: widget, listener: widget.onDidClose(remove) });\r\n    };\r\n    return class_1;\r\n}()));\r\nexport var PeekContext;\r\n(function (PeekContext) {\r\n    PeekContext.inPeekEditor = new RawContextKey('inReferenceSearchEditor', true);\r\n    PeekContext.notInPeekEditor = PeekContext.inPeekEditor.toNegated();\r\n})(PeekContext || (PeekContext = {}));\r\nvar PeekContextController = /** @class */ (function () {\r\n    function PeekContextController(editor, contextKeyService) {\r\n        if (editor instanceof EmbeddedCodeEditorWidget) {\r\n            PeekContext.inPeekEditor.bindTo(contextKeyService);\r\n        }\r\n    }\r\n    PeekContextController.prototype.dispose = function () { };\r\n    PeekContextController.ID = 'editor.contrib.referenceController';\r\n    PeekContextController = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], PeekContextController);\r\n    return PeekContextController;\r\n}());\r\nregisterEditorContribution(PeekContextController.ID, PeekContextController);\r\nexport function getOuterEditor(accessor) {\r\n    var editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n    if (editor instanceof EmbeddedCodeEditorWidget) {\r\n        return editor.getParentEditor();\r\n    }\r\n    return editor;\r\n}\r\nvar defaultOptions = {\r\n    headerBackgroundColor: Color.white,\r\n    primaryHeadingColor: Color.fromHex('#333333'),\r\n    secondaryHeadingColor: Color.fromHex('#6c6c6cb3')\r\n};\r\nvar PeekViewWidget = /** @class */ (function (_super) {\r\n    __extends(PeekViewWidget, _super);\r\n    function PeekViewWidget(editor, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this, editor, options) || this;\r\n        _this._onDidClose = new Emitter();\r\n        _this.onDidClose = _this._onDidClose.event;\r\n        objects.mixin(_this.options, defaultOptions, false);\r\n        return _this;\r\n    }\r\n    PeekViewWidget.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._onDidClose.fire(this);\r\n    };\r\n    PeekViewWidget.prototype.style = function (styles) {\r\n        var options = this.options;\r\n        if (styles.headerBackgroundColor) {\r\n            options.headerBackgroundColor = styles.headerBackgroundColor;\r\n        }\r\n        if (styles.primaryHeadingColor) {\r\n            options.primaryHeadingColor = styles.primaryHeadingColor;\r\n        }\r\n        if (styles.secondaryHeadingColor) {\r\n            options.secondaryHeadingColor = styles.secondaryHeadingColor;\r\n        }\r\n        _super.prototype.style.call(this, styles);\r\n    };\r\n    PeekViewWidget.prototype._applyStyles = function () {\r\n        _super.prototype._applyStyles.call(this);\r\n        var options = this.options;\r\n        if (this._headElement && options.headerBackgroundColor) {\r\n            this._headElement.style.backgroundColor = options.headerBackgroundColor.toString();\r\n        }\r\n        if (this._primaryHeading && options.primaryHeadingColor) {\r\n            this._primaryHeading.style.color = options.primaryHeadingColor.toString();\r\n        }\r\n        if (this._secondaryHeading && options.secondaryHeadingColor) {\r\n            this._secondaryHeading.style.color = options.secondaryHeadingColor.toString();\r\n        }\r\n        if (this._bodyElement && options.frameColor) {\r\n            this._bodyElement.style.borderColor = options.frameColor.toString();\r\n        }\r\n    };\r\n    PeekViewWidget.prototype._fillContainer = function (container) {\r\n        this.setCssClass('peekview-widget');\r\n        this._headElement = dom.$('.head');\r\n        this._bodyElement = dom.$('.body');\r\n        this._fillHead(this._headElement);\r\n        this._fillBody(this._bodyElement);\r\n        container.appendChild(this._headElement);\r\n        container.appendChild(this._bodyElement);\r\n    };\r\n    PeekViewWidget.prototype._fillHead = function (container) {\r\n        var _this = this;\r\n        var titleElement = dom.$('.peekview-title');\r\n        dom.append(this._headElement, titleElement);\r\n        dom.addStandardDisposableListener(titleElement, 'click', function (event) { return _this._onTitleClick(event); });\r\n        this._fillTitleIcon(titleElement);\r\n        this._primaryHeading = dom.$('span.filename');\r\n        this._secondaryHeading = dom.$('span.dirname');\r\n        this._metaHeading = dom.$('span.meta');\r\n        dom.append(titleElement, this._primaryHeading, this._secondaryHeading, this._metaHeading);\r\n        var actionsContainer = dom.$('.peekview-actions');\r\n        dom.append(this._headElement, actionsContainer);\r\n        var actionBarOptions = this._getActionBarOptions();\r\n        this._actionbarWidget = new ActionBar(actionsContainer, actionBarOptions);\r\n        this._disposables.add(this._actionbarWidget);\r\n        this._actionbarWidget.push(new Action('peekview.close', nls.localize('label.close', \"Close\"), 'codicon-close', true, function () {\r\n            _this.dispose();\r\n            return Promise.resolve();\r\n        }), { label: false, icon: true });\r\n    };\r\n    PeekViewWidget.prototype._fillTitleIcon = function (container) {\r\n    };\r\n    PeekViewWidget.prototype._getActionBarOptions = function () {\r\n        return {};\r\n    };\r\n    PeekViewWidget.prototype._onTitleClick = function (event) {\r\n        // implement me\r\n    };\r\n    PeekViewWidget.prototype.setTitle = function (primaryHeading, secondaryHeading) {\r\n        if (this._primaryHeading && this._secondaryHeading) {\r\n            this._primaryHeading.innerHTML = strings.escape(primaryHeading);\r\n            this._primaryHeading.setAttribute('aria-label', primaryHeading);\r\n            if (secondaryHeading) {\r\n                this._secondaryHeading.innerHTML = strings.escape(secondaryHeading);\r\n            }\r\n            else {\r\n                dom.clearNode(this._secondaryHeading);\r\n            }\r\n        }\r\n    };\r\n    PeekViewWidget.prototype.setMetaTitle = function (value) {\r\n        if (this._metaHeading) {\r\n            if (value) {\r\n                this._metaHeading.innerHTML = strings.escape(value);\r\n                dom.show(this._metaHeading);\r\n            }\r\n            else {\r\n                dom.hide(this._metaHeading);\r\n            }\r\n        }\r\n    };\r\n    PeekViewWidget.prototype._doLayout = function (heightInPixel, widthInPixel) {\r\n        if (!this._isShowing && heightInPixel < 0) {\r\n            // Looks like the view zone got folded away!\r\n            this.dispose();\r\n            return;\r\n        }\r\n        var headHeight = Math.ceil(this.editor.getOption(47 /* lineHeight */) * 1.2);\r\n        var bodyHeight = Math.round(heightInPixel - (headHeight + 2 /* the border-top/bottom width*/));\r\n        this._doLayoutHead(headHeight, widthInPixel);\r\n        this._doLayoutBody(bodyHeight, widthInPixel);\r\n    };\r\n    PeekViewWidget.prototype._doLayoutHead = function (heightInPixel, widthInPixel) {\r\n        if (this._headElement) {\r\n            this._headElement.style.height = heightInPixel + \"px\";\r\n            this._headElement.style.lineHeight = this._headElement.style.height;\r\n        }\r\n    };\r\n    PeekViewWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\r\n        if (this._bodyElement) {\r\n            this._bodyElement.style.height = heightInPixel + \"px\";\r\n        }\r\n    };\r\n    return PeekViewWidget;\r\n}(ZoneWidget));\r\nexport { PeekViewWidget };\r\nexport var peekViewTitleBackground = registerColor('peekViewTitle.background', { dark: '#1E1E1E', light: '#FFFFFF', hc: '#0C141F' }, nls.localize('peekViewTitleBackground', 'Background color of the peek view title area.'));\r\nexport var peekViewTitleForeground = registerColor('peekViewTitleLabel.foreground', { dark: '#FFFFFF', light: '#333333', hc: '#FFFFFF' }, nls.localize('peekViewTitleForeground', 'Color of the peek view title.'));\r\nexport var peekViewTitleInfoForeground = registerColor('peekViewTitleDescription.foreground', { dark: '#ccccccb3', light: '#6c6c6cb3', hc: '#FFFFFF99' }, nls.localize('peekViewTitleInfoForeground', 'Color of the peek view title info.'));\r\nexport var peekViewBorder = registerColor('peekView.border', { dark: '#007acc', light: '#007acc', hc: contrastBorder }, nls.localize('peekViewBorder', 'Color of the peek view borders and arrow.'));\r\nexport var peekViewResultsBackground = registerColor('peekViewResult.background', { dark: '#252526', light: '#F3F3F3', hc: Color.black }, nls.localize('peekViewResultsBackground', 'Background color of the peek view result list.'));\r\nexport var peekViewResultsMatchForeground = registerColor('peekViewResult.lineForeground', { dark: '#bbbbbb', light: '#646465', hc: Color.white }, nls.localize('peekViewResultsMatchForeground', 'Foreground color for line nodes in the peek view result list.'));\r\nexport var peekViewResultsFileForeground = registerColor('peekViewResult.fileForeground', { dark: Color.white, light: '#1E1E1E', hc: Color.white }, nls.localize('peekViewResultsFileForeground', 'Foreground color for file nodes in the peek view result list.'));\r\nexport var peekViewResultsSelectionBackground = registerColor('peekViewResult.selectionBackground', { dark: '#3399ff33', light: '#3399ff33', hc: null }, nls.localize('peekViewResultsSelectionBackground', 'Background color of the selected entry in the peek view result list.'));\r\nexport var peekViewResultsSelectionForeground = registerColor('peekViewResult.selectionForeground', { dark: Color.white, light: '#6C6C6C', hc: Color.white }, nls.localize('peekViewResultsSelectionForeground', 'Foreground color of the selected entry in the peek view result list.'));\r\nexport var peekViewEditorBackground = registerColor('peekViewEditor.background', { dark: '#001F33', light: '#F2F8FC', hc: Color.black }, nls.localize('peekViewEditorBackground', 'Background color of the peek view editor.'));\r\nexport var peekViewEditorGutterBackground = registerColor('peekViewEditorGutter.background', { dark: peekViewEditorBackground, light: peekViewEditorBackground, hc: peekViewEditorBackground }, nls.localize('peekViewEditorGutterBackground', 'Background color of the gutter in the peek view editor.'));\r\nexport var peekViewResultsMatchHighlight = registerColor('peekViewResult.matchHighlightBackground', { dark: '#ea5c004d', light: '#ea5c004d', hc: null }, nls.localize('peekViewResultsMatchHighlight', 'Match highlight color in the peek view result list.'));\r\nexport var peekViewEditorMatchHighlight = registerColor('peekViewEditor.matchHighlightBackground', { dark: '#ff8f0099', light: '#f5d802de', hc: null }, nls.localize('peekViewEditorMatchHighlight', 'Match highlight color in the peek view editor.'));\r\nexport var peekViewEditorMatchHighlightBorder = registerColor('peekViewEditor.matchHighlightBorder', { dark: null, light: null, hc: activeContrastBorder }, nls.localize('peekViewEditorMatchHighlightBorder', 'Match highlight border in the peek view editor.'));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { ICodeEditorService } from '../services/codeEditorService.js';\r\nimport { CodeEditorWidget } from './codeEditorWidget.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\r\nvar EmbeddedCodeEditorWidget = /** @class */ (function (_super) {\r\n    __extends(EmbeddedCodeEditorWidget, _super);\r\n    function EmbeddedCodeEditorWidget(domElement, options, parentEditor, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService) {\r\n        var _this = _super.call(this, domElement, parentEditor.getRawOptions(), {}, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService) || this;\r\n        _this._parentEditor = parentEditor;\r\n        _this._overwriteOptions = options;\r\n        // Overwrite parent's options\r\n        _super.prototype.updateOptions.call(_this, _this._overwriteOptions);\r\n        _this._register(parentEditor.onDidChangeConfiguration(function (e) { return _this._onParentConfigurationChanged(e); }));\r\n        return _this;\r\n    }\r\n    EmbeddedCodeEditorWidget.prototype.getParentEditor = function () {\r\n        return this._parentEditor;\r\n    };\r\n    EmbeddedCodeEditorWidget.prototype._onParentConfigurationChanged = function (e) {\r\n        _super.prototype.updateOptions.call(this, this._parentEditor.getRawOptions());\r\n        _super.prototype.updateOptions.call(this, this._overwriteOptions);\r\n    };\r\n    EmbeddedCodeEditorWidget.prototype.updateOptions = function (newOptions) {\r\n        objects.mixin(this._overwriteOptions, newOptions, true);\r\n        _super.prototype.updateOptions.call(this, this._overwriteOptions);\r\n    };\r\n    EmbeddedCodeEditorWidget = __decorate([\r\n        __param(3, IInstantiationService),\r\n        __param(4, ICodeEditorService),\r\n        __param(5, ICommandService),\r\n        __param(6, IContextKeyService),\r\n        __param(7, IThemeService),\r\n        __param(8, INotificationService),\r\n        __param(9, IAccessibilityService)\r\n    ], EmbeddedCodeEditorWidget);\r\n    return EmbeddedCodeEditorWidget;\r\n}(CodeEditorWidget));\r\nexport { EmbeddedCodeEditorWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar IdGenerator = /** @class */ (function () {\r\n    function IdGenerator(prefix) {\r\n        this._prefix = prefix;\r\n        this._lastId = 0;\r\n    }\r\n    IdGenerator.prototype.nextId = function () {\r\n        return this._prefix + (++this._lastId);\r\n    };\r\n    return IdGenerator;\r\n}());\r\nexport { IdGenerator };\r\nexport var defaultGenerator = new IdGenerator('id#');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './zoneWidget.css';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { Sash } from '../../../base/browser/ui/sash/sash.js';\r\nimport { Color, RGBA } from '../../../base/common/color.js';\r\nimport { IdGenerator } from '../../../base/common/idGenerator.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nvar defaultColor = new Color(new RGBA(0, 122, 204));\r\nvar defaultOptions = {\r\n    showArrow: true,\r\n    showFrame: true,\r\n    className: '',\r\n    frameColor: defaultColor,\r\n    arrowColor: defaultColor,\r\n    keepEditorSelection: false\r\n};\r\nvar WIDGET_ID = 'vs.editor.contrib.zoneWidget';\r\nvar ViewZoneDelegate = /** @class */ (function () {\r\n    function ViewZoneDelegate(domNode, afterLineNumber, afterColumn, heightInLines, onDomNodeTop, onComputedHeight) {\r\n        this.id = ''; // A valid zone id should be greater than 0\r\n        this.domNode = domNode;\r\n        this.afterLineNumber = afterLineNumber;\r\n        this.afterColumn = afterColumn;\r\n        this.heightInLines = heightInLines;\r\n        this._onDomNodeTop = onDomNodeTop;\r\n        this._onComputedHeight = onComputedHeight;\r\n    }\r\n    ViewZoneDelegate.prototype.onDomNodeTop = function (top) {\r\n        this._onDomNodeTop(top);\r\n    };\r\n    ViewZoneDelegate.prototype.onComputedHeight = function (height) {\r\n        this._onComputedHeight(height);\r\n    };\r\n    return ViewZoneDelegate;\r\n}());\r\nexport { ViewZoneDelegate };\r\nvar OverlayWidgetDelegate = /** @class */ (function () {\r\n    function OverlayWidgetDelegate(id, domNode) {\r\n        this._id = id;\r\n        this._domNode = domNode;\r\n    }\r\n    OverlayWidgetDelegate.prototype.getId = function () {\r\n        return this._id;\r\n    };\r\n    OverlayWidgetDelegate.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    OverlayWidgetDelegate.prototype.getPosition = function () {\r\n        return null;\r\n    };\r\n    return OverlayWidgetDelegate;\r\n}());\r\nexport { OverlayWidgetDelegate };\r\nvar Arrow = /** @class */ (function () {\r\n    function Arrow(_editor) {\r\n        this._editor = _editor;\r\n        this._ruleName = Arrow._IdGenerator.nextId();\r\n        this._decorations = [];\r\n        this._color = null;\r\n        this._height = -1;\r\n        //\r\n    }\r\n    Arrow.prototype.dispose = function () {\r\n        this.hide();\r\n        dom.removeCSSRulesContainingSelector(this._ruleName);\r\n    };\r\n    Object.defineProperty(Arrow.prototype, \"color\", {\r\n        set: function (value) {\r\n            if (this._color !== value) {\r\n                this._color = value;\r\n                this._updateStyle();\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Arrow.prototype, \"height\", {\r\n        set: function (value) {\r\n            if (this._height !== value) {\r\n                this._height = value;\r\n                this._updateStyle();\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Arrow.prototype._updateStyle = function () {\r\n        dom.removeCSSRulesContainingSelector(this._ruleName);\r\n        dom.createCSSRule(\".monaco-editor \" + this._ruleName, \"border-style: solid; border-color: transparent; border-bottom-color: \" + this._color + \"; border-width: \" + this._height + \"px; bottom: -\" + this._height + \"px; margin-left: -\" + this._height + \"px; \");\r\n    };\r\n    Arrow.prototype.show = function (where) {\r\n        this._decorations = this._editor.deltaDecorations(this._decorations, [{ range: Range.fromPositions(where), options: { className: this._ruleName, stickiness: 1 /* NeverGrowsWhenTypingAtEdges */ } }]);\r\n    };\r\n    Arrow.prototype.hide = function () {\r\n        this._editor.deltaDecorations(this._decorations, []);\r\n    };\r\n    Arrow._IdGenerator = new IdGenerator('.arrow-decoration-');\r\n    return Arrow;\r\n}());\r\nvar ZoneWidget = /** @class */ (function () {\r\n    function ZoneWidget(editor, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = {}; }\r\n        this._arrow = null;\r\n        this._overlayWidget = null;\r\n        this._resizeSash = null;\r\n        this._positionMarkerId = [];\r\n        this._viewZone = null;\r\n        this._disposables = new DisposableStore();\r\n        this.container = null;\r\n        this._isShowing = false;\r\n        this.editor = editor;\r\n        this.options = objects.deepClone(options);\r\n        objects.mixin(this.options, defaultOptions, false);\r\n        this.domNode = document.createElement('div');\r\n        if (!this.options.isAccessible) {\r\n            this.domNode.setAttribute('aria-hidden', 'true');\r\n            this.domNode.setAttribute('role', 'presentation');\r\n        }\r\n        this._disposables.add(this.editor.onDidLayoutChange(function (info) {\r\n            var width = _this._getWidth(info);\r\n            _this.domNode.style.width = width + 'px';\r\n            _this.domNode.style.left = _this._getLeft(info) + 'px';\r\n            _this._onWidth(width);\r\n        }));\r\n    }\r\n    ZoneWidget.prototype.dispose = function () {\r\n        var _this = this;\r\n        if (this._overlayWidget) {\r\n            this.editor.removeOverlayWidget(this._overlayWidget);\r\n            this._overlayWidget = null;\r\n        }\r\n        if (this._viewZone) {\r\n            this.editor.changeViewZones(function (accessor) {\r\n                if (_this._viewZone) {\r\n                    accessor.removeZone(_this._viewZone.id);\r\n                }\r\n                _this._viewZone = null;\r\n            });\r\n        }\r\n        this.editor.deltaDecorations(this._positionMarkerId, []);\r\n        this._positionMarkerId = [];\r\n        this._disposables.dispose();\r\n    };\r\n    ZoneWidget.prototype.create = function () {\r\n        dom.addClass(this.domNode, 'zone-widget');\r\n        if (this.options.className) {\r\n            dom.addClass(this.domNode, this.options.className);\r\n        }\r\n        this.container = document.createElement('div');\r\n        dom.addClass(this.container, 'zone-widget-container');\r\n        this.domNode.appendChild(this.container);\r\n        if (this.options.showArrow) {\r\n            this._arrow = new Arrow(this.editor);\r\n            this._disposables.add(this._arrow);\r\n        }\r\n        this._fillContainer(this.container);\r\n        this._initSash();\r\n        this._applyStyles();\r\n    };\r\n    ZoneWidget.prototype.style = function (styles) {\r\n        if (styles.frameColor) {\r\n            this.options.frameColor = styles.frameColor;\r\n        }\r\n        if (styles.arrowColor) {\r\n            this.options.arrowColor = styles.arrowColor;\r\n        }\r\n        this._applyStyles();\r\n    };\r\n    ZoneWidget.prototype._applyStyles = function () {\r\n        if (this.container && this.options.frameColor) {\r\n            var frameColor = this.options.frameColor.toString();\r\n            this.container.style.borderTopColor = frameColor;\r\n            this.container.style.borderBottomColor = frameColor;\r\n        }\r\n        if (this._arrow && this.options.arrowColor) {\r\n            var arrowColor = this.options.arrowColor.toString();\r\n            this._arrow.color = arrowColor;\r\n        }\r\n    };\r\n    ZoneWidget.prototype._getWidth = function (info) {\r\n        return info.width - info.minimapWidth - info.verticalScrollbarWidth;\r\n    };\r\n    ZoneWidget.prototype._getLeft = function (info) {\r\n        // If minimap is to the left, we move beyond it\r\n        if (info.minimapWidth > 0 && info.minimapLeft === 0) {\r\n            return info.minimapWidth;\r\n        }\r\n        return 0;\r\n    };\r\n    ZoneWidget.prototype._onViewZoneTop = function (top) {\r\n        this.domNode.style.top = top + 'px';\r\n    };\r\n    ZoneWidget.prototype._onViewZoneHeight = function (height) {\r\n        this.domNode.style.height = height + \"px\";\r\n        if (this.container) {\r\n            var containerHeight = height - this._decoratingElementsHeight();\r\n            this.container.style.height = containerHeight + \"px\";\r\n            var layoutInfo = this.editor.getLayoutInfo();\r\n            this._doLayout(containerHeight, this._getWidth(layoutInfo));\r\n        }\r\n        if (this._resizeSash) {\r\n            this._resizeSash.layout();\r\n        }\r\n    };\r\n    Object.defineProperty(ZoneWidget.prototype, \"position\", {\r\n        get: function () {\r\n            var id = this._positionMarkerId[0];\r\n            if (!id) {\r\n                return undefined;\r\n            }\r\n            var model = this.editor.getModel();\r\n            if (!model) {\r\n                return undefined;\r\n            }\r\n            var range = model.getDecorationRange(id);\r\n            if (!range) {\r\n                return undefined;\r\n            }\r\n            return range.getStartPosition();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ZoneWidget.prototype.show = function (rangeOrPos, heightInLines) {\r\n        var range = Range.isIRange(rangeOrPos) ? Range.lift(rangeOrPos) : Range.fromPositions(rangeOrPos);\r\n        this._isShowing = true;\r\n        this._showImpl(range, heightInLines);\r\n        this._isShowing = false;\r\n        this._positionMarkerId = this.editor.deltaDecorations(this._positionMarkerId, [{ range: range, options: ModelDecorationOptions.EMPTY }]);\r\n    };\r\n    ZoneWidget.prototype.hide = function () {\r\n        var _this = this;\r\n        if (this._viewZone) {\r\n            this.editor.changeViewZones(function (accessor) {\r\n                if (_this._viewZone) {\r\n                    accessor.removeZone(_this._viewZone.id);\r\n                }\r\n            });\r\n            this._viewZone = null;\r\n        }\r\n        if (this._overlayWidget) {\r\n            this.editor.removeOverlayWidget(this._overlayWidget);\r\n            this._overlayWidget = null;\r\n        }\r\n        if (this._arrow) {\r\n            this._arrow.hide();\r\n        }\r\n    };\r\n    ZoneWidget.prototype._decoratingElementsHeight = function () {\r\n        var lineHeight = this.editor.getOption(47 /* lineHeight */);\r\n        var result = 0;\r\n        if (this.options.showArrow) {\r\n            var arrowHeight = Math.round(lineHeight / 3);\r\n            result += 2 * arrowHeight;\r\n        }\r\n        if (this.options.showFrame) {\r\n            var frameThickness = Math.round(lineHeight / 9);\r\n            result += 2 * frameThickness;\r\n        }\r\n        return result;\r\n    };\r\n    ZoneWidget.prototype._showImpl = function (where, heightInLines) {\r\n        var _this = this;\r\n        var position = where.getStartPosition();\r\n        var layoutInfo = this.editor.getLayoutInfo();\r\n        var width = this._getWidth(layoutInfo);\r\n        this.domNode.style.width = width + \"px\";\r\n        this.domNode.style.left = this._getLeft(layoutInfo) + 'px';\r\n        // Render the widget as zone (rendering) and widget (lifecycle)\r\n        var viewZoneDomNode = document.createElement('div');\r\n        viewZoneDomNode.style.overflow = 'hidden';\r\n        var lineHeight = this.editor.getOption(47 /* lineHeight */);\r\n        // adjust heightInLines to viewport\r\n        var maxHeightInLines = (this.editor.getLayoutInfo().height / lineHeight) * 0.8;\r\n        if (heightInLines >= maxHeightInLines) {\r\n            heightInLines = maxHeightInLines;\r\n        }\r\n        var arrowHeight = 0;\r\n        var frameThickness = 0;\r\n        // Render the arrow one 1/3 of an editor line height\r\n        if (this._arrow && this.options.showArrow) {\r\n            arrowHeight = Math.round(lineHeight / 3);\r\n            this._arrow.height = arrowHeight;\r\n            this._arrow.show(position);\r\n        }\r\n        // Render the frame as 1/9 of an editor line height\r\n        if (this.options.showFrame) {\r\n            frameThickness = Math.round(lineHeight / 9);\r\n        }\r\n        // insert zone widget\r\n        this.editor.changeViewZones(function (accessor) {\r\n            if (_this._viewZone) {\r\n                accessor.removeZone(_this._viewZone.id);\r\n            }\r\n            if (_this._overlayWidget) {\r\n                _this.editor.removeOverlayWidget(_this._overlayWidget);\r\n                _this._overlayWidget = null;\r\n            }\r\n            _this.domNode.style.top = '-1000px';\r\n            _this._viewZone = new ViewZoneDelegate(viewZoneDomNode, position.lineNumber, position.column, heightInLines, function (top) { return _this._onViewZoneTop(top); }, function (height) { return _this._onViewZoneHeight(height); });\r\n            _this._viewZone.id = accessor.addZone(_this._viewZone);\r\n            _this._overlayWidget = new OverlayWidgetDelegate(WIDGET_ID + _this._viewZone.id, _this.domNode);\r\n            _this.editor.addOverlayWidget(_this._overlayWidget);\r\n        });\r\n        if (this.container && this.options.showFrame) {\r\n            var width_1 = this.options.frameWidth ? this.options.frameWidth : frameThickness;\r\n            this.container.style.borderTopWidth = width_1 + 'px';\r\n            this.container.style.borderBottomWidth = width_1 + 'px';\r\n        }\r\n        var containerHeight = heightInLines * lineHeight - this._decoratingElementsHeight();\r\n        if (this.container) {\r\n            this.container.style.top = arrowHeight + 'px';\r\n            this.container.style.height = containerHeight + 'px';\r\n            this.container.style.overflow = 'hidden';\r\n        }\r\n        this._doLayout(containerHeight, width);\r\n        if (!this.options.keepEditorSelection) {\r\n            this.editor.setSelection(where);\r\n        }\r\n        var model = this.editor.getModel();\r\n        if (model) {\r\n            var revealLine = where.endLineNumber + 1;\r\n            if (revealLine <= model.getLineCount()) {\r\n                // reveal line below the zone widget\r\n                this.revealLine(revealLine, false);\r\n            }\r\n            else {\r\n                // reveal last line atop\r\n                this.revealLine(model.getLineCount(), true);\r\n            }\r\n        }\r\n    };\r\n    ZoneWidget.prototype.revealLine = function (lineNumber, isLastLine) {\r\n        if (isLastLine) {\r\n            this.editor.revealLineInCenter(lineNumber, 0 /* Smooth */);\r\n        }\r\n        else {\r\n            this.editor.revealLine(lineNumber, 0 /* Smooth */);\r\n        }\r\n    };\r\n    ZoneWidget.prototype.setCssClass = function (className, classToReplace) {\r\n        if (!this.container) {\r\n            return;\r\n        }\r\n        if (classToReplace) {\r\n            this.container.classList.remove(classToReplace);\r\n        }\r\n        dom.addClass(this.container, className);\r\n    };\r\n    ZoneWidget.prototype._onWidth = function (widthInPixel) {\r\n        // implement in subclass\r\n    };\r\n    ZoneWidget.prototype._doLayout = function (heightInPixel, widthInPixel) {\r\n        // implement in subclass\r\n    };\r\n    ZoneWidget.prototype._relayout = function (newHeightInLines) {\r\n        var _this = this;\r\n        if (this._viewZone && this._viewZone.heightInLines !== newHeightInLines) {\r\n            this.editor.changeViewZones(function (accessor) {\r\n                if (_this._viewZone) {\r\n                    _this._viewZone.heightInLines = newHeightInLines;\r\n                    accessor.layoutZone(_this._viewZone.id);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    // --- sash\r\n    ZoneWidget.prototype._initSash = function () {\r\n        var _this = this;\r\n        if (this._resizeSash) {\r\n            return;\r\n        }\r\n        this._resizeSash = this._disposables.add(new Sash(this.domNode, this, { orientation: 1 /* HORIZONTAL */ }));\r\n        if (!this.options.isResizeable) {\r\n            this._resizeSash.hide();\r\n            this._resizeSash.state = 0 /* Disabled */;\r\n        }\r\n        var data;\r\n        this._disposables.add(this._resizeSash.onDidStart(function (e) {\r\n            if (_this._viewZone) {\r\n                data = {\r\n                    startY: e.startY,\r\n                    heightInLines: _this._viewZone.heightInLines,\r\n                };\r\n            }\r\n        }));\r\n        this._disposables.add(this._resizeSash.onDidEnd(function () {\r\n            data = undefined;\r\n        }));\r\n        this._disposables.add(this._resizeSash.onDidChange(function (evt) {\r\n            if (data) {\r\n                var lineDelta = (evt.currentY - data.startY) / _this.editor.getOption(47 /* lineHeight */);\r\n                var roundedLineDelta = lineDelta < 0 ? Math.ceil(lineDelta) : Math.floor(lineDelta);\r\n                var newHeightInLines = data.heightInLines + roundedLineDelta;\r\n                if (newHeightInLines > 5 && newHeightInLines < 35) {\r\n                    _this._relayout(newHeightInLines);\r\n                }\r\n            }\r\n        }));\r\n    };\r\n    ZoneWidget.prototype.getHorizontalSashLeft = function () {\r\n        return 0;\r\n    };\r\n    ZoneWidget.prototype.getHorizontalSashTop = function () {\r\n        return (this.domNode.style.height === null ? 0 : parseInt(this.domNode.style.height)) - (this._decoratingElementsHeight() / 2);\r\n    };\r\n    ZoneWidget.prototype.getHorizontalSashWidth = function () {\r\n        var layoutInfo = this.editor.getLayoutInfo();\r\n        return layoutInfo.width - layoutInfo.minimapWidth;\r\n    };\r\n    return ZoneWidget;\r\n}());\r\nexport { ZoneWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { localize } from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { defaultGenerator } from '../../../base/common/idGenerator.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar OneReference = /** @class */ (function () {\r\n    function OneReference(isProviderFirst, parent, _range, _rangeCallback) {\r\n        this.isProviderFirst = isProviderFirst;\r\n        this.parent = parent;\r\n        this._range = _range;\r\n        this._rangeCallback = _rangeCallback;\r\n        this.id = defaultGenerator.nextId();\r\n    }\r\n    Object.defineProperty(OneReference.prototype, \"uri\", {\r\n        get: function () {\r\n            return this.parent.uri;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OneReference.prototype, \"range\", {\r\n        get: function () {\r\n            return this._range;\r\n        },\r\n        set: function (value) {\r\n            this._range = value;\r\n            this._rangeCallback(this);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OneReference.prototype, \"ariaMessage\", {\r\n        get: function () {\r\n            return localize('aria.oneReference', \"symbol in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return OneReference;\r\n}());\r\nexport { OneReference };\r\nvar FilePreview = /** @class */ (function () {\r\n    function FilePreview(_modelReference) {\r\n        this._modelReference = _modelReference;\r\n    }\r\n    FilePreview.prototype.dispose = function () {\r\n        this._modelReference.dispose();\r\n    };\r\n    FilePreview.prototype.preview = function (range, n) {\r\n        if (n === void 0) { n = 8; }\r\n        var model = this._modelReference.object.textEditorModel;\r\n        if (!model) {\r\n            return undefined;\r\n        }\r\n        var startLineNumber = range.startLineNumber, startColumn = range.startColumn, endLineNumber = range.endLineNumber, endColumn = range.endColumn;\r\n        var word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\r\n        var beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\r\n        var afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        var before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\r\n        var inside = model.getValueInRange(range);\r\n        var after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\r\n        return {\r\n            value: before + inside + after,\r\n            highlight: { start: before.length, end: before.length + inside.length }\r\n        };\r\n    };\r\n    return FilePreview;\r\n}());\r\nexport { FilePreview };\r\nvar FileReferences = /** @class */ (function () {\r\n    function FileReferences(parent, uri) {\r\n        this.parent = parent;\r\n        this.uri = uri;\r\n        this.children = [];\r\n    }\r\n    FileReferences.prototype.dispose = function () {\r\n        dispose(this._preview);\r\n        this._preview = undefined;\r\n    };\r\n    Object.defineProperty(FileReferences.prototype, \"preview\", {\r\n        get: function () {\r\n            return this._preview;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FileReferences.prototype, \"failure\", {\r\n        get: function () {\r\n            return this._loadFailure;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FileReferences.prototype, \"ariaMessage\", {\r\n        get: function () {\r\n            var len = this.children.length;\r\n            if (len === 1) {\r\n                return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\r\n            }\r\n            else {\r\n                return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FileReferences.prototype.resolve = function (textModelResolverService) {\r\n        var _this = this;\r\n        if (this._resolved) {\r\n            return Promise.resolve(this);\r\n        }\r\n        return Promise.resolve(textModelResolverService.createModelReference(this.uri).then(function (modelReference) {\r\n            var model = modelReference.object;\r\n            if (!model) {\r\n                modelReference.dispose();\r\n                throw new Error();\r\n            }\r\n            _this._preview = new FilePreview(modelReference);\r\n            _this._resolved = true;\r\n            return _this;\r\n        }, function (err) {\r\n            // something wrong here\r\n            _this.children.length = 0;\r\n            _this._resolved = true;\r\n            _this._loadFailure = err;\r\n            return _this;\r\n        }));\r\n    };\r\n    return FileReferences;\r\n}());\r\nexport { FileReferences };\r\nvar ReferencesModel = /** @class */ (function () {\r\n    function ReferencesModel(links, title) {\r\n        var _this = this;\r\n        this._disposables = new DisposableStore();\r\n        this.groups = [];\r\n        this.references = [];\r\n        this._onDidChangeReferenceRange = new Emitter();\r\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\r\n        this._links = links;\r\n        this._title = title;\r\n        // grouping and sorting\r\n        var providersFirst = links[0];\r\n        links.sort(ReferencesModel._compareReferences);\r\n        var current;\r\n        for (var _i = 0, links_1 = links; _i < links_1.length; _i++) {\r\n            var link = links_1[_i];\r\n            if (!current || current.uri.toString() !== link.uri.toString()) {\r\n                // new group\r\n                current = new FileReferences(this, link.uri);\r\n                this.groups.push(current);\r\n            }\r\n            // append, check for equality first!\r\n            if (current.children.length === 0 || !Range.equalsRange(link.range, current.children[current.children.length - 1].range)) {\r\n                var oneRef = new OneReference(providersFirst === link, current, link.targetSelectionRange || link.range, function (ref) { return _this._onDidChangeReferenceRange.fire(ref); });\r\n                this.references.push(oneRef);\r\n                current.children.push(oneRef);\r\n            }\r\n        }\r\n    }\r\n    ReferencesModel.prototype.dispose = function () {\r\n        dispose(this.groups);\r\n        this._disposables.dispose();\r\n        this._onDidChangeReferenceRange.dispose();\r\n        this.groups.length = 0;\r\n    };\r\n    ReferencesModel.prototype.clone = function () {\r\n        return new ReferencesModel(this._links, this._title);\r\n    };\r\n    Object.defineProperty(ReferencesModel.prototype, \"title\", {\r\n        get: function () {\r\n            return this._title;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReferencesModel.prototype, \"isEmpty\", {\r\n        get: function () {\r\n            return this.groups.length === 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReferencesModel.prototype, \"ariaMessage\", {\r\n        get: function () {\r\n            if (this.isEmpty) {\r\n                return localize('aria.result.0', \"No results found\");\r\n            }\r\n            else if (this.references.length === 1) {\r\n                return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\r\n            }\r\n            else if (this.groups.length === 1) {\r\n                return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\r\n            }\r\n            else {\r\n                return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ReferencesModel.prototype.nextOrPreviousReference = function (reference, next) {\r\n        var parent = reference.parent;\r\n        var idx = parent.children.indexOf(reference);\r\n        var childCount = parent.children.length;\r\n        var groupCount = parent.parent.groups.length;\r\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\r\n            // cycling within one file\r\n            if (next) {\r\n                idx = (idx + 1) % childCount;\r\n            }\r\n            else {\r\n                idx = (idx + childCount - 1) % childCount;\r\n            }\r\n            return parent.children[idx];\r\n        }\r\n        idx = parent.parent.groups.indexOf(parent);\r\n        if (next) {\r\n            idx = (idx + 1) % groupCount;\r\n            return parent.parent.groups[idx].children[0];\r\n        }\r\n        else {\r\n            idx = (idx + groupCount - 1) % groupCount;\r\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\r\n        }\r\n    };\r\n    ReferencesModel.prototype.nearestReference = function (resource, position) {\r\n        var nearest = this.references.map(function (ref, idx) {\r\n            return {\r\n                idx: idx,\r\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\r\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\r\n            };\r\n        }).sort(function (a, b) {\r\n            if (a.prefixLen > b.prefixLen) {\r\n                return -1;\r\n            }\r\n            else if (a.prefixLen < b.prefixLen) {\r\n                return 1;\r\n            }\r\n            else if (a.offsetDist < b.offsetDist) {\r\n                return -1;\r\n            }\r\n            else if (a.offsetDist > b.offsetDist) {\r\n                return 1;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        })[0];\r\n        if (nearest) {\r\n            return this.references[nearest.idx];\r\n        }\r\n        return undefined;\r\n    };\r\n    ReferencesModel.prototype.referenceAt = function (resource, position) {\r\n        for (var _i = 0, _a = this.references; _i < _a.length; _i++) {\r\n            var ref = _a[_i];\r\n            if (ref.uri.toString() === resource.toString()) {\r\n                if (Range.containsPosition(ref.range, position)) {\r\n                    return ref;\r\n                }\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    ReferencesModel.prototype.firstReference = function () {\r\n        for (var _i = 0, _a = this.references; _i < _a.length; _i++) {\r\n            var ref = _a[_i];\r\n            if (ref.isProviderFirst) {\r\n                return ref;\r\n            }\r\n        }\r\n        return this.references[0];\r\n    };\r\n    ReferencesModel._compareReferences = function (a, b) {\r\n        return strings.compare(a.uri.toString(), b.uri.toString()) || Range.compareRangesUsingStarts(a.range, b.range);\r\n    };\r\n    return ReferencesModel;\r\n}());\r\nexport { ReferencesModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as objects from '../../../common/objects.js';\r\nimport { renderCodicons } from '../codiconLabel/codiconLabel.js';\r\nimport { escape } from '../../../common/strings.js';\r\nvar HighlightedLabel = /** @class */ (function () {\r\n    function HighlightedLabel(container, supportCodicons) {\r\n        this.supportCodicons = supportCodicons;\r\n        this.text = '';\r\n        this.title = '';\r\n        this.highlights = [];\r\n        this.didEverRender = false;\r\n        this.domNode = document.createElement('span');\r\n        this.domNode.className = 'monaco-highlighted-label';\r\n        container.appendChild(this.domNode);\r\n    }\r\n    Object.defineProperty(HighlightedLabel.prototype, \"element\", {\r\n        get: function () {\r\n            return this.domNode;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    HighlightedLabel.prototype.set = function (text, highlights, title, escapeNewLines) {\r\n        if (highlights === void 0) { highlights = []; }\r\n        if (title === void 0) { title = ''; }\r\n        if (!text) {\r\n            text = '';\r\n        }\r\n        if (escapeNewLines) {\r\n            // adjusts highlights inplace\r\n            text = HighlightedLabel.escapeNewLines(text, highlights);\r\n        }\r\n        if (this.didEverRender && this.text === text && this.title === title && objects.equals(this.highlights, highlights)) {\r\n            return;\r\n        }\r\n        if (!Array.isArray(highlights)) {\r\n            highlights = [];\r\n        }\r\n        this.text = text;\r\n        this.title = title;\r\n        this.highlights = highlights;\r\n        this.render();\r\n    };\r\n    HighlightedLabel.prototype.render = function () {\r\n        var htmlContent = '';\r\n        var pos = 0;\r\n        for (var _i = 0, _a = this.highlights; _i < _a.length; _i++) {\r\n            var highlight = _a[_i];\r\n            if (highlight.end === highlight.start) {\r\n                continue;\r\n            }\r\n            if (pos < highlight.start) {\r\n                htmlContent += '<span>';\r\n                var substring_1 = this.text.substring(pos, highlight.start);\r\n                htmlContent += this.supportCodicons ? renderCodicons(substring_1) : escape(substring_1);\r\n                htmlContent += '</span>';\r\n                pos = highlight.end;\r\n            }\r\n            htmlContent += '<span class=\"highlight\">';\r\n            var substring = this.text.substring(highlight.start, highlight.end);\r\n            htmlContent += this.supportCodicons ? renderCodicons(substring) : escape(substring);\r\n            htmlContent += '</span>';\r\n            pos = highlight.end;\r\n        }\r\n        if (pos < this.text.length) {\r\n            htmlContent += '<span>';\r\n            var substring = this.text.substring(pos);\r\n            htmlContent += this.supportCodicons ? renderCodicons(substring) : escape(substring);\r\n            htmlContent += '</span>';\r\n        }\r\n        this.domNode.innerHTML = htmlContent;\r\n        if (this.title) {\r\n            this.domNode.title = this.title;\r\n        }\r\n        else {\r\n            this.domNode.removeAttribute('title');\r\n        }\r\n        this.didEverRender = true;\r\n    };\r\n    HighlightedLabel.escapeNewLines = function (text, highlights) {\r\n        var total = 0;\r\n        var extra = 0;\r\n        return text.replace(/\\r\\n|\\r|\\n/g, function (match, offset) {\r\n            extra = match === '\\r\\n' ? -1 : 0;\r\n            offset += total;\r\n            for (var _i = 0, highlights_1 = highlights; _i < highlights_1.length; _i++) {\r\n                var highlight = highlights_1[_i];\r\n                if (highlight.end <= offset) {\r\n                    continue;\r\n                }\r\n                if (highlight.start >= offset) {\r\n                    highlight.start += extra;\r\n                }\r\n                if (highlight.end >= offset) {\r\n                    highlight.end += extra;\r\n                }\r\n            }\r\n            total += extra;\r\n            return '\\u23CE';\r\n        });\r\n    };\r\n    return HighlightedLabel;\r\n}());\r\nexport { HighlightedLabel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './iconlabel.css';\r\nimport * as dom from '../../dom.js';\r\nimport { HighlightedLabel } from '../highlightedlabel/highlightedLabel.js';\r\nimport { Disposable } from '../../../common/lifecycle.js';\r\nimport { Range } from '../../../common/range.js';\r\nimport { equals } from '../../../common/objects.js';\r\nvar FastLabelNode = /** @class */ (function () {\r\n    function FastLabelNode(_element) {\r\n        this._element = _element;\r\n    }\r\n    Object.defineProperty(FastLabelNode.prototype, \"element\", {\r\n        get: function () {\r\n            return this._element;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FastLabelNode.prototype, \"textContent\", {\r\n        set: function (content) {\r\n            if (this.disposed || content === this._textContent) {\r\n                return;\r\n            }\r\n            this._textContent = content;\r\n            this._element.textContent = content;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FastLabelNode.prototype, \"className\", {\r\n        set: function (className) {\r\n            if (this.disposed || className === this._className) {\r\n                return;\r\n            }\r\n            this._className = className;\r\n            this._element.className = className;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FastLabelNode.prototype, \"title\", {\r\n        set: function (title) {\r\n            if (this.disposed || title === this._title) {\r\n                return;\r\n            }\r\n            this._title = title;\r\n            if (this._title) {\r\n                this._element.title = title;\r\n            }\r\n            else {\r\n                this._element.removeAttribute('title');\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FastLabelNode.prototype, \"empty\", {\r\n        set: function (empty) {\r\n            if (this.disposed || empty === this._empty) {\r\n                return;\r\n            }\r\n            this._empty = empty;\r\n            this._element.style.marginLeft = empty ? '0' : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FastLabelNode.prototype.dispose = function () {\r\n        this.disposed = true;\r\n    };\r\n    return FastLabelNode;\r\n}());\r\nvar IconLabel = /** @class */ (function (_super) {\r\n    __extends(IconLabel, _super);\r\n    function IconLabel(container, options) {\r\n        var _a, _b;\r\n        var _this = _super.call(this) || this;\r\n        _this.domNode = _this._register(new FastLabelNode(dom.append(container, dom.$('.monaco-icon-label'))));\r\n        var labelContainer = dom.append(_this.domNode.element, dom.$('.monaco-icon-label-container'));\r\n        var nameContainer = dom.append(labelContainer, dom.$('span.monaco-icon-name-container'));\r\n        _this.descriptionContainer = _this._register(new FastLabelNode(dom.append(labelContainer, dom.$('span.monaco-icon-description-container'))));\r\n        if ((_a = options) === null || _a === void 0 ? void 0 : _a.supportHighlights) {\r\n            _this.nameNode = new LabelWithHighlights(nameContainer, !!options.supportCodicons);\r\n        }\r\n        else {\r\n            _this.nameNode = new Label(nameContainer);\r\n        }\r\n        if ((_b = options) === null || _b === void 0 ? void 0 : _b.supportDescriptionHighlights) {\r\n            _this.descriptionNodeFactory = function () { return new HighlightedLabel(dom.append(_this.descriptionContainer.element, dom.$('span.label-description')), !!options.supportCodicons); };\r\n        }\r\n        else {\r\n            _this.descriptionNodeFactory = function () { return _this._register(new FastLabelNode(dom.append(_this.descriptionContainer.element, dom.$('span.label-description')))); };\r\n        }\r\n        return _this;\r\n    }\r\n    IconLabel.prototype.setLabel = function (label, description, options) {\r\n        var _a, _b, _c;\r\n        var classes = ['monaco-icon-label'];\r\n        if (options) {\r\n            if (options.extraClasses) {\r\n                classes.push.apply(classes, options.extraClasses);\r\n            }\r\n            if (options.italic) {\r\n                classes.push('italic');\r\n            }\r\n        }\r\n        this.domNode.className = classes.join(' ');\r\n        this.domNode.title = ((_a = options) === null || _a === void 0 ? void 0 : _a.title) || '';\r\n        this.nameNode.setLabel(label, options);\r\n        if (description || this.descriptionNode) {\r\n            if (!this.descriptionNode) {\r\n                this.descriptionNode = this.descriptionNodeFactory(); // description node is created lazily on demand\r\n            }\r\n            if (this.descriptionNode instanceof HighlightedLabel) {\r\n                this.descriptionNode.set(description || '', options ? options.descriptionMatches : undefined);\r\n                if ((_b = options) === null || _b === void 0 ? void 0 : _b.descriptionTitle) {\r\n                    this.descriptionNode.element.title = options.descriptionTitle;\r\n                }\r\n                else {\r\n                    this.descriptionNode.element.removeAttribute('title');\r\n                }\r\n            }\r\n            else {\r\n                this.descriptionNode.textContent = description || '';\r\n                this.descriptionNode.title = ((_c = options) === null || _c === void 0 ? void 0 : _c.descriptionTitle) || '';\r\n                this.descriptionNode.empty = !description;\r\n            }\r\n        }\r\n    };\r\n    return IconLabel;\r\n}(Disposable));\r\nexport { IconLabel };\r\nvar Label = /** @class */ (function () {\r\n    function Label(container) {\r\n        this.container = container;\r\n        this.label = undefined;\r\n        this.singleLabel = undefined;\r\n    }\r\n    Label.prototype.setLabel = function (label, options) {\r\n        var _a, _b, _c, _d;\r\n        if (this.label === label && equals(this.options, options)) {\r\n            return;\r\n        }\r\n        this.label = label;\r\n        this.options = options;\r\n        if (typeof label === 'string') {\r\n            if (!this.singleLabel) {\r\n                this.container.innerHTML = '';\r\n                dom.removeClass(this.container, 'multiple');\r\n                this.singleLabel = dom.append(this.container, dom.$('a.label-name', { id: (_a = options) === null || _a === void 0 ? void 0 : _a.domId }));\r\n            }\r\n            this.singleLabel.textContent = label;\r\n        }\r\n        else {\r\n            this.container.innerHTML = '';\r\n            dom.addClass(this.container, 'multiple');\r\n            this.singleLabel = undefined;\r\n            for (var i = 0; i < label.length; i++) {\r\n                var l = label[i];\r\n                var id = ((_b = options) === null || _b === void 0 ? void 0 : _b.domId) && ((_c = options) === null || _c === void 0 ? void 0 : _c.domId) + \"_\" + i;\r\n                dom.append(this.container, dom.$('a.label-name', { id: id, 'data-icon-label-count': label.length, 'data-icon-label-index': i }, l));\r\n                if (i < label.length - 1) {\r\n                    dom.append(this.container, dom.$('span.label-separator', undefined, ((_d = options) === null || _d === void 0 ? void 0 : _d.separator) || '/'));\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return Label;\r\n}());\r\nfunction splitMatches(labels, separator, matches) {\r\n    if (!matches) {\r\n        return undefined;\r\n    }\r\n    var labelStart = 0;\r\n    return labels.map(function (label) {\r\n        var labelRange = { start: labelStart, end: labelStart + label.length };\r\n        var result = matches\r\n            .map(function (match) { return Range.intersect(labelRange, match); })\r\n            .filter(function (range) { return !Range.isEmpty(range); })\r\n            .map(function (_a) {\r\n            var start = _a.start, end = _a.end;\r\n            return ({ start: start - labelStart, end: end - labelStart });\r\n        });\r\n        labelStart = labelRange.end + separator.length;\r\n        return result;\r\n    });\r\n}\r\nvar LabelWithHighlights = /** @class */ (function () {\r\n    function LabelWithHighlights(container, supportCodicons) {\r\n        this.container = container;\r\n        this.supportCodicons = supportCodicons;\r\n        this.label = undefined;\r\n        this.singleLabel = undefined;\r\n    }\r\n    LabelWithHighlights.prototype.setLabel = function (label, options) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\r\n        if (this.label === label && equals(this.options, options)) {\r\n            return;\r\n        }\r\n        this.label = label;\r\n        this.options = options;\r\n        if (typeof label === 'string') {\r\n            if (!this.singleLabel) {\r\n                this.container.innerHTML = '';\r\n                dom.removeClass(this.container, 'multiple');\r\n                this.singleLabel = new HighlightedLabel(dom.append(this.container, dom.$('a.label-name', { id: (_a = options) === null || _a === void 0 ? void 0 : _a.domId })), this.supportCodicons);\r\n            }\r\n            this.singleLabel.set(label, (_b = options) === null || _b === void 0 ? void 0 : _b.matches, (_c = options) === null || _c === void 0 ? void 0 : _c.title, (_d = options) === null || _d === void 0 ? void 0 : _d.labelEscapeNewLines);\r\n        }\r\n        else {\r\n            this.container.innerHTML = '';\r\n            dom.addClass(this.container, 'multiple');\r\n            this.singleLabel = undefined;\r\n            var separator = ((_e = options) === null || _e === void 0 ? void 0 : _e.separator) || '/';\r\n            var matches = splitMatches(label, separator, (_f = options) === null || _f === void 0 ? void 0 : _f.matches);\r\n            for (var i = 0; i < label.length; i++) {\r\n                var l = label[i];\r\n                var m = matches ? matches[i] : undefined;\r\n                var id = ((_g = options) === null || _g === void 0 ? void 0 : _g.domId) && ((_h = options) === null || _h === void 0 ? void 0 : _h.domId) + \"_\" + i;\r\n                var name_1 = dom.$('a.label-name', { id: id, 'data-icon-label-count': label.length, 'data-icon-label-index': i });\r\n                var highlightedLabel = new HighlightedLabel(dom.append(this.container, name_1), this.supportCodicons);\r\n                highlightedLabel.set(l, m, (_j = options) === null || _j === void 0 ? void 0 : _j.title, (_k = options) === null || _k === void 0 ? void 0 : _k.labelEscapeNewLines);\r\n                if (i < label.length - 1) {\r\n                    dom.append(name_1, dom.$('span.label-separator', undefined, separator));\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return LabelWithHighlights;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './countBadge.css';\r\nimport { $, append } from '../../dom.js';\r\nimport { format } from '../../../common/strings.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nvar defaultOpts = {\r\n    badgeBackground: Color.fromHex('#4D4D4D'),\r\n    badgeForeground: Color.fromHex('#FFFFFF')\r\n};\r\nvar CountBadge = /** @class */ (function () {\r\n    function CountBadge(container, options) {\r\n        this.count = 0;\r\n        this.options = options || Object.create(null);\r\n        mixin(this.options, defaultOpts, false);\r\n        this.badgeBackground = this.options.badgeBackground;\r\n        this.badgeForeground = this.options.badgeForeground;\r\n        this.badgeBorder = this.options.badgeBorder;\r\n        this.element = append(container, $('.monaco-count-badge'));\r\n        this.countFormat = this.options.countFormat || '{0}';\r\n        this.titleFormat = this.options.titleFormat || '';\r\n        this.setCount(this.options.count || 0);\r\n    }\r\n    CountBadge.prototype.setCount = function (count) {\r\n        this.count = count;\r\n        this.render();\r\n    };\r\n    CountBadge.prototype.setTitleFormat = function (titleFormat) {\r\n        this.titleFormat = titleFormat;\r\n        this.render();\r\n    };\r\n    CountBadge.prototype.render = function () {\r\n        this.element.textContent = format(this.countFormat, this.count);\r\n        this.element.title = format(this.titleFormat, this.count);\r\n        this.applyStyles();\r\n    };\r\n    CountBadge.prototype.style = function (styles) {\r\n        this.badgeBackground = styles.badgeBackground;\r\n        this.badgeForeground = styles.badgeForeground;\r\n        this.badgeBorder = styles.badgeBorder;\r\n        this.applyStyles();\r\n    };\r\n    CountBadge.prototype.applyStyles = function () {\r\n        if (this.element) {\r\n            var background = this.badgeBackground ? this.badgeBackground.toString() : '';\r\n            var foreground = this.badgeForeground ? this.badgeForeground.toString() : '';\r\n            var border = this.badgeBorder ? this.badgeBorder.toString() : '';\r\n            this.element.style.backgroundColor = background;\r\n            this.element.style.color = foreground;\r\n            this.element.style.borderWidth = border ? '1px' : '';\r\n            this.element.style.borderStyle = border ? 'solid' : '';\r\n            this.element.style.borderColor = border;\r\n        }\r\n    };\r\n    return CountBadge;\r\n}());\r\nexport { CountBadge };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { URI } from './uri.js';\r\nimport { posix, normalize } from './path.js';\r\nimport { startsWithIgnoreCase, rtrim, startsWith } from './strings.js';\r\nimport { Schemas } from './network.js';\r\nimport { isLinux, isWindows } from './platform.js';\r\nimport { isEqual, basename, relativePath } from './resources.js';\r\n/**\r\n * @deprecated use LabelService instead\r\n */\r\nexport function getPathLabel(resource, userHomeProvider, rootProvider) {\r\n    if (typeof resource === 'string') {\r\n        resource = URI.file(resource);\r\n    }\r\n    // return early if we can resolve a relative path label from the root\r\n    if (rootProvider) {\r\n        var baseResource = rootProvider.getWorkspaceFolder(resource);\r\n        if (baseResource) {\r\n            var hasMultipleRoots = rootProvider.getWorkspace().folders.length > 1;\r\n            var pathLabel = void 0;\r\n            if (isEqual(baseResource.uri, resource)) {\r\n                pathLabel = ''; // no label if paths are identical\r\n            }\r\n            else {\r\n                pathLabel = relativePath(baseResource.uri, resource);\r\n            }\r\n            if (hasMultipleRoots) {\r\n                var rootName = baseResource.name ? baseResource.name : basename(baseResource.uri);\r\n                pathLabel = pathLabel ? (rootName + '  ' + pathLabel) : rootName; // always show root basename if there are multiple\r\n            }\r\n            return pathLabel;\r\n        }\r\n    }\r\n    // return if the resource is neither file:// nor untitled:// and no baseResource was provided\r\n    if (resource.scheme !== Schemas.file && resource.scheme !== Schemas.untitled) {\r\n        return resource.with({ query: null, fragment: null }).toString(true);\r\n    }\r\n    // convert c:\\something => C:\\something\r\n    if (hasDriveLetter(resource.fsPath)) {\r\n        return normalize(normalizeDriveLetter(resource.fsPath));\r\n    }\r\n    // normalize and tildify (macOS, Linux only)\r\n    var res = normalize(resource.fsPath);\r\n    if (!isWindows && userHomeProvider) {\r\n        res = tildify(res, userHomeProvider.userHome);\r\n    }\r\n    return res;\r\n}\r\nexport function getBaseLabel(resource) {\r\n    if (!resource) {\r\n        return undefined;\r\n    }\r\n    if (typeof resource === 'string') {\r\n        resource = URI.file(resource);\r\n    }\r\n    var base = basename(resource) || (resource.scheme === Schemas.file ? resource.fsPath : resource.path) /* can be empty string if '/' is passed in */;\r\n    // convert c: => C:\r\n    if (hasDriveLetter(base)) {\r\n        return normalizeDriveLetter(base);\r\n    }\r\n    return base;\r\n}\r\nfunction hasDriveLetter(path) {\r\n    return !!(isWindows && path && path[1] === ':');\r\n}\r\nexport function normalizeDriveLetter(path) {\r\n    if (hasDriveLetter(path)) {\r\n        return path.charAt(0).toUpperCase() + path.slice(1);\r\n    }\r\n    return path;\r\n}\r\nvar normalizedUserHomeCached = Object.create(null);\r\nexport function tildify(path, userHome) {\r\n    if (isWindows || !path || !userHome) {\r\n        return path; // unsupported\r\n    }\r\n    // Keep a normalized user home path as cache to prevent accumulated string creation\r\n    var normalizedUserHome = normalizedUserHomeCached.original === userHome ? normalizedUserHomeCached.normalized : undefined;\r\n    if (!normalizedUserHome) {\r\n        normalizedUserHome = \"\" + rtrim(userHome, posix.sep) + posix.sep;\r\n        normalizedUserHomeCached = { original: userHome, normalized: normalizedUserHome };\r\n    }\r\n    // Linux: case sensitive, macOS: case insensitive\r\n    if (isLinux ? startsWith(path, normalizedUserHome) : startsWithIgnoreCase(path, normalizedUserHome)) {\r\n        path = \"~/\" + path.substr(normalizedUserHome.length);\r\n    }\r\n    return path;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport './splitview.css';\r\nimport { toDisposable, Disposable, combinedDisposable } from '../../../common/lifecycle.js';\r\nimport { Event, Emitter } from '../../../common/event.js';\r\nimport * as types from '../../../common/types.js';\r\nimport * as dom from '../../dom.js';\r\nimport { clamp } from '../../../common/numbers.js';\r\nimport { range, firstIndex, pushToStart, pushToEnd } from '../../../common/arrays.js';\r\nimport { Sash } from '../sash/sash.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { domEvent } from '../../event.js';\r\nvar defaultStyles = {\r\n    separatorBorder: Color.transparent\r\n};\r\nvar ViewItem = /** @class */ (function () {\r\n    function ViewItem(container, view, size, disposable) {\r\n        this.container = container;\r\n        this.view = view;\r\n        this.disposable = disposable;\r\n        this._cachedVisibleSize = undefined;\r\n        if (typeof size === 'number') {\r\n            this._size = size;\r\n            this._cachedVisibleSize = undefined;\r\n            dom.addClass(container, 'visible');\r\n        }\r\n        else {\r\n            this._size = 0;\r\n            this._cachedVisibleSize = size.cachedVisibleSize;\r\n        }\r\n    }\r\n    Object.defineProperty(ViewItem.prototype, \"size\", {\r\n        get: function () {\r\n            return this._size;\r\n        },\r\n        set: function (size) {\r\n            this._size = size;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"visible\", {\r\n        get: function () {\r\n            return typeof this._cachedVisibleSize === 'undefined';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ViewItem.prototype.setVisible = function (visible, size) {\r\n        if (visible === this.visible) {\r\n            return;\r\n        }\r\n        if (visible) {\r\n            this.size = clamp(this._cachedVisibleSize, this.viewMinimumSize, this.viewMaximumSize);\r\n            this._cachedVisibleSize = undefined;\r\n        }\r\n        else {\r\n            this._cachedVisibleSize = typeof size === 'number' ? size : this.size;\r\n            this.size = 0;\r\n        }\r\n        dom.toggleClass(this.container, 'visible', visible);\r\n        if (this.view.setVisible) {\r\n            this.view.setVisible(visible);\r\n        }\r\n    };\r\n    Object.defineProperty(ViewItem.prototype, \"minimumSize\", {\r\n        get: function () { return this.visible ? this.view.minimumSize : 0; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"viewMinimumSize\", {\r\n        get: function () { return this.view.minimumSize; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"maximumSize\", {\r\n        get: function () { return this.visible ? this.view.maximumSize : 0; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"viewMaximumSize\", {\r\n        get: function () { return this.view.maximumSize; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"priority\", {\r\n        get: function () { return this.view.priority; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"snap\", {\r\n        get: function () { return !!this.view.snap; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"enabled\", {\r\n        set: function (enabled) {\r\n            this.container.style.pointerEvents = enabled ? null : 'none';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ViewItem.prototype.layout = function (offset, layoutContext) {\r\n        this.layoutContainer(offset);\r\n        this.view.layout(this.size, offset, layoutContext);\r\n    };\r\n    ViewItem.prototype.dispose = function () {\r\n        this.disposable.dispose();\r\n        return this.view;\r\n    };\r\n    return ViewItem;\r\n}());\r\nvar VerticalViewItem = /** @class */ (function (_super) {\r\n    __extends(VerticalViewItem, _super);\r\n    function VerticalViewItem() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    VerticalViewItem.prototype.layoutContainer = function (offset) {\r\n        this.container.style.top = offset + \"px\";\r\n        this.container.style.height = this.size + \"px\";\r\n    };\r\n    return VerticalViewItem;\r\n}(ViewItem));\r\nvar HorizontalViewItem = /** @class */ (function (_super) {\r\n    __extends(HorizontalViewItem, _super);\r\n    function HorizontalViewItem() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    HorizontalViewItem.prototype.layoutContainer = function (offset) {\r\n        this.container.style.left = offset + \"px\";\r\n        this.container.style.width = this.size + \"px\";\r\n    };\r\n    return HorizontalViewItem;\r\n}(ViewItem));\r\nvar State;\r\n(function (State) {\r\n    State[State[\"Idle\"] = 0] = \"Idle\";\r\n    State[State[\"Busy\"] = 1] = \"Busy\";\r\n})(State || (State = {}));\r\nexport var Sizing;\r\n(function (Sizing) {\r\n    Sizing.Distribute = { type: 'distribute' };\r\n    function Split(index) { return { type: 'split', index: index }; }\r\n    Sizing.Split = Split;\r\n    function Invisible(cachedVisibleSize) { return { type: 'invisible', cachedVisibleSize: cachedVisibleSize }; }\r\n    Sizing.Invisible = Invisible;\r\n})(Sizing || (Sizing = {}));\r\nvar SplitView = /** @class */ (function (_super) {\r\n    __extends(SplitView, _super);\r\n    function SplitView(container, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this) || this;\r\n        _this.size = 0;\r\n        _this.contentSize = 0;\r\n        _this.proportions = undefined;\r\n        _this.viewItems = [];\r\n        _this.sashItems = [];\r\n        _this.state = State.Idle;\r\n        _this._onDidSashChange = _this._register(new Emitter());\r\n        _this.onDidSashChange = _this._onDidSashChange.event;\r\n        _this._onDidSashReset = _this._register(new Emitter());\r\n        _this._startSnappingEnabled = true;\r\n        _this._endSnappingEnabled = true;\r\n        _this.orientation = types.isUndefined(options.orientation) ? 0 /* VERTICAL */ : options.orientation;\r\n        _this.inverseAltBehavior = !!options.inverseAltBehavior;\r\n        _this.proportionalLayout = types.isUndefined(options.proportionalLayout) ? true : !!options.proportionalLayout;\r\n        _this.el = document.createElement('div');\r\n        dom.addClass(_this.el, 'monaco-split-view2');\r\n        dom.addClass(_this.el, _this.orientation === 0 /* VERTICAL */ ? 'vertical' : 'horizontal');\r\n        container.appendChild(_this.el);\r\n        _this.sashContainer = dom.append(_this.el, dom.$('.sash-container'));\r\n        _this.viewContainer = dom.append(_this.el, dom.$('.split-view-container'));\r\n        _this.style(options.styles || defaultStyles);\r\n        // We have an existing set of view, add them now\r\n        if (options.descriptor) {\r\n            _this.size = options.descriptor.size;\r\n            options.descriptor.views.forEach(function (viewDescriptor, index) {\r\n                var sizing = types.isUndefined(viewDescriptor.visible) || viewDescriptor.visible ? viewDescriptor.size : { type: 'invisible', cachedVisibleSize: viewDescriptor.size };\r\n                var view = viewDescriptor.view;\r\n                _this.doAddView(view, sizing, index, true);\r\n            });\r\n            // Initialize content size and proportions for first layout\r\n            _this.contentSize = _this.viewItems.reduce(function (r, i) { return r + i.size; }, 0);\r\n            _this.saveProportions();\r\n        }\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SplitView.prototype, \"orthogonalStartSash\", {\r\n        get: function () { return this._orthogonalStartSash; },\r\n        set: function (sash) {\r\n            for (var _i = 0, _a = this.sashItems; _i < _a.length; _i++) {\r\n                var sashItem = _a[_i];\r\n                sashItem.sash.orthogonalStartSash = sash;\r\n            }\r\n            this._orthogonalStartSash = sash;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SplitView.prototype, \"orthogonalEndSash\", {\r\n        get: function () { return this._orthogonalEndSash; },\r\n        set: function (sash) {\r\n            for (var _i = 0, _a = this.sashItems; _i < _a.length; _i++) {\r\n                var sashItem = _a[_i];\r\n                sashItem.sash.orthogonalEndSash = sash;\r\n            }\r\n            this._orthogonalEndSash = sash;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SplitView.prototype, \"startSnappingEnabled\", {\r\n        get: function () { return this._startSnappingEnabled; },\r\n        set: function (startSnappingEnabled) {\r\n            if (this._startSnappingEnabled === startSnappingEnabled) {\r\n                return;\r\n            }\r\n            this._startSnappingEnabled = startSnappingEnabled;\r\n            this.updateSashEnablement();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SplitView.prototype, \"endSnappingEnabled\", {\r\n        get: function () { return this._endSnappingEnabled; },\r\n        set: function (endSnappingEnabled) {\r\n            if (this._endSnappingEnabled === endSnappingEnabled) {\r\n                return;\r\n            }\r\n            this._endSnappingEnabled = endSnappingEnabled;\r\n            this.updateSashEnablement();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SplitView.prototype.style = function (styles) {\r\n        if (styles.separatorBorder.isTransparent()) {\r\n            dom.removeClass(this.el, 'separator-border');\r\n            this.el.style.removeProperty('--separator-border');\r\n        }\r\n        else {\r\n            dom.addClass(this.el, 'separator-border');\r\n            this.el.style.setProperty('--separator-border', styles.separatorBorder.toString());\r\n        }\r\n    };\r\n    SplitView.prototype.addView = function (view, size, index) {\r\n        if (index === void 0) { index = this.viewItems.length; }\r\n        this.doAddView(view, size, index, false);\r\n    };\r\n    SplitView.prototype.layout = function (size, layoutContext) {\r\n        var _this = this;\r\n        var previousSize = Math.max(this.size, this.contentSize);\r\n        this.size = size;\r\n        this.layoutContext = layoutContext;\r\n        if (!this.proportions) {\r\n            var indexes = range(this.viewItems.length);\r\n            var lowPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 1 /* Low */; });\r\n            var highPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 2 /* High */; });\r\n            this.resize(this.viewItems.length - 1, size - previousSize, undefined, lowPriorityIndexes, highPriorityIndexes);\r\n        }\r\n        else {\r\n            for (var i = 0; i < this.viewItems.length; i++) {\r\n                var item = this.viewItems[i];\r\n                item.size = clamp(Math.round(this.proportions[i] * size), item.minimumSize, item.maximumSize);\r\n            }\r\n        }\r\n        this.distributeEmptySpace();\r\n        this.layoutViews();\r\n    };\r\n    SplitView.prototype.saveProportions = function () {\r\n        var _this = this;\r\n        if (this.proportionalLayout && this.contentSize > 0) {\r\n            this.proportions = this.viewItems.map(function (i) { return i.size / _this.contentSize; });\r\n        }\r\n    };\r\n    SplitView.prototype.onSashStart = function (_a) {\r\n        var _this = this;\r\n        var sash = _a.sash, start = _a.start, alt = _a.alt;\r\n        for (var _i = 0, _b = this.viewItems; _i < _b.length; _i++) {\r\n            var item = _b[_i];\r\n            item.enabled = false;\r\n        }\r\n        var index = firstIndex(this.sashItems, function (item) { return item.sash === sash; });\r\n        // This way, we can press Alt while we resize a sash, macOS style!\r\n        var disposable = combinedDisposable(domEvent(document.body, 'keydown')(function (e) { return resetSashDragState(_this.sashDragState.current, e.altKey); }), domEvent(document.body, 'keyup')(function () { return resetSashDragState(_this.sashDragState.current, false); }));\r\n        var resetSashDragState = function (start, alt) {\r\n            var sizes = _this.viewItems.map(function (i) { return i.size; });\r\n            var minDelta = Number.NEGATIVE_INFINITY;\r\n            var maxDelta = Number.POSITIVE_INFINITY;\r\n            if (_this.inverseAltBehavior) {\r\n                alt = !alt;\r\n            }\r\n            if (alt) {\r\n                // When we're using the last sash with Alt, we're resizing\r\n                // the view to the left/up, instead of right/down as usual\r\n                // Thus, we must do the inverse of the usual\r\n                var isLastSash = index === _this.sashItems.length - 1;\r\n                if (isLastSash) {\r\n                    var viewItem = _this.viewItems[index];\r\n                    minDelta = (viewItem.minimumSize - viewItem.size) / 2;\r\n                    maxDelta = (viewItem.maximumSize - viewItem.size) / 2;\r\n                }\r\n                else {\r\n                    var viewItem = _this.viewItems[index + 1];\r\n                    minDelta = (viewItem.size - viewItem.maximumSize) / 2;\r\n                    maxDelta = (viewItem.size - viewItem.minimumSize) / 2;\r\n                }\r\n            }\r\n            var snapBefore;\r\n            var snapAfter;\r\n            if (!alt) {\r\n                var upIndexes = range(index, -1);\r\n                var downIndexes = range(index + 1, _this.viewItems.length);\r\n                var minDeltaUp = upIndexes.reduce(function (r, i) { return r + (_this.viewItems[i].minimumSize - sizes[i]); }, 0);\r\n                var maxDeltaUp = upIndexes.reduce(function (r, i) { return r + (_this.viewItems[i].viewMaximumSize - sizes[i]); }, 0);\r\n                var maxDeltaDown = downIndexes.length === 0 ? Number.POSITIVE_INFINITY : downIndexes.reduce(function (r, i) { return r + (sizes[i] - _this.viewItems[i].minimumSize); }, 0);\r\n                var minDeltaDown = downIndexes.length === 0 ? Number.NEGATIVE_INFINITY : downIndexes.reduce(function (r, i) { return r + (sizes[i] - _this.viewItems[i].viewMaximumSize); }, 0);\r\n                var minDelta_1 = Math.max(minDeltaUp, minDeltaDown);\r\n                var maxDelta_1 = Math.min(maxDeltaDown, maxDeltaUp);\r\n                var snapBeforeIndex = _this.findFirstSnapIndex(upIndexes);\r\n                var snapAfterIndex = _this.findFirstSnapIndex(downIndexes);\r\n                if (typeof snapBeforeIndex === 'number') {\r\n                    var viewItem = _this.viewItems[snapBeforeIndex];\r\n                    var halfSize = Math.floor(viewItem.viewMinimumSize / 2);\r\n                    snapBefore = {\r\n                        index: snapBeforeIndex,\r\n                        limitDelta: viewItem.visible ? minDelta_1 - halfSize : minDelta_1 + halfSize,\r\n                        size: viewItem.size\r\n                    };\r\n                }\r\n                if (typeof snapAfterIndex === 'number') {\r\n                    var viewItem = _this.viewItems[snapAfterIndex];\r\n                    var halfSize = Math.floor(viewItem.viewMinimumSize / 2);\r\n                    snapAfter = {\r\n                        index: snapAfterIndex,\r\n                        limitDelta: viewItem.visible ? maxDelta_1 + halfSize : maxDelta_1 - halfSize,\r\n                        size: viewItem.size\r\n                    };\r\n                }\r\n            }\r\n            _this.sashDragState = { start: start, current: start, index: index, sizes: sizes, minDelta: minDelta, maxDelta: maxDelta, alt: alt, snapBefore: snapBefore, snapAfter: snapAfter, disposable: disposable };\r\n        };\r\n        resetSashDragState(start, alt);\r\n    };\r\n    SplitView.prototype.onSashChange = function (_a) {\r\n        var current = _a.current;\r\n        var _b = this.sashDragState, index = _b.index, start = _b.start, sizes = _b.sizes, alt = _b.alt, minDelta = _b.minDelta, maxDelta = _b.maxDelta, snapBefore = _b.snapBefore, snapAfter = _b.snapAfter;\r\n        this.sashDragState.current = current;\r\n        var delta = current - start;\r\n        var newDelta = this.resize(index, delta, sizes, undefined, undefined, minDelta, maxDelta, snapBefore, snapAfter);\r\n        if (alt) {\r\n            var isLastSash = index === this.sashItems.length - 1;\r\n            var newSizes = this.viewItems.map(function (i) { return i.size; });\r\n            var viewItemIndex = isLastSash ? index : index + 1;\r\n            var viewItem = this.viewItems[viewItemIndex];\r\n            var newMinDelta = viewItem.size - viewItem.maximumSize;\r\n            var newMaxDelta = viewItem.size - viewItem.minimumSize;\r\n            var resizeIndex = isLastSash ? index - 1 : index + 1;\r\n            this.resize(resizeIndex, -newDelta, newSizes, undefined, undefined, newMinDelta, newMaxDelta);\r\n        }\r\n        this.distributeEmptySpace();\r\n        this.layoutViews();\r\n    };\r\n    SplitView.prototype.onSashEnd = function (index) {\r\n        this._onDidSashChange.fire(index);\r\n        this.sashDragState.disposable.dispose();\r\n        this.saveProportions();\r\n        for (var _i = 0, _a = this.viewItems; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            item.enabled = true;\r\n        }\r\n    };\r\n    SplitView.prototype.onViewChange = function (item, size) {\r\n        var index = this.viewItems.indexOf(item);\r\n        if (index < 0 || index >= this.viewItems.length) {\r\n            return;\r\n        }\r\n        size = typeof size === 'number' ? size : item.size;\r\n        size = clamp(size, item.minimumSize, item.maximumSize);\r\n        if (this.inverseAltBehavior && index > 0) {\r\n            // In this case, we want the view to grow or shrink both sides equally\r\n            // so we just resize the \"left\" side by half and let `resize` do the clamping magic\r\n            this.resize(index - 1, Math.floor((item.size - size) / 2));\r\n            this.distributeEmptySpace();\r\n            this.layoutViews();\r\n        }\r\n        else {\r\n            item.size = size;\r\n            this.relayout([index], undefined);\r\n        }\r\n    };\r\n    SplitView.prototype.resizeView = function (index, size) {\r\n        var _this = this;\r\n        if (this.state !== State.Idle) {\r\n            throw new Error('Cant modify splitview');\r\n        }\r\n        this.state = State.Busy;\r\n        if (index < 0 || index >= this.viewItems.length) {\r\n            return;\r\n        }\r\n        var indexes = range(this.viewItems.length).filter(function (i) { return i !== index; });\r\n        var lowPriorityIndexes = __spreadArrays(indexes.filter(function (i) { return _this.viewItems[i].priority === 1 /* Low */; }), [index]);\r\n        var highPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 2 /* High */; });\r\n        var item = this.viewItems[index];\r\n        size = Math.round(size);\r\n        size = clamp(size, item.minimumSize, Math.min(item.maximumSize, this.size));\r\n        item.size = size;\r\n        this.relayout(lowPriorityIndexes, highPriorityIndexes);\r\n        this.state = State.Idle;\r\n    };\r\n    SplitView.prototype.distributeViewSizes = function () {\r\n        var _this = this;\r\n        var flexibleViewItems = [];\r\n        var flexibleSize = 0;\r\n        for (var _i = 0, _a = this.viewItems; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            if (item.maximumSize - item.minimumSize > 0) {\r\n                flexibleViewItems.push(item);\r\n                flexibleSize += item.size;\r\n            }\r\n        }\r\n        var size = Math.floor(flexibleSize / flexibleViewItems.length);\r\n        for (var _b = 0, flexibleViewItems_1 = flexibleViewItems; _b < flexibleViewItems_1.length; _b++) {\r\n            var item = flexibleViewItems_1[_b];\r\n            item.size = clamp(size, item.minimumSize, item.maximumSize);\r\n        }\r\n        var indexes = range(this.viewItems.length);\r\n        var lowPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 1 /* Low */; });\r\n        var highPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 2 /* High */; });\r\n        this.relayout(lowPriorityIndexes, highPriorityIndexes);\r\n    };\r\n    SplitView.prototype.getViewSize = function (index) {\r\n        if (index < 0 || index >= this.viewItems.length) {\r\n            return -1;\r\n        }\r\n        return this.viewItems[index].size;\r\n    };\r\n    SplitView.prototype.doAddView = function (view, size, index, skipLayout) {\r\n        var _this = this;\r\n        if (index === void 0) { index = this.viewItems.length; }\r\n        if (this.state !== State.Idle) {\r\n            throw new Error('Cant modify splitview');\r\n        }\r\n        this.state = State.Busy;\r\n        // Add view\r\n        var container = dom.$('.split-view-view');\r\n        if (index === this.viewItems.length) {\r\n            this.viewContainer.appendChild(container);\r\n        }\r\n        else {\r\n            this.viewContainer.insertBefore(container, this.viewContainer.children.item(index));\r\n        }\r\n        var onChangeDisposable = view.onDidChange(function (size) { return _this.onViewChange(item, size); });\r\n        var containerDisposable = toDisposable(function () { return _this.viewContainer.removeChild(container); });\r\n        var disposable = combinedDisposable(onChangeDisposable, containerDisposable);\r\n        var viewSize;\r\n        if (typeof size === 'number') {\r\n            viewSize = size;\r\n        }\r\n        else if (size.type === 'split') {\r\n            viewSize = this.getViewSize(size.index) / 2;\r\n        }\r\n        else if (size.type === 'invisible') {\r\n            viewSize = { cachedVisibleSize: size.cachedVisibleSize };\r\n        }\r\n        else {\r\n            viewSize = view.minimumSize;\r\n        }\r\n        var item = this.orientation === 0 /* VERTICAL */\r\n            ? new VerticalViewItem(container, view, viewSize, disposable)\r\n            : new HorizontalViewItem(container, view, viewSize, disposable);\r\n        this.viewItems.splice(index, 0, item);\r\n        // Add sash\r\n        if (this.viewItems.length > 1) {\r\n            var orientation_1 = this.orientation === 0 /* VERTICAL */ ? 1 /* HORIZONTAL */ : 0 /* VERTICAL */;\r\n            var layoutProvider = this.orientation === 0 /* VERTICAL */ ? { getHorizontalSashTop: function (sash) { return _this.getSashPosition(sash); } } : { getVerticalSashLeft: function (sash) { return _this.getSashPosition(sash); } };\r\n            var sash_1 = new Sash(this.sashContainer, layoutProvider, {\r\n                orientation: orientation_1,\r\n                orthogonalStartSash: this.orthogonalStartSash,\r\n                orthogonalEndSash: this.orthogonalEndSash\r\n            });\r\n            var sashEventMapper = this.orientation === 0 /* VERTICAL */\r\n                ? function (e) { return ({ sash: sash_1, start: e.startY, current: e.currentY, alt: e.altKey }); }\r\n                : function (e) { return ({ sash: sash_1, start: e.startX, current: e.currentX, alt: e.altKey }); };\r\n            var onStart = Event.map(sash_1.onDidStart, sashEventMapper);\r\n            var onStartDisposable = onStart(this.onSashStart, this);\r\n            var onChange = Event.map(sash_1.onDidChange, sashEventMapper);\r\n            var onChangeDisposable_1 = onChange(this.onSashChange, this);\r\n            var onEnd = Event.map(sash_1.onDidEnd, function () { return firstIndex(_this.sashItems, function (item) { return item.sash === sash_1; }); });\r\n            var onEndDisposable = onEnd(this.onSashEnd, this);\r\n            var onDidResetDisposable = sash_1.onDidReset(function () {\r\n                var index = firstIndex(_this.sashItems, function (item) { return item.sash === sash_1; });\r\n                var upIndexes = range(index, -1);\r\n                var downIndexes = range(index + 1, _this.viewItems.length);\r\n                var snapBeforeIndex = _this.findFirstSnapIndex(upIndexes);\r\n                var snapAfterIndex = _this.findFirstSnapIndex(downIndexes);\r\n                if (typeof snapBeforeIndex === 'number' && !_this.viewItems[snapBeforeIndex].visible) {\r\n                    return;\r\n                }\r\n                if (typeof snapAfterIndex === 'number' && !_this.viewItems[snapAfterIndex].visible) {\r\n                    return;\r\n                }\r\n                _this._onDidSashReset.fire(index);\r\n            });\r\n            var disposable_1 = combinedDisposable(onStartDisposable, onChangeDisposable_1, onEndDisposable, onDidResetDisposable, sash_1);\r\n            var sashItem = { sash: sash_1, disposable: disposable_1 };\r\n            this.sashItems.splice(index - 1, 0, sashItem);\r\n        }\r\n        container.appendChild(view.element);\r\n        var highPriorityIndexes;\r\n        if (typeof size !== 'number' && size.type === 'split') {\r\n            highPriorityIndexes = [size.index];\r\n        }\r\n        if (!skipLayout) {\r\n            this.relayout([index], highPriorityIndexes);\r\n        }\r\n        this.state = State.Idle;\r\n        if (!skipLayout && typeof size !== 'number' && size.type === 'distribute') {\r\n            this.distributeViewSizes();\r\n        }\r\n    };\r\n    SplitView.prototype.relayout = function (lowPriorityIndexes, highPriorityIndexes) {\r\n        var contentSize = this.viewItems.reduce(function (r, i) { return r + i.size; }, 0);\r\n        this.resize(this.viewItems.length - 1, this.size - contentSize, undefined, lowPriorityIndexes, highPriorityIndexes);\r\n        this.distributeEmptySpace();\r\n        this.layoutViews();\r\n        this.saveProportions();\r\n    };\r\n    SplitView.prototype.resize = function (index, delta, sizes, lowPriorityIndexes, highPriorityIndexes, overloadMinDelta, overloadMaxDelta, snapBefore, snapAfter) {\r\n        var _this = this;\r\n        if (sizes === void 0) { sizes = this.viewItems.map(function (i) { return i.size; }); }\r\n        if (overloadMinDelta === void 0) { overloadMinDelta = Number.NEGATIVE_INFINITY; }\r\n        if (overloadMaxDelta === void 0) { overloadMaxDelta = Number.POSITIVE_INFINITY; }\r\n        if (index < 0 || index >= this.viewItems.length) {\r\n            return 0;\r\n        }\r\n        var upIndexes = range(index, -1);\r\n        var downIndexes = range(index + 1, this.viewItems.length);\r\n        if (highPriorityIndexes) {\r\n            for (var _i = 0, highPriorityIndexes_1 = highPriorityIndexes; _i < highPriorityIndexes_1.length; _i++) {\r\n                var index_1 = highPriorityIndexes_1[_i];\r\n                pushToStart(upIndexes, index_1);\r\n                pushToStart(downIndexes, index_1);\r\n            }\r\n        }\r\n        if (lowPriorityIndexes) {\r\n            for (var _a = 0, lowPriorityIndexes_1 = lowPriorityIndexes; _a < lowPriorityIndexes_1.length; _a++) {\r\n                var index_2 = lowPriorityIndexes_1[_a];\r\n                pushToEnd(upIndexes, index_2);\r\n                pushToEnd(downIndexes, index_2);\r\n            }\r\n        }\r\n        var upItems = upIndexes.map(function (i) { return _this.viewItems[i]; });\r\n        var upSizes = upIndexes.map(function (i) { return sizes[i]; });\r\n        var downItems = downIndexes.map(function (i) { return _this.viewItems[i]; });\r\n        var downSizes = downIndexes.map(function (i) { return sizes[i]; });\r\n        var minDeltaUp = upIndexes.reduce(function (r, i) { return r + (_this.viewItems[i].minimumSize - sizes[i]); }, 0);\r\n        var maxDeltaUp = upIndexes.reduce(function (r, i) { return r + (_this.viewItems[i].maximumSize - sizes[i]); }, 0);\r\n        var maxDeltaDown = downIndexes.length === 0 ? Number.POSITIVE_INFINITY : downIndexes.reduce(function (r, i) { return r + (sizes[i] - _this.viewItems[i].minimumSize); }, 0);\r\n        var minDeltaDown = downIndexes.length === 0 ? Number.NEGATIVE_INFINITY : downIndexes.reduce(function (r, i) { return r + (sizes[i] - _this.viewItems[i].maximumSize); }, 0);\r\n        var minDelta = Math.max(minDeltaUp, minDeltaDown, overloadMinDelta);\r\n        var maxDelta = Math.min(maxDeltaDown, maxDeltaUp, overloadMaxDelta);\r\n        var snapped = false;\r\n        if (snapBefore) {\r\n            var snapView = this.viewItems[snapBefore.index];\r\n            var visible = delta >= snapBefore.limitDelta;\r\n            snapped = visible !== snapView.visible;\r\n            snapView.setVisible(visible, snapBefore.size);\r\n        }\r\n        if (!snapped && snapAfter) {\r\n            var snapView = this.viewItems[snapAfter.index];\r\n            var visible = delta < snapAfter.limitDelta;\r\n            snapped = visible !== snapView.visible;\r\n            snapView.setVisible(visible, snapAfter.size);\r\n        }\r\n        if (snapped) {\r\n            return this.resize(index, delta, sizes, lowPriorityIndexes, highPriorityIndexes, overloadMinDelta, overloadMaxDelta);\r\n        }\r\n        delta = clamp(delta, minDelta, maxDelta);\r\n        for (var i = 0, deltaUp = delta; i < upItems.length; i++) {\r\n            var item = upItems[i];\r\n            var size = clamp(upSizes[i] + deltaUp, item.minimumSize, item.maximumSize);\r\n            var viewDelta = size - upSizes[i];\r\n            deltaUp -= viewDelta;\r\n            item.size = size;\r\n        }\r\n        for (var i = 0, deltaDown = delta; i < downItems.length; i++) {\r\n            var item = downItems[i];\r\n            var size = clamp(downSizes[i] - deltaDown, item.minimumSize, item.maximumSize);\r\n            var viewDelta = size - downSizes[i];\r\n            deltaDown += viewDelta;\r\n            item.size = size;\r\n        }\r\n        return delta;\r\n    };\r\n    SplitView.prototype.distributeEmptySpace = function (lowPriorityIndex) {\r\n        var _this = this;\r\n        var contentSize = this.viewItems.reduce(function (r, i) { return r + i.size; }, 0);\r\n        var emptyDelta = this.size - contentSize;\r\n        var indexes = range(this.viewItems.length - 1, -1);\r\n        var lowPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 1 /* Low */; });\r\n        var highPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 2 /* High */; });\r\n        for (var _i = 0, highPriorityIndexes_2 = highPriorityIndexes; _i < highPriorityIndexes_2.length; _i++) {\r\n            var index = highPriorityIndexes_2[_i];\r\n            pushToStart(indexes, index);\r\n        }\r\n        for (var _a = 0, lowPriorityIndexes_2 = lowPriorityIndexes; _a < lowPriorityIndexes_2.length; _a++) {\r\n            var index = lowPriorityIndexes_2[_a];\r\n            pushToEnd(indexes, index);\r\n        }\r\n        if (typeof lowPriorityIndex === 'number') {\r\n            pushToEnd(indexes, lowPriorityIndex);\r\n        }\r\n        for (var i = 0; emptyDelta !== 0 && i < indexes.length; i++) {\r\n            var item = this.viewItems[indexes[i]];\r\n            var size = clamp(item.size + emptyDelta, item.minimumSize, item.maximumSize);\r\n            var viewDelta = size - item.size;\r\n            emptyDelta -= viewDelta;\r\n            item.size = size;\r\n        }\r\n    };\r\n    SplitView.prototype.layoutViews = function () {\r\n        // Save new content size\r\n        this.contentSize = this.viewItems.reduce(function (r, i) { return r + i.size; }, 0);\r\n        // Layout views\r\n        var offset = 0;\r\n        for (var _i = 0, _a = this.viewItems; _i < _a.length; _i++) {\r\n            var viewItem = _a[_i];\r\n            viewItem.layout(offset, this.layoutContext);\r\n            offset += viewItem.size;\r\n        }\r\n        // Layout sashes\r\n        this.sashItems.forEach(function (item) { return item.sash.layout(); });\r\n        this.updateSashEnablement();\r\n    };\r\n    SplitView.prototype.updateSashEnablement = function () {\r\n        var previous = false;\r\n        var collapsesDown = this.viewItems.map(function (i) { return previous = (i.size - i.minimumSize > 0) || previous; });\r\n        previous = false;\r\n        var expandsDown = this.viewItems.map(function (i) { return previous = (i.maximumSize - i.size > 0) || previous; });\r\n        var reverseViews = __spreadArrays(this.viewItems).reverse();\r\n        previous = false;\r\n        var collapsesUp = reverseViews.map(function (i) { return previous = (i.size - i.minimumSize > 0) || previous; }).reverse();\r\n        previous = false;\r\n        var expandsUp = reverseViews.map(function (i) { return previous = (i.maximumSize - i.size > 0) || previous; }).reverse();\r\n        var position = 0;\r\n        for (var index = 0; index < this.sashItems.length; index++) {\r\n            var sash = this.sashItems[index].sash;\r\n            var viewItem = this.viewItems[index];\r\n            position += viewItem.size;\r\n            var min = !(collapsesDown[index] && expandsUp[index + 1]);\r\n            var max = !(expandsDown[index] && collapsesUp[index + 1]);\r\n            if (min && max) {\r\n                var upIndexes = range(index, -1);\r\n                var downIndexes = range(index + 1, this.viewItems.length);\r\n                var snapBeforeIndex = this.findFirstSnapIndex(upIndexes);\r\n                var snapAfterIndex = this.findFirstSnapIndex(downIndexes);\r\n                var snappedBefore = typeof snapBeforeIndex === 'number' && !this.viewItems[snapBeforeIndex].visible;\r\n                var snappedAfter = typeof snapAfterIndex === 'number' && !this.viewItems[snapAfterIndex].visible;\r\n                if (snappedBefore && collapsesUp[index] && (position > 0 || this.startSnappingEnabled)) {\r\n                    sash.state = 1 /* Minimum */;\r\n                }\r\n                else if (snappedAfter && collapsesDown[index] && (position < this.contentSize || this.endSnappingEnabled)) {\r\n                    sash.state = 2 /* Maximum */;\r\n                }\r\n                else {\r\n                    sash.state = 0 /* Disabled */;\r\n                }\r\n            }\r\n            else if (min && !max) {\r\n                sash.state = 1 /* Minimum */;\r\n            }\r\n            else if (!min && max) {\r\n                sash.state = 2 /* Maximum */;\r\n            }\r\n            else {\r\n                sash.state = 3 /* Enabled */;\r\n            }\r\n        }\r\n    };\r\n    SplitView.prototype.getSashPosition = function (sash) {\r\n        var position = 0;\r\n        for (var i = 0; i < this.sashItems.length; i++) {\r\n            position += this.viewItems[i].size;\r\n            if (this.sashItems[i].sash === sash) {\r\n                return Math.min(position, this.contentSize - 2);\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    SplitView.prototype.findFirstSnapIndex = function (indexes) {\r\n        // visible views first\r\n        for (var _i = 0, indexes_1 = indexes; _i < indexes_1.length; _i++) {\r\n            var index = indexes_1[_i];\r\n            var viewItem = this.viewItems[index];\r\n            if (!viewItem.visible) {\r\n                continue;\r\n            }\r\n            if (viewItem.snap) {\r\n                return index;\r\n            }\r\n        }\r\n        // then, hidden views\r\n        for (var _a = 0, indexes_2 = indexes; _a < indexes_2.length; _a++) {\r\n            var index = indexes_2[_a];\r\n            var viewItem = this.viewItems[index];\r\n            if (viewItem.visible && viewItem.maximumSize - viewItem.minimumSize > 0) {\r\n                return undefined;\r\n            }\r\n            if (!viewItem.visible && viewItem.snap) {\r\n                return index;\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    SplitView.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this.viewItems.forEach(function (i) { return i.dispose(); });\r\n        this.viewItems = [];\r\n        this.sashItems.forEach(function (i) { return i.disposable.dispose(); });\r\n        this.sashItems = [];\r\n    };\r\n    return SplitView;\r\n}(Disposable));\r\nexport { SplitView };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { ReferencesModel, FileReferences, OneReference } from '../referencesModel.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\r\nimport { CountBadge } from '../../../../base/browser/ui/countBadge/countBadge.js';\r\nimport { ILabelService } from '../../../../platform/label/common/label.js';\r\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\r\nimport { attachBadgeStyler } from '../../../../platform/theme/common/styler.js';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { localize } from '../../../../nls.js';\r\nimport { getBaseLabel } from '../../../../base/common/labels.js';\r\nimport { dirname, basename } from '../../../../base/common/resources.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nimport { FuzzyScore, createMatches } from '../../../../base/common/filters.js';\r\nimport { HighlightedLabel } from '../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\r\nvar DataSource = /** @class */ (function () {\r\n    function DataSource(_resolverService) {\r\n        this._resolverService = _resolverService;\r\n    }\r\n    DataSource.prototype.hasChildren = function (element) {\r\n        if (element instanceof ReferencesModel) {\r\n            return true;\r\n        }\r\n        if (element instanceof FileReferences && !element.failure) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    DataSource.prototype.getChildren = function (element) {\r\n        if (element instanceof ReferencesModel) {\r\n            return element.groups;\r\n        }\r\n        if (element instanceof FileReferences) {\r\n            return element.resolve(this._resolverService).then(function (val) {\r\n                // if (element.failure) {\r\n                // \t// refresh the element on failure so that\r\n                // \t// we can update its rendering\r\n                // \treturn tree.refresh(element).then(() => val.children);\r\n                // }\r\n                return val.children;\r\n            });\r\n        }\r\n        throw new Error('bad tree');\r\n    };\r\n    DataSource = __decorate([\r\n        __param(0, ITextModelService)\r\n    ], DataSource);\r\n    return DataSource;\r\n}());\r\nexport { DataSource };\r\n//#endregion\r\nvar Delegate = /** @class */ (function () {\r\n    function Delegate() {\r\n    }\r\n    Delegate.prototype.getHeight = function () {\r\n        return 23;\r\n    };\r\n    Delegate.prototype.getTemplateId = function (element) {\r\n        if (element instanceof FileReferences) {\r\n            return FileReferencesRenderer.id;\r\n        }\r\n        else {\r\n            return OneReferenceRenderer.id;\r\n        }\r\n    };\r\n    return Delegate;\r\n}());\r\nexport { Delegate };\r\nvar StringRepresentationProvider = /** @class */ (function () {\r\n    function StringRepresentationProvider(_keybindingService) {\r\n        this._keybindingService = _keybindingService;\r\n    }\r\n    StringRepresentationProvider.prototype.getKeyboardNavigationLabel = function (element) {\r\n        if (element instanceof OneReference) {\r\n            var preview = element.parent.preview;\r\n            var parts = preview && preview.preview(element.range);\r\n            if (parts) {\r\n                return parts.value;\r\n            }\r\n        }\r\n        // FileReferences or unresolved OneReference\r\n        return basename(element.uri);\r\n    };\r\n    StringRepresentationProvider = __decorate([\r\n        __param(0, IKeybindingService)\r\n    ], StringRepresentationProvider);\r\n    return StringRepresentationProvider;\r\n}());\r\nexport { StringRepresentationProvider };\r\nvar IdentityProvider = /** @class */ (function () {\r\n    function IdentityProvider() {\r\n    }\r\n    IdentityProvider.prototype.getId = function (element) {\r\n        return element instanceof OneReference ? element.id : element.uri;\r\n    };\r\n    return IdentityProvider;\r\n}());\r\nexport { IdentityProvider };\r\n//#region render: File\r\nvar FileReferencesTemplate = /** @class */ (function (_super) {\r\n    __extends(FileReferencesTemplate, _super);\r\n    function FileReferencesTemplate(container, _uriLabel, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._uriLabel = _uriLabel;\r\n        var parent = document.createElement('div');\r\n        dom.addClass(parent, 'reference-file');\r\n        _this.file = _this._register(new IconLabel(parent, { supportHighlights: true }));\r\n        _this.badge = new CountBadge(dom.append(parent, dom.$('.count')));\r\n        _this._register(attachBadgeStyler(_this.badge, themeService));\r\n        container.appendChild(parent);\r\n        return _this;\r\n    }\r\n    FileReferencesTemplate.prototype.set = function (element, matches) {\r\n        var parent = dirname(element.uri);\r\n        this.file.setLabel(getBaseLabel(element.uri), this._uriLabel.getUriLabel(parent, { relative: true }), { title: this._uriLabel.getUriLabel(element.uri), matches: matches });\r\n        var len = element.children.length;\r\n        this.badge.setCount(len);\r\n        if (element.failure) {\r\n            this.badge.setTitleFormat(localize('referencesFailre', \"Failed to resolve file.\"));\r\n        }\r\n        else if (len > 1) {\r\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\r\n        }\r\n        else {\r\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\r\n        }\r\n    };\r\n    FileReferencesTemplate = __decorate([\r\n        __param(1, ILabelService),\r\n        __param(2, IThemeService)\r\n    ], FileReferencesTemplate);\r\n    return FileReferencesTemplate;\r\n}(Disposable));\r\nvar FileReferencesRenderer = /** @class */ (function () {\r\n    function FileReferencesRenderer(_instantiationService) {\r\n        this._instantiationService = _instantiationService;\r\n        this.templateId = FileReferencesRenderer.id;\r\n    }\r\n    FileReferencesRenderer.prototype.renderTemplate = function (container) {\r\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\r\n    };\r\n    FileReferencesRenderer.prototype.renderElement = function (node, index, template) {\r\n        template.set(node.element, createMatches(node.filterData));\r\n    };\r\n    FileReferencesRenderer.prototype.disposeTemplate = function (templateData) {\r\n        templateData.dispose();\r\n    };\r\n    FileReferencesRenderer.id = 'FileReferencesRenderer';\r\n    FileReferencesRenderer = __decorate([\r\n        __param(0, IInstantiationService)\r\n    ], FileReferencesRenderer);\r\n    return FileReferencesRenderer;\r\n}());\r\nexport { FileReferencesRenderer };\r\n//#endregion\r\n//#region render: Reference\r\nvar OneReferenceTemplate = /** @class */ (function () {\r\n    function OneReferenceTemplate(container) {\r\n        this.label = new HighlightedLabel(container, false);\r\n    }\r\n    OneReferenceTemplate.prototype.set = function (element, score) {\r\n        var filePreview = element.parent.preview;\r\n        var preview = filePreview && filePreview.preview(element.range);\r\n        if (!preview) {\r\n            // this means we FAILED to resolve the document...\r\n            this.label.set(basename(element.uri) + \":\" + (element.range.startLineNumber + 1) + \":\" + (element.range.startColumn + 1));\r\n        }\r\n        else {\r\n            // render search match as highlight unless\r\n            // we have score, then render the score\r\n            var value = preview.value, highlight = preview.highlight;\r\n            if (score && !FuzzyScore.isDefault(score)) {\r\n                dom.toggleClass(this.label.element, 'referenceMatch', false);\r\n                this.label.set(value, createMatches(score));\r\n            }\r\n            else {\r\n                dom.toggleClass(this.label.element, 'referenceMatch', true);\r\n                this.label.set(value, [highlight]);\r\n            }\r\n        }\r\n    };\r\n    return OneReferenceTemplate;\r\n}());\r\nvar OneReferenceRenderer = /** @class */ (function () {\r\n    function OneReferenceRenderer() {\r\n        this.templateId = OneReferenceRenderer.id;\r\n    }\r\n    OneReferenceRenderer.prototype.renderTemplate = function (container) {\r\n        return new OneReferenceTemplate(container);\r\n    };\r\n    OneReferenceRenderer.prototype.renderElement = function (node, index, templateData) {\r\n        templateData.set(node.element, node.filterData);\r\n    };\r\n    OneReferenceRenderer.prototype.disposeTemplate = function () {\r\n    };\r\n    OneReferenceRenderer.id = 'OneReferenceRenderer';\r\n    return OneReferenceRenderer;\r\n}());\r\nexport { OneReferenceRenderer };\r\n//#endregion\r\nvar AriaProvider = /** @class */ (function () {\r\n    function AriaProvider() {\r\n    }\r\n    AriaProvider.prototype.getAriaLabel = function (element) {\r\n        return element.ariaMessage;\r\n    };\r\n    return AriaProvider;\r\n}());\r\nexport { AriaProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport './referencesWidget.css';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { Color } from '../../../../base/common/color.js';\r\nimport { Emitter, Event } from '../../../../base/common/event.js';\r\nimport { dispose, DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { Schemas } from '../../../../base/common/network.js';\r\nimport { basenameOrAuthority, dirname, isEqual } from '../../../../base/common/resources.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { ModelDecorationOptions, TextModel } from '../../../common/model/textModel.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { AriaProvider, DataSource, Delegate, FileReferencesRenderer, OneReferenceRenderer, StringRepresentationProvider, IdentityProvider } from './referencesTree.js';\r\nimport * as nls from '../../../../nls.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { ILabelService } from '../../../../platform/label/common/label.js';\r\nimport { WorkbenchAsyncDataTree } from '../../../../platform/list/browser/listService.js';\r\nimport { activeContrastBorder } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport * as peekView from '../../peekView/peekView.js';\r\nimport { FileReferences, OneReference } from '../referencesModel.js';\r\nimport { SplitView, Sizing } from '../../../../base/browser/ui/splitview/splitview.js';\r\nvar DecorationsManager = /** @class */ (function () {\r\n    function DecorationsManager(_editor, _model) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._model = _model;\r\n        this._decorations = new Map();\r\n        this._decorationIgnoreSet = new Set();\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModelChange = new DisposableStore();\r\n        this._callOnDispose.add(this._editor.onDidChangeModel(function () { return _this._onModelChanged(); }));\r\n        this._onModelChanged();\r\n    }\r\n    DecorationsManager.prototype.dispose = function () {\r\n        this._callOnModelChange.dispose();\r\n        this._callOnDispose.dispose();\r\n        this.removeDecorations();\r\n    };\r\n    DecorationsManager.prototype._onModelChanged = function () {\r\n        this._callOnModelChange.clear();\r\n        var model = this._editor.getModel();\r\n        if (model) {\r\n            for (var _i = 0, _a = this._model.groups; _i < _a.length; _i++) {\r\n                var ref = _a[_i];\r\n                if (isEqual(ref.uri, model.uri)) {\r\n                    this._addDecorations(ref);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DecorationsManager.prototype._addDecorations = function (reference) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(function (event) { return _this._onDecorationChanged(); }));\r\n        var newDecorations = [];\r\n        var newDecorationsActualIndex = [];\r\n        for (var i = 0, len = reference.children.length; i < len; i++) {\r\n            var oneReference = reference.children[i];\r\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\r\n                continue;\r\n            }\r\n            newDecorations.push({\r\n                range: oneReference.range,\r\n                options: DecorationsManager.DecorationOptions\r\n            });\r\n            newDecorationsActualIndex.push(i);\r\n        }\r\n        var decorations = this._editor.deltaDecorations([], newDecorations);\r\n        for (var i = 0; i < decorations.length; i++) {\r\n            this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\r\n        }\r\n    };\r\n    DecorationsManager.prototype._onDecorationChanged = function () {\r\n        var _this = this;\r\n        var toRemove = [];\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        this._decorations.forEach(function (reference, decorationId) {\r\n            var newRange = model.getDecorationRange(decorationId);\r\n            if (!newRange) {\r\n                return;\r\n            }\r\n            var ignore = false;\r\n            if (Range.equalsRange(newRange, reference.range)) {\r\n                return;\r\n            }\r\n            else if (Range.spansMultipleLines(newRange)) {\r\n                ignore = true;\r\n            }\r\n            else {\r\n                var lineLength = reference.range.endColumn - reference.range.startColumn;\r\n                var newLineLength = newRange.endColumn - newRange.startColumn;\r\n                if (lineLength !== newLineLength) {\r\n                    ignore = true;\r\n                }\r\n            }\r\n            if (ignore) {\r\n                _this._decorationIgnoreSet.add(reference.id);\r\n                toRemove.push(decorationId);\r\n            }\r\n            else {\r\n                reference.range = newRange;\r\n            }\r\n        });\r\n        for (var i = 0, len = toRemove.length; i < len; i++) {\r\n            this._decorations.delete(toRemove[i]);\r\n        }\r\n        this._editor.deltaDecorations(toRemove, []);\r\n    };\r\n    DecorationsManager.prototype.removeDecorations = function () {\r\n        var toRemove = [];\r\n        this._decorations.forEach(function (value, key) {\r\n            toRemove.push(key);\r\n        });\r\n        this._editor.deltaDecorations(toRemove, []);\r\n        this._decorations.clear();\r\n    };\r\n    DecorationsManager.DecorationOptions = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'reference-decoration'\r\n    });\r\n    return DecorationsManager;\r\n}());\r\nvar LayoutData = /** @class */ (function () {\r\n    function LayoutData() {\r\n        this.ratio = 0.7;\r\n        this.heightInLines = 18;\r\n    }\r\n    LayoutData.fromJSON = function (raw) {\r\n        var ratio;\r\n        var heightInLines;\r\n        try {\r\n            var data = JSON.parse(raw);\r\n            ratio = data.ratio;\r\n            heightInLines = data.heightInLines;\r\n        }\r\n        catch (_a) {\r\n            //\r\n        }\r\n        return {\r\n            ratio: ratio || 0.7,\r\n            heightInLines: heightInLines || 18\r\n        };\r\n    };\r\n    return LayoutData;\r\n}());\r\nexport { LayoutData };\r\n/**\r\n * ZoneWidget that is shown inside the editor\r\n */\r\nvar ReferenceWidget = /** @class */ (function (_super) {\r\n    __extends(ReferenceWidget, _super);\r\n    function ReferenceWidget(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel) {\r\n        var _this = _super.call(this, editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true }) || this;\r\n        _this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\r\n        _this.layoutData = layoutData;\r\n        _this._textModelResolverService = _textModelResolverService;\r\n        _this._instantiationService = _instantiationService;\r\n        _this._peekViewService = _peekViewService;\r\n        _this._uriLabel = _uriLabel;\r\n        _this._disposeOnNewModel = new DisposableStore();\r\n        _this._callOnDispose = new DisposableStore();\r\n        _this._onDidSelectReference = new Emitter();\r\n        _this.onDidSelectReference = _this._onDidSelectReference.event;\r\n        _this._dim = { height: 0, width: 0 };\r\n        _this._applyTheme(themeService.getTheme());\r\n        _this._callOnDispose.add(themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        _this._peekViewService.addExclusiveWidget(editor, _this);\r\n        _this.create();\r\n        return _this;\r\n    }\r\n    ReferenceWidget.prototype.dispose = function () {\r\n        this.setModel(undefined);\r\n        this._callOnDispose.dispose();\r\n        this._disposeOnNewModel.dispose();\r\n        dispose(this._preview);\r\n        dispose(this._previewNotAvailableMessage);\r\n        dispose(this._tree);\r\n        dispose(this._previewModelReference);\r\n        this._splitView.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ReferenceWidget.prototype._applyTheme = function (theme) {\r\n        var borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\r\n        this.style({\r\n            arrowColor: borderColor,\r\n            frameColor: borderColor,\r\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\r\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\r\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\r\n        });\r\n    };\r\n    ReferenceWidget.prototype.show = function (where) {\r\n        this.editor.revealRangeInCenterIfOutsideViewport(where, 0 /* Smooth */);\r\n        _super.prototype.show.call(this, where, this.layoutData.heightInLines || 18);\r\n    };\r\n    ReferenceWidget.prototype.focus = function () {\r\n        this._tree.domFocus();\r\n    };\r\n    ReferenceWidget.prototype._onTitleClick = function (e) {\r\n        if (this._preview && this._preview.getModel()) {\r\n            this._onDidSelectReference.fire({\r\n                element: this._getFocusedReference(),\r\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\r\n                source: 'title'\r\n            });\r\n        }\r\n    };\r\n    ReferenceWidget.prototype._fillBody = function (containerElement) {\r\n        var _this = this;\r\n        this.setCssClass('reference-zone-widget');\r\n        // message pane\r\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\r\n        dom.hide(this._messageContainer);\r\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* HORIZONTAL */ });\r\n        // editor\r\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\r\n        var options = {\r\n            scrollBeyondLastLine: false,\r\n            scrollbar: {\r\n                verticalScrollbarSize: 14,\r\n                horizontal: 'auto',\r\n                useShadows: true,\r\n                verticalHasArrows: false,\r\n                horizontalHasArrows: false,\r\n                alwaysConsumeMouseWheel: false\r\n            },\r\n            overviewRulerLanes: 2,\r\n            fixedOverflowWidgets: true,\r\n            minimap: {\r\n                enabled: false\r\n            }\r\n        };\r\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, this.editor);\r\n        dom.hide(this._previewContainer);\r\n        this._previewNotAvailableMessage = TextModel.createFromString(nls.localize('missingPreviewMessage', \"no preview available\"));\r\n        // tree\r\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\r\n        var treeOptions = {\r\n            ariaLabel: nls.localize('treeAriaLabel', \"References\"),\r\n            keyboardSupport: this._defaultTreeKeyboardSupport,\r\n            accessibilityProvider: new AriaProvider(),\r\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\r\n            identityProvider: new IdentityProvider(),\r\n            overrideStyles: {\r\n                listBackground: peekView.peekViewResultsBackground\r\n            }\r\n        };\r\n        this._tree = this._instantiationService.createInstance(WorkbenchAsyncDataTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\r\n            this._instantiationService.createInstance(FileReferencesRenderer),\r\n            this._instantiationService.createInstance(OneReferenceRenderer),\r\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\r\n        // split stuff\r\n        this._splitView.addView({\r\n            onDidChange: Event.None,\r\n            element: this._previewContainer,\r\n            minimumSize: 200,\r\n            maximumSize: Number.MAX_VALUE,\r\n            layout: function (width) {\r\n                _this._preview.layout({ height: _this._dim.height, width: width });\r\n            }\r\n        }, Sizing.Distribute);\r\n        this._splitView.addView({\r\n            onDidChange: Event.None,\r\n            element: this._treeContainer,\r\n            minimumSize: 100,\r\n            maximumSize: Number.MAX_VALUE,\r\n            layout: function (width) {\r\n                _this._treeContainer.style.height = _this._dim.height + \"px\";\r\n                _this._treeContainer.style.width = width + \"px\";\r\n                _this._tree.layout(_this._dim.height, width);\r\n            }\r\n        }, Sizing.Distribute);\r\n        this._disposables.add(this._splitView.onDidSashChange(function () {\r\n            if (_this._dim.width) {\r\n                _this.layoutData.ratio = _this._splitView.getViewSize(0) / _this._dim.width;\r\n            }\r\n        }, undefined));\r\n        // listen on selection and focus\r\n        var onEvent = function (element, kind) {\r\n            if (element instanceof OneReference) {\r\n                if (kind === 'show') {\r\n                    _this._revealReference(element, false);\r\n                }\r\n                _this._onDidSelectReference.fire({ element: element, kind: kind, source: 'tree' });\r\n            }\r\n        };\r\n        this._tree.onDidChangeFocus(function (e) {\r\n            onEvent(e.elements[0], 'show');\r\n        });\r\n        this._tree.onDidOpen(function (e) {\r\n            if (e.browserEvent instanceof MouseEvent && (e.browserEvent.ctrlKey || e.browserEvent.metaKey || e.browserEvent.altKey)) {\r\n                // modifier-click -> open to the side\r\n                onEvent(e.elements[0], 'side');\r\n            }\r\n            else if (e.browserEvent instanceof KeyboardEvent || (e.browserEvent instanceof MouseEvent && e.browserEvent.detail === 2) || e.browserEvent.tapCount === 2) {\r\n                // keybinding (list service command)\r\n                // OR double click\r\n                // OR double tap\r\n                // -> close widget and goto target\r\n                onEvent(e.elements[0], 'goto');\r\n            }\r\n            else {\r\n                // preview location\r\n                onEvent(e.elements[0], 'show');\r\n            }\r\n        });\r\n        dom.hide(this._treeContainer);\r\n    };\r\n    ReferenceWidget.prototype._onWidth = function (width) {\r\n        if (this._dim) {\r\n            this._doLayoutBody(this._dim.height, width);\r\n        }\r\n    };\r\n    ReferenceWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\r\n        _super.prototype._doLayoutBody.call(this, heightInPixel, widthInPixel);\r\n        this._dim = { height: heightInPixel, width: widthInPixel };\r\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\r\n        this._splitView.layout(widthInPixel);\r\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\r\n    };\r\n    ReferenceWidget.prototype.setSelection = function (selection) {\r\n        var _this = this;\r\n        return this._revealReference(selection, true).then(function () {\r\n            if (!_this._model) {\r\n                // disposed\r\n                return;\r\n            }\r\n            // show in tree\r\n            _this._tree.setSelection([selection]);\r\n            _this._tree.setFocus([selection]);\r\n        });\r\n    };\r\n    ReferenceWidget.prototype.setModel = function (newModel) {\r\n        // clean up\r\n        this._disposeOnNewModel.clear();\r\n        this._model = newModel;\r\n        if (this._model) {\r\n            return this._onNewModel();\r\n        }\r\n        return Promise.resolve();\r\n    };\r\n    ReferenceWidget.prototype._onNewModel = function () {\r\n        var _this = this;\r\n        if (!this._model) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        if (this._model.isEmpty) {\r\n            this.setTitle('');\r\n            this._messageContainer.innerHTML = nls.localize('noResults', \"No results\");\r\n            dom.show(this._messageContainer);\r\n            return Promise.resolve(undefined);\r\n        }\r\n        dom.hide(this._messageContainer);\r\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\r\n        this._disposeOnNewModel.add(this._decorationsManager);\r\n        // listen on model changes\r\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(function (reference) { return _this._tree.rerender(reference); }));\r\n        // listen on editor\r\n        this._disposeOnNewModel.add(this._preview.onMouseDown(function (e) {\r\n            var event = e.event, target = e.target;\r\n            if (event.detail !== 2) {\r\n                return;\r\n            }\r\n            var element = _this._getFocusedReference();\r\n            if (!element) {\r\n                return;\r\n            }\r\n            _this._onDidSelectReference.fire({\r\n                element: { uri: element.uri, range: target.range },\r\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\r\n                source: 'editor'\r\n            });\r\n        }));\r\n        // make sure things are rendered\r\n        dom.addClass(this.container, 'results-loaded');\r\n        dom.show(this._treeContainer);\r\n        dom.show(this._previewContainer);\r\n        this._splitView.layout(this._dim.width);\r\n        this.focus();\r\n        // pick input and a reference to begin with\r\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\r\n    };\r\n    ReferenceWidget.prototype._getFocusedReference = function () {\r\n        var element = this._tree.getFocus()[0];\r\n        if (element instanceof OneReference) {\r\n            return element;\r\n        }\r\n        else if (element instanceof FileReferences) {\r\n            if (element.children.length > 0) {\r\n                return element.children[0];\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    ReferenceWidget.prototype._revealReference = function (reference, revealParent) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var promise, ref, model, scrollType, sel;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        // check if there is anything to do...\r\n                        if (this._revealedReference === reference) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        this._revealedReference = reference;\r\n                        // Update widget header\r\n                        if (reference.uri.scheme !== Schemas.inMemory) {\r\n                            this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\r\n                        }\r\n                        else {\r\n                            this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\r\n                        }\r\n                        promise = this._textModelResolverService.createModelReference(reference.uri);\r\n                        if (!(this._tree.getInput() === reference.parent)) return [3 /*break*/, 1];\r\n                        this._tree.reveal(reference);\r\n                        return [3 /*break*/, 3];\r\n                    case 1:\r\n                        if (revealParent) {\r\n                            this._tree.reveal(reference.parent);\r\n                        }\r\n                        return [4 /*yield*/, this._tree.expand(reference.parent)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        this._tree.reveal(reference);\r\n                        _a.label = 3;\r\n                    case 3: return [4 /*yield*/, promise];\r\n                    case 4:\r\n                        ref = _a.sent();\r\n                        if (!this._model) {\r\n                            // disposed\r\n                            ref.dispose();\r\n                            return [2 /*return*/];\r\n                        }\r\n                        dispose(this._previewModelReference);\r\n                        model = ref.object;\r\n                        if (model) {\r\n                            scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* Smooth */ : 1 /* Immediate */;\r\n                            sel = Range.lift(reference.range).collapseToStart();\r\n                            this._previewModelReference = ref;\r\n                            this._preview.setModel(model.textEditorModel);\r\n                            this._preview.setSelection(sel);\r\n                            this._preview.revealRangeInCenter(sel, scrollType);\r\n                        }\r\n                        else {\r\n                            this._preview.setModel(this._previewNotAvailableMessage);\r\n                            ref.dispose();\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ReferenceWidget = __decorate([\r\n        __param(3, IThemeService),\r\n        __param(4, ITextModelService),\r\n        __param(5, IInstantiationService),\r\n        __param(6, peekView.IPeekViewService),\r\n        __param(7, ILabelService)\r\n    ], ReferenceWidget);\r\n    return ReferenceWidget;\r\n}(peekView.PeekViewWidget));\r\nexport { ReferenceWidget };\r\n// theming\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var findMatchHighlightColor = theme.getColor(peekView.peekViewResultsMatchHighlight);\r\n    if (findMatchHighlightColor) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { background-color: \" + findMatchHighlightColor + \"; }\");\r\n    }\r\n    var referenceHighlightColor = theme.getColor(peekView.peekViewEditorMatchHighlight);\r\n    if (referenceHighlightColor) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: \" + referenceHighlightColor + \"; }\");\r\n    }\r\n    var referenceHighlightBorder = theme.getColor(peekView.peekViewEditorMatchHighlightBorder);\r\n    if (referenceHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid \" + referenceHighlightBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n    var hcOutline = theme.getColor(activeContrastBorder);\r\n    if (hcOutline) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { border: 1px dotted \" + hcOutline + \"; box-sizing: border-box; }\");\r\n    }\r\n    var resultsBackground = theme.getColor(peekView.peekViewResultsBackground);\r\n    if (resultsBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree { background-color: \" + resultsBackground + \"; }\");\r\n    }\r\n    var resultsMatchForeground = theme.getColor(peekView.peekViewResultsMatchForeground);\r\n    if (resultsMatchForeground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree { color: \" + resultsMatchForeground + \"; }\");\r\n    }\r\n    var resultsFileForeground = theme.getColor(peekView.peekViewResultsFileForeground);\r\n    if (resultsFileForeground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .reference-file { color: \" + resultsFileForeground + \"; }\");\r\n    }\r\n    var resultsSelectedBackground = theme.getColor(peekView.peekViewResultsSelectionBackground);\r\n    if (resultsSelectedBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { background-color: \" + resultsSelectedBackground + \"; }\");\r\n    }\r\n    var resultsSelectedForeground = theme.getColor(peekView.peekViewResultsSelectionForeground);\r\n    if (resultsSelectedForeground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { color: \" + resultsSelectedForeground + \" !important; }\");\r\n    }\r\n    var editorBackground = theme.getColor(peekView.peekViewEditorBackground);\r\n    if (editorBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,\" +\r\n            \".monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {\" +\r\n            (\"\\tbackground-color: \" + editorBackground + \";\") +\r\n            \"}\");\r\n    }\r\n    var editorGutterBackground = theme.getColor(peekView.peekViewEditorGutterBackground);\r\n    if (editorGutterBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .monaco-editor .margin {\" +\r\n            (\"\\tbackground-color: \" + editorGutterBackground + \";\") +\r\n            \"}\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as nls from '../../../../nls.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { dispose, DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IContextKeyService, RawContextKey, ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\r\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\r\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\r\nimport { OneReference } from '../referencesModel.js';\r\nimport { ReferenceWidget, LayoutData } from './referencesWidget.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\r\nimport { createCancelablePromise } from '../../../../base/common/async.js';\r\nimport { getOuterEditor, PeekContext } from '../../peekView/peekView.js';\r\nimport { IListService, WorkbenchListFocusContextKey } from '../../../../platform/list/browser/listService.js';\r\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\r\nexport var ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false);\r\nvar ReferencesController = /** @class */ (function () {\r\n    function ReferencesController(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\r\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\r\n        this._editor = _editor;\r\n        this._editorService = _editorService;\r\n        this._notificationService = _notificationService;\r\n        this._instantiationService = _instantiationService;\r\n        this._storageService = _storageService;\r\n        this._configurationService = _configurationService;\r\n        this._disposables = new DisposableStore();\r\n        this._requestIdPool = 0;\r\n        this._ignoreModelChangeEvent = false;\r\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\r\n    }\r\n    ReferencesController.get = function (editor) {\r\n        return editor.getContribution(ReferencesController.ID);\r\n    };\r\n    ReferencesController.prototype.dispose = function () {\r\n        this._referenceSearchVisible.reset();\r\n        this._disposables.dispose();\r\n        dispose(this._widget);\r\n        dispose(this._model);\r\n        this._widget = undefined;\r\n        this._model = undefined;\r\n    };\r\n    ReferencesController.prototype.toggleWidget = function (range, modelPromise, peekMode) {\r\n        var _this = this;\r\n        // close current widget and return early is position didn't change\r\n        var widgetPosition;\r\n        if (this._widget) {\r\n            widgetPosition = this._widget.position;\r\n        }\r\n        this.closeWidget();\r\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\r\n            return;\r\n        }\r\n        this._peekMode = peekMode;\r\n        this._referenceSearchVisible.set(true);\r\n        // close the widget on model/mode changes\r\n        this._disposables.add(this._editor.onDidChangeModelLanguage(function () { _this.closeWidget(); }));\r\n        this._disposables.add(this._editor.onDidChangeModel(function () {\r\n            if (!_this._ignoreModelChangeEvent) {\r\n                _this.closeWidget();\r\n            }\r\n        }));\r\n        var storageKey = 'peekViewLayout';\r\n        var data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* GLOBAL */, '{}'));\r\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\r\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\r\n        this._widget.show(range);\r\n        this._disposables.add(this._widget.onDidClose(function () {\r\n            modelPromise.cancel();\r\n            if (_this._widget) {\r\n                _this._storageService.store(storageKey, JSON.stringify(_this._widget.layoutData), 0 /* GLOBAL */);\r\n                _this._widget = undefined;\r\n            }\r\n            _this.closeWidget();\r\n        }));\r\n        this._disposables.add(this._widget.onDidSelectReference(function (event) {\r\n            var element = event.element, kind = event.kind;\r\n            if (!element) {\r\n                return;\r\n            }\r\n            switch (kind) {\r\n                case 'open':\r\n                    if (event.source !== 'editor' || !_this._configurationService.getValue('editor.stablePeek')) {\r\n                        // when stable peek is configured we don't close\r\n                        // the peek window on selecting the editor\r\n                        _this.openReference(element, false);\r\n                    }\r\n                    break;\r\n                case 'side':\r\n                    _this.openReference(element, true);\r\n                    break;\r\n                case 'goto':\r\n                    if (peekMode) {\r\n                        _this._gotoReference(element);\r\n                    }\r\n                    else {\r\n                        _this.openReference(element, false);\r\n                    }\r\n                    break;\r\n            }\r\n        }));\r\n        var requestId = ++this._requestIdPool;\r\n        modelPromise.then(function (model) {\r\n            // still current request? widget still open?\r\n            if (requestId !== _this._requestIdPool || !_this._widget) {\r\n                return undefined;\r\n            }\r\n            if (_this._model) {\r\n                _this._model.dispose();\r\n            }\r\n            _this._model = model;\r\n            // show widget\r\n            return _this._widget.setModel(_this._model).then(function () {\r\n                if (_this._widget && _this._model && _this._editor.hasModel()) { // might have been closed\r\n                    // set title\r\n                    if (!_this._model.isEmpty) {\r\n                        _this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", _this._model.title, _this._model.references.length));\r\n                    }\r\n                    else {\r\n                        _this._widget.setMetaTitle('');\r\n                    }\r\n                    // set 'best' selection\r\n                    var uri = _this._editor.getModel().uri;\r\n                    var pos = new Position(range.startLineNumber, range.startColumn);\r\n                    var selection = _this._model.nearestReference(uri, pos);\r\n                    if (selection) {\r\n                        return _this._widget.setSelection(selection);\r\n                    }\r\n                }\r\n                return undefined;\r\n            });\r\n        }, function (error) {\r\n            _this._notificationService.error(error);\r\n        });\r\n    };\r\n    ReferencesController.prototype.goToNextOrPreviousReference = function (fwd) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var currentPosition, source, target, editorFocus;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this._editor.hasModel() || !this._model || !this._widget) {\r\n                            // can be called while still resolving...\r\n                            return [2 /*return*/];\r\n                        }\r\n                        currentPosition = this._widget.position;\r\n                        if (!currentPosition) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\r\n                        if (!source) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        target = this._model.nextOrPreviousReference(source, fwd);\r\n                        editorFocus = this._editor.hasTextFocus();\r\n                        return [4 /*yield*/, this._widget.setSelection(target)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4 /*yield*/, this._gotoReference(target)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        if (editorFocus) {\r\n                            this._editor.focus();\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ReferencesController.prototype.closeWidget = function () {\r\n        this._referenceSearchVisible.reset();\r\n        this._disposables.clear();\r\n        dispose(this._widget);\r\n        dispose(this._model);\r\n        this._widget = undefined;\r\n        this._model = undefined;\r\n        this._editor.focus();\r\n        this._requestIdPool += 1; // Cancel pending requests\r\n    };\r\n    ReferencesController.prototype._gotoReference = function (ref) {\r\n        var _this = this;\r\n        if (this._widget) {\r\n            this._widget.hide();\r\n        }\r\n        this._ignoreModelChangeEvent = true;\r\n        var range = Range.lift(ref.range).collapseToStart();\r\n        return this._editorService.openCodeEditor({\r\n            resource: ref.uri,\r\n            options: { selection: range }\r\n        }, this._editor).then(function (openedEditor) {\r\n            var _a;\r\n            _this._ignoreModelChangeEvent = false;\r\n            if (!openedEditor || !_this._widget) {\r\n                // something went wrong...\r\n                _this.closeWidget();\r\n                return;\r\n            }\r\n            if (_this._editor === openedEditor) {\r\n                //\r\n                _this._widget.show(range);\r\n                _this._widget.focus();\r\n            }\r\n            else {\r\n                // we opened a different editor instance which means a different controller instance.\r\n                // therefore we stop with this controller and continue with the other\r\n                var other = ReferencesController.get(openedEditor);\r\n                var model_1 = _this._model.clone();\r\n                _this.closeWidget();\r\n                openedEditor.focus();\r\n                other.toggleWidget(range, createCancelablePromise(function (_) { return Promise.resolve(model_1); }), (_a = _this._peekMode, (_a !== null && _a !== void 0 ? _a : false)));\r\n            }\r\n        }, function (err) {\r\n            _this._ignoreModelChangeEvent = false;\r\n            onUnexpectedError(err);\r\n        });\r\n    };\r\n    ReferencesController.prototype.openReference = function (ref, sideBySide) {\r\n        // clear stage\r\n        if (!sideBySide) {\r\n            this.closeWidget();\r\n        }\r\n        var uri = ref.uri, range = ref.range;\r\n        this._editorService.openCodeEditor({\r\n            resource: uri,\r\n            options: { selection: range }\r\n        }, this._editor, sideBySide);\r\n    };\r\n    ReferencesController.ID = 'editor.contrib.referencesController';\r\n    ReferencesController = __decorate([\r\n        __param(2, IContextKeyService),\r\n        __param(3, ICodeEditorService),\r\n        __param(4, INotificationService),\r\n        __param(5, IInstantiationService),\r\n        __param(6, IStorageService),\r\n        __param(7, IConfigurationService)\r\n    ], ReferencesController);\r\n    return ReferencesController;\r\n}());\r\nexport { ReferencesController };\r\nfunction withController(accessor, fn) {\r\n    var outerEditor = getOuterEditor(accessor);\r\n    if (!outerEditor) {\r\n        return;\r\n    }\r\n    var controller = ReferencesController.get(outerEditor);\r\n    if (controller) {\r\n        fn(controller);\r\n    }\r\n}\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'goToNextReference',\r\n    weight: 200 /* WorkbenchContrib */ + 50,\r\n    primary: 62 /* F4 */,\r\n    secondary: [70 /* F12 */],\r\n    when: ctxReferenceSearchVisible,\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) {\r\n            controller.goToNextOrPreviousReference(true);\r\n        });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'goToNextReferenceFromEmbeddedEditor',\r\n    weight: 100 /* EditorContrib */ + 50,\r\n    primary: 62 /* F4 */,\r\n    secondary: [70 /* F12 */],\r\n    when: PeekContext.inPeekEditor,\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) {\r\n            controller.goToNextOrPreviousReference(true);\r\n        });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'goToPreviousReference',\r\n    weight: 200 /* WorkbenchContrib */ + 50,\r\n    primary: 1024 /* Shift */ | 62 /* F4 */,\r\n    secondary: [1024 /* Shift */ | 70 /* F12 */],\r\n    when: ctxReferenceSearchVisible,\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) {\r\n            controller.goToNextOrPreviousReference(false);\r\n        });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'goToPreviousReferenceFromEmbeddedEditor',\r\n    weight: 100 /* EditorContrib */ + 50,\r\n    primary: 1024 /* Shift */ | 62 /* F4 */,\r\n    secondary: [1024 /* Shift */ | 70 /* F12 */],\r\n    when: PeekContext.inPeekEditor,\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) {\r\n            controller.goToNextOrPreviousReference(false);\r\n        });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'closeReferenceSearch',\r\n    weight: 200 /* WorkbenchContrib */ + 50,\r\n    primary: 9 /* Escape */,\r\n    secondary: [1024 /* Shift */ | 9 /* Escape */],\r\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek')),\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) { return controller.closeWidget(); });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'closeReferenceSearchEditor',\r\n    weight: 100 /* EditorContrib */ - 101,\r\n    primary: 9 /* Escape */,\r\n    secondary: [1024 /* Shift */ | 9 /* Escape */],\r\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek')),\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) { return controller.closeWidget(); });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'openReferenceToSide',\r\n    weight: 100 /* EditorContrib */,\r\n    primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n    mac: {\r\n        primary: 256 /* WinCtrl */ | 3 /* Enter */\r\n    },\r\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey),\r\n    handler: function (accessor) {\r\n        var _a;\r\n        var listService = accessor.get(IListService);\r\n        var focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\r\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\r\n            withController(accessor, function (controller) { return controller.openReference(focus[0], true); });\r\n        }\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { flatten, coalesce } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { DefinitionProviderRegistry, ImplementationProviderRegistry, TypeDefinitionProviderRegistry, DeclarationProviderRegistry, ReferenceProviderRegistry } from '../../common/modes.js';\r\nfunction getLocationLinks(model, position, registry, provide) {\r\n    var provider = registry.ordered(model);\r\n    // get results\r\n    var promises = provider.map(function (provider) {\r\n        return Promise.resolve(provide(provider, model, position)).then(undefined, function (err) {\r\n            onUnexpectedExternalError(err);\r\n            return undefined;\r\n        });\r\n    });\r\n    return Promise.all(promises)\r\n        .then(flatten)\r\n        .then(coalesce);\r\n}\r\nexport function getDefinitionsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, DefinitionProviderRegistry, function (provider, model, position) {\r\n        return provider.provideDefinition(model, position, token);\r\n    });\r\n}\r\nexport function getDeclarationsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, DeclarationProviderRegistry, function (provider, model, position) {\r\n        return provider.provideDeclaration(model, position, token);\r\n    });\r\n}\r\nexport function getImplementationsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, ImplementationProviderRegistry, function (provider, model, position) {\r\n        return provider.provideImplementation(model, position, token);\r\n    });\r\n}\r\nexport function getTypeDefinitionsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, TypeDefinitionProviderRegistry, function (provider, model, position) {\r\n        return provider.provideTypeDefinition(model, position, token);\r\n    });\r\n}\r\nexport function getReferencesAtPosition(model, position, compact, token) {\r\n    var _this = this;\r\n    return getLocationLinks(model, position, ReferenceProviderRegistry, function (provider, model, position) { return __awaiter(_this, void 0, void 0, function () {\r\n        var result, resultWithoutDeclaration;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, provider.provideReferences(model, position, { includeDeclaration: true }, token)];\r\n                case 1:\r\n                    result = _a.sent();\r\n                    if (!compact || !result || result.length !== 2) {\r\n                        return [2 /*return*/, result];\r\n                    }\r\n                    return [4 /*yield*/, provider.provideReferences(model, position, { includeDeclaration: false }, token)];\r\n                case 2:\r\n                    resultWithoutDeclaration = _a.sent();\r\n                    if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\r\n                        return [2 /*return*/, resultWithoutDeclaration];\r\n                    }\r\n                    return [2 /*return*/, result];\r\n            }\r\n        });\r\n    }); });\r\n}\r\nregisterDefaultLanguageCommand('_executeDefinitionProvider', function (model, position) { return getDefinitionsAtPosition(model, position, CancellationToken.None); });\r\nregisterDefaultLanguageCommand('_executeDeclarationProvider', function (model, position) { return getDeclarationsAtPosition(model, position, CancellationToken.None); });\r\nregisterDefaultLanguageCommand('_executeImplementationProvider', function (model, position) { return getImplementationsAtPosition(model, position, CancellationToken.None); });\r\nregisterDefaultLanguageCommand('_executeTypeDefinitionProvider', function (model, position) { return getTypeDefinitionsAtPosition(model, position, CancellationToken.None); });\r\nregisterDefaultLanguageCommand('_executeReferenceProvider', function (model, position) { return getReferencesAtPosition(model, position, false, CancellationToken.None); });\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { registerEditorCommand, EditorCommand } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { dispose, combinedDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nexport var ctxHasSymbols = new RawContextKey('hasSymbols', false);\r\nexport var ISymbolNavigationService = createDecorator('ISymbolNavigationService');\r\nvar SymbolNavigationService = /** @class */ (function () {\r\n    function SymbolNavigationService(contextKeyService, _editorService, _notificationService, _keybindingService) {\r\n        this._editorService = _editorService;\r\n        this._notificationService = _notificationService;\r\n        this._keybindingService = _keybindingService;\r\n        this._currentModel = undefined;\r\n        this._currentIdx = -1;\r\n        this._ignoreEditorChange = false;\r\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\r\n    }\r\n    SymbolNavigationService.prototype.reset = function () {\r\n        this._ctxHasSymbols.reset();\r\n        dispose(this._currentState);\r\n        dispose(this._currentMessage);\r\n        this._currentModel = undefined;\r\n        this._currentIdx = -1;\r\n    };\r\n    SymbolNavigationService.prototype.put = function (anchor) {\r\n        var _this = this;\r\n        var refModel = anchor.parent.parent;\r\n        if (refModel.references.length <= 1) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        this._currentModel = refModel;\r\n        this._currentIdx = refModel.references.indexOf(anchor);\r\n        this._ctxHasSymbols.set(true);\r\n        this._showMessage();\r\n        var editorState = new EditorState(this._editorService);\r\n        var listener = editorState.onDidChange(function (_) {\r\n            if (_this._ignoreEditorChange) {\r\n                return;\r\n            }\r\n            var editor = _this._editorService.getActiveCodeEditor();\r\n            if (!editor) {\r\n                return;\r\n            }\r\n            var model = editor.getModel();\r\n            var position = editor.getPosition();\r\n            if (!model || !position) {\r\n                return;\r\n            }\r\n            var seenUri = false;\r\n            var seenPosition = false;\r\n            for (var _i = 0, _a = refModel.references; _i < _a.length; _i++) {\r\n                var reference = _a[_i];\r\n                if (isEqual(reference.uri, model.uri)) {\r\n                    seenUri = true;\r\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\r\n                }\r\n                else if (seenUri) {\r\n                    break;\r\n                }\r\n            }\r\n            if (!seenUri || !seenPosition) {\r\n                _this.reset();\r\n            }\r\n        });\r\n        this._currentState = combinedDisposable(editorState, listener);\r\n    };\r\n    SymbolNavigationService.prototype.revealNext = function (source) {\r\n        var _this = this;\r\n        if (!this._currentModel) {\r\n            return Promise.resolve();\r\n        }\r\n        // get next result and advance\r\n        this._currentIdx += 1;\r\n        this._currentIdx %= this._currentModel.references.length;\r\n        var reference = this._currentModel.references[this._currentIdx];\r\n        // status\r\n        this._showMessage();\r\n        // open editor, ignore events while that happens\r\n        this._ignoreEditorChange = true;\r\n        return this._editorService.openCodeEditor({\r\n            resource: reference.uri,\r\n            options: {\r\n                selection: Range.collapseToStart(reference.range),\r\n                revealInCenterIfOutsideViewport: true\r\n            }\r\n        }, source).finally(function () {\r\n            _this._ignoreEditorChange = false;\r\n        });\r\n    };\r\n    SymbolNavigationService.prototype._showMessage = function () {\r\n        dispose(this._currentMessage);\r\n        var kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\r\n        var message = kb\r\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\r\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\r\n        this._currentMessage = this._notificationService.status(message);\r\n    };\r\n    SymbolNavigationService = __decorate([\r\n        __param(0, IContextKeyService),\r\n        __param(1, ICodeEditorService),\r\n        __param(2, INotificationService),\r\n        __param(3, IKeybindingService)\r\n    ], SymbolNavigationService);\r\n    return SymbolNavigationService;\r\n}());\r\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, true);\r\nregisterEditorCommand(new /** @class */ (function (_super) {\r\n    __extends(class_1, _super);\r\n    function class_1() {\r\n        return _super.call(this, {\r\n            id: 'editor.gotoNextSymbolFromResult',\r\n            precondition: ctxHasSymbols,\r\n            kbOpts: {\r\n                weight: 100 /* EditorContrib */,\r\n                primary: 70 /* F12 */\r\n            }\r\n        }) || this;\r\n    }\r\n    class_1.prototype.runEditorCommand = function (accessor, editor) {\r\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\r\n    };\r\n    return class_1;\r\n}(EditorCommand)));\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'editor.gotoNextSymbolFromResult.cancel',\r\n    weight: 100 /* EditorContrib */,\r\n    when: ctxHasSymbols,\r\n    primary: 9 /* Escape */,\r\n    handler: function (accessor) {\r\n        accessor.get(ISymbolNavigationService).reset();\r\n    }\r\n});\r\n//\r\nvar EditorState = /** @class */ (function () {\r\n    function EditorState(editorService) {\r\n        this._listener = new Map();\r\n        this._disposables = new DisposableStore();\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\r\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\r\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\r\n    }\r\n    EditorState.prototype.dispose = function () {\r\n        this._disposables.dispose();\r\n        this._onDidChange.dispose();\r\n        this._listener.forEach(dispose);\r\n    };\r\n    EditorState.prototype._onDidAddEditor = function (editor) {\r\n        var _this = this;\r\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(function (_) { return _this._onDidChange.fire({ editor: editor }); }), editor.onDidChangeModelContent(function (_) { return _this._onDidChange.fire({ editor: editor }); })));\r\n    };\r\n    EditorState.prototype._onDidRemoveEditor = function (editor) {\r\n        dispose(this._listener.get(editor));\r\n        this._listener.delete(editor);\r\n    };\r\n    EditorState = __decorate([\r\n        __param(0, ICodeEditorService)\r\n    ], EditorState);\r\n    return EditorState;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar _a, _b, _c, _d, _e, _f, _g, _h;\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { createCancelablePromise, raceCancellation } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { isWeb } from '../../../base/common/platform.js';\r\nimport { isCodeEditor } from '../../browser/editorBrowser.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport * as corePosition from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { isLocationLink } from '../../common/modes.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { PeekContext } from '../peekView/peekView.js';\r\nimport { ReferencesController } from './peek/referencesController.js';\r\nimport { ReferencesModel } from './referencesModel.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { getDefinitionsAtPosition, getImplementationsAtPosition, getTypeDefinitionsAtPosition, getDeclarationsAtPosition, getReferencesAtPosition } from './goToSymbol.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { EditorStateCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { ISymbolNavigationService } from './symbolNavigation.js';\r\nimport { isStandalone } from '../../../base/browser/browser.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nMenuRegistry.appendMenuItem(7 /* EditorContext */, {\r\n    submenu: 8 /* EditorContextPeek */,\r\n    title: nls.localize('peek.submenu', \"Peek\"),\r\n    group: 'navigation',\r\n    order: 100\r\n});\r\nvar SymbolNavigationAction = /** @class */ (function (_super) {\r\n    __extends(SymbolNavigationAction, _super);\r\n    function SymbolNavigationAction(configuration, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._configuration = configuration;\r\n        return _this;\r\n    }\r\n    SymbolNavigationAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var notificationService = accessor.get(INotificationService);\r\n        var editorService = accessor.get(ICodeEditorService);\r\n        var progressService = accessor.get(IEditorProgressService);\r\n        var symbolNavService = accessor.get(ISymbolNavigationService);\r\n        var model = editor.getModel();\r\n        var pos = editor.getPosition();\r\n        var cts = new EditorStateCancellationTokenSource(editor, 1 /* Value */ | 4 /* Position */);\r\n        var promise = raceCancellation(this._getLocationModel(model, pos, cts.token), cts.token).then(function (references) { return __awaiter(_this, void 0, void 0, function () {\r\n            var altAction, altActionId, referenceCount, info;\r\n            return __generator(this, function (_a) {\r\n                if (!references || cts.token.isCancellationRequested) {\r\n                    return [2 /*return*/];\r\n                }\r\n                alert(references.ariaMessage);\r\n                if (references.referenceAt(model.uri, pos)) {\r\n                    altActionId = this._getAlternativeCommand(editor);\r\n                    if (altActionId !== this.id) {\r\n                        altAction = editor.getAction(altActionId);\r\n                    }\r\n                }\r\n                referenceCount = references.references.length;\r\n                if (referenceCount === 0) {\r\n                    // no result -> show message\r\n                    if (!this._configuration.muteMessage) {\r\n                        info = model.getWordAtPosition(pos);\r\n                        MessageController.get(editor).showMessage(this._getNoResultFoundMessage(info), pos);\r\n                    }\r\n                }\r\n                else if (referenceCount === 1 && altAction) {\r\n                    // already at the only result, run alternative\r\n                    altAction.run();\r\n                }\r\n                else {\r\n                    // normal results handling\r\n                    return [2 /*return*/, this._onResult(editorService, symbolNavService, editor, references)];\r\n                }\r\n                return [2 /*return*/];\r\n            });\r\n        }); }, function (err) {\r\n            // report an error\r\n            notificationService.error(err);\r\n        }).finally(function () {\r\n            cts.dispose();\r\n        });\r\n        progressService.showWhile(promise, 250);\r\n        return promise;\r\n    };\r\n    SymbolNavigationAction.prototype._onResult = function (editorService, symbolNavService, editor, model) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var gotoLocation, next, peek, targetEditor;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        gotoLocation = this._getGoToPreference(editor);\r\n                        if (!(this._configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) return [3 /*break*/, 1];\r\n                        this._openInPeek(editor, model);\r\n                        return [3 /*break*/, 3];\r\n                    case 1:\r\n                        next = model.firstReference();\r\n                        peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\r\n                        return [4 /*yield*/, this._openReference(editor, editorService, next, this._configuration.openToSide, !peek)];\r\n                    case 2:\r\n                        targetEditor = _a.sent();\r\n                        if (peek && targetEditor) {\r\n                            this._openInPeek(targetEditor, model);\r\n                        }\r\n                        else {\r\n                            model.dispose();\r\n                        }\r\n                        // keep remaining locations around when using\r\n                        // 'goto'-mode\r\n                        if (gotoLocation === 'goto') {\r\n                            symbolNavService.put(next);\r\n                        }\r\n                        _a.label = 3;\r\n                    case 3: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SymbolNavigationAction.prototype._openReference = function (editor, editorService, reference, sideBySide, highlight) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var range, targetEditor, modelNow_1, ids_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        range = undefined;\r\n                        if (isLocationLink(reference)) {\r\n                            range = reference.targetSelectionRange;\r\n                        }\r\n                        if (!range) {\r\n                            range = reference.range;\r\n                        }\r\n                        return [4 /*yield*/, editorService.openCodeEditor({\r\n                                resource: reference.uri,\r\n                                options: {\r\n                                    selection: Range.collapseToStart(range),\r\n                                    revealInCenterIfOutsideViewport: true\r\n                                }\r\n                            }, editor, sideBySide)];\r\n                    case 1:\r\n                        targetEditor = _a.sent();\r\n                        if (!targetEditor) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (highlight) {\r\n                            modelNow_1 = targetEditor.getModel();\r\n                            ids_1 = targetEditor.deltaDecorations([], [{ range: range, options: { className: 'symbolHighlight' } }]);\r\n                            setTimeout(function () {\r\n                                if (targetEditor.getModel() === modelNow_1) {\r\n                                    targetEditor.deltaDecorations(ids_1, []);\r\n                                }\r\n                            }, 350);\r\n                        }\r\n                        return [2 /*return*/, targetEditor];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SymbolNavigationAction.prototype._openInPeek = function (target, model) {\r\n        var controller = ReferencesController.get(target);\r\n        if (controller && target.hasModel()) {\r\n            controller.toggleWidget(target.getSelection(), createCancelablePromise(function (_) { return Promise.resolve(model); }), this._configuration.openInPeek);\r\n        }\r\n        else {\r\n            model.dispose();\r\n        }\r\n    };\r\n    return SymbolNavigationAction;\r\n}(EditorAction));\r\n//#region --- DEFINITION\r\nvar DefinitionAction = /** @class */ (function (_super) {\r\n    __extends(DefinitionAction, _super);\r\n    function DefinitionAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DefinitionAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getDefinitionsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('def.title', 'Definitions')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DefinitionAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\r\n            : nls.localize('generic.noResults', \"No definition found\");\r\n    };\r\n    DefinitionAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(39 /* gotoLocation */).alternativeDefinitionCommand;\r\n    };\r\n    DefinitionAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(39 /* gotoLocation */).multipleDefinitions;\r\n    };\r\n    return DefinitionAction;\r\n}(SymbolNavigationAction));\r\nexport { DefinitionAction };\r\nvar goToDefinitionKb = isWeb && !isStandalone\r\n    ? 2048 /* CtrlCmd */ | 70 /* F12 */\r\n    : 70 /* F12 */;\r\nregisterEditorAction((_a = /** @class */ (function (_super) {\r\n        __extends(GoToDefinitionAction, _super);\r\n        function GoToDefinitionAction() {\r\n            var _this = _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToDefinitionAction.id,\r\n                label: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\r\n                alias: 'Go to Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: goToDefinitionKb,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.1\r\n                },\r\n                menuOpts: {\r\n                    menuId: 17 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 2,\r\n                    title: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\r\n                }\r\n            }) || this;\r\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\r\n            return _this;\r\n        }\r\n        return GoToDefinitionAction;\r\n    }(DefinitionAction)),\r\n    _a.id = 'editor.action.revealDefinition',\r\n    _a));\r\nregisterEditorAction((_b = /** @class */ (function (_super) {\r\n        __extends(OpenDefinitionToSideAction, _super);\r\n        function OpenDefinitionToSideAction() {\r\n            var _this = _super.call(this, {\r\n                openToSide: true,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: OpenDefinitionToSideAction.id,\r\n                label: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\r\n                alias: 'Open Definition to the Side',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, goToDefinitionKb),\r\n                    weight: 100 /* EditorContrib */\r\n                }\r\n            }) || this;\r\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\r\n            return _this;\r\n        }\r\n        return OpenDefinitionToSideAction;\r\n    }(DefinitionAction)),\r\n    _b.id = 'editor.action.revealDefinitionAside',\r\n    _b));\r\nregisterEditorAction((_c = /** @class */ (function (_super) {\r\n        __extends(PeekDefinitionAction, _super);\r\n        function PeekDefinitionAction() {\r\n            var _this = _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekDefinitionAction.id,\r\n                label: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\r\n                alias: 'Peek Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 512 /* Alt */ | 70 /* F12 */,\r\n                    linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 68 /* F10 */ },\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    menuId: 8 /* EditorContextPeek */,\r\n                    group: 'peek',\r\n                    order: 2\r\n                }\r\n            }) || this;\r\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\r\n            return _this;\r\n        }\r\n        return PeekDefinitionAction;\r\n    }(DefinitionAction)),\r\n    _c.id = 'editor.action.peekDefinition',\r\n    _c));\r\n//#endregion\r\n//#region --- DECLARATION\r\nvar DeclarationAction = /** @class */ (function (_super) {\r\n    __extends(DeclarationAction, _super);\r\n    function DeclarationAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DeclarationAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getDeclarationsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('decl.title', 'Declarations')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DeclarationAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\r\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\r\n    };\r\n    DeclarationAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(39 /* gotoLocation */).alternativeDeclarationCommand;\r\n    };\r\n    DeclarationAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(39 /* gotoLocation */).multipleDeclarations;\r\n    };\r\n    return DeclarationAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction((_d = /** @class */ (function (_super) {\r\n        __extends(GoToDeclarationAction, _super);\r\n        function GoToDeclarationAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToDeclarationAction.id,\r\n                label: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\r\n                alias: 'Go to Declaration',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.3\r\n                },\r\n                menuOpts: {\r\n                    menuId: 17 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 3,\r\n                    title: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\r\n                },\r\n            }) || this;\r\n        }\r\n        GoToDeclarationAction.prototype._getNoResultFoundMessage = function (info) {\r\n            return info && info.word\r\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\r\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\r\n        };\r\n        return GoToDeclarationAction;\r\n    }(DeclarationAction)),\r\n    _d.id = 'editor.action.revealDeclaration',\r\n    _d));\r\nregisterEditorAction(/** @class */ (function (_super) {\r\n    __extends(PeekDeclarationAction, _super);\r\n    function PeekDeclarationAction() {\r\n        return _super.call(this, {\r\n            openToSide: false,\r\n            openInPeek: true,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.peekDeclaration',\r\n            label: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\r\n            alias: 'Peek Declaration',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n            contextMenuOpts: {\r\n                menuId: 8 /* EditorContextPeek */,\r\n                group: 'peek',\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    return PeekDeclarationAction;\r\n}(DeclarationAction)));\r\n//#endregion\r\n//#region --- TYPE DEFINITION\r\nvar TypeDefinitionAction = /** @class */ (function (_super) {\r\n    __extends(TypeDefinitionAction, _super);\r\n    function TypeDefinitionAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    TypeDefinitionAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getTypeDefinitionsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('typedef.title', 'Type Definitions')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TypeDefinitionAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\r\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\r\n    };\r\n    TypeDefinitionAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(39 /* gotoLocation */).alternativeTypeDefinitionCommand;\r\n    };\r\n    TypeDefinitionAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(39 /* gotoLocation */).multipleTypeDefinitions;\r\n    };\r\n    return TypeDefinitionAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction((_e = /** @class */ (function (_super) {\r\n        __extends(GoToTypeDefinitionAction, _super);\r\n        function GoToTypeDefinitionAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToTypeDefinitionAction.ID,\r\n                label: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\r\n                alias: 'Go to Type Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 0,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.4\r\n                },\r\n                menuOpts: {\r\n                    menuId: 17 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 3,\r\n                    title: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\r\n                }\r\n            }) || this;\r\n        }\r\n        return GoToTypeDefinitionAction;\r\n    }(TypeDefinitionAction)),\r\n    _e.ID = 'editor.action.goToTypeDefinition',\r\n    _e));\r\nregisterEditorAction((_f = /** @class */ (function (_super) {\r\n        __extends(PeekTypeDefinitionAction, _super);\r\n        function PeekTypeDefinitionAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekTypeDefinitionAction.ID,\r\n                label: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\r\n                alias: 'Peek Type Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                contextMenuOpts: {\r\n                    menuId: 8 /* EditorContextPeek */,\r\n                    group: 'peek',\r\n                    order: 4\r\n                }\r\n            }) || this;\r\n        }\r\n        return PeekTypeDefinitionAction;\r\n    }(TypeDefinitionAction)),\r\n    _f.ID = 'editor.action.peekTypeDefinition',\r\n    _f));\r\n//#endregion\r\n//#region --- IMPLEMENTATION\r\nvar ImplementationAction = /** @class */ (function (_super) {\r\n    __extends(ImplementationAction, _super);\r\n    function ImplementationAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ImplementationAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getImplementationsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('impl.title', 'Implementations')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ImplementationAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\r\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\r\n    };\r\n    ImplementationAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(39 /* gotoLocation */).alternativeImplementationCommand;\r\n    };\r\n    ImplementationAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(39 /* gotoLocation */).multipleImplementations;\r\n    };\r\n    return ImplementationAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction((_g = /** @class */ (function (_super) {\r\n        __extends(GoToImplementationAction, _super);\r\n        function GoToImplementationAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToImplementationAction.ID,\r\n                label: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\r\n                alias: 'Go to Implementations',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 70 /* F12 */,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                menuOpts: {\r\n                    menuId: 17 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 4,\r\n                    title: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.45\r\n                }\r\n            }) || this;\r\n        }\r\n        return GoToImplementationAction;\r\n    }(ImplementationAction)),\r\n    _g.ID = 'editor.action.goToImplementation',\r\n    _g));\r\nregisterEditorAction((_h = /** @class */ (function (_super) {\r\n        __extends(PeekImplementationAction, _super);\r\n        function PeekImplementationAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekImplementationAction.ID,\r\n                label: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\r\n                alias: 'Peek Implementations',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 70 /* F12 */,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    menuId: 8 /* EditorContextPeek */,\r\n                    group: 'peek',\r\n                    order: 5\r\n                }\r\n            }) || this;\r\n        }\r\n        return PeekImplementationAction;\r\n    }(ImplementationAction)),\r\n    _h.ID = 'editor.action.peekImplementation',\r\n    _h));\r\n//#endregion\r\n//#region --- REFERENCES\r\nvar ReferencesAction = /** @class */ (function (_super) {\r\n    __extends(ReferencesAction, _super);\r\n    function ReferencesAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ReferencesAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info\r\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\r\n            : nls.localize('references.noGeneric', \"No references found\");\r\n    };\r\n    ReferencesAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(39 /* gotoLocation */).alternativeReferenceCommand;\r\n    };\r\n    ReferencesAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(39 /* gotoLocation */).multipleReferences;\r\n    };\r\n    return ReferencesAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction(/** @class */ (function (_super) {\r\n    __extends(GoToReferencesAction, _super);\r\n    function GoToReferencesAction() {\r\n        return _super.call(this, {\r\n            openToSide: false,\r\n            openInPeek: false,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.goToReferences',\r\n            label: nls.localize('goToReferences.label', \"Go to References\"),\r\n            alias: 'Go to References',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 70 /* F12 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: 'navigation',\r\n                order: 1.45\r\n            },\r\n            menuOpts: {\r\n                menuId: 17 /* MenubarGoMenu */,\r\n                group: '4_symbol_nav',\r\n                order: 5,\r\n                title: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\r\n            },\r\n        }) || this;\r\n    }\r\n    GoToReferencesAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getReferencesAtPosition(model, position, true, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('ref.title', 'References')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return GoToReferencesAction;\r\n}(ReferencesAction)));\r\nregisterEditorAction(/** @class */ (function (_super) {\r\n    __extends(PeekReferencesAction, _super);\r\n    function PeekReferencesAction() {\r\n        return _super.call(this, {\r\n            openToSide: false,\r\n            openInPeek: true,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.referenceSearch.trigger',\r\n            label: nls.localize('references.action.label', \"Peek References\"),\r\n            alias: 'Peek References',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n            contextMenuOpts: {\r\n                menuId: 8 /* EditorContextPeek */,\r\n                group: 'peek',\r\n                order: 6\r\n            }\r\n        }) || this;\r\n    }\r\n    PeekReferencesAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getReferencesAtPosition(model, position, false, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('ref.title', 'References')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return PeekReferencesAction;\r\n}(ReferencesAction)));\r\n//#endregion\r\n//#region --- GENERIC goto symbols command\r\nvar GenericGoToLocationAction = /** @class */ (function (_super) {\r\n    __extends(GenericGoToLocationAction, _super);\r\n    function GenericGoToLocationAction(_references, _gotoMultipleBehaviour) {\r\n        var _this = _super.call(this, {\r\n            muteMessage: true,\r\n            openInPeek: false,\r\n            openToSide: false\r\n        }, {\r\n            id: 'editor.action.goToLocation',\r\n            label: nls.localize('label.generic', \"Go To Any Symbol\"),\r\n            alias: 'Go To Any Symbol',\r\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n        }) || this;\r\n        _this._references = _references;\r\n        _this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\r\n        return _this;\r\n    }\r\n    GenericGoToLocationAction.prototype._getLocationModel = function (_model, _position, _token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2 /*return*/, new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'))];\r\n            });\r\n        });\r\n    };\r\n    GenericGoToLocationAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\r\n    };\r\n    GenericGoToLocationAction.prototype._getGoToPreference = function (editor) {\r\n        var _a;\r\n        return _a = this._gotoMultipleBehaviour, (_a !== null && _a !== void 0 ? _a : editor.getOption(39 /* gotoLocation */).multipleReferences);\r\n    };\r\n    GenericGoToLocationAction.prototype._getAlternativeCommand = function () { return ''; };\r\n    return GenericGoToLocationAction;\r\n}(SymbolNavigationAction));\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.goToLocations',\r\n    description: {\r\n        description: 'Go to locations from a position in a file',\r\n        args: [\r\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\r\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\r\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\r\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\r\n        ]\r\n    },\r\n    handler: function (accessor, resource, position, references, multiple) { return __awaiter(void 0, void 0, void 0, function () {\r\n        var editorService, editor;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    assertType(URI.isUri(resource));\r\n                    assertType(corePosition.Position.isIPosition(position));\r\n                    assertType(Array.isArray(references));\r\n                    assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\r\n                    editorService = accessor.get(ICodeEditorService);\r\n                    return [4 /*yield*/, editorService.openCodeEditor({ resource: resource }, editorService.getFocusedCodeEditor())];\r\n                case 1:\r\n                    editor = _a.sent();\r\n                    if (isCodeEditor(editor)) {\r\n                        editor.setPosition(position);\r\n                        editor.revealPositionInCenterIfOutsideViewport(position, 0 /* Smooth */);\r\n                        return [2 /*return*/, editor.invokeWithinContext(function (accessor) {\r\n                                var command = new GenericGoToLocationAction(references, multiple);\r\n                                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\r\n                            })];\r\n                    }\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    }); }\r\n});\r\n//#endregion\r\n//#region --- REFERENCE search special commands\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.findReferences',\r\n    handler: function (accessor, resource, position) {\r\n        assertType(URI.isUri(resource));\r\n        assertType(corePosition.Position.isIPosition(position));\r\n        var codeEditorService = accessor.get(ICodeEditorService);\r\n        return codeEditorService.openCodeEditor({ resource: resource }, codeEditorService.getFocusedCodeEditor()).then(function (control) {\r\n            if (!isCodeEditor(control) || !control.hasModel()) {\r\n                return undefined;\r\n            }\r\n            var controller = ReferencesController.get(control);\r\n            if (!controller) {\r\n                return undefined;\r\n            }\r\n            var references = createCancelablePromise(function (token) { return getReferencesAtPosition(control.getModel(), corePosition.Position.lift(position), false, token).then(function (references) { return new ReferencesModel(references, nls.localize('ref.title', 'References')); }); });\r\n            var range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n            return Promise.resolve(controller.toggleWidget(range, references, false));\r\n        });\r\n    }\r\n});\r\n// use NEW command\r\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.goToLocations');\r\n//#endregion\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { equals } from './arrays.js';\r\nvar MarkdownString = /** @class */ (function () {\r\n    function MarkdownString(value, isTrusted) {\r\n        if (value === void 0) { value = ''; }\r\n        if (isTrusted === void 0) { isTrusted = false; }\r\n        this._value = value;\r\n        this._isTrusted = isTrusted;\r\n    }\r\n    Object.defineProperty(MarkdownString.prototype, \"value\", {\r\n        get: function () { return this._value; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MarkdownString.prototype, \"isTrusted\", {\r\n        get: function () { return this._isTrusted; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkdownString.prototype.appendText = function (value) {\r\n        // escape markdown syntax tokens: http://daringfireball.net/projects/markdown/syntax#backslash\r\n        this._value += value\r\n            .replace(/[\\\\`*_{}[\\]()#+\\-.!]/g, '\\\\$&')\r\n            .replace('\\n', '\\n\\n');\r\n        return this;\r\n    };\r\n    MarkdownString.prototype.appendMarkdown = function (value) {\r\n        this._value += value;\r\n        return this;\r\n    };\r\n    MarkdownString.prototype.appendCodeblock = function (langId, code) {\r\n        this._value += '\\n```';\r\n        this._value += langId;\r\n        this._value += '\\n';\r\n        this._value += code;\r\n        this._value += '\\n```\\n';\r\n        return this;\r\n    };\r\n    return MarkdownString;\r\n}());\r\nexport { MarkdownString };\r\nexport function isEmptyMarkdownString(oneOrMany) {\r\n    if (isMarkdownString(oneOrMany)) {\r\n        return !oneOrMany.value;\r\n    }\r\n    else if (Array.isArray(oneOrMany)) {\r\n        return oneOrMany.every(isEmptyMarkdownString);\r\n    }\r\n    else {\r\n        return true;\r\n    }\r\n}\r\nexport function isMarkdownString(thing) {\r\n    if (thing instanceof MarkdownString) {\r\n        return true;\r\n    }\r\n    else if (thing && typeof thing === 'object') {\r\n        return typeof thing.value === 'string'\r\n            && (typeof thing.isTrusted === 'boolean' || thing.isTrusted === undefined);\r\n    }\r\n    return false;\r\n}\r\nexport function markedStringsEquals(a, b) {\r\n    if (!a && !b) {\r\n        return true;\r\n    }\r\n    else if (!a || !b) {\r\n        return false;\r\n    }\r\n    else if (Array.isArray(a) && Array.isArray(b)) {\r\n        return equals(a, b, markdownStringEqual);\r\n    }\r\n    else if (isMarkdownString(a) && isMarkdownString(b)) {\r\n        return markdownStringEqual(a, b);\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\nfunction markdownStringEqual(a, b) {\r\n    if (a === b) {\r\n        return true;\r\n    }\r\n    else if (!a || !b) {\r\n        return false;\r\n    }\r\n    else {\r\n        return a.value === b.value && a.isTrusted === b.isTrusted;\r\n    }\r\n}\r\nexport function removeMarkdownEscapes(text) {\r\n    if (!text) {\r\n        return text;\r\n    }\r\n    return text.replace(/\\\\([\\\\`*_{}[\\]()#+\\-.!])/g, '$1');\r\n}\r\nexport function parseHrefAndDimensions(href) {\r\n    var dimensions = [];\r\n    var splitted = href.split('|').map(function (s) { return s.trim(); });\r\n    href = splitted[0];\r\n    var parameters = splitted[1];\r\n    if (parameters) {\r\n        var heightFromParams = /height=(\\d+)/.exec(parameters);\r\n        var widthFromParams = /width=(\\d+)/.exec(parameters);\r\n        var height = heightFromParams ? heightFromParams[1] : '';\r\n        var width = widthFromParams ? widthFromParams[1] : '';\r\n        var widthIsFinite = isFinite(parseInt(width));\r\n        var heightIsFinite = isFinite(parseInt(height));\r\n        if (widthIsFinite) {\r\n            dimensions.push(\"width=\\\"\" + width + \"\\\"\");\r\n        }\r\n        if (heightIsFinite) {\r\n            dimensions.push(\"height=\\\"\" + height + \"\\\"\");\r\n        }\r\n    }\r\n    return { href: href, dimensions: dimensions };\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { Emitter } from '../../../../base/common/event.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nfunction hasModifier(e, modifier) {\r\n    return !!e[modifier];\r\n}\r\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\r\nvar ClickLinkMouseEvent = /** @class */ (function () {\r\n    function ClickLinkMouseEvent(source, opts) {\r\n        this.target = source.target;\r\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\r\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\r\n        this.isNoneOrSingleMouseDown = (browser.isIE || source.event.detail <= 1); // IE does not support event.detail properly\r\n    }\r\n    return ClickLinkMouseEvent;\r\n}());\r\nexport { ClickLinkMouseEvent };\r\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\r\nvar ClickLinkKeyboardEvent = /** @class */ (function () {\r\n    function ClickLinkKeyboardEvent(source, opts) {\r\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\r\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\r\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\r\n    }\r\n    return ClickLinkKeyboardEvent;\r\n}());\r\nexport { ClickLinkKeyboardEvent };\r\nvar ClickLinkOptions = /** @class */ (function () {\r\n    function ClickLinkOptions(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\r\n        this.triggerKey = triggerKey;\r\n        this.triggerModifier = triggerModifier;\r\n        this.triggerSideBySideKey = triggerSideBySideKey;\r\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\r\n    }\r\n    ClickLinkOptions.prototype.equals = function (other) {\r\n        return (this.triggerKey === other.triggerKey\r\n            && this.triggerModifier === other.triggerModifier\r\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\r\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\r\n    };\r\n    return ClickLinkOptions;\r\n}());\r\nexport { ClickLinkOptions };\r\nfunction createOptions(multiCursorModifier) {\r\n    if (multiCursorModifier === 'altKey') {\r\n        if (platform.isMacintosh) {\r\n            return new ClickLinkOptions(57 /* Meta */, 'metaKey', 6 /* Alt */, 'altKey');\r\n        }\r\n        return new ClickLinkOptions(5 /* Ctrl */, 'ctrlKey', 6 /* Alt */, 'altKey');\r\n    }\r\n    if (platform.isMacintosh) {\r\n        return new ClickLinkOptions(6 /* Alt */, 'altKey', 57 /* Meta */, 'metaKey');\r\n    }\r\n    return new ClickLinkOptions(6 /* Alt */, 'altKey', 5 /* Ctrl */, 'ctrlKey');\r\n}\r\nvar ClickLinkGesture = /** @class */ (function (_super) {\r\n    __extends(ClickLinkGesture, _super);\r\n    function ClickLinkGesture(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onMouseMoveOrRelevantKeyDown = _this._register(new Emitter());\r\n        _this.onMouseMoveOrRelevantKeyDown = _this._onMouseMoveOrRelevantKeyDown.event;\r\n        _this._onExecute = _this._register(new Emitter());\r\n        _this.onExecute = _this._onExecute.event;\r\n        _this._onCancel = _this._register(new Emitter());\r\n        _this.onCancel = _this._onCancel.event;\r\n        _this._editor = editor;\r\n        _this._opts = createOptions(_this._editor.getOption(57 /* multiCursorModifier */));\r\n        _this.lastMouseMoveEvent = null;\r\n        _this.hasTriggerKeyOnMouseDown = false;\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(57 /* multiCursorModifier */)) {\r\n                var newOpts = createOptions(_this._editor.getOption(57 /* multiCursorModifier */));\r\n                if (_this._opts.equals(newOpts)) {\r\n                    return;\r\n                }\r\n                _this._opts = newOpts;\r\n                _this.lastMouseMoveEvent = null;\r\n                _this.hasTriggerKeyOnMouseDown = false;\r\n                _this._onCancel.fire();\r\n            }\r\n        }));\r\n        _this._register(_this._editor.onMouseMove(function (e) { return _this.onEditorMouseMove(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseDown(function (e) { return _this.onEditorMouseDown(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseUp(function (e) { return _this.onEditorMouseUp(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onKeyDown(function (e) { return _this.onEditorKeyDown(new ClickLinkKeyboardEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onKeyUp(function (e) { return _this.onEditorKeyUp(new ClickLinkKeyboardEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseDrag(function () { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidChangeCursorSelection(function (e) { return _this.onDidChangeCursorSelection(e); }));\r\n        _this._register(_this._editor.onDidChangeModel(function (e) { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidChangeModelContent(function () { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidScrollChange(function (e) {\r\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\r\n                _this.resetHandler();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    ClickLinkGesture.prototype.onDidChangeCursorSelection = function (e) {\r\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\r\n            this.resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/Microsoft/vscode/issues/7827)\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseMove = function (mouseEvent) {\r\n        this.lastMouseMoveEvent = mouseEvent;\r\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseDown = function (mouseEvent) {\r\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\r\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\r\n        // release the mouse button without wanting to do the navigation.\r\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\r\n        this.hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseUp = function (mouseEvent) {\r\n        if (this.hasTriggerKeyOnMouseDown) {\r\n            this._onExecute.fire(mouseEvent);\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorKeyDown = function (e) {\r\n        if (this.lastMouseMoveEvent\r\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\r\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\r\n            )) {\r\n            this._onMouseMoveOrRelevantKeyDown.fire([this.lastMouseMoveEvent, e]);\r\n        }\r\n        else if (e.hasTriggerModifier) {\r\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorKeyUp = function (e) {\r\n        if (e.keyCodeIsTriggerKey) {\r\n            this._onCancel.fire();\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.resetHandler = function () {\r\n        this.lastMouseMoveEvent = null;\r\n        this.hasTriggerKeyOnMouseDown = false;\r\n        this._onCancel.fire();\r\n    };\r\n    return ClickLinkGesture;\r\n}(Disposable));\r\nexport { ClickLinkGesture };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './goToDefinitionAtPosition.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport { createCancelablePromise } from '../../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\r\nimport { IModeService } from '../../../common/services/modeService.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { DefinitionProviderRegistry } from '../../../common/modes.js';\r\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\r\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport { editorActiveLinkForeground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { EditorState } from '../../../browser/core/editorState.js';\r\nimport { DefinitionAction } from '../goToCommands.js';\r\nimport { ClickLinkGesture } from './clickLinkGesture.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { withNullAsUndefined } from '../../../../base/common/types.js';\r\nvar GotoDefinitionAtPositionEditorContribution = /** @class */ (function () {\r\n    function GotoDefinitionAtPositionEditorContribution(editor, textModelResolverService, modeService) {\r\n        var _this = this;\r\n        this.textModelResolverService = textModelResolverService;\r\n        this.modeService = modeService;\r\n        this.toUnhook = new DisposableStore();\r\n        this.toUnhookForKeyboard = new DisposableStore();\r\n        this.linkDecorations = [];\r\n        this.currentWordAtPosition = null;\r\n        this.previousPromise = null;\r\n        this.editor = editor;\r\n        var linkGesture = new ClickLinkGesture(editor);\r\n        this.toUnhook.add(linkGesture);\r\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(function (_a) {\r\n            var mouseEvent = _a[0], keyboardEvent = _a[1];\r\n            _this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\r\n        }));\r\n        this.toUnhook.add(linkGesture.onExecute(function (mouseEvent) {\r\n            if (_this.isEnabled(mouseEvent)) {\r\n                _this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier).then(function () {\r\n                    _this.removeLinkDecorations();\r\n                }, function (error) {\r\n                    _this.removeLinkDecorations();\r\n                    onUnexpectedError(error);\r\n                });\r\n            }\r\n        }));\r\n        this.toUnhook.add(linkGesture.onCancel(function () {\r\n            _this.removeLinkDecorations();\r\n            _this.currentWordAtPosition = null;\r\n        }));\r\n    }\r\n    GotoDefinitionAtPositionEditorContribution.get = function (editor) {\r\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.startFindDefinitionFromCursor = function (position) {\r\n        // For issue: https://github.com/microsoft/vscode/issues/46257\r\n        // equivalent to mouse move with meta/ctrl key\r\n        var _this = this;\r\n        // First find the definition and add decorations\r\n        // to the editor to be shown with the content hover widget\r\n        return this.startFindDefinition(position).then(function () {\r\n            // Add listeners for editor cursor move and key down events\r\n            // Dismiss the \"extended\" editor decorations when the user hides\r\n            // the hover widget. There is no event for the widget itself so these\r\n            // serve as a best effort. After removing the link decorations, the hover\r\n            // widget is clean and will only show declarations per next request.\r\n            _this.toUnhookForKeyboard.add(_this.editor.onDidChangeCursorPosition(function () {\r\n                _this.currentWordAtPosition = null;\r\n                _this.removeLinkDecorations();\r\n                _this.toUnhookForKeyboard.clear();\r\n            }));\r\n            _this.toUnhookForKeyboard.add(_this.editor.onKeyDown(function (e) {\r\n                if (e) {\r\n                    _this.currentWordAtPosition = null;\r\n                    _this.removeLinkDecorations();\r\n                    _this.toUnhookForKeyboard.clear();\r\n                }\r\n            }));\r\n        });\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.startFindDefinitionFromMouse = function (mouseEvent, withKey) {\r\n        // check if we are active and on a content widget\r\n        if (mouseEvent.target.type === 9 /* CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\r\n            this.currentWordAtPosition = null;\r\n            this.removeLinkDecorations();\r\n            return;\r\n        }\r\n        var position = mouseEvent.target.position;\r\n        this.startFindDefinition(position);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.startFindDefinition = function (position) {\r\n        var _this = this;\r\n        var _a;\r\n        // Dispose listeners for updating decorations when using keyboard to show definition hover\r\n        this.toUnhookForKeyboard.clear();\r\n        // Find word at mouse position\r\n        var word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\r\n        if (!word) {\r\n            this.currentWordAtPosition = null;\r\n            this.removeLinkDecorations();\r\n            return Promise.resolve(0);\r\n        }\r\n        // Return early if word at position is still the same\r\n        if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\r\n            return Promise.resolve(0);\r\n        }\r\n        this.currentWordAtPosition = word;\r\n        // Find definition and decorate word if found\r\n        var state = new EditorState(this.editor, 4 /* Position */ | 1 /* Value */ | 2 /* Selection */ | 8 /* Scroll */);\r\n        if (this.previousPromise) {\r\n            this.previousPromise.cancel();\r\n            this.previousPromise = null;\r\n        }\r\n        this.previousPromise = createCancelablePromise(function (token) { return _this.findDefinition(position, token); });\r\n        return this.previousPromise.then(function (results) {\r\n            if (!results || !results.length || !state.validate(_this.editor)) {\r\n                _this.removeLinkDecorations();\r\n                return;\r\n            }\r\n            // Multiple results\r\n            if (results.length > 1) {\r\n                _this.addDecoration(new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn), new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\r\n            }\r\n            // Single result\r\n            else {\r\n                var result_1 = results[0];\r\n                if (!result_1.uri) {\r\n                    return;\r\n                }\r\n                _this.textModelResolverService.createModelReference(result_1.uri).then(function (ref) {\r\n                    if (!ref.object || !ref.object.textEditorModel) {\r\n                        ref.dispose();\r\n                        return;\r\n                    }\r\n                    var textEditorModel = ref.object.textEditorModel;\r\n                    var startLineNumber = result_1.range.startLineNumber;\r\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\r\n                        // invalid range\r\n                        ref.dispose();\r\n                        return;\r\n                    }\r\n                    var previewValue = _this.getPreviewValue(textEditorModel, startLineNumber, result_1);\r\n                    var wordRange;\r\n                    if (result_1.originSelectionRange) {\r\n                        wordRange = Range.lift(result_1.originSelectionRange);\r\n                    }\r\n                    else {\r\n                        wordRange = new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\r\n                    }\r\n                    var modeId = _this.modeService.getModeIdByFilepathOrFirstLine(textEditorModel.uri);\r\n                    _this.addDecoration(wordRange, new MarkdownString().appendCodeblock(modeId ? modeId : '', previewValue));\r\n                    ref.dispose();\r\n                });\r\n            }\r\n        }).then(undefined, onUnexpectedError);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.getPreviewValue = function (textEditorModel, startLineNumber, result) {\r\n        var rangeToUse = result.targetSelectionRange ? result.range : this.getPreviewRangeBasedOnBrackets(textEditorModel, startLineNumber);\r\n        var numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\r\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\r\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\r\n        }\r\n        var previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\r\n        return previewValue;\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.stripIndentationFromPreviewRange = function (textEditorModel, startLineNumber, previewRange) {\r\n        var startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\r\n        var minIndent = startIndent;\r\n        for (var endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\r\n            var endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\r\n            minIndent = Math.min(minIndent, endIndent);\r\n        }\r\n        var previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(\"^\\\\s{\" + (minIndent - 1) + \"}\", 'gm'), '').trim();\r\n        return previewValue;\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.getPreviewRangeBasedOnIndentation = function (textEditorModel, startLineNumber) {\r\n        var startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\r\n        var maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\r\n        var endLineNumber = startLineNumber + 1;\r\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\r\n            var endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\r\n            if (startIndent === endIndent) {\r\n                break;\r\n            }\r\n        }\r\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.getPreviewRangeBasedOnBrackets = function (textEditorModel, startLineNumber) {\r\n        var maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\r\n        var brackets = [];\r\n        var ignoreFirstEmpty = true;\r\n        var currentBracket = textEditorModel.findNextBracket(new Position(startLineNumber, 1));\r\n        while (currentBracket !== null) {\r\n            if (brackets.length === 0) {\r\n                brackets.push(currentBracket);\r\n            }\r\n            else {\r\n                var lastBracket = brackets[brackets.length - 1];\r\n                if (lastBracket.open[0] === currentBracket.open[0] && lastBracket.isOpen && !currentBracket.isOpen) {\r\n                    brackets.pop();\r\n                }\r\n                else {\r\n                    brackets.push(currentBracket);\r\n                }\r\n                if (brackets.length === 0) {\r\n                    if (ignoreFirstEmpty) {\r\n                        ignoreFirstEmpty = false;\r\n                    }\r\n                    else {\r\n                        return new Range(startLineNumber, 1, currentBracket.range.endLineNumber + 1, 1);\r\n                    }\r\n                }\r\n            }\r\n            var maxColumn = textEditorModel.getLineMaxColumn(startLineNumber);\r\n            var nextLineNumber = currentBracket.range.endLineNumber;\r\n            var nextColumn = currentBracket.range.endColumn;\r\n            if (maxColumn === currentBracket.range.endColumn) {\r\n                nextLineNumber++;\r\n                nextColumn = 1;\r\n            }\r\n            if (nextLineNumber > maxLineNumber) {\r\n                return new Range(startLineNumber, 1, maxLineNumber + 1, 1);\r\n            }\r\n            currentBracket = textEditorModel.findNextBracket(new Position(nextLineNumber, nextColumn));\r\n        }\r\n        return new Range(startLineNumber, 1, maxLineNumber + 1, 1);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.addDecoration = function (range, hoverMessage) {\r\n        var newDecorations = {\r\n            range: range,\r\n            options: {\r\n                inlineClassName: 'goto-definition-link',\r\n                hoverMessage: hoverMessage\r\n            }\r\n        };\r\n        this.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, [newDecorations]);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.removeLinkDecorations = function () {\r\n        if (this.linkDecorations.length > 0) {\r\n            this.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, []);\r\n        }\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.isEnabled = function (mouseEvent, withKey) {\r\n        return this.editor.hasModel() &&\r\n            mouseEvent.isNoneOrSingleMouseDown &&\r\n            (mouseEvent.target.type === 6 /* CONTENT_TEXT */) &&\r\n            (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false)) &&\r\n            DefinitionProviderRegistry.has(this.editor.getModel());\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.findDefinition = function (position, token) {\r\n        var model = this.editor.getModel();\r\n        if (!model) {\r\n            return Promise.resolve(null);\r\n        }\r\n        return getDefinitionsAtPosition(model, position, token);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.gotoDefinition = function (position, openToSide) {\r\n        var _this = this;\r\n        this.editor.setPosition(position);\r\n        var action = new DefinitionAction({ openToSide: openToSide, openInPeek: false, muteMessage: true }, { alias: '', label: '', id: '', precondition: undefined });\r\n        return this.editor.invokeWithinContext(function (accessor) { return action.run(accessor, _this.editor); });\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.dispose = function () {\r\n        this.toUnhook.dispose();\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\r\n    GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\r\n    GotoDefinitionAtPositionEditorContribution = __decorate([\r\n        __param(1, ITextModelService),\r\n        __param(2, IModeService)\r\n    ], GotoDefinitionAtPositionEditorContribution);\r\n    return GotoDefinitionAtPositionEditorContribution;\r\n}());\r\nexport { GotoDefinitionAtPositionEditorContribution };\r\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(\".monaco-editor .goto-definition-link { color: \" + activeLinkForeground + \" !important; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport Severity from '../../../base/common/severity.js';\r\nimport { registerThemingParticipant } from '../../theme/common/themeService.js';\r\nimport { problemsErrorIconForeground, problemsInfoIconForeground, problemsWarningIconForeground } from '../../theme/common/colorRegistry.js';\r\nexport var SeverityIcon;\r\n(function (SeverityIcon) {\r\n    function className(severity) {\r\n        switch (severity) {\r\n            case Severity.Ignore:\r\n                return 'severity-ignore codicon-info';\r\n            case Severity.Info:\r\n                return 'codicon-info';\r\n            case Severity.Warning:\r\n                return 'codicon-warning';\r\n            case Severity.Error:\r\n                return 'codicon-error';\r\n        }\r\n        return '';\r\n    }\r\n    SeverityIcon.className = className;\r\n})(SeverityIcon || (SeverityIcon = {}));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var errorIconForeground = theme.getColor(problemsErrorIconForeground);\r\n    if (errorIconForeground) {\r\n        collector.addRule(\"\\n\\t\\t\\t.monaco-editor .zone-widget .codicon-error,\\n\\t\\t\\t.monaco-workbench .markers-panel .marker-icon.codicon-error,\\n\\t\\t\\t.monaco-workbench .extensions-viewlet > .extensions .codicon-error,\\n\\t\\t\\t.monaco-workbench .dialog-box .dialog-message-row .codicon-error {\\n\\t\\t\\t\\tcolor: \" + errorIconForeground + \";\\n\\t\\t\\t}\\n\\t\\t\");\r\n    }\r\n    var warningIconForeground = theme.getColor(problemsWarningIconForeground);\r\n    if (errorIconForeground) {\r\n        collector.addRule(\"\\n\\t\\t\\t.monaco-editor .zone-widget .codicon-warning,\\n\\t\\t\\t.monaco-workbench .markers-panel .marker-icon.codicon-warning,\\n\\t\\t\\t.monaco-workbench .extensions-viewlet > .extensions .codicon-warning,\\n\\t\\t\\t.monaco-workbench .extension-editor .codicon-warning,\\n\\t\\t\\t.monaco-workbench .dialog-box .dialog-message-row .codicon-warning {\\n\\t\\t\\t\\tcolor: \" + warningIconForeground + \";\\n\\t\\t\\t}\\n\\t\\t\");\r\n    }\r\n    var infoIconForeground = theme.getColor(problemsInfoIconForeground);\r\n    if (errorIconForeground) {\r\n        collector.addRule(\"\\n\\t\\t\\t.monaco-editor .zone-widget .codicon-info,\\n\\t\\t\\t.monaco-workbench .markers-panel .marker-icon.codicon-info,\\n\\t\\t\\t.monaco-workbench .extensions-viewlet > .extensions .codicon-info,\\n\\t\\t\\t.monaco-workbench .extension-editor .codicon-info,\\n\\t\\t\\t.monaco-workbench .dialog-box .dialog-message-row .codicon-info {\\n\\t\\t\\t\\tcolor: \" + infoIconForeground + \";\\n\\t\\t\\t}\\n\\t\\t\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './media/gotoErrorWidget.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerColor, oneOf, textLinkForeground, editorErrorForeground, editorErrorBorder, editorWarningForeground, editorWarningBorder, editorInfoForeground, editorInfoBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { ScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { getBaseLabel, getPathLabel } from '../../../base/common/labels.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { PeekViewWidget, peekViewTitleForeground, peekViewTitleInfoForeground } from '../peekView/peekView.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { SeverityIcon } from '../../../platform/severityIcon/common/severityIcon.js';\r\nvar MessageWidget = /** @class */ (function () {\r\n    function MessageWidget(parent, editor, onRelatedInformation) {\r\n        var _this = this;\r\n        this._lines = 0;\r\n        this._longestLineLength = 0;\r\n        this._relatedDiagnostics = new WeakMap();\r\n        this._disposables = new DisposableStore();\r\n        this._editor = editor;\r\n        var domNode = document.createElement('div');\r\n        domNode.className = 'descriptioncontainer';\r\n        domNode.setAttribute('aria-live', 'assertive');\r\n        domNode.setAttribute('role', 'alert');\r\n        this._messageBlock = document.createElement('div');\r\n        dom.addClass(this._messageBlock, 'message');\r\n        domNode.appendChild(this._messageBlock);\r\n        this._relatedBlock = document.createElement('div');\r\n        domNode.appendChild(this._relatedBlock);\r\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', function (event) {\r\n            event.preventDefault();\r\n            var related = _this._relatedDiagnostics.get(event.target);\r\n            if (related) {\r\n                onRelatedInformation(related);\r\n            }\r\n        }));\r\n        this._scrollable = new ScrollableElement(domNode, {\r\n            horizontal: 1 /* Auto */,\r\n            vertical: 1 /* Auto */,\r\n            useShadows: false,\r\n            horizontalScrollbarSize: 3,\r\n            verticalScrollbarSize: 3\r\n        });\r\n        parent.appendChild(this._scrollable.getDomNode());\r\n        this._disposables.add(this._scrollable.onScroll(function (e) {\r\n            domNode.style.left = \"-\" + e.scrollLeft + \"px\";\r\n            domNode.style.top = \"-\" + e.scrollTop + \"px\";\r\n        }));\r\n        this._disposables.add(this._scrollable);\r\n    }\r\n    MessageWidget.prototype.dispose = function () {\r\n        dispose(this._disposables);\r\n    };\r\n    MessageWidget.prototype.update = function (_a) {\r\n        var source = _a.source, message = _a.message, relatedInformation = _a.relatedInformation, code = _a.code;\r\n        var lines = message.split(/\\r\\n|\\r|\\n/g);\r\n        this._lines = lines.length;\r\n        this._longestLineLength = 0;\r\n        for (var _i = 0, lines_1 = lines; _i < lines_1.length; _i++) {\r\n            var line = lines_1[_i];\r\n            this._longestLineLength = Math.max(line.length, this._longestLineLength);\r\n        }\r\n        dom.clearNode(this._messageBlock);\r\n        this._editor.applyFontInfo(this._messageBlock);\r\n        var lastLineElement = this._messageBlock;\r\n        for (var _b = 0, lines_2 = lines; _b < lines_2.length; _b++) {\r\n            var line = lines_2[_b];\r\n            lastLineElement = document.createElement('div');\r\n            lastLineElement.innerText = line;\r\n            if (line === '') {\r\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\r\n            }\r\n            this._messageBlock.appendChild(lastLineElement);\r\n        }\r\n        if (source || code) {\r\n            var detailsElement = document.createElement('span');\r\n            dom.addClass(detailsElement, 'details');\r\n            lastLineElement.appendChild(detailsElement);\r\n            if (source) {\r\n                var sourceElement = document.createElement('span');\r\n                sourceElement.innerText = source;\r\n                dom.addClass(sourceElement, 'source');\r\n                detailsElement.appendChild(sourceElement);\r\n            }\r\n            if (code) {\r\n                var codeElement = document.createElement('span');\r\n                codeElement.innerText = \"(\" + code + \")\";\r\n                dom.addClass(codeElement, 'code');\r\n                detailsElement.appendChild(codeElement);\r\n            }\r\n        }\r\n        dom.clearNode(this._relatedBlock);\r\n        this._editor.applyFontInfo(this._relatedBlock);\r\n        if (isNonEmptyArray(relatedInformation)) {\r\n            var relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\r\n            relatedInformationNode.style.paddingTop = Math.floor(this._editor.getOption(47 /* lineHeight */) * 0.66) + \"px\";\r\n            this._lines += 1;\r\n            for (var _c = 0, relatedInformation_1 = relatedInformation; _c < relatedInformation_1.length; _c++) {\r\n                var related = relatedInformation_1[_c];\r\n                var container = document.createElement('div');\r\n                var relatedResource = document.createElement('a');\r\n                dom.addClass(relatedResource, 'filename');\r\n                relatedResource.innerHTML = getBaseLabel(related.resource) + \"(\" + related.startLineNumber + \", \" + related.startColumn + \"): \";\r\n                relatedResource.title = getPathLabel(related.resource, undefined);\r\n                this._relatedDiagnostics.set(relatedResource, related);\r\n                var relatedMessage = document.createElement('span');\r\n                relatedMessage.innerText = related.message;\r\n                container.appendChild(relatedResource);\r\n                container.appendChild(relatedMessage);\r\n                this._lines += 1;\r\n                relatedInformationNode.appendChild(container);\r\n            }\r\n        }\r\n        var fontInfo = this._editor.getOption(32 /* fontInfo */);\r\n        var scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\r\n        var scrollHeight = fontInfo.lineHeight * this._lines;\r\n        this._scrollable.setScrollDimensions({ scrollWidth: scrollWidth, scrollHeight: scrollHeight });\r\n    };\r\n    MessageWidget.prototype.layout = function (height, width) {\r\n        this._scrollable.getDomNode().style.height = height + \"px\";\r\n        this._scrollable.getDomNode().style.width = width + \"px\";\r\n        this._scrollable.setScrollDimensions({ width: width, height: height });\r\n    };\r\n    MessageWidget.prototype.getHeightInLines = function () {\r\n        return Math.min(17, this._lines);\r\n    };\r\n    return MessageWidget;\r\n}());\r\nvar MarkerNavigationWidget = /** @class */ (function (_super) {\r\n    __extends(MarkerNavigationWidget, _super);\r\n    function MarkerNavigationWidget(editor, actions, _themeService) {\r\n        var _this = _super.call(this, editor, { showArrow: true, showFrame: true, isAccessible: true }) || this;\r\n        _this.actions = actions;\r\n        _this._themeService = _themeService;\r\n        _this._callOnDispose = new DisposableStore();\r\n        _this._onDidSelectRelatedInformation = new Emitter();\r\n        _this.onDidSelectRelatedInformation = _this._onDidSelectRelatedInformation.event;\r\n        _this._severity = MarkerSeverity.Warning;\r\n        _this._backgroundColor = Color.white;\r\n        _this._applyTheme(_themeService.getTheme());\r\n        _this._callOnDispose.add(_themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        _this.create();\r\n        return _this;\r\n    }\r\n    MarkerNavigationWidget.prototype._applyTheme = function (theme) {\r\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\r\n        var colorId = editorMarkerNavigationError;\r\n        if (this._severity === MarkerSeverity.Warning) {\r\n            colorId = editorMarkerNavigationWarning;\r\n        }\r\n        else if (this._severity === MarkerSeverity.Info) {\r\n            colorId = editorMarkerNavigationInfo;\r\n        }\r\n        var frameColor = theme.getColor(colorId);\r\n        this.style({\r\n            arrowColor: frameColor,\r\n            frameColor: frameColor,\r\n            headerBackgroundColor: this._backgroundColor,\r\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\r\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\r\n        }); // style() will trigger _applyStyles\r\n    };\r\n    MarkerNavigationWidget.prototype._applyStyles = function () {\r\n        if (this._parentContainer) {\r\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\r\n        }\r\n        _super.prototype._applyStyles.call(this);\r\n    };\r\n    MarkerNavigationWidget.prototype.dispose = function () {\r\n        this._callOnDispose.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    MarkerNavigationWidget.prototype._fillHead = function (container) {\r\n        _super.prototype._fillHead.call(this, container);\r\n        this._actionbarWidget.push(this.actions, { label: false, icon: true });\r\n    };\r\n    MarkerNavigationWidget.prototype._fillTitleIcon = function (container) {\r\n        this._icon = dom.append(container, dom.$(''));\r\n    };\r\n    MarkerNavigationWidget.prototype._getActionBarOptions = function () {\r\n        return {\r\n            orientation: 1 /* HORIZONTAL_REVERSE */\r\n        };\r\n    };\r\n    MarkerNavigationWidget.prototype._fillBody = function (container) {\r\n        var _this = this;\r\n        this._parentContainer = container;\r\n        dom.addClass(container, 'marker-widget');\r\n        this._parentContainer.tabIndex = 0;\r\n        this._parentContainer.setAttribute('role', 'tooltip');\r\n        this._container = document.createElement('div');\r\n        container.appendChild(this._container);\r\n        this._message = new MessageWidget(this._container, this.editor, function (related) { return _this._onDidSelectRelatedInformation.fire(related); });\r\n        this._disposables.add(this._message);\r\n    };\r\n    MarkerNavigationWidget.prototype.show = function (where, heightInLines) {\r\n        throw new Error('call showAtMarker');\r\n    };\r\n    MarkerNavigationWidget.prototype.showAtMarker = function (marker, markerIdx, markerCount) {\r\n        // update:\r\n        // * title\r\n        // * message\r\n        this._container.classList.remove('stale');\r\n        this._message.update(marker);\r\n        // update frame color (only applied on 'show')\r\n        this._severity = marker.severity;\r\n        this._applyTheme(this._themeService.getTheme());\r\n        // show\r\n        var range = Range.lift(marker);\r\n        var editorPosition = this.editor.getPosition();\r\n        var position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\r\n        _super.prototype.show.call(this, position, this.computeRequiredHeight());\r\n        var model = this.editor.getModel();\r\n        if (model) {\r\n            var detail = markerCount > 1\r\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\r\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\r\n            this.setTitle(basename(model.uri), detail);\r\n        }\r\n        this._icon.className = \"codicon \" + SeverityIcon.className(MarkerSeverity.toSeverity(this._severity));\r\n        this.editor.revealPositionInCenter(position, 0 /* Smooth */);\r\n    };\r\n    MarkerNavigationWidget.prototype.updateMarker = function (marker) {\r\n        this._container.classList.remove('stale');\r\n        this._message.update(marker);\r\n    };\r\n    MarkerNavigationWidget.prototype.showStale = function () {\r\n        this._container.classList.add('stale');\r\n        this._relayout();\r\n    };\r\n    MarkerNavigationWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\r\n        _super.prototype._doLayoutBody.call(this, heightInPixel, widthInPixel);\r\n        this._heightInPixel = heightInPixel;\r\n        this._message.layout(heightInPixel, widthInPixel);\r\n        this._container.style.height = heightInPixel + \"px\";\r\n    };\r\n    MarkerNavigationWidget.prototype._onWidth = function (widthInPixel) {\r\n        this._message.layout(this._heightInPixel, widthInPixel);\r\n    };\r\n    MarkerNavigationWidget.prototype._relayout = function () {\r\n        _super.prototype._relayout.call(this, this.computeRequiredHeight());\r\n    };\r\n    MarkerNavigationWidget.prototype.computeRequiredHeight = function () {\r\n        return 3 + this._message.getHeightInLines();\r\n    };\r\n    return MarkerNavigationWidget;\r\n}(PeekViewWidget));\r\nexport { MarkerNavigationWidget };\r\n// theming\r\nvar errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\r\nvar warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\r\nvar infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\r\nexport var editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hc: errorDefault }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\r\nexport var editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hc: warningDefault }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\r\nexport var editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hc: infoDefault }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\r\nexport var editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: '#2D2D30', light: Color.white, hc: '#0C141F' }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(\".monaco-editor .marker-widget a { color: \" + link + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\r\nimport { compare } from '../../../base/common/strings.js';\r\nimport { binarySearch, find } from '../../../base/common/arrays.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nvar MarkerModel = /** @class */ (function () {\r\n    function MarkerModel(editor, markers) {\r\n        var _this = this;\r\n        this._toUnbind = new DisposableStore();\r\n        this._editor = editor;\r\n        this._markers = [];\r\n        this._nextIdx = -1;\r\n        this._ignoreSelectionChange = false;\r\n        this._onCurrentMarkerChanged = new Emitter();\r\n        this._onMarkerSetChanged = new Emitter();\r\n        this.setMarkers(markers);\r\n        // listen on editor\r\n        this._toUnbind.add(this._editor.onDidDispose(function () { return _this.dispose(); }));\r\n        this._toUnbind.add(this._editor.onDidChangeCursorPosition(function () {\r\n            if (_this._ignoreSelectionChange) {\r\n                return;\r\n            }\r\n            if (_this.currentMarker && _this._editor.getPosition() && Range.containsPosition(_this.currentMarker, _this._editor.getPosition())) {\r\n                return;\r\n            }\r\n            _this._nextIdx = -1;\r\n        }));\r\n    }\r\n    Object.defineProperty(MarkerModel.prototype, \"onCurrentMarkerChanged\", {\r\n        get: function () {\r\n            return this._onCurrentMarkerChanged.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MarkerModel.prototype, \"onMarkerSetChanged\", {\r\n        get: function () {\r\n            return this._onMarkerSetChanged.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.setMarkers = function (markers) {\r\n        var oldMarker = this._nextIdx >= 0 ? this._markers[this._nextIdx] : undefined;\r\n        this._markers = markers || [];\r\n        this._markers.sort(MarkerNavigationAction.compareMarker);\r\n        if (!oldMarker) {\r\n            this._nextIdx = -1;\r\n        }\r\n        else {\r\n            this._nextIdx = Math.max(-1, binarySearch(this._markers, oldMarker, MarkerNavigationAction.compareMarker));\r\n        }\r\n        this._onMarkerSetChanged.fire(this);\r\n    };\r\n    MarkerModel.prototype.withoutWatchingEditorPosition = function (callback) {\r\n        this._ignoreSelectionChange = true;\r\n        try {\r\n            callback();\r\n        }\r\n        finally {\r\n            this._ignoreSelectionChange = false;\r\n        }\r\n    };\r\n    MarkerModel.prototype._initIdx = function (fwd) {\r\n        var found = false;\r\n        var position = this._editor.getPosition();\r\n        for (var i = 0; i < this._markers.length; i++) {\r\n            var range = Range.lift(this._markers[i]);\r\n            if (range.isEmpty() && this._editor.getModel()) {\r\n                var word = this._editor.getModel().getWordAtPosition(range.getStartPosition());\r\n                if (word) {\r\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\r\n                }\r\n            }\r\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\r\n                this._nextIdx = i;\r\n                found = true;\r\n                break;\r\n            }\r\n        }\r\n        if (!found) {\r\n            // after the last change\r\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\r\n        }\r\n        if (this._nextIdx < 0) {\r\n            this._nextIdx = this._markers.length - 1;\r\n        }\r\n    };\r\n    Object.defineProperty(MarkerModel.prototype, \"currentMarker\", {\r\n        get: function () {\r\n            return this.canNavigate() ? this._markers[this._nextIdx] : undefined;\r\n        },\r\n        set: function (marker) {\r\n            var idx = this._nextIdx;\r\n            this._nextIdx = -1;\r\n            if (marker) {\r\n                this._nextIdx = this.indexOf(marker);\r\n            }\r\n            if (this._nextIdx !== idx) {\r\n                this._onCurrentMarkerChanged.fire(marker);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.move = function (fwd, inCircles) {\r\n        if (!this.canNavigate()) {\r\n            this._onCurrentMarkerChanged.fire(undefined);\r\n            return !inCircles;\r\n        }\r\n        var oldIdx = this._nextIdx;\r\n        var atEdge = false;\r\n        if (this._nextIdx === -1) {\r\n            this._initIdx(fwd);\r\n        }\r\n        else if (fwd) {\r\n            if (inCircles || this._nextIdx + 1 < this._markers.length) {\r\n                this._nextIdx = (this._nextIdx + 1) % this._markers.length;\r\n            }\r\n            else {\r\n                atEdge = true;\r\n            }\r\n        }\r\n        else if (!fwd) {\r\n            if (inCircles || this._nextIdx > 0) {\r\n                this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\r\n            }\r\n            else {\r\n                atEdge = true;\r\n            }\r\n        }\r\n        if (oldIdx !== this._nextIdx) {\r\n            var marker = this._markers[this._nextIdx];\r\n            this._onCurrentMarkerChanged.fire(marker);\r\n        }\r\n        return atEdge;\r\n    };\r\n    MarkerModel.prototype.canNavigate = function () {\r\n        return this._markers.length > 0;\r\n    };\r\n    MarkerModel.prototype.findMarkerAtPosition = function (pos) {\r\n        return find(this._markers, function (marker) { return Range.containsPosition(marker, pos); });\r\n    };\r\n    Object.defineProperty(MarkerModel.prototype, \"total\", {\r\n        get: function () {\r\n            return this._markers.length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.indexOf = function (marker) {\r\n        return 1 + this._markers.indexOf(marker);\r\n    };\r\n    MarkerModel.prototype.dispose = function () {\r\n        this._toUnbind.dispose();\r\n    };\r\n    return MarkerModel;\r\n}());\r\nvar MarkerController = /** @class */ (function () {\r\n    function MarkerController(editor, _markerService, _contextKeyService, _themeService, _editorService, _keybindingService) {\r\n        this._markerService = _markerService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._themeService = _themeService;\r\n        this._editorService = _editorService;\r\n        this._keybindingService = _keybindingService;\r\n        this._model = null;\r\n        this._widget = null;\r\n        this._disposeOnClose = new DisposableStore();\r\n        this._editor = editor;\r\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\r\n    }\r\n    MarkerController.get = function (editor) {\r\n        return editor.getContribution(MarkerController.ID);\r\n    };\r\n    MarkerController.prototype.dispose = function () {\r\n        this._cleanUp();\r\n        this._disposeOnClose.dispose();\r\n    };\r\n    MarkerController.prototype._cleanUp = function () {\r\n        this._widgetVisible.reset();\r\n        this._disposeOnClose.clear();\r\n        this._widget = null;\r\n        this._model = null;\r\n    };\r\n    MarkerController.prototype.getOrCreateModel = function () {\r\n        var _this = this;\r\n        if (this._model) {\r\n            return this._model;\r\n        }\r\n        var markers = this._getMarkers();\r\n        this._model = new MarkerModel(this._editor, markers);\r\n        this._markerService.onMarkerChanged(this._onMarkerChanged, this, this._disposeOnClose);\r\n        var prevMarkerKeybinding = this._keybindingService.lookupKeybinding(PrevMarkerAction.ID);\r\n        var nextMarkerKeybinding = this._keybindingService.lookupKeybinding(NextMarkerAction.ID);\r\n        var actions = [\r\n            new Action(PrevMarkerAction.ID, PrevMarkerAction.LABEL + (prevMarkerKeybinding ? \" (\" + prevMarkerKeybinding.getLabel() + \")\" : ''), 'show-previous-problem codicon-chevron-up', this._model.canNavigate(), function () { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                if (this._model) {\r\n                    this._model.move(false, true);\r\n                }\r\n                return [2 /*return*/];\r\n            }); }); }),\r\n            new Action(NextMarkerAction.ID, NextMarkerAction.LABEL + (nextMarkerKeybinding ? \" (\" + nextMarkerKeybinding.getLabel() + \")\" : ''), 'show-next-problem codicon-chevron-down', this._model.canNavigate(), function () { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                if (this._model) {\r\n                    this._model.move(true, true);\r\n                }\r\n                return [2 /*return*/];\r\n            }); }); })\r\n        ];\r\n        this._widget = new MarkerNavigationWidget(this._editor, actions, this._themeService);\r\n        this._widgetVisible.set(true);\r\n        this._widget.onDidClose(function () { return _this.closeMarkersNavigation(); }, this, this._disposeOnClose);\r\n        this._disposeOnClose.add(this._model);\r\n        this._disposeOnClose.add(this._widget);\r\n        for (var _i = 0, actions_1 = actions; _i < actions_1.length; _i++) {\r\n            var action = actions_1[_i];\r\n            this._disposeOnClose.add(action);\r\n        }\r\n        this._disposeOnClose.add(this._widget.onDidSelectRelatedInformation(function (related) {\r\n            _this._editorService.openCodeEditor({\r\n                resource: related.resource,\r\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\r\n            }, _this._editor).then(undefined, onUnexpectedError);\r\n            _this.closeMarkersNavigation(false);\r\n        }));\r\n        this._disposeOnClose.add(this._editor.onDidChangeModel(function () { return _this._cleanUp(); }));\r\n        this._disposeOnClose.add(this._model.onCurrentMarkerChanged(function (marker) {\r\n            if (!marker || !_this._model) {\r\n                _this._cleanUp();\r\n            }\r\n            else {\r\n                _this._model.withoutWatchingEditorPosition(function () {\r\n                    if (!_this._widget || !_this._model) {\r\n                        return;\r\n                    }\r\n                    _this._widget.showAtMarker(marker, _this._model.indexOf(marker), _this._model.total);\r\n                });\r\n            }\r\n        }));\r\n        this._disposeOnClose.add(this._model.onMarkerSetChanged(function () {\r\n            if (!_this._widget || !_this._widget.position || !_this._model) {\r\n                return;\r\n            }\r\n            var marker = _this._model.findMarkerAtPosition(_this._widget.position);\r\n            if (marker) {\r\n                _this._widget.updateMarker(marker);\r\n            }\r\n            else {\r\n                _this._widget.showStale();\r\n            }\r\n        }));\r\n        return this._model;\r\n    };\r\n    MarkerController.prototype.closeMarkersNavigation = function (focusEditor) {\r\n        if (focusEditor === void 0) { focusEditor = true; }\r\n        this._cleanUp();\r\n        if (focusEditor) {\r\n            this._editor.focus();\r\n        }\r\n    };\r\n    MarkerController.prototype.show = function (marker) {\r\n        var model = this.getOrCreateModel();\r\n        model.currentMarker = marker;\r\n    };\r\n    MarkerController.prototype._onMarkerChanged = function (changedResources) {\r\n        var editorModel = this._editor.getModel();\r\n        if (!editorModel) {\r\n            return;\r\n        }\r\n        if (!this._model) {\r\n            return;\r\n        }\r\n        if (!changedResources.some(function (r) { return isEqual(editorModel.uri, r); })) {\r\n            return;\r\n        }\r\n        this._model.setMarkers(this._getMarkers());\r\n    };\r\n    MarkerController.prototype._getMarkers = function () {\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return [];\r\n        }\r\n        return this._markerService.read({\r\n            resource: model.uri,\r\n            severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\r\n        });\r\n    };\r\n    MarkerController.ID = 'editor.contrib.markerController';\r\n    MarkerController = __decorate([\r\n        __param(1, IMarkerService),\r\n        __param(2, IContextKeyService),\r\n        __param(3, IThemeService),\r\n        __param(4, ICodeEditorService),\r\n        __param(5, IKeybindingService)\r\n    ], MarkerController);\r\n    return MarkerController;\r\n}());\r\nexport { MarkerController };\r\nvar MarkerNavigationAction = /** @class */ (function (_super) {\r\n    __extends(MarkerNavigationAction, _super);\r\n    function MarkerNavigationAction(next, multiFile, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._isNext = next;\r\n        _this._multiFile = multiFile;\r\n        return _this;\r\n    }\r\n    MarkerNavigationAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        var markerService = accessor.get(IMarkerService);\r\n        var editorService = accessor.get(ICodeEditorService);\r\n        var controller = MarkerController.get(editor);\r\n        if (!controller) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var model = controller.getOrCreateModel();\r\n        var atEdge = model.move(this._isNext, !this._multiFile);\r\n        if (!atEdge || !this._multiFile) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        // try with the next/prev file\r\n        var markers = markerService.read({ severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info }).sort(MarkerNavigationAction.compareMarker);\r\n        if (markers.length === 0) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var editorModel = editor.getModel();\r\n        if (!editorModel) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var oldMarker = model.currentMarker || { resource: editorModel.uri, severity: MarkerSeverity.Error, startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 };\r\n        var idx = binarySearch(markers, oldMarker, MarkerNavigationAction.compareMarker);\r\n        if (idx < 0) {\r\n            // find best match...\r\n            idx = ~idx;\r\n            idx %= markers.length;\r\n        }\r\n        else if (this._isNext) {\r\n            idx = (idx + 1) % markers.length;\r\n        }\r\n        else {\r\n            idx = (idx + markers.length - 1) % markers.length;\r\n        }\r\n        var newMarker = markers[idx];\r\n        if (isEqual(newMarker.resource, editorModel.uri)) {\r\n            // the next `resource` is this resource which\r\n            // means we cycle within this file\r\n            model.move(this._isNext, true);\r\n            return Promise.resolve(undefined);\r\n        }\r\n        // close the widget for this editor-instance, open the resource\r\n        // for the next marker and re-start marker navigation in there\r\n        controller.closeMarkersNavigation();\r\n        return editorService.openCodeEditor({\r\n            resource: newMarker.resource,\r\n            options: { pinned: false, revealIfOpened: true, revealInCenterIfOutsideViewport: true, selection: newMarker }\r\n        }, editor).then(function (editor) {\r\n            if (!editor) {\r\n                return undefined;\r\n            }\r\n            return editor.getAction(_this.id).run();\r\n        });\r\n    };\r\n    MarkerNavigationAction.compareMarker = function (a, b) {\r\n        var res = compare(a.resource.toString(), b.resource.toString());\r\n        if (res === 0) {\r\n            res = MarkerSeverity.compare(a.severity, b.severity);\r\n        }\r\n        if (res === 0) {\r\n            res = Range.compareRangesUsingStarts(a, b);\r\n        }\r\n        return res;\r\n    };\r\n    return MarkerNavigationAction;\r\n}(EditorAction));\r\nvar NextMarkerAction = /** @class */ (function (_super) {\r\n    __extends(NextMarkerAction, _super);\r\n    function NextMarkerAction() {\r\n        return _super.call(this, true, false, {\r\n            id: NextMarkerAction.ID,\r\n            label: NextMarkerAction.LABEL,\r\n            alias: 'Go to Next Problem (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: { kbExpr: EditorContextKeys.editorTextFocus, primary: 512 /* Alt */ | 66 /* F8 */, weight: 100 /* EditorContrib */ }\r\n        }) || this;\r\n    }\r\n    NextMarkerAction.ID = 'editor.action.marker.next';\r\n    NextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\r\n    return NextMarkerAction;\r\n}(MarkerNavigationAction));\r\nexport { NextMarkerAction };\r\nvar PrevMarkerAction = /** @class */ (function (_super) {\r\n    __extends(PrevMarkerAction, _super);\r\n    function PrevMarkerAction() {\r\n        return _super.call(this, false, false, {\r\n            id: PrevMarkerAction.ID,\r\n            label: PrevMarkerAction.LABEL,\r\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: { kbExpr: EditorContextKeys.editorTextFocus, primary: 1024 /* Shift */ | 512 /* Alt */ | 66 /* F8 */, weight: 100 /* EditorContrib */ }\r\n        }) || this;\r\n    }\r\n    PrevMarkerAction.ID = 'editor.action.marker.prev';\r\n    PrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\r\n    return PrevMarkerAction;\r\n}(MarkerNavigationAction));\r\nvar NextMarkerInFilesAction = /** @class */ (function (_super) {\r\n    __extends(NextMarkerInFilesAction, _super);\r\n    function NextMarkerInFilesAction() {\r\n        return _super.call(this, true, true, {\r\n            id: 'editor.action.marker.nextInFiles',\r\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\r\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return NextMarkerInFilesAction;\r\n}(MarkerNavigationAction));\r\nvar PrevMarkerInFilesAction = /** @class */ (function (_super) {\r\n    __extends(PrevMarkerInFilesAction, _super);\r\n    function PrevMarkerInFilesAction() {\r\n        return _super.call(this, false, true, {\r\n            id: 'editor.action.marker.prevInFiles',\r\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\r\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 1024 /* Shift */ | 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return PrevMarkerInFilesAction;\r\n}(MarkerNavigationAction));\r\nregisterEditorContribution(MarkerController.ID, MarkerController);\r\nregisterEditorAction(NextMarkerAction);\r\nregisterEditorAction(PrevMarkerAction);\r\nregisterEditorAction(NextMarkerInFilesAction);\r\nregisterEditorAction(PrevMarkerInFilesAction);\r\nvar CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\r\nvar MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\r\nregisterEditorCommand(new MarkerCommand({\r\n    id: 'closeMarkersNavigation',\r\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\r\n    handler: function (x) { return x.closeMarkersNavigation(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 50,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\n// Go to menu\r\nMenuRegistry.appendMenuItem(17 /* MenubarGoMenu */, {\r\n    group: '6_problem_nav',\r\n    command: {\r\n        id: 'editor.action.marker.nextInFiles',\r\n        title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\")\r\n    },\r\n    order: 1\r\n});\r\nMenuRegistry.appendMenuItem(17 /* MenubarGoMenu */, {\r\n    group: '6_problem_nav',\r\n    command: {\r\n        id: 'editor.action.marker.prevInFiles',\r\n        title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\")\r\n    },\r\n    order: 2\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nvar ColorPickerModel = /** @class */ (function () {\r\n    function ColorPickerModel(color, availableColorPresentations, presentationIndex) {\r\n        this.presentationIndex = presentationIndex;\r\n        this._onColorFlushed = new Emitter();\r\n        this.onColorFlushed = this._onColorFlushed.event;\r\n        this._onDidChangeColor = new Emitter();\r\n        this.onDidChangeColor = this._onDidChangeColor.event;\r\n        this._onDidChangePresentation = new Emitter();\r\n        this.onDidChangePresentation = this._onDidChangePresentation.event;\r\n        this.originalColor = color;\r\n        this._color = color;\r\n        this._colorPresentations = availableColorPresentations;\r\n    }\r\n    Object.defineProperty(ColorPickerModel.prototype, \"color\", {\r\n        get: function () {\r\n            return this._color;\r\n        },\r\n        set: function (color) {\r\n            if (this._color.equals(color)) {\r\n                return;\r\n            }\r\n            this._color = color;\r\n            this._onDidChangeColor.fire(color);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ColorPickerModel.prototype, \"presentation\", {\r\n        get: function () { return this.colorPresentations[this.presentationIndex]; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ColorPickerModel.prototype, \"colorPresentations\", {\r\n        get: function () {\r\n            return this._colorPresentations;\r\n        },\r\n        set: function (colorPresentations) {\r\n            this._colorPresentations = colorPresentations;\r\n            if (this.presentationIndex > colorPresentations.length - 1) {\r\n                this.presentationIndex = 0;\r\n            }\r\n            this._onDidChangePresentation.fire(this.presentation);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ColorPickerModel.prototype.selectNextColorPresentation = function () {\r\n        this.presentationIndex = (this.presentationIndex + 1) % this.colorPresentations.length;\r\n        this.flushColor();\r\n        this._onDidChangePresentation.fire(this.presentation);\r\n    };\r\n    ColorPickerModel.prototype.guessColorPresentation = function (color, originalText) {\r\n        for (var i = 0; i < this.colorPresentations.length; i++) {\r\n            if (originalText === this.colorPresentations[i].label) {\r\n                this.presentationIndex = i;\r\n                this._onDidChangePresentation.fire(this.presentation);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    ColorPickerModel.prototype.flushColor = function () {\r\n        this._onColorFlushed.fire(this._color);\r\n    };\r\n    return ColorPickerModel;\r\n}());\r\nexport { ColorPickerModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './colorPicker.css';\r\nimport { onDidChangeZoomLevel } from '../../../base/browser/browser.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { GlobalMouseMoveMonitor, standardMouseMoveMerger } from '../../../base/browser/globalMouseMoveMonitor.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nimport { Color, HSVA, RGBA } from '../../../base/common/color.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { editorHoverBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nvar $ = dom.$;\r\nvar ColorPickerHeader = /** @class */ (function (_super) {\r\n    __extends(ColorPickerHeader, _super);\r\n    function ColorPickerHeader(container, model, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = model;\r\n        _this.domNode = $('.colorpicker-header');\r\n        dom.append(container, _this.domNode);\r\n        _this.pickedColorNode = dom.append(_this.domNode, $('.picked-color'));\r\n        var colorBox = dom.append(_this.domNode, $('.original-color'));\r\n        colorBox.style.backgroundColor = Color.Format.CSS.format(_this.model.originalColor) || '';\r\n        _this.backgroundColor = themeService.getTheme().getColor(editorHoverBackground) || Color.white;\r\n        _this._register(registerThemingParticipant(function (theme, collector) {\r\n            _this.backgroundColor = theme.getColor(editorHoverBackground) || Color.white;\r\n        }));\r\n        _this._register(dom.addDisposableListener(_this.pickedColorNode, dom.EventType.CLICK, function () { return _this.model.selectNextColorPresentation(); }));\r\n        _this._register(dom.addDisposableListener(colorBox, dom.EventType.CLICK, function () {\r\n            _this.model.color = _this.model.originalColor;\r\n            _this.model.flushColor();\r\n        }));\r\n        _this._register(model.onDidChangeColor(_this.onDidChangeColor, _this));\r\n        _this._register(model.onDidChangePresentation(_this.onDidChangePresentation, _this));\r\n        _this.pickedColorNode.style.backgroundColor = Color.Format.CSS.format(model.color) || '';\r\n        dom.toggleClass(_this.pickedColorNode, 'light', model.color.rgba.a < 0.5 ? _this.backgroundColor.isLighter() : model.color.isLighter());\r\n        return _this;\r\n    }\r\n    ColorPickerHeader.prototype.onDidChangeColor = function (color) {\r\n        this.pickedColorNode.style.backgroundColor = Color.Format.CSS.format(color) || '';\r\n        dom.toggleClass(this.pickedColorNode, 'light', color.rgba.a < 0.5 ? this.backgroundColor.isLighter() : color.isLighter());\r\n        this.onDidChangePresentation();\r\n    };\r\n    ColorPickerHeader.prototype.onDidChangePresentation = function () {\r\n        this.pickedColorNode.textContent = this.model.presentation ? this.model.presentation.label : '';\r\n    };\r\n    return ColorPickerHeader;\r\n}(Disposable));\r\nexport { ColorPickerHeader };\r\nvar ColorPickerBody = /** @class */ (function (_super) {\r\n    __extends(ColorPickerBody, _super);\r\n    function ColorPickerBody(container, model, pixelRatio) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = model;\r\n        _this.pixelRatio = pixelRatio;\r\n        _this.domNode = $('.colorpicker-body');\r\n        dom.append(container, _this.domNode);\r\n        _this.saturationBox = new SaturationBox(_this.domNode, _this.model, _this.pixelRatio);\r\n        _this._register(_this.saturationBox);\r\n        _this._register(_this.saturationBox.onDidChange(_this.onDidSaturationValueChange, _this));\r\n        _this._register(_this.saturationBox.onColorFlushed(_this.flushColor, _this));\r\n        _this.opacityStrip = new OpacityStrip(_this.domNode, _this.model);\r\n        _this._register(_this.opacityStrip);\r\n        _this._register(_this.opacityStrip.onDidChange(_this.onDidOpacityChange, _this));\r\n        _this._register(_this.opacityStrip.onColorFlushed(_this.flushColor, _this));\r\n        _this.hueStrip = new HueStrip(_this.domNode, _this.model);\r\n        _this._register(_this.hueStrip);\r\n        _this._register(_this.hueStrip.onDidChange(_this.onDidHueChange, _this));\r\n        _this._register(_this.hueStrip.onColorFlushed(_this.flushColor, _this));\r\n        return _this;\r\n    }\r\n    ColorPickerBody.prototype.flushColor = function () {\r\n        this.model.flushColor();\r\n    };\r\n    ColorPickerBody.prototype.onDidSaturationValueChange = function (_a) {\r\n        var s = _a.s, v = _a.v;\r\n        var hsva = this.model.color.hsva;\r\n        this.model.color = new Color(new HSVA(hsva.h, s, v, hsva.a));\r\n    };\r\n    ColorPickerBody.prototype.onDidOpacityChange = function (a) {\r\n        var hsva = this.model.color.hsva;\r\n        this.model.color = new Color(new HSVA(hsva.h, hsva.s, hsva.v, a));\r\n    };\r\n    ColorPickerBody.prototype.onDidHueChange = function (value) {\r\n        var hsva = this.model.color.hsva;\r\n        var h = (1 - value) * 360;\r\n        this.model.color = new Color(new HSVA(h === 360 ? 0 : h, hsva.s, hsva.v, hsva.a));\r\n    };\r\n    ColorPickerBody.prototype.layout = function () {\r\n        this.saturationBox.layout();\r\n        this.opacityStrip.layout();\r\n        this.hueStrip.layout();\r\n    };\r\n    return ColorPickerBody;\r\n}(Disposable));\r\nexport { ColorPickerBody };\r\nvar SaturationBox = /** @class */ (function (_super) {\r\n    __extends(SaturationBox, _super);\r\n    function SaturationBox(container, model, pixelRatio) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = model;\r\n        _this.pixelRatio = pixelRatio;\r\n        _this._onDidChange = new Emitter();\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._onColorFlushed = new Emitter();\r\n        _this.onColorFlushed = _this._onColorFlushed.event;\r\n        _this.domNode = $('.saturation-wrap');\r\n        dom.append(container, _this.domNode);\r\n        // Create canvas, draw selected color\r\n        _this.canvas = document.createElement('canvas');\r\n        _this.canvas.className = 'saturation-box';\r\n        dom.append(_this.domNode, _this.canvas);\r\n        // Add selection circle\r\n        _this.selection = $('.saturation-selection');\r\n        dom.append(_this.domNode, _this.selection);\r\n        _this.layout();\r\n        _this._register(dom.addDisposableGenericMouseDownListner(_this.domNode, function (e) { return _this.onMouseDown(e); }));\r\n        _this._register(_this.model.onDidChangeColor(_this.onDidChangeColor, _this));\r\n        _this.monitor = null;\r\n        return _this;\r\n    }\r\n    SaturationBox.prototype.onMouseDown = function (e) {\r\n        var _this = this;\r\n        this.monitor = this._register(new GlobalMouseMoveMonitor());\r\n        var origin = dom.getDomNodePagePosition(this.domNode);\r\n        if (e.target !== this.selection) {\r\n            this.onDidChangePosition(e.offsetX, e.offsetY);\r\n        }\r\n        this.monitor.startMonitoring(standardMouseMoveMerger, function (event) { return _this.onDidChangePosition(event.posx - origin.left, event.posy - origin.top); }, function () { return null; });\r\n        var mouseUpListener = dom.addDisposableGenericMouseUpListner(document, function () {\r\n            _this._onColorFlushed.fire();\r\n            mouseUpListener.dispose();\r\n            if (_this.monitor) {\r\n                _this.monitor.stopMonitoring(true);\r\n                _this.monitor = null;\r\n            }\r\n        }, true);\r\n    };\r\n    SaturationBox.prototype.onDidChangePosition = function (left, top) {\r\n        var s = Math.max(0, Math.min(1, left / this.width));\r\n        var v = Math.max(0, Math.min(1, 1 - (top / this.height)));\r\n        this.paintSelection(s, v);\r\n        this._onDidChange.fire({ s: s, v: v });\r\n    };\r\n    SaturationBox.prototype.layout = function () {\r\n        this.width = this.domNode.offsetWidth;\r\n        this.height = this.domNode.offsetHeight;\r\n        this.canvas.width = this.width * this.pixelRatio;\r\n        this.canvas.height = this.height * this.pixelRatio;\r\n        this.paint();\r\n        var hsva = this.model.color.hsva;\r\n        this.paintSelection(hsva.s, hsva.v);\r\n    };\r\n    SaturationBox.prototype.paint = function () {\r\n        var hsva = this.model.color.hsva;\r\n        var saturatedColor = new Color(new HSVA(hsva.h, 1, 1, 1));\r\n        var ctx = this.canvas.getContext('2d');\r\n        var whiteGradient = ctx.createLinearGradient(0, 0, this.canvas.width, 0);\r\n        whiteGradient.addColorStop(0, 'rgba(255, 255, 255, 1)');\r\n        whiteGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.5)');\r\n        whiteGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\r\n        var blackGradient = ctx.createLinearGradient(0, 0, 0, this.canvas.height);\r\n        blackGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');\r\n        blackGradient.addColorStop(1, 'rgba(0, 0, 0, 1)');\r\n        ctx.rect(0, 0, this.canvas.width, this.canvas.height);\r\n        ctx.fillStyle = Color.Format.CSS.format(saturatedColor);\r\n        ctx.fill();\r\n        ctx.fillStyle = whiteGradient;\r\n        ctx.fill();\r\n        ctx.fillStyle = blackGradient;\r\n        ctx.fill();\r\n    };\r\n    SaturationBox.prototype.paintSelection = function (s, v) {\r\n        this.selection.style.left = s * this.width + \"px\";\r\n        this.selection.style.top = this.height - v * this.height + \"px\";\r\n    };\r\n    SaturationBox.prototype.onDidChangeColor = function () {\r\n        if (this.monitor && this.monitor.isMonitoring()) {\r\n            return;\r\n        }\r\n        this.paint();\r\n    };\r\n    return SaturationBox;\r\n}(Disposable));\r\nvar Strip = /** @class */ (function (_super) {\r\n    __extends(Strip, _super);\r\n    function Strip(container, model) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = model;\r\n        _this._onDidChange = new Emitter();\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._onColorFlushed = new Emitter();\r\n        _this.onColorFlushed = _this._onColorFlushed.event;\r\n        _this.domNode = dom.append(container, $('.strip'));\r\n        _this.overlay = dom.append(_this.domNode, $('.overlay'));\r\n        _this.slider = dom.append(_this.domNode, $('.slider'));\r\n        _this.slider.style.top = \"0px\";\r\n        _this._register(dom.addDisposableGenericMouseDownListner(_this.domNode, function (e) { return _this.onMouseDown(e); }));\r\n        _this.layout();\r\n        return _this;\r\n    }\r\n    Strip.prototype.layout = function () {\r\n        this.height = this.domNode.offsetHeight - this.slider.offsetHeight;\r\n        var value = this.getValue(this.model.color);\r\n        this.updateSliderPosition(value);\r\n    };\r\n    Strip.prototype.onMouseDown = function (e) {\r\n        var _this = this;\r\n        var monitor = this._register(new GlobalMouseMoveMonitor());\r\n        var origin = dom.getDomNodePagePosition(this.domNode);\r\n        dom.addClass(this.domNode, 'grabbing');\r\n        if (e.target !== this.slider) {\r\n            this.onDidChangeTop(e.offsetY);\r\n        }\r\n        monitor.startMonitoring(standardMouseMoveMerger, function (event) { return _this.onDidChangeTop(event.posy - origin.top); }, function () { return null; });\r\n        var mouseUpListener = dom.addDisposableGenericMouseUpListner(document, function () {\r\n            _this._onColorFlushed.fire();\r\n            mouseUpListener.dispose();\r\n            monitor.stopMonitoring(true);\r\n            dom.removeClass(_this.domNode, 'grabbing');\r\n        }, true);\r\n    };\r\n    Strip.prototype.onDidChangeTop = function (top) {\r\n        var value = Math.max(0, Math.min(1, 1 - (top / this.height)));\r\n        this.updateSliderPosition(value);\r\n        this._onDidChange.fire(value);\r\n    };\r\n    Strip.prototype.updateSliderPosition = function (value) {\r\n        this.slider.style.top = (1 - value) * this.height + \"px\";\r\n    };\r\n    return Strip;\r\n}(Disposable));\r\nvar OpacityStrip = /** @class */ (function (_super) {\r\n    __extends(OpacityStrip, _super);\r\n    function OpacityStrip(container, model) {\r\n        var _this = _super.call(this, container, model) || this;\r\n        dom.addClass(_this.domNode, 'opacity-strip');\r\n        _this._register(model.onDidChangeColor(_this.onDidChangeColor, _this));\r\n        _this.onDidChangeColor(_this.model.color);\r\n        return _this;\r\n    }\r\n    OpacityStrip.prototype.onDidChangeColor = function (color) {\r\n        var _a = color.rgba, r = _a.r, g = _a.g, b = _a.b;\r\n        var opaque = new Color(new RGBA(r, g, b, 1));\r\n        var transparent = new Color(new RGBA(r, g, b, 0));\r\n        this.overlay.style.background = \"linear-gradient(to bottom, \" + opaque + \" 0%, \" + transparent + \" 100%)\";\r\n    };\r\n    OpacityStrip.prototype.getValue = function (color) {\r\n        return color.hsva.a;\r\n    };\r\n    return OpacityStrip;\r\n}(Strip));\r\nvar HueStrip = /** @class */ (function (_super) {\r\n    __extends(HueStrip, _super);\r\n    function HueStrip(container, model) {\r\n        var _this = _super.call(this, container, model) || this;\r\n        dom.addClass(_this.domNode, 'hue-strip');\r\n        return _this;\r\n    }\r\n    HueStrip.prototype.getValue = function (color) {\r\n        return 1 - (color.hsva.h / 360);\r\n    };\r\n    return HueStrip;\r\n}(Strip));\r\nvar ColorPickerWidget = /** @class */ (function (_super) {\r\n    __extends(ColorPickerWidget, _super);\r\n    function ColorPickerWidget(container, model, pixelRatio, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = model;\r\n        _this.pixelRatio = pixelRatio;\r\n        _this._register(onDidChangeZoomLevel(function () { return _this.layout(); }));\r\n        var element = $('.colorpicker-widget');\r\n        container.appendChild(element);\r\n        var header = new ColorPickerHeader(element, _this.model, themeService);\r\n        _this.body = new ColorPickerBody(element, _this.model, _this.pixelRatio);\r\n        _this._register(header);\r\n        _this._register(_this.body);\r\n        return _this;\r\n    }\r\n    ColorPickerWidget.prototype.layout = function () {\r\n        this.body.layout();\r\n    };\r\n    return ColorPickerWidget;\r\n}(Widget));\r\nexport { ColorPickerWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { coalesce } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { HoverProviderRegistry } from '../../common/modes.js';\r\nexport function getHover(model, position, token) {\r\n    var supports = HoverProviderRegistry.ordered(model);\r\n    var promises = supports.map(function (support) {\r\n        return Promise.resolve(support.provideHover(model, position, token)).then(function (hover) {\r\n            return hover && isValid(hover) ? hover : undefined;\r\n        }, function (err) {\r\n            onUnexpectedExternalError(err);\r\n            return undefined;\r\n        });\r\n    });\r\n    return Promise.all(promises).then(coalesce);\r\n}\r\nregisterDefaultLanguageCommand('_executeHoverProvider', function (model, position) { return getHover(model, position, CancellationToken.None); });\r\nfunction isValid(result) {\r\n    var hasRange = (typeof result.range !== 'undefined');\r\n    var hasHtmlContent = typeof result.contents !== 'undefined' && result.contents && result.contents.length > 0;\r\n    return hasRange && hasHtmlContent;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { RunOnceScheduler, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nvar HoverOperation = /** @class */ (function () {\r\n    function HoverOperation(computer, success, error, progress, hoverTime) {\r\n        var _this = this;\r\n        this._computer = computer;\r\n        this._state = 0 /* IDLE */;\r\n        this._hoverTime = hoverTime;\r\n        this._firstWaitScheduler = new RunOnceScheduler(function () { return _this._triggerAsyncComputation(); }, 0);\r\n        this._secondWaitScheduler = new RunOnceScheduler(function () { return _this._triggerSyncComputation(); }, 0);\r\n        this._loadingMessageScheduler = new RunOnceScheduler(function () { return _this._showLoadingMessage(); }, 0);\r\n        this._asyncComputationPromise = null;\r\n        this._asyncComputationPromiseDone = false;\r\n        this._completeCallback = success;\r\n        this._errorCallback = error;\r\n        this._progressCallback = progress;\r\n    }\r\n    HoverOperation.prototype.setHoverTime = function (hoverTime) {\r\n        this._hoverTime = hoverTime;\r\n    };\r\n    HoverOperation.prototype._firstWaitTime = function () {\r\n        return this._hoverTime / 2;\r\n    };\r\n    HoverOperation.prototype._secondWaitTime = function () {\r\n        return this._hoverTime / 2;\r\n    };\r\n    HoverOperation.prototype._loadingMessageTime = function () {\r\n        return 3 * this._hoverTime;\r\n    };\r\n    HoverOperation.prototype._triggerAsyncComputation = function () {\r\n        var _this = this;\r\n        this._state = 2 /* SECOND_WAIT */;\r\n        this._secondWaitScheduler.schedule(this._secondWaitTime());\r\n        if (this._computer.computeAsync) {\r\n            this._asyncComputationPromiseDone = false;\r\n            this._asyncComputationPromise = createCancelablePromise(function (token) { return _this._computer.computeAsync(token); });\r\n            this._asyncComputationPromise.then(function (asyncResult) {\r\n                _this._asyncComputationPromiseDone = true;\r\n                _this._withAsyncResult(asyncResult);\r\n            }, function (e) { return _this._onError(e); });\r\n        }\r\n        else {\r\n            this._asyncComputationPromiseDone = true;\r\n        }\r\n    };\r\n    HoverOperation.prototype._triggerSyncComputation = function () {\r\n        if (this._computer.computeSync) {\r\n            this._computer.onResult(this._computer.computeSync(), true);\r\n        }\r\n        if (this._asyncComputationPromiseDone) {\r\n            this._state = 0 /* IDLE */;\r\n            this._onComplete(this._computer.getResult());\r\n        }\r\n        else {\r\n            this._state = 3 /* WAITING_FOR_ASYNC_COMPUTATION */;\r\n            this._onProgress(this._computer.getResult());\r\n        }\r\n    };\r\n    HoverOperation.prototype._showLoadingMessage = function () {\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            this._onProgress(this._computer.getResultWithLoadingMessage());\r\n        }\r\n    };\r\n    HoverOperation.prototype._withAsyncResult = function (asyncResult) {\r\n        if (asyncResult) {\r\n            this._computer.onResult(asyncResult, false);\r\n        }\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            this._state = 0 /* IDLE */;\r\n            this._onComplete(this._computer.getResult());\r\n        }\r\n    };\r\n    HoverOperation.prototype._onComplete = function (value) {\r\n        if (this._completeCallback) {\r\n            this._completeCallback(value);\r\n        }\r\n    };\r\n    HoverOperation.prototype._onError = function (error) {\r\n        if (this._errorCallback) {\r\n            this._errorCallback(error);\r\n        }\r\n        else {\r\n            onUnexpectedError(error);\r\n        }\r\n    };\r\n    HoverOperation.prototype._onProgress = function (value) {\r\n        if (this._progressCallback) {\r\n            this._progressCallback(value);\r\n        }\r\n    };\r\n    HoverOperation.prototype.start = function (mode) {\r\n        if (mode === 0 /* Delayed */) {\r\n            if (this._state === 0 /* IDLE */) {\r\n                this._state = 1 /* FIRST_WAIT */;\r\n                this._firstWaitScheduler.schedule(this._firstWaitTime());\r\n                this._loadingMessageScheduler.schedule(this._loadingMessageTime());\r\n            }\r\n        }\r\n        else {\r\n            switch (this._state) {\r\n                case 0 /* IDLE */:\r\n                    this._triggerAsyncComputation();\r\n                    this._secondWaitScheduler.cancel();\r\n                    this._triggerSyncComputation();\r\n                    break;\r\n                case 2 /* SECOND_WAIT */:\r\n                    this._secondWaitScheduler.cancel();\r\n                    this._triggerSyncComputation();\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n    HoverOperation.prototype.cancel = function () {\r\n        this._loadingMessageScheduler.cancel();\r\n        if (this._state === 1 /* FIRST_WAIT */) {\r\n            this._firstWaitScheduler.cancel();\r\n        }\r\n        if (this._state === 2 /* SECOND_WAIT */) {\r\n            this._secondWaitScheduler.cancel();\r\n            if (this._asyncComputationPromise) {\r\n                this._asyncComputationPromise.cancel();\r\n                this._asyncComputationPromise = null;\r\n            }\r\n        }\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            if (this._asyncComputationPromise) {\r\n                this._asyncComputationPromise.cancel();\r\n                this._asyncComputationPromise = null;\r\n            }\r\n        }\r\n        this._state = 0 /* IDLE */;\r\n    };\r\n    return HoverOperation;\r\n}());\r\nexport { HoverOperation };\r\n","/**\n * marked - a markdown parser\n * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n// BEGIN MONACOCHANGE\nvar __marked_exports;\n// END MONACOCHANGE\n\n;(function(root) {\n'use strict';\n\n/**\n * Block-Level Grammar\n */\n\nvar block = {\n  newline: /^\\n+/,\n  code: /^( {4}[^\\n]+\\n*)+/,\n  fences: noop,\n  hr: /^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)/,\n  heading: /^ *(#{1,6}) *([^\\n]+?) *(?:#+ *)?(?:\\n+|$)/,\n  nptable: noop,\n  blockquote: /^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/,\n  list: /^( {0,3})(bull) [\\s\\S]+?(?:hr|def|\\n{2,}(?! )(?!\\1bull )\\n*|\\s*$)/,\n  html: '^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?\\\\?>\\\\n*' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?>\\\\n*' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>\\\\n*' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (6)\n    + '|<(?!script|pre|style)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (7) open tag\n    + '|</(?!script|pre|style)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (7) closing tag\n    + ')',\n  def: /^ {0,3}\\[(label)\\]: *\\n? *<?([^\\s>]+)>?(?:(?: +\\n? *| *\\n *)(title))? *(?:\\n+|$)/,\n  table: noop,\n  lheading: /^([^\\n]+)\\n *(=|-){2,} *(?:\\n+|$)/,\n  paragraph: /^([^\\n]+(?:\\n(?!hr|heading|lheading| {0,3}>|<\\/?(?:tag)(?: +|\\n|\\/?>)|<(?:script|pre|style|!--))[^\\n]+)*)/,\n  text: /^[^\\n]+/\n};\n\nblock._label = /(?!\\s*\\])(?:\\\\[\\[\\]]|[^\\[\\]])+/;\nblock._title = /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/;\nblock.def = edit(block.def)\n  .replace('label', block._label)\n  .replace('title', block._title)\n  .getRegex();\n\nblock.bullet = /(?:[*+-]|\\d{1,9}\\.)/;\nblock.item = /^( *)(bull) ?[^\\n]*(?:\\n(?!\\1bull ?)[^\\n]*)*/;\nblock.item = edit(block.item, 'gm')\n  .replace(/bull/g, block.bullet)\n  .getRegex();\n\nblock.list = edit(block.list)\n  .replace(/bull/g, block.bullet)\n  .replace('hr', '\\\\n+(?=\\\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$))')\n  .replace('def', '\\\\n+(?=' + block.def.source + ')')\n  .getRegex();\n\nblock._tag = 'address|article|aside|base|basefont|blockquote|body|caption'\n  + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'\n  + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'\n  + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'\n  + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr'\n  + '|track|ul';\nblock._comment = /<!--(?!-?>)[\\s\\S]*?-->/;\nblock.html = edit(block.html, 'i')\n  .replace('comment', block._comment)\n  .replace('tag', block._tag)\n  .replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/)\n  .getRegex();\n\nblock.paragraph = edit(block.paragraph)\n  .replace('hr', block.hr)\n  .replace('heading', block.heading)\n  .replace('lheading', block.lheading)\n  .replace('tag', block._tag) // pars can be interrupted by type (6) html blocks\n  .getRegex();\n\nblock.blockquote = edit(block.blockquote)\n  .replace('paragraph', block.paragraph)\n  .getRegex();\n\n/**\n * Normal Block Grammar\n */\n\nblock.normal = merge({}, block);\n\n/**\n * GFM Block Grammar\n */\n\nblock.gfm = merge({}, block.normal, {\n  fences: /^ {0,3}(`{3,}|~{3,})([^`\\n]*)\\n(?:|([\\s\\S]*?)\\n)(?: {0,3}\\1[~`]* *(?:\\n+|$)|$)/,\n  paragraph: /^/,\n  heading: /^ *(#{1,6}) +([^\\n]+?) *#* *(?:\\n+|$)/\n});\n\nblock.gfm.paragraph = edit(block.paragraph)\n  .replace('(?!', '(?!'\n    + block.gfm.fences.source.replace('\\\\1', '\\\\2') + '|'\n    + block.list.source.replace('\\\\1', '\\\\3') + '|')\n  .getRegex();\n\n/**\n * GFM + Tables Block Grammar\n */\n\nblock.tables = merge({}, block.gfm, {\n  nptable: /^ *([^|\\n ].*\\|.*)\\n *([-:]+ *\\|[-| :]*)(?:\\n((?:.*[^>\\n ].*(?:\\n|$))*)\\n*|$)/,\n  table: /^ *\\|(.+)\\n *\\|?( *[-:]+[-| :]*)(?:\\n((?: *[^>\\n ].*(?:\\n|$))*)\\n*|$)/\n});\n\n/**\n * Pedantic grammar\n */\n\nblock.pedantic = merge({}, block.normal, {\n  html: edit(\n    '^ *(?:comment *(?:\\\\n|\\\\s*$)'\n    + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n    + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))')\n    .replace('comment', block._comment)\n    .replace(/tag/g, '(?!(?:'\n      + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'\n      + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'\n      + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b')\n    .getRegex(),\n  def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/\n});\n\n/**\n * Block Lexer\n */\n\nfunction Lexer(options) {\n  this.tokens = [];\n  this.tokens.links = Object.create(null);\n  this.options = options || marked.defaults;\n  this.rules = block.normal;\n\n  if (this.options.pedantic) {\n    this.rules = block.pedantic;\n  } else if (this.options.gfm) {\n    if (this.options.tables) {\n      this.rules = block.tables;\n    } else {\n      this.rules = block.gfm;\n    }\n  }\n}\n\n/**\n * Expose Block Rules\n */\n\nLexer.rules = block;\n\n/**\n * Static Lex Method\n */\n\nLexer.lex = function(src, options) {\n  var lexer = new Lexer(options);\n  return lexer.lex(src);\n};\n\n/**\n * Preprocessing\n */\n\nLexer.prototype.lex = function(src) {\n  src = src\n    .replace(/\\r\\n|\\r/g, '\\n')\n    .replace(/\\t/g, '    ')\n    .replace(/\\u00a0/g, ' ')\n    .replace(/\\u2424/g, '\\n');\n\n  return this.token(src, true);\n};\n\n/**\n * Lexing\n */\n\nLexer.prototype.token = function(src, top) {\n  src = src.replace(/^ +$/gm, '');\n  var next,\n      loose,\n      cap,\n      bull,\n      b,\n      item,\n      listStart,\n      listItems,\n      t,\n      space,\n      i,\n      tag,\n      l,\n      isordered,\n      istask,\n      ischecked;\n\n  while (src) {\n    // newline\n    if (cap = this.rules.newline.exec(src)) {\n      src = src.substring(cap[0].length);\n      if (cap[0].length > 1) {\n        this.tokens.push({\n          type: 'space'\n        });\n      }\n    }\n\n    // code\n    if (cap = this.rules.code.exec(src)) {\n      src = src.substring(cap[0].length);\n      cap = cap[0].replace(/^ {4}/gm, '');\n      this.tokens.push({\n        type: 'code',\n        text: !this.options.pedantic\n          ? rtrim(cap, '\\n')\n          : cap\n      });\n      continue;\n    }\n\n    // fences (gfm)\n    if (cap = this.rules.fences.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'code',\n        lang: cap[2] ? cap[2].trim() : cap[2],\n        text: cap[3] || ''\n      });\n      continue;\n    }\n\n    // heading\n    if (cap = this.rules.heading.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'heading',\n        depth: cap[1].length,\n        text: cap[2]\n      });\n      continue;\n    }\n\n    // table no leading pipe (gfm)\n    if (cap = this.rules.nptable.exec(src)) {\n      item = {\n        type: 'table',\n        header: splitCells(cap[1].replace(/^ *| *\\| *$/g, '')),\n        align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n        cells: cap[3] ? cap[3].replace(/\\n$/, '').split('\\n') : []\n      };\n\n      if (item.header.length === item.align.length) {\n        src = src.substring(cap[0].length);\n\n        for (i = 0; i < item.align.length; i++) {\n          if (/^ *-+: *$/.test(item.align[i])) {\n            item.align[i] = 'right';\n          } else if (/^ *:-+: *$/.test(item.align[i])) {\n            item.align[i] = 'center';\n          } else if (/^ *:-+ *$/.test(item.align[i])) {\n            item.align[i] = 'left';\n          } else {\n            item.align[i] = null;\n          }\n        }\n\n        for (i = 0; i < item.cells.length; i++) {\n          item.cells[i] = splitCells(item.cells[i], item.header.length);\n        }\n\n        this.tokens.push(item);\n\n        continue;\n      }\n    }\n\n    // hr\n    if (cap = this.rules.hr.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'hr'\n      });\n      continue;\n    }\n\n    // blockquote\n    if (cap = this.rules.blockquote.exec(src)) {\n      src = src.substring(cap[0].length);\n\n      this.tokens.push({\n        type: 'blockquote_start'\n      });\n\n      cap = cap[0].replace(/^ *> ?/gm, '');\n\n      // Pass `top` to keep the current\n      // \"toplevel\" state. This is exactly\n      // how markdown.pl works.\n      this.token(cap, top);\n\n      this.tokens.push({\n        type: 'blockquote_end'\n      });\n\n      continue;\n    }\n\n    // list\n    if (cap = this.rules.list.exec(src)) {\n      src = src.substring(cap[0].length);\n      bull = cap[2];\n      isordered = bull.length > 1;\n\n      listStart = {\n        type: 'list_start',\n        ordered: isordered,\n        start: isordered ? +bull : '',\n        loose: false\n      };\n\n      this.tokens.push(listStart);\n\n      // Get each top-level item.\n      cap = cap[0].match(this.rules.item);\n\n      listItems = [];\n      next = false;\n      l = cap.length;\n      i = 0;\n\n      for (; i < l; i++) {\n        item = cap[i];\n\n        // Remove the list item's bullet\n        // so it is seen as the next token.\n        space = item.length;\n        item = item.replace(/^ *([*+-]|\\d+\\.) */, '');\n\n        // Outdent whatever the\n        // list item contains. Hacky.\n        if (~item.indexOf('\\n ')) {\n          space -= item.length;\n          item = !this.options.pedantic\n            ? item.replace(new RegExp('^ {1,' + space + '}', 'gm'), '')\n            : item.replace(/^ {1,4}/gm, '');\n        }\n\n        // Determine whether the next list item belongs here.\n        // Backpedal if it does not belong in this list.\n        if (i !== l - 1) {\n          b = block.bullet.exec(cap[i + 1])[0];\n          if (bull.length > 1 ? b.length === 1\n            : (b.length > 1 || (this.options.smartLists && b !== bull))) {\n            src = cap.slice(i + 1).join('\\n') + src;\n            i = l - 1;\n          }\n        }\n\n        // Determine whether item is loose or not.\n        // Use: /(^|\\n)(?! )[^\\n]+\\n\\n(?!\\s*$)/\n        // for discount behavior.\n        loose = next || /\\n\\n(?!\\s*$)/.test(item);\n        if (i !== l - 1) {\n          next = item.charAt(item.length - 1) === '\\n';\n          if (!loose) loose = next;\n        }\n\n        if (loose) {\n          listStart.loose = true;\n        }\n\n        // Check for task list items\n        istask = /^\\[[ xX]\\] /.test(item);\n        ischecked = undefined;\n        if (istask) {\n          ischecked = item[1] !== ' ';\n          item = item.replace(/^\\[[ xX]\\] +/, '');\n        }\n\n        t = {\n          type: 'list_item_start',\n          task: istask,\n          checked: ischecked,\n          loose: loose\n        };\n\n        listItems.push(t);\n        this.tokens.push(t);\n\n        // Recurse.\n        this.token(item, false);\n\n        this.tokens.push({\n          type: 'list_item_end'\n        });\n      }\n\n      if (listStart.loose) {\n        l = listItems.length;\n        i = 0;\n        for (; i < l; i++) {\n          listItems[i].loose = true;\n        }\n      }\n\n      this.tokens.push({\n        type: 'list_end'\n      });\n\n      continue;\n    }\n\n    // html\n    if (cap = this.rules.html.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: this.options.sanitize\n          ? 'paragraph'\n          : 'html',\n        pre: !this.options.sanitizer\n          && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),\n        text: cap[0]\n      });\n      continue;\n    }\n\n    // def\n    if (top && (cap = this.rules.def.exec(src))) {\n      src = src.substring(cap[0].length);\n      if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n      tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n      if (!this.tokens.links[tag]) {\n        this.tokens.links[tag] = {\n          href: cap[2],\n          title: cap[3]\n        };\n      }\n      continue;\n    }\n\n    // table (gfm)\n    if (cap = this.rules.table.exec(src)) {\n      item = {\n        type: 'table',\n        header: splitCells(cap[1].replace(/^ *| *\\| *$/g, '')),\n        align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n        cells: cap[3] ? cap[3].replace(/\\n$/, '').split('\\n') : []\n      };\n\n      if (item.header.length === item.align.length) {\n        src = src.substring(cap[0].length);\n\n        for (i = 0; i < item.align.length; i++) {\n          if (/^ *-+: *$/.test(item.align[i])) {\n            item.align[i] = 'right';\n          } else if (/^ *:-+: *$/.test(item.align[i])) {\n            item.align[i] = 'center';\n          } else if (/^ *:-+ *$/.test(item.align[i])) {\n            item.align[i] = 'left';\n          } else {\n            item.align[i] = null;\n          }\n        }\n\n        for (i = 0; i < item.cells.length; i++) {\n          item.cells[i] = splitCells(\n            item.cells[i].replace(/^ *\\| *| *\\| *$/g, ''),\n            item.header.length);\n        }\n\n        this.tokens.push(item);\n\n        continue;\n      }\n    }\n\n    // lheading\n    if (cap = this.rules.lheading.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'heading',\n        depth: cap[2] === '=' ? 1 : 2,\n        text: cap[1]\n      });\n      continue;\n    }\n\n    // top-level paragraph\n    if (top && (cap = this.rules.paragraph.exec(src))) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'paragraph',\n        text: cap[1].charAt(cap[1].length - 1) === '\\n'\n          ? cap[1].slice(0, -1)\n          : cap[1]\n      });\n      continue;\n    }\n\n    // text\n    if (cap = this.rules.text.exec(src)) {\n      // Top-level should never reach here.\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'text',\n        text: cap[0]\n      });\n      continue;\n    }\n\n    if (src) {\n      throw new Error('Infinite loop on byte: ' + src.charCodeAt(0));\n    }\n  }\n\n  return this.tokens;\n};\n\n/**\n * Inline-Level Grammar\n */\n\nvar inline = {\n  escape: /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/,\n  autolink: /^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/,\n  url: noop,\n  tag: '^comment'\n    + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>', // CDATA section\n  link: /^!?\\[(label)\\]\\(href(?:\\s+(title))?\\s*\\)/,\n  reflink: /^!?\\[(label)\\]\\[(?!\\s*\\])((?:\\\\[\\[\\]]?|[^\\[\\]\\\\])+)\\]/,\n  nolink: /^!?\\[(?!\\s*\\])((?:\\[[^\\[\\]]*\\]|\\\\[\\[\\]]|[^\\[\\]])*)\\](?:\\[\\])?/,\n  strong: /^__([^\\s_])__(?!_)|^\\*\\*([^\\s*])\\*\\*(?!\\*)|^__([^\\s][\\s\\S]*?[^\\s])__(?!_)|^\\*\\*([^\\s][\\s\\S]*?[^\\s])\\*\\*(?!\\*)/,\n  em: /^_([^\\s_])_(?!_)|^\\*([^\\s*\"<\\[])\\*(?!\\*)|^_([^\\s][\\s\\S]*?[^\\s_])_(?!_|[^\\spunctuation])|^_([^\\s_][\\s\\S]*?[^\\s])_(?!_|[^\\spunctuation])|^\\*([^\\s\"<\\[][\\s\\S]*?[^\\s*])\\*(?!\\*)|^\\*([^\\s*\"<\\[][\\s\\S]*?[^\\s])\\*(?!\\*)/,\n  code: /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/,\n  br: /^( {2,}|\\\\)\\n(?!\\s*$)/,\n  del: noop,\n  text: /^(`+|[^`])(?:[\\s\\S]*?(?:(?=[\\\\<!\\[`*]|\\b_|$)|[^ ](?= {2,}\\n))|(?= {2,}\\n))/\n};\n\n// list of punctuation marks from common mark spec\n// without ` and ] to workaround Rule 17 (inline code blocks/links)\ninline._punctuation = '!\"#$%&\\'()*+,\\\\-./:;<=>?@\\\\[^_{|}~';\ninline.em = edit(inline.em).replace(/punctuation/g, inline._punctuation).getRegex();\n\ninline._escapes = /\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/g;\n\ninline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;\ninline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;\ninline.autolink = edit(inline.autolink)\n  .replace('scheme', inline._scheme)\n  .replace('email', inline._email)\n  .getRegex();\n\ninline._attribute = /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/;\n\ninline.tag = edit(inline.tag)\n  .replace('comment', block._comment)\n  .replace('attribute', inline._attribute)\n  .getRegex();\n\ninline._label = /(?:\\[[^\\[\\]]*\\]|\\\\[\\[\\]]?|`[^`]*`|`(?!`)|[^\\[\\]\\\\`])*?/;\ninline._href = /\\s*(<(?:\\\\[<>]?|[^\\s<>\\\\])*>|[^\\s\\x00-\\x1f]*)/;\ninline._title = /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/;\n\ninline.link = edit(inline.link)\n  .replace('label', inline._label)\n  .replace('href', inline._href)\n  .replace('title', inline._title)\n  .getRegex();\n\ninline.reflink = edit(inline.reflink)\n  .replace('label', inline._label)\n  .getRegex();\n\n/**\n * Normal Inline Grammar\n */\n\ninline.normal = merge({}, inline);\n\n/**\n * Pedantic Inline Grammar\n */\n\ninline.pedantic = merge({}, inline.normal, {\n  strong: /^__(?=\\S)([\\s\\S]*?\\S)__(?!_)|^\\*\\*(?=\\S)([\\s\\S]*?\\S)\\*\\*(?!\\*)/,\n  em: /^_(?=\\S)([\\s\\S]*?\\S)_(?!_)|^\\*(?=\\S)([\\s\\S]*?\\S)\\*(?!\\*)/,\n  link: edit(/^!?\\[(label)\\]\\((.*?)\\)/)\n    .replace('label', inline._label)\n    .getRegex(),\n  reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/)\n    .replace('label', inline._label)\n    .getRegex()\n});\n\n/**\n * GFM Inline Grammar\n */\n\ninline.gfm = merge({}, inline.normal, {\n  escape: edit(inline.escape).replace('])', '~|])').getRegex(),\n  _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,\n  url: /^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/,\n  _backpedal: /(?:[^?!.,:;*_~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,\n  del: /^~+(?=\\S)([\\s\\S]*?\\S)~+/,\n  text: /^(`+|[^`])(?:[\\s\\S]*?(?:(?=[\\\\<!\\[`*~]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@))|(?= {2,}\\n|[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@))/\n});\n\ninline.gfm.url = edit(inline.gfm.url, 'i')\n  .replace('email', inline.gfm._extended_email)\n  .getRegex();\n/**\n * GFM + Line Breaks Inline Grammar\n */\n\ninline.breaks = merge({}, inline.gfm, {\n  br: edit(inline.br).replace('{2,}', '*').getRegex(),\n  text: edit(inline.gfm.text).replace(/\\{2,\\}/g, '*').getRegex()\n});\n\n/**\n * Inline Lexer & Compiler\n */\n\nfunction InlineLexer(links, options) {\n  this.options = options || marked.defaults;\n  this.links = links;\n  this.rules = inline.normal;\n  this.renderer = this.options.renderer || new Renderer();\n  this.renderer.options = this.options;\n\n  if (!this.links) {\n    throw new Error('Tokens array requires a `links` property.');\n  }\n\n  if (this.options.pedantic) {\n    this.rules = inline.pedantic;\n  } else if (this.options.gfm) {\n    if (this.options.breaks) {\n      this.rules = inline.breaks;\n    } else {\n      this.rules = inline.gfm;\n    }\n  }\n}\n\n/**\n * Expose Inline Rules\n */\n\nInlineLexer.rules = inline;\n\n/**\n * Static Lexing/Compiling Method\n */\n\nInlineLexer.output = function(src, links, options) {\n  var inline = new InlineLexer(links, options);\n  return inline.output(src);\n};\n\n/**\n * Lexing/Compiling\n */\n\nInlineLexer.prototype.output = function(src) {\n  var out = '',\n      link,\n      text,\n      href,\n      title,\n      cap,\n      prevCapZero;\n\n  while (src) {\n    // escape\n    if (cap = this.rules.escape.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += escape(cap[1]);\n      continue;\n    }\n\n    // tag\n    if (cap = this.rules.tag.exec(src)) {\n      if (!this.inLink && /^<a /i.test(cap[0])) {\n        this.inLink = true;\n      } else if (this.inLink && /^<\\/a>/i.test(cap[0])) {\n        this.inLink = false;\n      }\n      if (!this.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n        this.inRawBlock = true;\n      } else if (this.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n        this.inRawBlock = false;\n      }\n\n      src = src.substring(cap[0].length);\n      out += this.options.sanitize\n        ? this.options.sanitizer\n          ? this.options.sanitizer(cap[0])\n          : escape(cap[0])\n        : cap[0];\n      continue;\n    }\n\n    // link\n    if (cap = this.rules.link.exec(src)) {\n      var lastParenIndex = findClosingBracket(cap[2], '()');\n      if (lastParenIndex > -1) {\n        var linkLen = cap[0].length - (cap[2].length - lastParenIndex) - (cap[3] || '').length;\n        cap[2] = cap[2].substring(0, lastParenIndex);\n        cap[0] = cap[0].substring(0, linkLen).trim();\n        cap[3] = '';\n      }\n      src = src.substring(cap[0].length);\n      this.inLink = true;\n      href = cap[2];\n      if (this.options.pedantic) {\n        link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n\n        if (link) {\n          href = link[1];\n          title = link[3];\n        } else {\n          title = '';\n        }\n      } else {\n        title = cap[3] ? cap[3].slice(1, -1) : '';\n      }\n      href = href.trim().replace(/^<([\\s\\S]*)>$/, '$1');\n      out += this.outputLink(cap, {\n        href: InlineLexer.escapes(href),\n        title: InlineLexer.escapes(title)\n      });\n      this.inLink = false;\n      continue;\n    }\n\n    // reflink, nolink\n    if ((cap = this.rules.reflink.exec(src))\n        || (cap = this.rules.nolink.exec(src))) {\n      src = src.substring(cap[0].length);\n      link = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n      link = this.links[link.toLowerCase()];\n      if (!link || !link.href) {\n        out += cap[0].charAt(0);\n        src = cap[0].substring(1) + src;\n        continue;\n      }\n      this.inLink = true;\n      out += this.outputLink(cap, link);\n      this.inLink = false;\n      continue;\n    }\n\n    // strong\n    if (cap = this.rules.strong.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.strong(this.output(cap[4] || cap[3] || cap[2] || cap[1]));\n      continue;\n    }\n\n    // em\n    if (cap = this.rules.em.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.em(this.output(cap[6] || cap[5] || cap[4] || cap[3] || cap[2] || cap[1]));\n      continue;\n    }\n\n    // code\n    if (cap = this.rules.code.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.codespan(escape(cap[2].trim(), true));\n      continue;\n    }\n\n    // br\n    if (cap = this.rules.br.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.br();\n      continue;\n    }\n\n    // del (gfm)\n    if (cap = this.rules.del.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.del(this.output(cap[1]));\n      continue;\n    }\n\n    // autolink\n    if (cap = this.rules.autolink.exec(src)) {\n      src = src.substring(cap[0].length);\n      if (cap[2] === '@') {\n        text = escape(this.mangle(cap[1]));\n        href = 'mailto:' + text;\n      } else {\n        text = escape(cap[1]);\n        href = text;\n      }\n      out += this.renderer.link(href, null, text);\n      continue;\n    }\n\n    // url (gfm)\n    if (!this.inLink && (cap = this.rules.url.exec(src))) {\n      if (cap[2] === '@') {\n        text = escape(cap[0]);\n        href = 'mailto:' + text;\n      } else {\n        // do extended autolink path validation\n        do {\n          prevCapZero = cap[0];\n          cap[0] = this.rules._backpedal.exec(cap[0])[0];\n        } while (prevCapZero !== cap[0]);\n        text = escape(cap[0]);\n        if (cap[1] === 'www.') {\n          href = 'http://' + text;\n        } else {\n          href = text;\n        }\n      }\n      src = src.substring(cap[0].length);\n      out += this.renderer.link(href, null, text);\n      continue;\n    }\n\n    // text\n    if (cap = this.rules.text.exec(src)) {\n      src = src.substring(cap[0].length);\n      if (this.inRawBlock) {\n        out += this.renderer.text(cap[0]);\n      } else {\n        out += this.renderer.text(escape(this.smartypants(cap[0])));\n      }\n      continue;\n    }\n\n    if (src) {\n      throw new Error('Infinite loop on byte: ' + src.charCodeAt(0));\n    }\n  }\n\n  return out;\n};\n\nInlineLexer.escapes = function(text) {\n  return text ? text.replace(InlineLexer.rules._escapes, '$1') : text;\n};\n\n/**\n * Compile Link\n */\n\nInlineLexer.prototype.outputLink = function(cap, link) {\n  var href = link.href,\n      title = link.title ? escape(link.title) : null;\n\n  return cap[0].charAt(0) !== '!'\n    ? this.renderer.link(href, title, this.output(cap[1]))\n    : this.renderer.image(href, title, escape(cap[1]));\n};\n\n/**\n * Smartypants Transformations\n */\n\nInlineLexer.prototype.smartypants = function(text) {\n  if (!this.options.smartypants) return text;\n  return text\n    // em-dashes\n    .replace(/---/g, '\\u2014')\n    // en-dashes\n    .replace(/--/g, '\\u2013')\n    // opening singles\n    .replace(/(^|[-\\u2014/(\\[{\"\\s])'/g, '$1\\u2018')\n    // closing singles & apostrophes\n    .replace(/'/g, '\\u2019')\n    // opening doubles\n    .replace(/(^|[-\\u2014/(\\[{\\u2018\\s])\"/g, '$1\\u201c')\n    // closing doubles\n    .replace(/\"/g, '\\u201d')\n    // ellipses\n    .replace(/\\.{3}/g, '\\u2026');\n};\n\n/**\n * Mangle Links\n */\n\nInlineLexer.prototype.mangle = function(text) {\n  if (!this.options.mangle) return text;\n  var out = '',\n      l = text.length,\n      i = 0,\n      ch;\n\n  for (; i < l; i++) {\n    ch = text.charCodeAt(i);\n    if (Math.random() > 0.5) {\n      ch = 'x' + ch.toString(16);\n    }\n    out += '&#' + ch + ';';\n  }\n\n  return out;\n};\n\n/**\n * Renderer\n */\n\nfunction Renderer(options) {\n  this.options = options || marked.defaults;\n}\n\nRenderer.prototype.code = function(code, infostring, escaped) {\n  var lang = (infostring || '').match(/\\S*/)[0];\n  if (this.options.highlight) {\n    var out = this.options.highlight(code, lang);\n    if (out != null && out !== code) {\n      escaped = true;\n      code = out;\n    }\n  }\n\n  if (!lang) {\n    return '<pre><code>'\n      + (escaped ? code : escape(code, true))\n      + '</code></pre>';\n  }\n\n  return '<pre><code class=\"'\n    + this.options.langPrefix\n    + escape(lang, true)\n    + '\">'\n    + (escaped ? code : escape(code, true))\n    + '</code></pre>\\n';\n};\n\nRenderer.prototype.blockquote = function(quote) {\n  return '<blockquote>\\n' + quote + '</blockquote>\\n';\n};\n\nRenderer.prototype.html = function(html) {\n  return html;\n};\n\nRenderer.prototype.heading = function(text, level, raw, slugger) {\n  if (this.options.headerIds) {\n    return '<h'\n      + level\n      + ' id=\"'\n      + this.options.headerPrefix\n      + slugger.slug(raw)\n      + '\">'\n      + text\n      + '</h'\n      + level\n      + '>\\n';\n  }\n  // ignore IDs\n  return '<h' + level + '>' + text + '</h' + level + '>\\n';\n};\n\nRenderer.prototype.hr = function() {\n  return this.options.xhtml ? '<hr/>\\n' : '<hr>\\n';\n};\n\nRenderer.prototype.list = function(body, ordered, start) {\n  var type = ordered ? 'ol' : 'ul',\n      startatt = (ordered && start !== 1) ? (' start=\"' + start + '\"') : '';\n  return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n};\n\nRenderer.prototype.listitem = function(text) {\n  return '<li>' + text + '</li>\\n';\n};\n\nRenderer.prototype.checkbox = function(checked) {\n  return '<input '\n    + (checked ? 'checked=\"\" ' : '')\n    + 'disabled=\"\" type=\"checkbox\"'\n    + (this.options.xhtml ? ' /' : '')\n    + '> ';\n};\n\nRenderer.prototype.paragraph = function(text) {\n  return '<p>' + text + '</p>\\n';\n};\n\nRenderer.prototype.table = function(header, body) {\n  if (body) body = '<tbody>' + body + '</tbody>';\n\n  return '<table>\\n'\n    + '<thead>\\n'\n    + header\n    + '</thead>\\n'\n    + body\n    + '</table>\\n';\n};\n\nRenderer.prototype.tablerow = function(content) {\n  return '<tr>\\n' + content + '</tr>\\n';\n};\n\nRenderer.prototype.tablecell = function(content, flags) {\n  var type = flags.header ? 'th' : 'td';\n  var tag = flags.align\n    ? '<' + type + ' align=\"' + flags.align + '\">'\n    : '<' + type + '>';\n  return tag + content + '</' + type + '>\\n';\n};\n\n// span level renderer\nRenderer.prototype.strong = function(text) {\n  return '<strong>' + text + '</strong>';\n};\n\nRenderer.prototype.em = function(text) {\n  return '<em>' + text + '</em>';\n};\n\nRenderer.prototype.codespan = function(text) {\n  return '<code>' + text + '</code>';\n};\n\nRenderer.prototype.br = function() {\n  return this.options.xhtml ? '<br/>' : '<br>';\n};\n\nRenderer.prototype.del = function(text) {\n  return '<del>' + text + '</del>';\n};\n\nRenderer.prototype.link = function(href, title, text) {\n  href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n  if (href === null) {\n    return text;\n  }\n  var out = '<a href=\"' + escape(href) + '\"';\n  if (title) {\n    out += ' title=\"' + title + '\"';\n  }\n  out += '>' + text + '</a>';\n  return out;\n};\n\nRenderer.prototype.image = function(href, title, text) {\n  href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n  if (href === null) {\n    return text;\n  }\n\n  var out = '<img src=\"' + href + '\" alt=\"' + text + '\"';\n  if (title) {\n    out += ' title=\"' + title + '\"';\n  }\n  out += this.options.xhtml ? '/>' : '>';\n  return out;\n};\n\nRenderer.prototype.text = function(text) {\n  return text;\n};\n\n/**\n * TextRenderer\n * returns only the textual part of the token\n */\n\nfunction TextRenderer() {}\n\n// no need for block level renderers\n\nTextRenderer.prototype.strong =\nTextRenderer.prototype.em =\nTextRenderer.prototype.codespan =\nTextRenderer.prototype.del =\nTextRenderer.prototype.text = function (text) {\n  return text;\n};\n\nTextRenderer.prototype.link =\nTextRenderer.prototype.image = function(href, title, text) {\n  return '' + text;\n};\n\nTextRenderer.prototype.br = function() {\n  return '';\n};\n\n/**\n * Parsing & Compiling\n */\n\nfunction Parser(options) {\n  this.tokens = [];\n  this.token = null;\n  this.options = options || marked.defaults;\n  this.options.renderer = this.options.renderer || new Renderer();\n  this.renderer = this.options.renderer;\n  this.renderer.options = this.options;\n  this.slugger = new Slugger();\n}\n\n/**\n * Static Parse Method\n */\n\nParser.parse = function(src, options) {\n  var parser = new Parser(options);\n  return parser.parse(src);\n};\n\n/**\n * Parse Loop\n */\n\nParser.prototype.parse = function(src) {\n  this.inline = new InlineLexer(src.links, this.options);\n  // use an InlineLexer with a TextRenderer to extract pure text\n  this.inlineText = new InlineLexer(\n    src.links,\n    merge({}, this.options, {renderer: new TextRenderer()})\n  );\n  this.tokens = src.reverse();\n\n  var out = '';\n  while (this.next()) {\n    out += this.tok();\n  }\n\n  return out;\n};\n\n/**\n * Next Token\n */\n\nParser.prototype.next = function() {\n  return this.token = this.tokens.pop();\n};\n\n/**\n * Preview Next Token\n */\n\nParser.prototype.peek = function() {\n  return this.tokens[this.tokens.length - 1] || 0;\n};\n\n/**\n * Parse Text Tokens\n */\n\nParser.prototype.parseText = function() {\n  var body = this.token.text;\n\n  while (this.peek().type === 'text') {\n    body += '\\n' + this.next().text;\n  }\n\n  return this.inline.output(body);\n};\n\n/**\n * Parse Current Token\n */\n\nParser.prototype.tok = function() {\n  switch (this.token.type) {\n    case 'space': {\n      return '';\n    }\n    case 'hr': {\n      return this.renderer.hr();\n    }\n    case 'heading': {\n      return this.renderer.heading(\n        this.inline.output(this.token.text),\n        this.token.depth,\n        unescape(this.inlineText.output(this.token.text)),\n        this.slugger);\n    }\n    case 'code': {\n      return this.renderer.code(this.token.text,\n        this.token.lang,\n        this.token.escaped);\n    }\n    case 'table': {\n      var header = '',\n          body = '',\n          i,\n          row,\n          cell,\n          j;\n\n      // header\n      cell = '';\n      for (i = 0; i < this.token.header.length; i++) {\n        cell += this.renderer.tablecell(\n          this.inline.output(this.token.header[i]),\n          { header: true, align: this.token.align[i] }\n        );\n      }\n      header += this.renderer.tablerow(cell);\n\n      for (i = 0; i < this.token.cells.length; i++) {\n        row = this.token.cells[i];\n\n        cell = '';\n        for (j = 0; j < row.length; j++) {\n          cell += this.renderer.tablecell(\n            this.inline.output(row[j]),\n            { header: false, align: this.token.align[j] }\n          );\n        }\n\n        body += this.renderer.tablerow(cell);\n      }\n      return this.renderer.table(header, body);\n    }\n    case 'blockquote_start': {\n      body = '';\n\n      while (this.next().type !== 'blockquote_end') {\n        body += this.tok();\n      }\n\n      return this.renderer.blockquote(body);\n    }\n    case 'list_start': {\n      body = '';\n      var ordered = this.token.ordered,\n          start = this.token.start;\n\n      while (this.next().type !== 'list_end') {\n        body += this.tok();\n      }\n\n      return this.renderer.list(body, ordered, start);\n    }\n    case 'list_item_start': {\n      body = '';\n      var loose = this.token.loose;\n      var checked = this.token.checked;\n      var task = this.token.task;\n\n      if (this.token.task) {\n        body += this.renderer.checkbox(checked);\n      }\n\n      while (this.next().type !== 'list_item_end') {\n        body += !loose && this.token.type === 'text'\n          ? this.parseText()\n          : this.tok();\n      }\n      return this.renderer.listitem(body, task, checked);\n    }\n    case 'html': {\n      // TODO parse inline content if parameter markdown=1\n      return this.renderer.html(this.token.text);\n    }\n    case 'paragraph': {\n      return this.renderer.paragraph(this.inline.output(this.token.text));\n    }\n    case 'text': {\n      return this.renderer.paragraph(this.parseText());\n    }\n    default: {\n      var errMsg = 'Token with \"' + this.token.type + '\" type was not found.';\n      if (this.options.silent) {\n        console.log(errMsg);\n      } else {\n        throw new Error(errMsg);\n      }\n    }\n  }\n};\n\n/**\n * Slugger generates header id\n */\n\nfunction Slugger () {\n  this.seen = {};\n}\n\n/**\n * Convert string to unique id\n */\n\nSlugger.prototype.slug = function (value) {\n  var slug = value\n    .toLowerCase()\n    .trim()\n    .replace(/[\\u2000-\\u206F\\u2E00-\\u2E7F\\\\'!\"#$%&()*+,./:;<=>?@[\\]^`{|}~]/g, '')\n    .replace(/\\s/g, '-');\n\n  if (this.seen.hasOwnProperty(slug)) {\n    var originalSlug = slug;\n    do {\n      this.seen[originalSlug]++;\n      slug = originalSlug + '-' + this.seen[originalSlug];\n    } while (this.seen.hasOwnProperty(slug));\n  }\n  this.seen[slug] = 0;\n\n  return slug;\n};\n\n/**\n * Helpers\n */\n\nfunction escape(html, encode) {\n  if (encode) {\n    if (escape.escapeTest.test(html)) {\n      return html.replace(escape.escapeReplace, function (ch) { return escape.replacements[ch]; });\n    }\n  } else {\n    if (escape.escapeTestNoEncode.test(html)) {\n      return html.replace(escape.escapeReplaceNoEncode, function (ch) { return escape.replacements[ch]; });\n    }\n  }\n\n  return html;\n}\n\nescape.escapeTest = /[&<>\"']/;\nescape.escapeReplace = /[&<>\"']/g;\nescape.replacements = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\n\nescape.escapeTestNoEncode = /[<>\"']|&(?!#?\\w+;)/;\nescape.escapeReplaceNoEncode = /[<>\"']|&(?!#?\\w+;)/g;\n\nfunction unescape(html) {\n  // explicitly match decimal, hex, and named HTML entities\n  return html.replace(/&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig, function(_, n) {\n    n = n.toLowerCase();\n    if (n === 'colon') return ':';\n    if (n.charAt(0) === '#') {\n      return n.charAt(1) === 'x'\n        ? String.fromCharCode(parseInt(n.substring(2), 16))\n        : String.fromCharCode(+n.substring(1));\n    }\n    return '';\n  });\n}\n\nfunction edit(regex, opt) {\n  regex = regex.source || regex;\n  opt = opt || '';\n  return {\n    replace: function(name, val) {\n      val = val.source || val;\n      val = val.replace(/(^|[^\\[])\\^/g, '$1');\n      regex = regex.replace(name, val);\n      return this;\n    },\n    getRegex: function() {\n      return new RegExp(regex, opt);\n    }\n  };\n}\n\nfunction cleanUrl(sanitize, base, href) {\n  if (sanitize) {\n    try {\n      var prot = decodeURIComponent(unescape(href))\n        .replace(/[^\\w:]/g, '')\n        .toLowerCase();\n    } catch (e) {\n      return null;\n    }\n    if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {\n      return null;\n    }\n  }\n  if (base && !originIndependentUrl.test(href)) {\n    href = resolveUrl(base, href);\n  }\n  try {\n    href = encodeURI(href).replace(/%25/g, '%');\n  } catch (e) {\n    return null;\n  }\n  return href;\n}\n\nfunction resolveUrl(base, href) {\n  if (!baseUrls[' ' + base]) {\n    // we can ignore everything in base after the last slash of its path component,\n    // but we might need to add _that_\n    // https://tools.ietf.org/html/rfc3986#section-3\n    if (/^[^:]+:\\/*[^/]*$/.test(base)) {\n      baseUrls[' ' + base] = base + '/';\n    } else {\n      baseUrls[' ' + base] = rtrim(base, '/', true);\n    }\n  }\n  base = baseUrls[' ' + base];\n\n  if (href.slice(0, 2) === '//') {\n    return base.replace(/:[\\s\\S]*/, ':') + href;\n  } else if (href.charAt(0) === '/') {\n    return base.replace(/(:\\/*[^/]*)[\\s\\S]*/, '$1') + href;\n  } else {\n    return base + href;\n  }\n}\nvar baseUrls = {};\nvar originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;\n\nfunction noop() {}\nnoop.exec = noop;\n\nfunction merge(obj) {\n  var i = 1,\n      target,\n      key;\n\n  for (; i < arguments.length; i++) {\n    target = arguments[i];\n    for (key in target) {\n      if (Object.prototype.hasOwnProperty.call(target, key)) {\n        obj[key] = target[key];\n      }\n    }\n  }\n\n  return obj;\n}\n\nfunction splitCells(tableRow, count) {\n  // ensure that every cell-delimiting pipe has a space\n  // before it to distinguish it from an escaped pipe\n  var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n        var escaped = false,\n            curr = offset;\n        while (--curr >= 0 && str[curr] === '\\\\') escaped = !escaped;\n        if (escaped) {\n          // odd number of slashes means | is escaped\n          // so we leave it alone\n          return '|';\n        } else {\n          // add space before unescaped |\n          return ' |';\n        }\n      }),\n      cells = row.split(/ \\|/),\n      i = 0;\n\n  if (cells.length > count) {\n    cells.splice(count);\n  } else {\n    while (cells.length < count) cells.push('');\n  }\n\n  for (; i < cells.length; i++) {\n    // leading or trailing whitespace is ignored per the gfm spec\n    cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n  }\n  return cells;\n}\n\n// Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n// /c*$/ is vulnerable to REDOS.\n// invert: Remove suffix of non-c chars instead. Default falsey.\nfunction rtrim(str, c, invert) {\n  if (str.length === 0) {\n    return '';\n  }\n\n  // Length of suffix matching the invert condition.\n  var suffLen = 0;\n\n  // Step left until we fail to match the invert condition.\n  while (suffLen < str.length) {\n    var currChar = str.charAt(str.length - suffLen - 1);\n    if (currChar === c && !invert) {\n      suffLen++;\n    } else if (currChar !== c && invert) {\n      suffLen++;\n    } else {\n      break;\n    }\n  }\n\n  return str.substr(0, str.length - suffLen);\n}\n\nfunction findClosingBracket(str, b) {\n  if (str.indexOf(b[1]) === -1) {\n    return -1;\n  }\n  var level = 0;\n  for (var i = 0; i < str.length; i++) {\n    if (str[i] === '\\\\') {\n      i++;\n    } else if (str[i] === b[0]) {\n      level++;\n    } else if (str[i] === b[1]) {\n      level--;\n      if (level < 0) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\n/**\n * Marked\n */\n\nfunction marked(src, opt, callback) {\n  // throw error in case of non string input\n  if (typeof src === 'undefined' || src === null) {\n    throw new Error('marked(): input parameter is undefined or null');\n  }\n  if (typeof src !== 'string') {\n    throw new Error('marked(): input parameter is of type '\n      + Object.prototype.toString.call(src) + ', string expected');\n  }\n\n  if (callback || typeof opt === 'function') {\n    if (!callback) {\n      callback = opt;\n      opt = null;\n    }\n\n    opt = merge({}, marked.defaults, opt || {});\n\n    var highlight = opt.highlight,\n        tokens,\n        pending,\n        i = 0;\n\n    try {\n      tokens = Lexer.lex(src, opt);\n    } catch (e) {\n      return callback(e);\n    }\n\n    pending = tokens.length;\n\n    var done = function(err) {\n      if (err) {\n        opt.highlight = highlight;\n        return callback(err);\n      }\n\n      var out;\n\n      try {\n        out = Parser.parse(tokens, opt);\n      } catch (e) {\n        err = e;\n      }\n\n      opt.highlight = highlight;\n\n      return err\n        ? callback(err)\n        : callback(null, out);\n    };\n\n    if (!highlight || highlight.length < 3) {\n      return done();\n    }\n\n    delete opt.highlight;\n\n    if (!pending) return done();\n\n    for (; i < tokens.length; i++) {\n      (function(token) {\n        if (token.type !== 'code') {\n          return --pending || done();\n        }\n        return highlight(token.text, token.lang, function(err, code) {\n          if (err) return done(err);\n          if (code == null || code === token.text) {\n            return --pending || done();\n          }\n          token.text = code;\n          token.escaped = true;\n          --pending || done();\n        });\n      })(tokens[i]);\n    }\n\n    return;\n  }\n  try {\n    if (opt) opt = merge({}, marked.defaults, opt);\n    return Parser.parse(Lexer.lex(src, opt), opt);\n  } catch (e) {\n    e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n    if ((opt || marked.defaults).silent) {\n      return '<p>An error occurred:</p><pre>'\n        + escape(e.message + '', true)\n        + '</pre>';\n    }\n    throw e;\n  }\n}\n\n/**\n * Options\n */\n\nmarked.options =\nmarked.setOptions = function(opt) {\n  merge(marked.defaults, opt);\n  return marked;\n};\n\nmarked.getDefaults = function () {\n  return {\n    baseUrl: null,\n    breaks: false,\n    gfm: true,\n    headerIds: true,\n    headerPrefix: '',\n    highlight: null,\n    langPrefix: 'language-',\n    mangle: true,\n    pedantic: false,\n    renderer: new Renderer(),\n    sanitize: false,\n    sanitizer: null,\n    silent: false,\n    smartLists: false,\n    smartypants: false,\n    tables: true,\n    xhtml: false\n  };\n};\n\nmarked.defaults = marked.getDefaults();\n\n/**\n * Expose\n */\n\nmarked.Parser = Parser;\nmarked.parser = Parser.parse;\n\nmarked.Renderer = Renderer;\nmarked.TextRenderer = TextRenderer;\n\nmarked.Lexer = Lexer;\nmarked.lexer = Lexer.lex;\n\nmarked.InlineLexer = InlineLexer;\nmarked.inlineLexer = InlineLexer.output;\n\nmarked.Slugger = Slugger;\n\nmarked.parse = marked;\n\n// BEGIN MONACOCHANGE\n// if (typeof module !== 'undefined' && typeof exports === 'object') {\n//   module.exports = marked;\n// } else if (typeof define === 'function' && define.amd) {\n//   define(function() { return marked; });\n// } else {\n//   root.marked = marked;\n// }\n// })(this || (typeof window !== 'undefined' ? window : global));\n__marked_exports = marked;\n}).call(this);\n\n// ESM-comment-begin\n// define(function() { return __marked_exports; });\n// ESM-comment-end\n\n// ESM-uncomment-begin\nexport var marked = __marked_exports;\nexport var Parser = __marked_exports.Parser;\nexport var parser = __marked_exports.parser;\nexport var Renderer = __marked_exports.Renderer;\nexport var TextRenderer = __marked_exports.TextRenderer;\nexport var Lexer = __marked_exports.Lexer;\nexport var lexer = __marked_exports.lexer;\nexport var InlineLexer = __marked_exports.InlineLexer;\nexport var inlineLexer = __marked_exports.inlineLexer;\nexport var parse = __marked_exports.parse;\n// ESM-uncomment-end\n// END MONACOCHANGE\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { toggleClass } from '../../../base/browser/dom.js';\r\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nvar ContentHoverWidget = /** @class */ (function (_super) {\r\n    __extends(ContentHoverWidget, _super);\r\n    function ContentHoverWidget(id, editor) {\r\n        var _this = _super.call(this) || this;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        _this.allowEditorOverflow = true;\r\n        _this._id = id;\r\n        _this._editor = editor;\r\n        _this._isVisible = false;\r\n        _this._stoleFocus = false;\r\n        _this._containerDomNode = document.createElement('div');\r\n        _this._containerDomNode.className = 'monaco-editor-hover hidden';\r\n        _this._containerDomNode.tabIndex = 0;\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'monaco-editor-hover-content';\r\n        _this.scrollbar = new DomScrollableElement(_this._domNode, {});\r\n        _this._register(_this.scrollbar);\r\n        _this._containerDomNode.appendChild(_this.scrollbar.getDomNode());\r\n        _this.onkeydown(_this._containerDomNode, function (e) {\r\n            if (e.equals(9 /* Escape */)) {\r\n                _this.hide();\r\n            }\r\n        });\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(32 /* fontInfo */)) {\r\n                _this.updateFont();\r\n            }\r\n        }));\r\n        _this._editor.onDidLayoutChange(function (e) { return _this.layout(); });\r\n        _this.layout();\r\n        _this._editor.addContentWidget(_this);\r\n        _this._showAtPosition = null;\r\n        _this._showAtRange = null;\r\n        _this._stoleFocus = false;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ContentHoverWidget.prototype, \"isVisible\", {\r\n        get: function () {\r\n            return this._isVisible;\r\n        },\r\n        set: function (value) {\r\n            this._isVisible = value;\r\n            toggleClass(this._containerDomNode, 'hidden', !this._isVisible);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ContentHoverWidget.prototype.getId = function () {\r\n        return this._id;\r\n    };\r\n    ContentHoverWidget.prototype.getDomNode = function () {\r\n        return this._containerDomNode;\r\n    };\r\n    ContentHoverWidget.prototype.showAt = function (position, range, focus) {\r\n        // Position has changed\r\n        this._showAtPosition = position;\r\n        this._showAtRange = range;\r\n        this.isVisible = true;\r\n        this._editor.layoutContentWidget(this);\r\n        // Simply force a synchronous render on the editor\r\n        // such that the widget does not really render with left = '0px'\r\n        this._editor.render();\r\n        this._stoleFocus = focus;\r\n        if (focus) {\r\n            this._containerDomNode.focus();\r\n        }\r\n    };\r\n    ContentHoverWidget.prototype.hide = function () {\r\n        if (!this.isVisible) {\r\n            return;\r\n        }\r\n        this.isVisible = false;\r\n        this._editor.layoutContentWidget(this);\r\n        if (this._stoleFocus) {\r\n            this._editor.focus();\r\n        }\r\n    };\r\n    ContentHoverWidget.prototype.getPosition = function () {\r\n        if (this.isVisible) {\r\n            return {\r\n                position: this._showAtPosition,\r\n                range: this._showAtRange,\r\n                preference: [\r\n                    1 /* ABOVE */,\r\n                    2 /* BELOW */\r\n                ]\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    ContentHoverWidget.prototype.dispose = function () {\r\n        this._editor.removeContentWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ContentHoverWidget.prototype.updateFont = function () {\r\n        var _this = this;\r\n        var codeClasses = Array.prototype.slice.call(this._domNode.getElementsByClassName('code'));\r\n        codeClasses.forEach(function (node) { return _this._editor.applyFontInfo(node); });\r\n    };\r\n    ContentHoverWidget.prototype.updateContents = function (node) {\r\n        this._domNode.textContent = '';\r\n        this._domNode.appendChild(node);\r\n        this.updateFont();\r\n        this._editor.layoutContentWidget(this);\r\n        this.onContentsChange();\r\n    };\r\n    ContentHoverWidget.prototype.onContentsChange = function () {\r\n        this.scrollbar.scanDomNode();\r\n    };\r\n    ContentHoverWidget.prototype.layout = function () {\r\n        var height = Math.max(this._editor.getLayoutInfo().height / 4, 250);\r\n        var _a = this._editor.getOption(32 /* fontInfo */), fontSize = _a.fontSize, lineHeight = _a.lineHeight;\r\n        this._domNode.style.fontSize = fontSize + \"px\";\r\n        this._domNode.style.lineHeight = lineHeight + \"px\";\r\n        this._domNode.style.maxHeight = height + \"px\";\r\n        this._domNode.style.maxWidth = Math.max(this._editor.getLayoutInfo().width * 0.66, 500) + \"px\";\r\n    };\r\n    return ContentHoverWidget;\r\n}(Widget));\r\nexport { ContentHoverWidget };\r\nvar GlyphHoverWidget = /** @class */ (function (_super) {\r\n    __extends(GlyphHoverWidget, _super);\r\n    function GlyphHoverWidget(id, editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._id = id;\r\n        _this._editor = editor;\r\n        _this._isVisible = false;\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'monaco-editor-hover hidden';\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._showAtLineNumber = -1;\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(32 /* fontInfo */)) {\r\n                _this.updateFont();\r\n            }\r\n        }));\r\n        _this._editor.addOverlayWidget(_this);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(GlyphHoverWidget.prototype, \"isVisible\", {\r\n        get: function () {\r\n            return this._isVisible;\r\n        },\r\n        set: function (value) {\r\n            this._isVisible = value;\r\n            toggleClass(this._domNode, 'hidden', !this._isVisible);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    GlyphHoverWidget.prototype.getId = function () {\r\n        return this._id;\r\n    };\r\n    GlyphHoverWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    GlyphHoverWidget.prototype.showAt = function (lineNumber) {\r\n        this._showAtLineNumber = lineNumber;\r\n        if (!this.isVisible) {\r\n            this.isVisible = true;\r\n        }\r\n        var editorLayout = this._editor.getLayoutInfo();\r\n        var topForLineNumber = this._editor.getTopForLineNumber(this._showAtLineNumber);\r\n        var editorScrollTop = this._editor.getScrollTop();\r\n        var lineHeight = this._editor.getOption(47 /* lineHeight */);\r\n        var nodeHeight = this._domNode.clientHeight;\r\n        var top = topForLineNumber - editorScrollTop - ((nodeHeight - lineHeight) / 2);\r\n        this._domNode.style.left = editorLayout.glyphMarginLeft + editorLayout.glyphMarginWidth + \"px\";\r\n        this._domNode.style.top = Math.max(Math.round(top), 0) + \"px\";\r\n    };\r\n    GlyphHoverWidget.prototype.hide = function () {\r\n        if (!this.isVisible) {\r\n            return;\r\n        }\r\n        this.isVisible = false;\r\n    };\r\n    GlyphHoverWidget.prototype.getPosition = function () {\r\n        return null;\r\n    };\r\n    GlyphHoverWidget.prototype.dispose = function () {\r\n        this._editor.removeOverlayWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    GlyphHoverWidget.prototype.updateFont = function () {\r\n        var _this = this;\r\n        var codeTags = Array.prototype.slice.call(this._domNode.getElementsByTagName('code'));\r\n        var codeClasses = Array.prototype.slice.call(this._domNode.getElementsByClassName('code'));\r\n        __spreadArrays(codeTags, codeClasses).forEach(function (node) { return _this._editor.applyFontInfo(node); });\r\n    };\r\n    GlyphHoverWidget.prototype.updateContents = function (node) {\r\n        this._domNode.textContent = '';\r\n        this._domNode.appendChild(node);\r\n        this.updateFont();\r\n    };\r\n    return GlyphHoverWidget;\r\n}(Widget));\r\nexport { GlyphHoverWidget };\r\n","/*\nThe MIT License (MIT)\n\nCopyright  2015 Nicolas Bevacqua\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n*/\n\nlet __insane_func;\n\n(function () { function r(e, n, t) { function o(i, f) { if (!n[i]) { if (!e[i]) { var c = \"function\" == typeof require && require; if (!f && c) return c(i, !0); if (u) return u(i, !0); var a = new Error(\"Cannot find module '\" + i + \"'\"); throw a.code = \"MODULE_NOT_FOUND\", a } var p = n[i] = { exports: {} }; e[i][0].call(p.exports, function (r) { var n = e[i][1][r]; return o(n || r) }, p, p.exports, r, e, n, t) } return n[i].exports } for (var u = \"function\" == typeof require && require, i = 0; i < t.length; i++)o(t[i]); return o } return r })()({\n\t1: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar toMap = require('./toMap');\n\t\tvar uris = ['background', 'base', 'cite', 'href', 'longdesc', 'src', 'usemap'];\n\n\t\tmodule.exports = {\n\t\t\turis: toMap(uris) // attributes that have an href and hence need to be sanitized\n\t\t};\n\n\t}, { \"./toMap\": 10 }], 2: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar defaults = {\n\t\t\tallowedAttributes: {\n\t\t\t\t'*': ['title', 'accesskey'],\n\t\t\t\ta: ['href', 'name', 'target', 'aria-label'],\n\t\t\t\tiframe: ['allowfullscreen', 'frameborder', 'src'],\n\t\t\t\timg: ['src', 'alt', 'title', 'aria-label']\n\t\t\t},\n\t\t\tallowedClasses: {},\n\t\t\tallowedSchemes: ['http', 'https', 'mailto'],\n\t\t\tallowedTags: [\n\t\t\t\t'a', 'abbr', 'article', 'b', 'blockquote', 'br', 'caption', 'code', 'del', 'details', 'div', 'em',\n\t\t\t\t'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 'ins', 'kbd', 'li', 'main', 'mark',\n\t\t\t\t'ol', 'p', 'pre', 'section', 'span', 'strike', 'strong', 'sub', 'summary', 'sup', 'table',\n\t\t\t\t'tbody', 'td', 'th', 'thead', 'tr', 'u', 'ul'\n\t\t\t],\n\t\t\tfilter: null\n\t\t};\n\n\t\tmodule.exports = defaults;\n\n\t}, {}], 3: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar toMap = require('./toMap');\n\t\tvar voids = ['area', 'br', 'col', 'hr', 'img', 'wbr', 'input', 'base', 'basefont', 'link', 'meta'];\n\n\t\tmodule.exports = {\n\t\t\tvoids: toMap(voids)\n\t\t};\n\n\t}, { \"./toMap\": 10 }], 4: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar he = require('he');\n\t\tvar assign = require('assignment');\n\t\tvar parser = require('./parser');\n\t\tvar sanitizer = require('./sanitizer');\n\t\tvar defaults = require('./defaults');\n\n\t\tfunction insane(html, options, strict) {\n\t\t\tvar buffer = [];\n\t\t\tvar configuration = strict === true ? options : assign({}, defaults, options);\n\t\t\tvar handler = sanitizer(buffer, configuration);\n\n\t\t\tparser(html, handler);\n\n\t\t\treturn buffer.join('');\n\t\t}\n\n\t\tinsane.defaults = defaults;\n\t\tmodule.exports = insane;\n\t\t__insane_func = insane;\n\n\t}, { \"./defaults\": 2, \"./parser\": 7, \"./sanitizer\": 8, \"assignment\": 6, \"he\": 9 }], 5: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tmodule.exports = function lowercase(string) {\n\t\t\treturn typeof string === 'string' ? string.toLowerCase() : string;\n\t\t};\n\n\t}, {}], 6: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tfunction assignment(result) {\n\t\t\tvar stack = Array.prototype.slice.call(arguments, 1);\n\t\t\tvar item;\n\t\t\tvar key;\n\t\t\twhile (stack.length) {\n\t\t\t\titem = stack.shift();\n\t\t\t\tfor (key in item) {\n\t\t\t\t\tif (item.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (Object.prototype.toString.call(result[key]) === '[object Object]') {\n\t\t\t\t\t\t\tresult[key] = assignment(result[key], item[key]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult[key] = item[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\n\t\tmodule.exports = assignment;\n\n\t}, {}], 7: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar he = require('he');\n\t\tvar lowercase = require('./lowercase');\n\t\tvar attributes = require('./attributes');\n\t\tvar elements = require('./elements');\n\t\tvar rstart = /^<\\s*([\\w:-]+)((?:\\s+[\\w:-]+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)\\s*>/;\n\t\tvar rend = /^<\\s*\\/\\s*([\\w:-]+)[^>]*>/;\n\t\tvar rattrs = /([\\w:-]+)(?:\\s*=\\s*(?:(?:\"((?:[^\"])*)\")|(?:'((?:[^'])*)')|([^>\\s]+)))?/g;\n\t\tvar rtag = /^</;\n\t\tvar rtagend = /^<\\s*\\//;\n\n\t\tfunction createStack() {\n\t\t\tvar stack = [];\n\t\t\tstack.lastItem = function lastItem() {\n\t\t\t\treturn stack[stack.length - 1];\n\t\t\t};\n\t\t\treturn stack;\n\t\t}\n\n\t\tfunction parser(html, handler) {\n\t\t\tvar stack = createStack();\n\t\t\tvar last = html;\n\t\t\tvar chars;\n\n\t\t\twhile (html) {\n\t\t\t\tparsePart();\n\t\t\t}\n\t\t\tparseEndTag(); // clean up any remaining tags\n\n\t\t\tfunction parsePart() {\n\t\t\t\tchars = true;\n\t\t\t\tparseTag();\n\n\t\t\t\tvar same = html === last;\n\t\t\t\tlast = html;\n\n\t\t\t\tif (same) { // discard, because it's invalid\n\t\t\t\t\thtml = '';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseTag() {\n\t\t\t\tif (html.substr(0, 4) === '<!--') { // comments\n\t\t\t\t\tparseComment();\n\t\t\t\t} else if (rtagend.test(html)) {\n\t\t\t\t\tparseEdge(rend, parseEndTag);\n\t\t\t\t} else if (rtag.test(html)) {\n\t\t\t\t\tparseEdge(rstart, parseStartTag);\n\t\t\t\t}\n\t\t\t\tparseTagDecode();\n\t\t\t}\n\n\t\t\tfunction parseEdge(regex, parser) {\n\t\t\t\tvar match = html.match(regex);\n\t\t\t\tif (match) {\n\t\t\t\t\thtml = html.substring(match[0].length);\n\t\t\t\t\tmatch[0].replace(regex, parser);\n\t\t\t\t\tchars = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseComment() {\n\t\t\t\tvar index = html.indexOf('-->');\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\tif (handler.comment) {\n\t\t\t\t\t\thandler.comment(html.substring(4, index));\n\t\t\t\t\t}\n\t\t\t\t\thtml = html.substring(index + 3);\n\t\t\t\t\tchars = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseTagDecode() {\n\t\t\t\tif (!chars) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar text;\n\t\t\t\tvar index = html.indexOf('<');\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\ttext = html.substring(0, index);\n\t\t\t\t\thtml = html.substring(index);\n\t\t\t\t} else {\n\t\t\t\t\ttext = html;\n\t\t\t\t\thtml = '';\n\t\t\t\t}\n\t\t\t\tif (handler.chars) {\n\t\t\t\t\thandler.chars(text);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseStartTag(tag, tagName, rest, unary) {\n\t\t\t\tvar attrs = {};\n\t\t\t\tvar low = lowercase(tagName);\n\t\t\t\tvar u = elements.voids[low] || !!unary;\n\n\t\t\t\trest.replace(rattrs, attrReplacer);\n\n\t\t\t\tif (!u) {\n\t\t\t\t\tstack.push(low);\n\t\t\t\t}\n\t\t\t\tif (handler.start) {\n\t\t\t\t\thandler.start(low, attrs, u);\n\t\t\t\t}\n\n\t\t\t\tfunction attrReplacer(match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {\n\t\t\t\t\tif (doubleQuotedValue === void 0 && singleQuotedValue === void 0 && unquotedValue === void 0) {\n\t\t\t\t\t\tattrs[name] = void 0; // attribute is like <button disabled></button>\n\t\t\t\t\t} else {\n\t\t\t\t\t\tattrs[name] = he.decode(doubleQuotedValue || singleQuotedValue || unquotedValue || '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseEndTag(tag, tagName) {\n\t\t\t\tvar i;\n\t\t\t\tvar pos = 0;\n\t\t\t\tvar low = lowercase(tagName);\n\t\t\t\tif (low) {\n\t\t\t\t\tfor (pos = stack.length - 1; pos >= 0; pos--) {\n\t\t\t\t\t\tif (stack[pos] === low) {\n\t\t\t\t\t\t\tbreak; // find the closest opened tag of the same type\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pos >= 0) {\n\t\t\t\t\tfor (i = stack.length - 1; i >= pos; i--) {\n\t\t\t\t\t\tif (handler.end) { // close all the open elements, up the stack\n\t\t\t\t\t\t\thandler.end(stack[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstack.length = pos;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmodule.exports = parser;\n\n\t}, { \"./attributes\": 1, \"./elements\": 3, \"./lowercase\": 5, \"he\": 9 }], 8: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar he = require('he');\n\t\tvar lowercase = require('./lowercase');\n\t\tvar attributes = require('./attributes');\n\t\tvar elements = require('./elements');\n\n\t\tfunction sanitizer(buffer, options) {\n\t\t\tvar last;\n\t\t\tvar context;\n\t\t\tvar o = options || {};\n\n\t\t\treset();\n\n\t\t\treturn {\n\t\t\t\tstart: start,\n\t\t\t\tend: end,\n\t\t\t\tchars: chars\n\t\t\t};\n\n\t\t\tfunction out(value) {\n\t\t\t\tbuffer.push(value);\n\t\t\t}\n\n\t\t\tfunction start(tag, attrs, unary) {\n\t\t\t\tvar low = lowercase(tag);\n\n\t\t\t\tif (context.ignoring) {\n\t\t\t\t\tignore(low); return;\n\t\t\t\t}\n\t\t\t\tif ((o.allowedTags || []).indexOf(low) === -1) {\n\t\t\t\t\tignore(low); return;\n\t\t\t\t}\n\t\t\t\tif (o.filter && !o.filter({ tag: low, attrs: attrs })) {\n\t\t\t\t\tignore(low); return;\n\t\t\t\t}\n\n\t\t\t\tout('<');\n\t\t\t\tout(low);\n\t\t\t\tObject.keys(attrs).forEach(parse);\n\t\t\t\tout(unary ? '/>' : '>');\n\n\t\t\t\tfunction parse(key) {\n\t\t\t\t\tvar value = attrs[key];\n\t\t\t\t\tvar classesOk = (o.allowedClasses || {})[low] || [];\n\t\t\t\t\tvar attrsOk = (o.allowedAttributes || {})[low] || [];\n\t\t\t\t\tattrsOk = attrsOk.concat((o.allowedAttributes || {})['*'] || []);\n\t\t\t\t\tvar valid;\n\t\t\t\t\tvar lkey = lowercase(key);\n\t\t\t\t\tif (lkey === 'class' && attrsOk.indexOf(lkey) === -1) {\n\t\t\t\t\t\tvalue = value.split(' ').filter(isValidClass).join(' ').trim();\n\t\t\t\t\t\tvalid = value.length;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalid = attrsOk.indexOf(lkey) !== -1 && (attributes.uris[lkey] !== true || testUrl(value));\n\t\t\t\t\t}\n\t\t\t\t\tif (valid) {\n\t\t\t\t\t\tout(' ');\n\t\t\t\t\t\tout(key);\n\t\t\t\t\t\tif (typeof value === 'string') {\n\t\t\t\t\t\t\tout('=\"');\n\t\t\t\t\t\t\tout(he.encode(value));\n\t\t\t\t\t\t\tout('\"');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfunction isValidClass(className) {\n\t\t\t\t\t\treturn classesOk && classesOk.indexOf(className) !== -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction end(tag) {\n\t\t\t\tvar low = lowercase(tag);\n\t\t\t\tvar allowed = (o.allowedTags || []).indexOf(low) !== -1;\n\t\t\t\tif (allowed) {\n\t\t\t\t\tif (context.ignoring === false) {\n\t\t\t\t\t\tout('</');\n\t\t\t\t\t\tout(low);\n\t\t\t\t\t\tout('>');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tunignore(low);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tunignore(low);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction testUrl(text) {\n\t\t\t\tvar start = text[0];\n\t\t\t\tif (start === '#' || start === '/') {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar colon = text.indexOf(':');\n\t\t\t\tif (colon === -1) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar questionmark = text.indexOf('?');\n\t\t\t\tif (questionmark !== -1 && colon > questionmark) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar hash = text.indexOf('#');\n\t\t\t\tif (hash !== -1 && colon > hash) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn o.allowedSchemes.some(matches);\n\n\t\t\t\tfunction matches(scheme) {\n\t\t\t\t\treturn text.indexOf(scheme + ':') === 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction chars(text) {\n\t\t\t\tif (context.ignoring === false) {\n\t\t\t\t\tout(o.transformText ? o.transformText(text) : text);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction ignore(tag) {\n\t\t\t\tif (elements.voids[tag]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (context.ignoring === false) {\n\t\t\t\t\tcontext = { ignoring: tag, depth: 1 };\n\t\t\t\t} else if (context.ignoring === tag) {\n\t\t\t\t\tcontext.depth++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction unignore(tag) {\n\t\t\t\tif (context.ignoring === tag) {\n\t\t\t\t\tif (--context.depth <= 0) {\n\t\t\t\t\t\treset();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction reset() {\n\t\t\t\tcontext = { ignoring: false, depth: 0 };\n\t\t\t}\n\t\t}\n\n\t\tmodule.exports = sanitizer;\n\n\t}, { \"./attributes\": 1, \"./elements\": 3, \"./lowercase\": 5, \"he\": 9 }], 9: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar escapes = {\n\t\t\t'&': '&amp;',\n\t\t\t'<': '&lt;',\n\t\t\t'>': '&gt;',\n\t\t\t'\"': '&quot;',\n\t\t\t\"'\": '&#39;'\n\t\t};\n\t\tvar unescapes = {\n\t\t\t'&amp;': '&',\n\t\t\t'&lt;': '<',\n\t\t\t'&gt;': '>',\n\t\t\t'&quot;': '\"',\n\t\t\t'&#39;': \"'\"\n\t\t};\n\t\tvar rescaped = /(&amp;|&lt;|&gt;|&quot;|&#39;)/g;\n\t\tvar runescaped = /[&<>\"']/g;\n\n\t\tfunction escapeHtmlChar(match) {\n\t\t\treturn escapes[match];\n\t\t}\n\t\tfunction unescapeHtmlChar(match) {\n\t\t\treturn unescapes[match];\n\t\t}\n\n\t\tfunction escapeHtml(text) {\n\t\t\treturn text == null ? '' : String(text).replace(runescaped, escapeHtmlChar);\n\t\t}\n\n\t\tfunction unescapeHtml(html) {\n\t\t\treturn html == null ? '' : String(html).replace(rescaped, unescapeHtmlChar);\n\t\t}\n\n\t\tescapeHtml.options = unescapeHtml.options = {};\n\n\t\tmodule.exports = {\n\t\t\tencode: escapeHtml,\n\t\t\tescape: escapeHtml,\n\t\t\tdecode: unescapeHtml,\n\t\t\tunescape: unescapeHtml,\n\t\t\tversion: '1.0.0-browser'\n\t\t};\n\n\t}, {}], 10: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tfunction toMap(list) {\n\t\t\treturn list.reduce(asKey, {});\n\t\t}\n\n\t\tfunction asKey(accumulator, item) {\n\t\t\taccumulator[item] = true;\n\t\t\treturn accumulator;\n\t\t}\n\n\t\tmodule.exports = toMap;\n\n\t}, {}]\n}, {}, [4]);\n\n// ESM-comment-begin\n// define(function() { return { insane: __insane_func }; });\n// ESM-comment-end\n\n// ESM-uncomment-begin\nexport var insane = __insane_func;\n// ESM-uncomment-end\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as DOM from './dom.js';\r\nimport { createElement } from './formattedTextRenderer.js';\r\nimport { onUnexpectedError } from '../common/errors.js';\r\nimport { parseHrefAndDimensions, removeMarkdownEscapes } from '../common/htmlContent.js';\r\nimport { defaultGenerator } from '../common/idGenerator.js';\r\nimport * as marked from '../common/marked/marked.js';\r\nimport { insane } from '../common/insane/insane.js';\r\nimport { parse } from '../common/marshalling.js';\r\nimport { cloneAndChange } from '../common/objects.js';\r\nimport { escape } from '../common/strings.js';\r\nimport { URI } from '../common/uri.js';\r\nimport { Schemas } from '../common/network.js';\r\n/**\r\n * Create html nodes for the given content element.\r\n */\r\nexport function renderMarkdown(markdown, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var element = createElement(options);\r\n    var _uriMassage = function (part) {\r\n        var data;\r\n        try {\r\n            data = parse(decodeURIComponent(part));\r\n        }\r\n        catch (e) {\r\n            // ignore\r\n        }\r\n        if (!data) {\r\n            return part;\r\n        }\r\n        data = cloneAndChange(data, function (value) {\r\n            if (markdown.uris && markdown.uris[value]) {\r\n                return URI.revive(markdown.uris[value]);\r\n            }\r\n            else {\r\n                return undefined;\r\n            }\r\n        });\r\n        return encodeURIComponent(JSON.stringify(data));\r\n    };\r\n    var _href = function (href, isDomUri) {\r\n        var data = markdown.uris && markdown.uris[href];\r\n        if (!data) {\r\n            return href; // no uri exists\r\n        }\r\n        var uri = URI.revive(data);\r\n        if (URI.parse(href).toString() === uri.toString()) {\r\n            return href; // no tranformation performed\r\n        }\r\n        if (isDomUri) {\r\n            uri = DOM.asDomUri(uri);\r\n        }\r\n        if (uri.query) {\r\n            uri = uri.with({ query: _uriMassage(uri.query) });\r\n        }\r\n        return uri.toString(true);\r\n    };\r\n    // signal to code-block render that the\r\n    // element has been created\r\n    var signalInnerHTML;\r\n    var withInnerHTML = new Promise(function (c) { return signalInnerHTML = c; });\r\n    var renderer = new marked.Renderer();\r\n    renderer.image = function (href, title, text) {\r\n        var _a;\r\n        var dimensions = [];\r\n        var attributes = [];\r\n        if (href) {\r\n            (_a = parseHrefAndDimensions(href), href = _a.href, dimensions = _a.dimensions);\r\n            href = _href(href, true);\r\n            attributes.push(\"src=\\\"\" + href + \"\\\"\");\r\n        }\r\n        if (text) {\r\n            attributes.push(\"alt=\\\"\" + text + \"\\\"\");\r\n        }\r\n        if (title) {\r\n            attributes.push(\"title=\\\"\" + title + \"\\\"\");\r\n        }\r\n        if (dimensions.length) {\r\n            attributes = attributes.concat(dimensions);\r\n        }\r\n        return '<img ' + attributes.join(' ') + '>';\r\n    };\r\n    renderer.link = function (href, title, text) {\r\n        // Remove markdown escapes. Workaround for https://github.com/chjj/marked/issues/829\r\n        if (href === text) { // raw link case\r\n            text = removeMarkdownEscapes(text);\r\n        }\r\n        href = _href(href, false);\r\n        title = removeMarkdownEscapes(title);\r\n        href = removeMarkdownEscapes(href);\r\n        if (!href\r\n            || href.match(/^data:|javascript:/i)\r\n            || (href.match(/^command:/i) && !markdown.isTrusted)\r\n            || href.match(/^command:(\\/\\/\\/)?_workbench\\.downloadResource/i)) {\r\n            // drop the link\r\n            return text;\r\n        }\r\n        else {\r\n            // HTML Encode href\r\n            href = href.replace(/&/g, '&amp;')\r\n                .replace(/</g, '&lt;')\r\n                .replace(/>/g, '&gt;')\r\n                .replace(/\"/g, '&quot;')\r\n                .replace(/'/g, '&#39;');\r\n            return \"<a href=\\\"#\\\" data-href=\\\"\" + href + \"\\\" title=\\\"\" + (title || href) + \"\\\">\" + text + \"</a>\";\r\n        }\r\n    };\r\n    renderer.paragraph = function (text) {\r\n        return \"<p>\" + text + \"</p>\";\r\n    };\r\n    if (options.codeBlockRenderer) {\r\n        renderer.code = function (code, lang) {\r\n            var value = options.codeBlockRenderer(lang, code);\r\n            // when code-block rendering is async we return sync\r\n            // but update the node with the real result later.\r\n            var id = defaultGenerator.nextId();\r\n            var promise = Promise.all([value, withInnerHTML]).then(function (values) {\r\n                var strValue = values[0];\r\n                var span = element.querySelector(\"div[data-code=\\\"\" + id + \"\\\"]\");\r\n                if (span) {\r\n                    span.innerHTML = strValue;\r\n                }\r\n            }).catch(function (err) {\r\n                // ignore\r\n            });\r\n            if (options.codeBlockRenderCallback) {\r\n                promise.then(options.codeBlockRenderCallback);\r\n            }\r\n            return \"<div class=\\\"code\\\" data-code=\\\"\" + id + \"\\\">\" + escape(code) + \"</div>\";\r\n        };\r\n    }\r\n    var actionHandler = options.actionHandler;\r\n    if (actionHandler) {\r\n        actionHandler.disposeables.add(DOM.addStandardDisposableListener(element, 'click', function (event) {\r\n            var target = event.target;\r\n            if (target.tagName !== 'A') {\r\n                target = target.parentElement;\r\n                if (!target || target.tagName !== 'A') {\r\n                    return;\r\n                }\r\n            }\r\n            try {\r\n                var href = target.dataset['href'];\r\n                if (href) {\r\n                    actionHandler.callback(href, event);\r\n                }\r\n            }\r\n            catch (err) {\r\n                onUnexpectedError(err);\r\n            }\r\n            finally {\r\n                event.preventDefault();\r\n            }\r\n        }));\r\n    }\r\n    var markedOptions = {\r\n        sanitize: true,\r\n        renderer: renderer\r\n    };\r\n    var allowedSchemes = [Schemas.http, Schemas.https, Schemas.mailto, Schemas.data, Schemas.file, Schemas.vscodeRemote, Schemas.vscodeRemoteResource];\r\n    if (markdown.isTrusted) {\r\n        allowedSchemes.push(Schemas.command);\r\n    }\r\n    var renderedMarkdown = marked.parse(markdown.value, markedOptions);\r\n    element.innerHTML = insane(renderedMarkdown, {\r\n        allowedSchemes: allowedSchemes,\r\n        allowedAttributes: {\r\n            'a': ['href', 'name', 'target', 'data-href'],\r\n            'iframe': ['allowfullscreen', 'frameborder', 'src'],\r\n            'img': ['src', 'title', 'alt', 'width', 'height'],\r\n            'div': ['class', 'data-code'],\r\n            'span': ['class']\r\n        }\r\n    });\r\n    signalInnerHTML();\r\n    return element;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { renderMarkdown } from '../../../base/browser/markdownRenderer.js';\r\nimport { IOpenerService, NullOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { tokenizeToString } from '../../common/modes/textToHtmlTokenizer.js';\r\nimport { optional } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore, Disposable } from '../../../base/common/lifecycle.js';\r\nimport { TokenizationRegistry } from '../../common/modes.js';\r\nvar MarkdownRenderer = /** @class */ (function (_super) {\r\n    __extends(MarkdownRenderer, _super);\r\n    function MarkdownRenderer(_editor, _modeService, _openerService) {\r\n        if (_openerService === void 0) { _openerService = NullOpenerService; }\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._modeService = _modeService;\r\n        _this._openerService = _openerService;\r\n        _this._onDidRenderCodeBlock = _this._register(new Emitter());\r\n        _this.onDidRenderCodeBlock = _this._onDidRenderCodeBlock.event;\r\n        return _this;\r\n    }\r\n    MarkdownRenderer.prototype.getOptions = function (disposeables) {\r\n        var _this = this;\r\n        return {\r\n            codeBlockRenderer: function (languageAlias, value) {\r\n                // In markdown,\r\n                // it is possible that we stumble upon language aliases (e.g.js instead of javascript)\r\n                // it is possible no alias is given in which case we fall back to the current editor lang\r\n                var modeId = null;\r\n                if (languageAlias) {\r\n                    modeId = _this._modeService.getModeIdForLanguageName(languageAlias);\r\n                }\r\n                else {\r\n                    var model = _this._editor.getModel();\r\n                    if (model) {\r\n                        modeId = model.getLanguageIdentifier().language;\r\n                    }\r\n                }\r\n                _this._modeService.triggerMode(modeId || '');\r\n                return Promise.resolve(true).then(function (_) {\r\n                    var promise = TokenizationRegistry.getPromise(modeId || '');\r\n                    if (promise) {\r\n                        return promise.then(function (support) { return tokenizeToString(value, support); });\r\n                    }\r\n                    return tokenizeToString(value, undefined);\r\n                }).then(function (code) {\r\n                    return \"<span style=\\\"font-family: \" + _this._editor.getOption(32 /* fontInfo */).fontFamily + \"\\\">\" + code + \"</span>\";\r\n                });\r\n            },\r\n            codeBlockRenderCallback: function () { return _this._onDidRenderCodeBlock.fire(); },\r\n            actionHandler: {\r\n                callback: function (content) {\r\n                    _this._openerService.open(content, { fromUserGesture: true }).catch(onUnexpectedError);\r\n                },\r\n                disposeables: disposeables\r\n            }\r\n        };\r\n    };\r\n    MarkdownRenderer.prototype.render = function (markdown) {\r\n        var disposeables = new DisposableStore();\r\n        var element;\r\n        if (!markdown) {\r\n            element = document.createElement('span');\r\n        }\r\n        else {\r\n            element = renderMarkdown(markdown, this.getOptions(disposeables));\r\n        }\r\n        return {\r\n            element: element,\r\n            dispose: function () { return disposeables.dispose(); }\r\n        };\r\n    };\r\n    MarkdownRenderer = __decorate([\r\n        __param(1, IModeService),\r\n        __param(2, optional(IOpenerService))\r\n    ], MarkdownRenderer);\r\n    return MarkdownRenderer;\r\n}(Disposable));\r\nexport { MarkdownRenderer };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { Color, RGBA } from '../../../base/common/color.js';\r\nimport { MarkdownString, isEmptyMarkdownString, markedStringsEquals } from '../../../base/common/htmlContent.js';\r\nimport { toDisposable, DisposableStore, combinedDisposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { HoverProviderRegistry, TokenizationRegistry } from '../../common/modes.js';\r\nimport { getColorPresentations } from '../colorPicker/color.js';\r\nimport { ColorDetector } from '../colorPicker/colorDetector.js';\r\nimport { ColorPickerModel } from '../colorPicker/colorPickerModel.js';\r\nimport { ColorPickerWidget } from '../colorPicker/colorPickerWidget.js';\r\nimport { getHover } from './getHover.js';\r\nimport { HoverOperation } from './hoverOperation.js';\r\nimport { ContentHoverWidget } from './hoverWidgets.js';\r\nimport { MarkdownRenderer } from '../markdown/markdownRenderer.js';\r\nimport { coalesce, isNonEmptyArray, asArray } from '../../../base/common/arrays.js';\r\nimport { IMarkerData, MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { NullOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { MarkerController, NextMarkerAction } from '../gotoError/gotoError.js';\r\nimport { createCancelablePromise } from '../../../base/common/async.js';\r\nimport { getCodeActions } from '../codeAction/codeAction.js';\r\nimport { QuickFixAction, QuickFixController } from '../codeAction/codeActionCommands.js';\r\nimport { CodeActionKind } from '../codeAction/types.js';\r\nvar $ = dom.$;\r\nvar ColorHover = /** @class */ (function () {\r\n    function ColorHover(range, color, provider) {\r\n        this.range = range;\r\n        this.color = color;\r\n        this.provider = provider;\r\n    }\r\n    return ColorHover;\r\n}());\r\nvar MarkerHover = /** @class */ (function () {\r\n    function MarkerHover(range, marker) {\r\n        this.range = range;\r\n        this.marker = marker;\r\n    }\r\n    return MarkerHover;\r\n}());\r\nvar ModesContentComputer = /** @class */ (function () {\r\n    function ModesContentComputer(editor, _markerDecorationsService) {\r\n        this._markerDecorationsService = _markerDecorationsService;\r\n        this._editor = editor;\r\n        this._result = [];\r\n    }\r\n    ModesContentComputer.prototype.setRange = function (range) {\r\n        this._range = range;\r\n        this._result = [];\r\n    };\r\n    ModesContentComputer.prototype.clearResult = function () {\r\n        this._result = [];\r\n    };\r\n    ModesContentComputer.prototype.computeAsync = function (token) {\r\n        if (!this._editor.hasModel() || !this._range) {\r\n            return Promise.resolve([]);\r\n        }\r\n        var model = this._editor.getModel();\r\n        if (!HoverProviderRegistry.has(model)) {\r\n            return Promise.resolve([]);\r\n        }\r\n        return getHover(model, new Position(this._range.startLineNumber, this._range.startColumn), token);\r\n    };\r\n    ModesContentComputer.prototype.computeSync = function () {\r\n        var _this = this;\r\n        if (!this._editor.hasModel() || !this._range) {\r\n            return [];\r\n        }\r\n        var model = this._editor.getModel();\r\n        var lineNumber = this._range.startLineNumber;\r\n        if (lineNumber > this._editor.getModel().getLineCount()) {\r\n            // Illegal line number => no results\r\n            return [];\r\n        }\r\n        var colorDetector = ColorDetector.get(this._editor);\r\n        var maxColumn = model.getLineMaxColumn(lineNumber);\r\n        var lineDecorations = this._editor.getLineDecorations(lineNumber);\r\n        var didFindColor = false;\r\n        var hoverRange = this._range;\r\n        var result = lineDecorations.map(function (d) {\r\n            var startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\r\n            var endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\r\n            if (startColumn > hoverRange.startColumn || hoverRange.endColumn > endColumn) {\r\n                return null;\r\n            }\r\n            var range = new Range(hoverRange.startLineNumber, startColumn, hoverRange.startLineNumber, endColumn);\r\n            var marker = _this._markerDecorationsService.getMarker(model, d);\r\n            if (marker) {\r\n                return new MarkerHover(range, marker);\r\n            }\r\n            var colorData = colorDetector.getColorData(d.range.getStartPosition());\r\n            if (!didFindColor && colorData) {\r\n                didFindColor = true;\r\n                var _a = colorData.colorInfo, color = _a.color, range_1 = _a.range;\r\n                return new ColorHover(range_1, color, colorData.provider);\r\n            }\r\n            else {\r\n                if (isEmptyMarkdownString(d.options.hoverMessage)) {\r\n                    return null;\r\n                }\r\n                var contents = d.options.hoverMessage ? asArray(d.options.hoverMessage) : [];\r\n                return { contents: contents, range: range };\r\n            }\r\n        });\r\n        return coalesce(result);\r\n    };\r\n    ModesContentComputer.prototype.onResult = function (result, isFromSynchronousComputation) {\r\n        // Always put synchronous messages before asynchronous ones\r\n        if (isFromSynchronousComputation) {\r\n            this._result = result.concat(this._result.sort(function (a, b) {\r\n                if (a instanceof ColorHover) { // sort picker messages at to the top\r\n                    return -1;\r\n                }\r\n                else if (b instanceof ColorHover) {\r\n                    return 1;\r\n                }\r\n                return 0;\r\n            }));\r\n        }\r\n        else {\r\n            this._result = this._result.concat(result);\r\n        }\r\n    };\r\n    ModesContentComputer.prototype.getResult = function () {\r\n        return this._result.slice(0);\r\n    };\r\n    ModesContentComputer.prototype.getResultWithLoadingMessage = function () {\r\n        return this._result.slice(0).concat([this._getLoadingMessage()]);\r\n    };\r\n    ModesContentComputer.prototype._getLoadingMessage = function () {\r\n        return {\r\n            range: this._range,\r\n            contents: [new MarkdownString().appendText(nls.localize('modesContentHover.loading', \"Loading...\"))]\r\n        };\r\n    };\r\n    return ModesContentComputer;\r\n}());\r\nvar ModesContentHoverWidget = /** @class */ (function (_super) {\r\n    __extends(ModesContentHoverWidget, _super);\r\n    function ModesContentHoverWidget(editor, markerDecorationsService, _themeService, _keybindingService, _modeService, _openerService) {\r\n        if (_openerService === void 0) { _openerService = NullOpenerService; }\r\n        var _this = _super.call(this, ModesContentHoverWidget.ID, editor) || this;\r\n        _this._themeService = _themeService;\r\n        _this._keybindingService = _keybindingService;\r\n        _this._modeService = _modeService;\r\n        _this._openerService = _openerService;\r\n        _this.renderDisposable = _this._register(new MutableDisposable());\r\n        _this._messages = [];\r\n        _this._lastRange = null;\r\n        _this._computer = new ModesContentComputer(_this._editor, markerDecorationsService);\r\n        _this._highlightDecorations = [];\r\n        _this._isChangingDecorations = false;\r\n        _this._shouldFocus = false;\r\n        _this._colorPicker = null;\r\n        _this._hoverOperation = new HoverOperation(_this._computer, function (result) { return _this._withResult(result, true); }, null, function (result) { return _this._withResult(result, false); }, _this._editor.getOption(42 /* hover */).delay);\r\n        _this._register(dom.addStandardDisposableListener(_this.getDomNode(), dom.EventType.FOCUS, function () {\r\n            if (_this._colorPicker) {\r\n                dom.addClass(_this.getDomNode(), 'colorpicker-hover');\r\n            }\r\n        }));\r\n        _this._register(dom.addStandardDisposableListener(_this.getDomNode(), dom.EventType.BLUR, function () {\r\n            dom.removeClass(_this.getDomNode(), 'colorpicker-hover');\r\n        }));\r\n        _this._register(editor.onDidChangeConfiguration(function (e) {\r\n            _this._hoverOperation.setHoverTime(_this._editor.getOption(42 /* hover */).delay);\r\n        }));\r\n        _this._register(TokenizationRegistry.onDidChange(function (e) {\r\n            if (_this.isVisible && _this._lastRange && _this._messages.length > 0) {\r\n                _this._domNode.textContent = '';\r\n                _this._renderMessages(_this._lastRange, _this._messages);\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    ModesContentHoverWidget.prototype.dispose = function () {\r\n        this._hoverOperation.cancel();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ModesContentHoverWidget.prototype.onModelDecorationsChanged = function () {\r\n        if (this._isChangingDecorations) {\r\n            return;\r\n        }\r\n        if (this.isVisible) {\r\n            // The decorations have changed and the hover is visible,\r\n            // we need to recompute the displayed text\r\n            this._hoverOperation.cancel();\r\n            this._computer.clearResult();\r\n            if (!this._colorPicker) { // TODO@Michel ensure that displayed text for other decorations is computed even if color picker is in place\r\n                this._hoverOperation.start(0 /* Delayed */);\r\n            }\r\n        }\r\n    };\r\n    ModesContentHoverWidget.prototype.startShowingAt = function (range, mode, focus) {\r\n        if (this._lastRange && this._lastRange.equalsRange(range)) {\r\n            // We have to show the widget at the exact same range as before, so no work is needed\r\n            return;\r\n        }\r\n        this._hoverOperation.cancel();\r\n        if (this.isVisible) {\r\n            // The range might have changed, but the hover is visible\r\n            // Instead of hiding it completely, filter out messages that are still in the new range and\r\n            // kick off a new computation\r\n            if (!this._showAtPosition || this._showAtPosition.lineNumber !== range.startLineNumber) {\r\n                this.hide();\r\n            }\r\n            else {\r\n                var filteredMessages = [];\r\n                for (var i = 0, len = this._messages.length; i < len; i++) {\r\n                    var msg = this._messages[i];\r\n                    var rng = msg.range;\r\n                    if (rng && rng.startColumn <= range.startColumn && rng.endColumn >= range.endColumn) {\r\n                        filteredMessages.push(msg);\r\n                    }\r\n                }\r\n                if (filteredMessages.length > 0) {\r\n                    if (hoverContentsEquals(filteredMessages, this._messages)) {\r\n                        return;\r\n                    }\r\n                    this._renderMessages(range, filteredMessages);\r\n                }\r\n                else {\r\n                    this.hide();\r\n                }\r\n            }\r\n        }\r\n        this._lastRange = range;\r\n        this._computer.setRange(range);\r\n        this._shouldFocus = focus;\r\n        this._hoverOperation.start(mode);\r\n    };\r\n    ModesContentHoverWidget.prototype.hide = function () {\r\n        this._lastRange = null;\r\n        this._hoverOperation.cancel();\r\n        _super.prototype.hide.call(this);\r\n        this._isChangingDecorations = true;\r\n        this._highlightDecorations = this._editor.deltaDecorations(this._highlightDecorations, []);\r\n        this._isChangingDecorations = false;\r\n        this.renderDisposable.clear();\r\n        this._colorPicker = null;\r\n    };\r\n    ModesContentHoverWidget.prototype.isColorPickerVisible = function () {\r\n        if (this._colorPicker) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ModesContentHoverWidget.prototype._withResult = function (result, complete) {\r\n        this._messages = result;\r\n        if (this._lastRange && this._messages.length > 0) {\r\n            this._renderMessages(this._lastRange, this._messages);\r\n        }\r\n        else if (complete) {\r\n            this.hide();\r\n        }\r\n    };\r\n    ModesContentHoverWidget.prototype._renderMessages = function (renderRange, messages) {\r\n        var _this = this;\r\n        this.renderDisposable.dispose();\r\n        this._colorPicker = null;\r\n        // update column from which to show\r\n        var renderColumn = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n        var highlightRange = messages[0].range ? Range.lift(messages[0].range) : null;\r\n        var fragment = document.createDocumentFragment();\r\n        var isEmptyHoverContent = true;\r\n        var containColorPicker = false;\r\n        var markdownDisposeables = new DisposableStore();\r\n        var markerMessages = [];\r\n        messages.forEach(function (msg) {\r\n            if (!msg.range) {\r\n                return;\r\n            }\r\n            renderColumn = Math.min(renderColumn, msg.range.startColumn);\r\n            highlightRange = highlightRange ? Range.plusRange(highlightRange, msg.range) : Range.lift(msg.range);\r\n            if (msg instanceof ColorHover) {\r\n                containColorPicker = true;\r\n                var _a = msg.color, red = _a.red, green = _a.green, blue = _a.blue, alpha = _a.alpha;\r\n                var rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\r\n                var color_1 = new Color(rgba);\r\n                if (!_this._editor.hasModel()) {\r\n                    return;\r\n                }\r\n                var editorModel_1 = _this._editor.getModel();\r\n                var range_2 = new Range(msg.range.startLineNumber, msg.range.startColumn, msg.range.endLineNumber, msg.range.endColumn);\r\n                var colorInfo = { range: msg.range, color: msg.color };\r\n                // create blank olor picker model and widget first to ensure it's positioned correctly.\r\n                var model_1 = new ColorPickerModel(color_1, [], 0);\r\n                var widget_1 = new ColorPickerWidget(fragment, model_1, _this._editor.getOption(101 /* pixelRatio */), _this._themeService);\r\n                getColorPresentations(editorModel_1, colorInfo, msg.provider, CancellationToken.None).then(function (colorPresentations) {\r\n                    model_1.colorPresentations = colorPresentations || [];\r\n                    if (!_this._editor.hasModel()) {\r\n                        // gone...\r\n                        return;\r\n                    }\r\n                    var originalText = _this._editor.getModel().getValueInRange(msg.range);\r\n                    model_1.guessColorPresentation(color_1, originalText);\r\n                    var updateEditorModel = function () {\r\n                        var textEdits;\r\n                        var newRange;\r\n                        if (model_1.presentation.textEdit) {\r\n                            textEdits = [model_1.presentation.textEdit];\r\n                            newRange = new Range(model_1.presentation.textEdit.range.startLineNumber, model_1.presentation.textEdit.range.startColumn, model_1.presentation.textEdit.range.endLineNumber, model_1.presentation.textEdit.range.endColumn);\r\n                            newRange = newRange.setEndPosition(newRange.endLineNumber, newRange.startColumn + model_1.presentation.textEdit.text.length);\r\n                        }\r\n                        else {\r\n                            textEdits = [{ identifier: null, range: range_2, text: model_1.presentation.label, forceMoveMarkers: false }];\r\n                            newRange = range_2.setEndPosition(range_2.endLineNumber, range_2.startColumn + model_1.presentation.label.length);\r\n                        }\r\n                        _this._editor.pushUndoStop();\r\n                        _this._editor.executeEdits('colorpicker', textEdits);\r\n                        if (model_1.presentation.additionalTextEdits) {\r\n                            textEdits = __spreadArrays(model_1.presentation.additionalTextEdits);\r\n                            _this._editor.executeEdits('colorpicker', textEdits);\r\n                            _this.hide();\r\n                        }\r\n                        _this._editor.pushUndoStop();\r\n                        range_2 = newRange;\r\n                    };\r\n                    var updateColorPresentations = function (color) {\r\n                        return getColorPresentations(editorModel_1, {\r\n                            range: range_2,\r\n                            color: {\r\n                                red: color.rgba.r / 255,\r\n                                green: color.rgba.g / 255,\r\n                                blue: color.rgba.b / 255,\r\n                                alpha: color.rgba.a\r\n                            }\r\n                        }, msg.provider, CancellationToken.None).then(function (colorPresentations) {\r\n                            model_1.colorPresentations = colorPresentations || [];\r\n                        });\r\n                    };\r\n                    var colorListener = model_1.onColorFlushed(function (color) {\r\n                        updateColorPresentations(color).then(updateEditorModel);\r\n                    });\r\n                    var colorChangeListener = model_1.onDidChangeColor(updateColorPresentations);\r\n                    _this._colorPicker = widget_1;\r\n                    _this.showAt(range_2.getStartPosition(), range_2, _this._shouldFocus);\r\n                    _this.updateContents(fragment);\r\n                    _this._colorPicker.layout();\r\n                    _this.renderDisposable.value = combinedDisposable(colorListener, colorChangeListener, widget_1, markdownDisposeables);\r\n                });\r\n            }\r\n            else {\r\n                if (msg instanceof MarkerHover) {\r\n                    markerMessages.push(msg);\r\n                    isEmptyHoverContent = false;\r\n                }\r\n                else {\r\n                    msg.contents\r\n                        .filter(function (contents) { return !isEmptyMarkdownString(contents); })\r\n                        .forEach(function (contents) {\r\n                        var markdownHoverElement = $('div.hover-row.markdown-hover');\r\n                        var hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\r\n                        var renderer = markdownDisposeables.add(new MarkdownRenderer(_this._editor, _this._modeService, _this._openerService));\r\n                        markdownDisposeables.add(renderer.onDidRenderCodeBlock(function () {\r\n                            hoverContentsElement.className = 'hover-contents code-hover-contents';\r\n                            _this.onContentsChange();\r\n                        }));\r\n                        var renderedContents = markdownDisposeables.add(renderer.render(contents));\r\n                        hoverContentsElement.appendChild(renderedContents.element);\r\n                        fragment.appendChild(markdownHoverElement);\r\n                        isEmptyHoverContent = false;\r\n                    });\r\n                }\r\n            }\r\n        });\r\n        if (markerMessages.length) {\r\n            markerMessages.forEach(function (msg) { return fragment.appendChild(_this.renderMarkerHover(msg)); });\r\n            var markerHoverForStatusbar = markerMessages.length === 1 ? markerMessages[0] : markerMessages.sort(function (a, b) { return MarkerSeverity.compare(a.marker.severity, b.marker.severity); })[0];\r\n            fragment.appendChild(this.renderMarkerStatusbar(markerHoverForStatusbar));\r\n        }\r\n        // show\r\n        if (!containColorPicker && !isEmptyHoverContent) {\r\n            this.showAt(new Position(renderRange.startLineNumber, renderColumn), highlightRange, this._shouldFocus);\r\n            this.updateContents(fragment);\r\n        }\r\n        this._isChangingDecorations = true;\r\n        this._highlightDecorations = this._editor.deltaDecorations(this._highlightDecorations, highlightRange ? [{\r\n                range: highlightRange,\r\n                options: ModesContentHoverWidget._DECORATION_OPTIONS\r\n            }] : []);\r\n        this._isChangingDecorations = false;\r\n    };\r\n    ModesContentHoverWidget.prototype.renderMarkerHover = function (markerHover) {\r\n        var _this = this;\r\n        var hoverElement = $('div.hover-row');\r\n        var markerElement = dom.append(hoverElement, $('div.marker.hover-contents'));\r\n        var _a = markerHover.marker, source = _a.source, message = _a.message, code = _a.code, relatedInformation = _a.relatedInformation;\r\n        this._editor.applyFontInfo(markerElement);\r\n        var messageElement = dom.append(markerElement, $('span'));\r\n        messageElement.style.whiteSpace = 'pre-wrap';\r\n        messageElement.innerText = message;\r\n        if (source || code) {\r\n            var detailsElement = dom.append(markerElement, $('span'));\r\n            detailsElement.style.opacity = '0.6';\r\n            detailsElement.style.paddingLeft = '6px';\r\n            detailsElement.innerText = source && code ? source + \"(\" + code + \")\" : source ? source : \"(\" + code + \")\";\r\n        }\r\n        if (isNonEmptyArray(relatedInformation)) {\r\n            var _loop_1 = function (message_1, resource, startLineNumber, startColumn) {\r\n                var relatedInfoContainer = dom.append(markerElement, $('div'));\r\n                relatedInfoContainer.style.marginTop = '8px';\r\n                var a = dom.append(relatedInfoContainer, $('a'));\r\n                a.innerText = basename(resource) + \"(\" + startLineNumber + \", \" + startColumn + \"): \";\r\n                a.style.cursor = 'pointer';\r\n                a.onclick = function (e) {\r\n                    e.stopPropagation();\r\n                    e.preventDefault();\r\n                    if (_this._openerService) {\r\n                        _this._openerService.open(resource.with({ fragment: startLineNumber + \",\" + startColumn }), { fromUserGesture: true }).catch(onUnexpectedError);\r\n                    }\r\n                };\r\n                var messageElement_1 = dom.append(relatedInfoContainer, $('span'));\r\n                messageElement_1.innerText = message_1;\r\n                this_1._editor.applyFontInfo(messageElement_1);\r\n            };\r\n            var this_1 = this;\r\n            for (var _i = 0, relatedInformation_1 = relatedInformation; _i < relatedInformation_1.length; _i++) {\r\n                var _b = relatedInformation_1[_i], message_1 = _b.message, resource = _b.resource, startLineNumber = _b.startLineNumber, startColumn = _b.startColumn;\r\n                _loop_1(message_1, resource, startLineNumber, startColumn);\r\n            }\r\n        }\r\n        return hoverElement;\r\n    };\r\n    ModesContentHoverWidget.prototype.renderMarkerStatusbar = function (markerHover) {\r\n        var _this = this;\r\n        var hoverElement = $('div.hover-row.status-bar');\r\n        var disposables = new DisposableStore();\r\n        var actionsElement = dom.append(hoverElement, $('div.actions'));\r\n        if (markerHover.marker.severity === MarkerSeverity.Error || markerHover.marker.severity === MarkerSeverity.Warning || markerHover.marker.severity === MarkerSeverity.Info) {\r\n            disposables.add(this.renderAction(actionsElement, {\r\n                label: nls.localize('peek problem', \"Peek Problem\"),\r\n                commandId: NextMarkerAction.ID,\r\n                run: function () {\r\n                    _this.hide();\r\n                    MarkerController.get(_this._editor).show(markerHover.marker);\r\n                    _this._editor.focus();\r\n                }\r\n            }));\r\n        }\r\n        var quickfixPlaceholderElement = dom.append(actionsElement, $('div'));\r\n        quickfixPlaceholderElement.style.opacity = '0';\r\n        quickfixPlaceholderElement.style.transition = 'opacity 0.2s';\r\n        setTimeout(function () { return quickfixPlaceholderElement.style.opacity = '1'; }, 200);\r\n        quickfixPlaceholderElement.textContent = nls.localize('checkingForQuickFixes', \"Checking for quick fixes...\");\r\n        disposables.add(toDisposable(function () { return quickfixPlaceholderElement.remove(); }));\r\n        var codeActionsPromise = this.getCodeActions(markerHover.marker);\r\n        disposables.add(toDisposable(function () { return codeActionsPromise.cancel(); }));\r\n        codeActionsPromise.then(function (actions) {\r\n            quickfixPlaceholderElement.style.transition = '';\r\n            quickfixPlaceholderElement.style.opacity = '1';\r\n            if (!actions.validActions.length) {\r\n                actions.dispose();\r\n                quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\r\n                return;\r\n            }\r\n            quickfixPlaceholderElement.remove();\r\n            var showing = false;\r\n            disposables.add(toDisposable(function () {\r\n                if (!showing) {\r\n                    actions.dispose();\r\n                }\r\n            }));\r\n            disposables.add(_this.renderAction(actionsElement, {\r\n                label: nls.localize('quick fixes', \"Quick Fix...\"),\r\n                commandId: QuickFixAction.Id,\r\n                run: function (target) {\r\n                    showing = true;\r\n                    var controller = QuickFixController.get(_this._editor);\r\n                    var elementPosition = dom.getDomNodePagePosition(target);\r\n                    controller.showCodeActions(actions, {\r\n                        x: elementPosition.left + 6,\r\n                        y: elementPosition.top + elementPosition.height + 6\r\n                    });\r\n                }\r\n            }));\r\n        });\r\n        this.renderDisposable.value = disposables;\r\n        return hoverElement;\r\n    };\r\n    ModesContentHoverWidget.prototype.getCodeActions = function (marker) {\r\n        var _this = this;\r\n        return createCancelablePromise(function (cancellationToken) {\r\n            return getCodeActions(_this._editor.getModel(), new Range(marker.startLineNumber, marker.startColumn, marker.endLineNumber, marker.endColumn), { type: 'manual', filter: { include: CodeActionKind.QuickFix } }, cancellationToken);\r\n        });\r\n    };\r\n    ModesContentHoverWidget.prototype.renderAction = function (parent, actionOptions) {\r\n        var actionContainer = dom.append(parent, $('div.action-container'));\r\n        var action = dom.append(actionContainer, $('a.action'));\r\n        if (actionOptions.iconClass) {\r\n            dom.append(action, $(\"span.icon.\" + actionOptions.iconClass));\r\n        }\r\n        var label = dom.append(action, $('span'));\r\n        label.textContent = actionOptions.label;\r\n        var keybinding = this._keybindingService.lookupKeybinding(actionOptions.commandId);\r\n        if (keybinding) {\r\n            label.title = actionOptions.label + \" (\" + keybinding.getLabel() + \")\";\r\n        }\r\n        return dom.addDisposableListener(actionContainer, dom.EventType.CLICK, function (e) {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            actionOptions.run(actionContainer);\r\n        });\r\n    };\r\n    ModesContentHoverWidget.ID = 'editor.contrib.modesContentHoverWidget';\r\n    ModesContentHoverWidget._DECORATION_OPTIONS = ModelDecorationOptions.register({\r\n        className: 'hoverHighlight'\r\n    });\r\n    return ModesContentHoverWidget;\r\n}(ContentHoverWidget));\r\nexport { ModesContentHoverWidget };\r\nfunction hoverContentsEquals(first, second) {\r\n    if ((!first && second) || (first && !second) || first.length !== second.length) {\r\n        return false;\r\n    }\r\n    for (var i = 0; i < first.length; i++) {\r\n        var firstElement = first[i];\r\n        var secondElement = second[i];\r\n        if (firstElement instanceof MarkerHover && secondElement instanceof MarkerHover) {\r\n            return IMarkerData.makeKey(firstElement.marker) === IMarkerData.makeKey(secondElement.marker);\r\n        }\r\n        if (firstElement instanceof ColorHover || secondElement instanceof ColorHover) {\r\n            return false;\r\n        }\r\n        if (firstElement instanceof MarkerHover || secondElement instanceof MarkerHover) {\r\n            return false;\r\n        }\r\n        if (!markedStringsEquals(firstElement.contents, secondElement.contents)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { $ } from '../../../base/browser/dom.js';\r\nimport { isEmptyMarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { HoverOperation } from './hoverOperation.js';\r\nimport { GlyphHoverWidget } from './hoverWidgets.js';\r\nimport { MarkdownRenderer } from '../markdown/markdownRenderer.js';\r\nimport { NullOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { asArray } from '../../../base/common/arrays.js';\r\nvar MarginComputer = /** @class */ (function () {\r\n    function MarginComputer(editor) {\r\n        this._editor = editor;\r\n        this._lineNumber = -1;\r\n        this._result = [];\r\n    }\r\n    MarginComputer.prototype.setLineNumber = function (lineNumber) {\r\n        this._lineNumber = lineNumber;\r\n        this._result = [];\r\n    };\r\n    MarginComputer.prototype.clearResult = function () {\r\n        this._result = [];\r\n    };\r\n    MarginComputer.prototype.computeSync = function () {\r\n        var toHoverMessage = function (contents) {\r\n            return {\r\n                value: contents\r\n            };\r\n        };\r\n        var lineDecorations = this._editor.getLineDecorations(this._lineNumber);\r\n        var result = [];\r\n        if (!lineDecorations) {\r\n            return result;\r\n        }\r\n        for (var _i = 0, lineDecorations_1 = lineDecorations; _i < lineDecorations_1.length; _i++) {\r\n            var d = lineDecorations_1[_i];\r\n            if (!d.options.glyphMarginClassName) {\r\n                continue;\r\n            }\r\n            var hoverMessage = d.options.glyphMarginHoverMessage;\r\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\r\n                continue;\r\n            }\r\n            result.push.apply(result, asArray(hoverMessage).map(toHoverMessage));\r\n        }\r\n        return result;\r\n    };\r\n    MarginComputer.prototype.onResult = function (result, isFromSynchronousComputation) {\r\n        this._result = this._result.concat(result);\r\n    };\r\n    MarginComputer.prototype.getResult = function () {\r\n        return this._result;\r\n    };\r\n    MarginComputer.prototype.getResultWithLoadingMessage = function () {\r\n        return this.getResult();\r\n    };\r\n    return MarginComputer;\r\n}());\r\nvar ModesGlyphHoverWidget = /** @class */ (function (_super) {\r\n    __extends(ModesGlyphHoverWidget, _super);\r\n    function ModesGlyphHoverWidget(editor, modeService, openerService) {\r\n        if (openerService === void 0) { openerService = NullOpenerService; }\r\n        var _this = _super.call(this, ModesGlyphHoverWidget.ID, editor) || this;\r\n        _this._renderDisposeables = _this._register(new DisposableStore());\r\n        _this._messages = [];\r\n        _this._lastLineNumber = -1;\r\n        _this._markdownRenderer = _this._register(new MarkdownRenderer(_this._editor, modeService, openerService));\r\n        _this._computer = new MarginComputer(_this._editor);\r\n        _this._hoverOperation = new HoverOperation(_this._computer, function (result) { return _this._withResult(result); }, undefined, function (result) { return _this._withResult(result); }, 300);\r\n        return _this;\r\n    }\r\n    ModesGlyphHoverWidget.prototype.dispose = function () {\r\n        this._hoverOperation.cancel();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ModesGlyphHoverWidget.prototype.onModelDecorationsChanged = function () {\r\n        if (this.isVisible) {\r\n            // The decorations have changed and the hover is visible,\r\n            // we need to recompute the displayed text\r\n            this._hoverOperation.cancel();\r\n            this._computer.clearResult();\r\n            this._hoverOperation.start(0 /* Delayed */);\r\n        }\r\n    };\r\n    ModesGlyphHoverWidget.prototype.startShowingAt = function (lineNumber) {\r\n        if (this._lastLineNumber === lineNumber) {\r\n            // We have to show the widget at the exact same line number as before, so no work is needed\r\n            return;\r\n        }\r\n        this._hoverOperation.cancel();\r\n        this.hide();\r\n        this._lastLineNumber = lineNumber;\r\n        this._computer.setLineNumber(lineNumber);\r\n        this._hoverOperation.start(0 /* Delayed */);\r\n    };\r\n    ModesGlyphHoverWidget.prototype.hide = function () {\r\n        this._lastLineNumber = -1;\r\n        this._hoverOperation.cancel();\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ModesGlyphHoverWidget.prototype._withResult = function (result) {\r\n        this._messages = result;\r\n        if (this._messages.length > 0) {\r\n            this._renderMessages(this._lastLineNumber, this._messages);\r\n        }\r\n        else {\r\n            this.hide();\r\n        }\r\n    };\r\n    ModesGlyphHoverWidget.prototype._renderMessages = function (lineNumber, messages) {\r\n        this._renderDisposeables.clear();\r\n        var fragment = document.createDocumentFragment();\r\n        for (var _i = 0, messages_1 = messages; _i < messages_1.length; _i++) {\r\n            var msg = messages_1[_i];\r\n            var renderedContents = this._markdownRenderer.render(msg.value);\r\n            this._renderDisposeables.add(renderedContents);\r\n            fragment.appendChild($('div.hover-row', undefined, renderedContents.element));\r\n        }\r\n        this.updateContents(fragment);\r\n        this.showAt(lineNumber);\r\n    };\r\n    ModesGlyphHoverWidget.ID = 'editor.contrib.modesGlyphHoverWidget';\r\n    return ModesGlyphHoverWidget;\r\n}(GlyphHoverWidget));\r\nexport { ModesGlyphHoverWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './hover.css';\r\nimport * as nls from '../../../nls.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { ModesContentHoverWidget } from './modesContentHover.js';\r\nimport { ModesGlyphHoverWidget } from './modesGlyphHover.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorHoverBackground, editorHoverBorder, editorHoverHighlight, textCodeBlockBackground, textLinkForeground, editorHoverStatusBarBackground, editorHoverForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { IMarkerDecorationsService } from '../../common/services/markersDecorationService.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { GotoDefinitionAtPositionEditorContribution } from '../gotoSymbol/link/goToDefinitionAtPosition.js';\r\nvar ModesHoverController = /** @class */ (function () {\r\n    function ModesHoverController(_editor, _openerService, _modeService, _markerDecorationsService, _keybindingService, _themeService) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._openerService = _openerService;\r\n        this._modeService = _modeService;\r\n        this._markerDecorationsService = _markerDecorationsService;\r\n        this._keybindingService = _keybindingService;\r\n        this._themeService = _themeService;\r\n        this._toUnhook = new DisposableStore();\r\n        this._contentWidget = new MutableDisposable();\r\n        this._glyphWidget = new MutableDisposable();\r\n        this._isMouseDown = false;\r\n        this._hoverClicked = false;\r\n        this._hookEvents();\r\n        this._didChangeConfigurationHandler = this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(42 /* hover */)) {\r\n                _this._hideWidgets();\r\n                _this._unhookEvents();\r\n                _this._hookEvents();\r\n            }\r\n        });\r\n    }\r\n    Object.defineProperty(ModesHoverController.prototype, \"contentWidget\", {\r\n        get: function () {\r\n            if (!this._contentWidget.value) {\r\n                this._createHoverWidgets();\r\n            }\r\n            return this._contentWidget.value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ModesHoverController.prototype, \"glyphWidget\", {\r\n        get: function () {\r\n            if (!this._glyphWidget.value) {\r\n                this._createHoverWidgets();\r\n            }\r\n            return this._glyphWidget.value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ModesHoverController.get = function (editor) {\r\n        return editor.getContribution(ModesHoverController.ID);\r\n    };\r\n    ModesHoverController.prototype._hookEvents = function () {\r\n        var _this = this;\r\n        var hideWidgetsEventHandler = function () { return _this._hideWidgets(); };\r\n        var hoverOpts = this._editor.getOption(42 /* hover */);\r\n        this._isHoverEnabled = hoverOpts.enabled;\r\n        this._isHoverSticky = hoverOpts.sticky;\r\n        if (this._isHoverEnabled) {\r\n            this._toUnhook.add(this._editor.onMouseDown(function (e) { return _this._onEditorMouseDown(e); }));\r\n            this._toUnhook.add(this._editor.onMouseUp(function (e) { return _this._onEditorMouseUp(e); }));\r\n            this._toUnhook.add(this._editor.onMouseMove(function (e) { return _this._onEditorMouseMove(e); }));\r\n            this._toUnhook.add(this._editor.onKeyDown(function (e) { return _this._onKeyDown(e); }));\r\n            this._toUnhook.add(this._editor.onDidChangeModelDecorations(function () { return _this._onModelDecorationsChanged(); }));\r\n        }\r\n        else {\r\n            this._toUnhook.add(this._editor.onMouseMove(hideWidgetsEventHandler));\r\n        }\r\n        this._toUnhook.add(this._editor.onMouseLeave(hideWidgetsEventHandler));\r\n        this._toUnhook.add(this._editor.onDidChangeModel(hideWidgetsEventHandler));\r\n        this._toUnhook.add(this._editor.onDidScrollChange(function (e) { return _this._onEditorScrollChanged(e); }));\r\n    };\r\n    ModesHoverController.prototype._unhookEvents = function () {\r\n        this._toUnhook.clear();\r\n    };\r\n    ModesHoverController.prototype._onModelDecorationsChanged = function () {\r\n        this.contentWidget.onModelDecorationsChanged();\r\n        this.glyphWidget.onModelDecorationsChanged();\r\n    };\r\n    ModesHoverController.prototype._onEditorScrollChanged = function (e) {\r\n        if (e.scrollTopChanged || e.scrollLeftChanged) {\r\n            this._hideWidgets();\r\n        }\r\n    };\r\n    ModesHoverController.prototype._onEditorMouseDown = function (mouseEvent) {\r\n        this._isMouseDown = true;\r\n        var targetType = mouseEvent.target.type;\r\n        if (targetType === 9 /* CONTENT_WIDGET */ && mouseEvent.target.detail === ModesContentHoverWidget.ID) {\r\n            this._hoverClicked = true;\r\n            // mouse down on top of content hover widget\r\n            return;\r\n        }\r\n        if (targetType === 12 /* OVERLAY_WIDGET */ && mouseEvent.target.detail === ModesGlyphHoverWidget.ID) {\r\n            // mouse down on top of overlay hover widget\r\n            return;\r\n        }\r\n        if (targetType !== 12 /* OVERLAY_WIDGET */ && mouseEvent.target.detail !== ModesGlyphHoverWidget.ID) {\r\n            this._hoverClicked = false;\r\n        }\r\n        this._hideWidgets();\r\n    };\r\n    ModesHoverController.prototype._onEditorMouseUp = function (mouseEvent) {\r\n        this._isMouseDown = false;\r\n    };\r\n    ModesHoverController.prototype._onEditorMouseMove = function (mouseEvent) {\r\n        var targetType = mouseEvent.target.type;\r\n        if (this._isMouseDown && this._hoverClicked && this.contentWidget.isColorPickerVisible()) {\r\n            return;\r\n        }\r\n        if (this._isHoverSticky && targetType === 9 /* CONTENT_WIDGET */ && mouseEvent.target.detail === ModesContentHoverWidget.ID) {\r\n            // mouse moved on top of content hover widget\r\n            return;\r\n        }\r\n        if (this._isHoverSticky && targetType === 12 /* OVERLAY_WIDGET */ && mouseEvent.target.detail === ModesGlyphHoverWidget.ID) {\r\n            // mouse moved on top of overlay hover widget\r\n            return;\r\n        }\r\n        if (targetType === 7 /* CONTENT_EMPTY */) {\r\n            var epsilon = this._editor.getOption(32 /* fontInfo */).typicalHalfwidthCharacterWidth / 2;\r\n            var data = mouseEvent.target.detail;\r\n            if (data && !data.isAfterLines && typeof data.horizontalDistanceToText === 'number' && data.horizontalDistanceToText < epsilon) {\r\n                // Let hover kick in even when the mouse is technically in the empty area after a line, given the distance is small enough\r\n                targetType = 6 /* CONTENT_TEXT */;\r\n            }\r\n        }\r\n        if (targetType === 6 /* CONTENT_TEXT */) {\r\n            this.glyphWidget.hide();\r\n            if (this._isHoverEnabled && mouseEvent.target.range) {\r\n                this.contentWidget.startShowingAt(mouseEvent.target.range, 0 /* Delayed */, false);\r\n            }\r\n        }\r\n        else if (targetType === 2 /* GUTTER_GLYPH_MARGIN */) {\r\n            this.contentWidget.hide();\r\n            if (this._isHoverEnabled && mouseEvent.target.position) {\r\n                this.glyphWidget.startShowingAt(mouseEvent.target.position.lineNumber);\r\n            }\r\n        }\r\n        else {\r\n            this._hideWidgets();\r\n        }\r\n    };\r\n    ModesHoverController.prototype._onKeyDown = function (e) {\r\n        if (e.keyCode !== 5 /* Ctrl */ && e.keyCode !== 6 /* Alt */ && e.keyCode !== 57 /* Meta */ && e.keyCode !== 4 /* Shift */) {\r\n            // Do not hide hover when a modifier key is pressed\r\n            this._hideWidgets();\r\n        }\r\n    };\r\n    ModesHoverController.prototype._hideWidgets = function () {\r\n        if (!this._glyphWidget.value || !this._contentWidget.value || (this._isMouseDown && this._hoverClicked && this._contentWidget.value.isColorPickerVisible())) {\r\n            return;\r\n        }\r\n        this._glyphWidget.value.hide();\r\n        this._contentWidget.value.hide();\r\n    };\r\n    ModesHoverController.prototype._createHoverWidgets = function () {\r\n        this._contentWidget.value = new ModesContentHoverWidget(this._editor, this._markerDecorationsService, this._themeService, this._keybindingService, this._modeService, this._openerService);\r\n        this._glyphWidget.value = new ModesGlyphHoverWidget(this._editor, this._modeService, this._openerService);\r\n    };\r\n    ModesHoverController.prototype.showContentHover = function (range, mode, focus) {\r\n        this.contentWidget.startShowingAt(range, mode, focus);\r\n    };\r\n    ModesHoverController.prototype.dispose = function () {\r\n        this._unhookEvents();\r\n        this._toUnhook.dispose();\r\n        this._didChangeConfigurationHandler.dispose();\r\n        this._glyphWidget.dispose();\r\n        this._contentWidget.dispose();\r\n    };\r\n    ModesHoverController.ID = 'editor.contrib.hover';\r\n    ModesHoverController = __decorate([\r\n        __param(1, IOpenerService),\r\n        __param(2, IModeService),\r\n        __param(3, IMarkerDecorationsService),\r\n        __param(4, IKeybindingService),\r\n        __param(5, IThemeService)\r\n    ], ModesHoverController);\r\n    return ModesHoverController;\r\n}());\r\nexport { ModesHoverController };\r\nvar ShowHoverAction = /** @class */ (function (_super) {\r\n    __extends(ShowHoverAction, _super);\r\n    function ShowHoverAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.showHover',\r\n            label: nls.localize({\r\n                key: 'showHover',\r\n                comment: [\r\n                    'Label for action that will trigger the showing of a hover in the editor.',\r\n                    'This allows for users to show the hover without using the mouse.'\r\n                ]\r\n            }, \"Show Hover\"),\r\n            alias: 'Show Hover',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 39 /* KEY_I */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ShowHoverAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var controller = ModesHoverController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        var position = editor.getPosition();\r\n        var range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n        var focus = editor.getOption(2 /* accessibilitySupport */) === 2 /* Enabled */;\r\n        controller.showContentHover(range, 1 /* Immediate */, focus);\r\n    };\r\n    return ShowHoverAction;\r\n}(EditorAction));\r\nvar ShowDefinitionPreviewHoverAction = /** @class */ (function (_super) {\r\n    __extends(ShowDefinitionPreviewHoverAction, _super);\r\n    function ShowDefinitionPreviewHoverAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.showDefinitionPreviewHover',\r\n            label: nls.localize({\r\n                key: 'showDefinitionPreviewHover',\r\n                comment: [\r\n                    'Label for action that will trigger the showing of definition preview hover in the editor.',\r\n                    'This allows for users to show the definition preview hover without using the mouse.'\r\n                ]\r\n            }, \"Show Definition Preview Hover\"),\r\n            alias: 'Show Definition Preview Hover',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    ShowDefinitionPreviewHoverAction.prototype.run = function (accessor, editor) {\r\n        var controller = ModesHoverController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        var position = editor.getPosition();\r\n        if (!position) {\r\n            return;\r\n        }\r\n        var range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n        var goto = GotoDefinitionAtPositionEditorContribution.get(editor);\r\n        var promise = goto.startFindDefinitionFromCursor(position);\r\n        if (promise) {\r\n            promise.then(function () {\r\n                controller.showContentHover(range, 1 /* Immediate */, true);\r\n            });\r\n        }\r\n        else {\r\n            controller.showContentHover(range, 1 /* Immediate */, true);\r\n        }\r\n    };\r\n    return ShowDefinitionPreviewHoverAction;\r\n}(EditorAction));\r\nregisterEditorContribution(ModesHoverController.ID, ModesHoverController);\r\nregisterEditorAction(ShowHoverAction);\r\nregisterEditorAction(ShowDefinitionPreviewHoverAction);\r\n// theming\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var editorHoverHighlightColor = theme.getColor(editorHoverHighlight);\r\n    if (editorHoverHighlightColor) {\r\n        collector.addRule(\".monaco-editor .hoverHighlight { background-color: \" + editorHoverHighlightColor + \"; }\");\r\n    }\r\n    var hoverBackground = theme.getColor(editorHoverBackground);\r\n    if (hoverBackground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover { background-color: \" + hoverBackground + \"; }\");\r\n    }\r\n    var hoverBorder = theme.getColor(editorHoverBorder);\r\n    if (hoverBorder) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover { border: 1px solid \" + hoverBorder + \"; }\");\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid \" + hoverBorder.transparent(0.5) + \"; }\");\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover hr { border-top: 1px solid \" + hoverBorder.transparent(0.5) + \"; }\");\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover hr { border-bottom: 0px solid \" + hoverBorder.transparent(0.5) + \"; }\");\r\n    }\r\n    var link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover a { color: \" + link + \"; }\");\r\n    }\r\n    var hoverForeground = theme.getColor(editorHoverForeground);\r\n    if (hoverForeground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover { color: \" + hoverForeground + \"; }\");\r\n    }\r\n    var actionsBackground = theme.getColor(editorHoverStatusBarBackground);\r\n    if (actionsBackground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover .hover-row .actions { background-color: \" + actionsBackground + \"; }\");\r\n    }\r\n    var codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover code { background-color: \" + codeBackground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Selection } from '../../common/core/selection.js';\r\nvar InPlaceReplaceCommand = /** @class */ (function () {\r\n    function InPlaceReplaceCommand(editRange, originalSelection, text) {\r\n        this._editRange = editRange;\r\n        this._originalSelection = originalSelection;\r\n        this._text = text;\r\n    }\r\n    InPlaceReplaceCommand.prototype.getEditOperations = function (model, builder) {\r\n        builder.addTrackedEditOperation(this._editRange, this._text);\r\n    };\r\n    InPlaceReplaceCommand.prototype.computeCursorState = function (model, helper) {\r\n        var inverseEditOperations = helper.getInverseEditOperations();\r\n        var srcRange = inverseEditOperations[0].range;\r\n        if (!this._originalSelection.isEmpty()) {\r\n            // Preserve selection and extends to typed text\r\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn - this._text.length, srcRange.endLineNumber, srcRange.endColumn);\r\n        }\r\n        return new Selection(srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn), srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn));\r\n    };\r\n    return InPlaceReplaceCommand;\r\n}());\r\nexport { InPlaceReplaceCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { registerEditorAction, EditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { InPlaceReplaceCommand } from './inPlaceReplaceCommand.js';\r\nimport { EditorState } from '../../browser/core/editorState.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { editorBracketMatchBorder } from '../../common/view/editorColorRegistry.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { createCancelablePromise, timeout } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nvar InPlaceReplaceController = /** @class */ (function () {\r\n    function InPlaceReplaceController(editor, editorWorkerService) {\r\n        this.decorationIds = [];\r\n        this.editor = editor;\r\n        this.editorWorkerService = editorWorkerService;\r\n    }\r\n    InPlaceReplaceController.get = function (editor) {\r\n        return editor.getContribution(InPlaceReplaceController.ID);\r\n    };\r\n    InPlaceReplaceController.prototype.dispose = function () {\r\n    };\r\n    InPlaceReplaceController.prototype.run = function (source, up) {\r\n        var _this = this;\r\n        // cancel any pending request\r\n        if (this.currentRequest) {\r\n            this.currentRequest.cancel();\r\n        }\r\n        var editorSelection = this.editor.getSelection();\r\n        var model = this.editor.getModel();\r\n        if (!model || !editorSelection) {\r\n            return undefined;\r\n        }\r\n        var selection = editorSelection;\r\n        if (selection.startLineNumber !== selection.endLineNumber) {\r\n            // Can't accept multiline selection\r\n            return undefined;\r\n        }\r\n        var state = new EditorState(this.editor, 1 /* Value */ | 4 /* Position */);\r\n        var modelURI = model.uri;\r\n        if (!this.editorWorkerService.canNavigateValueSet(modelURI)) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        this.currentRequest = createCancelablePromise(function (token) { return _this.editorWorkerService.navigateValueSet(modelURI, selection, up); });\r\n        return this.currentRequest.then(function (result) {\r\n            if (!result || !result.range || !result.value) {\r\n                // No proper result\r\n                return;\r\n            }\r\n            if (!state.validate(_this.editor)) {\r\n                // state has changed\r\n                return;\r\n            }\r\n            // Selection\r\n            var editRange = Range.lift(result.range);\r\n            var highlightRange = result.range;\r\n            var diff = result.value.length - (selection.endColumn - selection.startColumn);\r\n            // highlight\r\n            highlightRange = {\r\n                startLineNumber: highlightRange.startLineNumber,\r\n                startColumn: highlightRange.startColumn,\r\n                endLineNumber: highlightRange.endLineNumber,\r\n                endColumn: highlightRange.startColumn + result.value.length\r\n            };\r\n            if (diff > 1) {\r\n                selection = new Selection(selection.startLineNumber, selection.startColumn, selection.endLineNumber, selection.endColumn + diff - 1);\r\n            }\r\n            // Insert new text\r\n            var command = new InPlaceReplaceCommand(editRange, selection, result.value);\r\n            _this.editor.pushUndoStop();\r\n            _this.editor.executeCommand(source, command);\r\n            _this.editor.pushUndoStop();\r\n            // add decoration\r\n            _this.decorationIds = _this.editor.deltaDecorations(_this.decorationIds, [{\r\n                    range: highlightRange,\r\n                    options: InPlaceReplaceController.DECORATION\r\n                }]);\r\n            // remove decoration after delay\r\n            if (_this.decorationRemover) {\r\n                _this.decorationRemover.cancel();\r\n            }\r\n            _this.decorationRemover = timeout(350);\r\n            _this.decorationRemover.then(function () { return _this.decorationIds = _this.editor.deltaDecorations(_this.decorationIds, []); }).catch(onUnexpectedError);\r\n        }).catch(onUnexpectedError);\r\n    };\r\n    InPlaceReplaceController.ID = 'editor.contrib.inPlaceReplaceController';\r\n    InPlaceReplaceController.DECORATION = ModelDecorationOptions.register({\r\n        className: 'valueSetReplacement'\r\n    });\r\n    InPlaceReplaceController = __decorate([\r\n        __param(1, IEditorWorkerService)\r\n    ], InPlaceReplaceController);\r\n    return InPlaceReplaceController;\r\n}());\r\nvar InPlaceReplaceUp = /** @class */ (function (_super) {\r\n    __extends(InPlaceReplaceUp, _super);\r\n    function InPlaceReplaceUp() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.inPlaceReplace.up',\r\n            label: nls.localize('InPlaceReplaceAction.previous.label', \"Replace with Previous Value\"),\r\n            alias: 'Replace with Previous Value',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 82 /* US_COMMA */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InPlaceReplaceUp.prototype.run = function (accessor, editor) {\r\n        var controller = InPlaceReplaceController.get(editor);\r\n        if (!controller) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        return controller.run(this.id, true);\r\n    };\r\n    return InPlaceReplaceUp;\r\n}(EditorAction));\r\nvar InPlaceReplaceDown = /** @class */ (function (_super) {\r\n    __extends(InPlaceReplaceDown, _super);\r\n    function InPlaceReplaceDown() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.inPlaceReplace.down',\r\n            label: nls.localize('InPlaceReplaceAction.next.label', \"Replace with Next Value\"),\r\n            alias: 'Replace with Next Value',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 84 /* US_DOT */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InPlaceReplaceDown.prototype.run = function (accessor, editor) {\r\n        var controller = InPlaceReplaceController.get(editor);\r\n        if (!controller) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        return controller.run(this.id, false);\r\n    };\r\n    return InPlaceReplaceDown;\r\n}(EditorAction));\r\nregisterEditorContribution(InPlaceReplaceController.ID, InPlaceReplaceController);\r\nregisterEditorAction(InPlaceReplaceUp);\r\nregisterEditorAction(InPlaceReplaceDown);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(editorBracketMatchBorder);\r\n    if (border) {\r\n        collector.addRule(\".monaco-editor.vs .valueSetReplacement { outline: solid 2px \" + border + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { EditOperation } from '../core/editOperation.js';\r\nimport { Range } from '../core/range.js';\r\nvar TrimTrailingWhitespaceCommand = /** @class */ (function () {\r\n    function TrimTrailingWhitespaceCommand(selection, cursors) {\r\n        this._selection = selection;\r\n        this._cursors = cursors;\r\n        this._selectionId = null;\r\n    }\r\n    TrimTrailingWhitespaceCommand.prototype.getEditOperations = function (model, builder) {\r\n        var ops = trimTrailingWhitespace(model, this._cursors);\r\n        for (var i = 0, len = ops.length; i < len; i++) {\r\n            var op = ops[i];\r\n            builder.addEditOperation(op.range, op.text);\r\n        }\r\n        this._selectionId = builder.trackSelection(this._selection);\r\n    };\r\n    TrimTrailingWhitespaceCommand.prototype.computeCursorState = function (model, helper) {\r\n        return helper.getTrackedSelection(this._selectionId);\r\n    };\r\n    return TrimTrailingWhitespaceCommand;\r\n}());\r\nexport { TrimTrailingWhitespaceCommand };\r\n/**\r\n * Generate commands for trimming trailing whitespace on a model and ignore lines on which cursors are sitting.\r\n */\r\nexport function trimTrailingWhitespace(model, cursors) {\r\n    // Sort cursors ascending\r\n    cursors.sort(function (a, b) {\r\n        if (a.lineNumber === b.lineNumber) {\r\n            return a.column - b.column;\r\n        }\r\n        return a.lineNumber - b.lineNumber;\r\n    });\r\n    // Reduce multiple cursors on the same line and only keep the last one on the line\r\n    for (var i = cursors.length - 2; i >= 0; i--) {\r\n        if (cursors[i].lineNumber === cursors[i + 1].lineNumber) {\r\n            // Remove cursor at `i`\r\n            cursors.splice(i, 1);\r\n        }\r\n    }\r\n    var r = [];\r\n    var rLen = 0;\r\n    var cursorIndex = 0;\r\n    var cursorLen = cursors.length;\r\n    for (var lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        var maxLineColumn = lineContent.length + 1;\r\n        var minEditColumn = 0;\r\n        if (cursorIndex < cursorLen && cursors[cursorIndex].lineNumber === lineNumber) {\r\n            minEditColumn = cursors[cursorIndex].column;\r\n            cursorIndex++;\r\n            if (minEditColumn === maxLineColumn) {\r\n                // The cursor is at the end of the line => no edits for sure on this line\r\n                continue;\r\n            }\r\n        }\r\n        if (lineContent.length === 0) {\r\n            continue;\r\n        }\r\n        var lastNonWhitespaceIndex = strings.lastNonWhitespaceIndex(lineContent);\r\n        var fromColumn = 0;\r\n        if (lastNonWhitespaceIndex === -1) {\r\n            // Entire line is whitespace\r\n            fromColumn = 1;\r\n        }\r\n        else if (lastNonWhitespaceIndex !== lineContent.length - 1) {\r\n            // There is trailing whitespace\r\n            fromColumn = lastNonWhitespaceIndex + 2;\r\n        }\r\n        else {\r\n            // There is no trailing whitespace\r\n            continue;\r\n        }\r\n        fromColumn = Math.max(minEditColumn, fromColumn);\r\n        r[rLen++] = EditOperation.delete(new Range(lineNumber, fromColumn, lineNumber, maxLineColumn));\r\n    }\r\n    return r;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nvar CopyLinesCommand = /** @class */ (function () {\r\n    function CopyLinesCommand(selection, isCopyingDown) {\r\n        this._selection = selection;\r\n        this._isCopyingDown = isCopyingDown;\r\n        this._selectionDirection = 0 /* LTR */;\r\n        this._selectionId = null;\r\n        this._startLineNumberDelta = 0;\r\n        this._endLineNumberDelta = 0;\r\n    }\r\n    CopyLinesCommand.prototype.getEditOperations = function (model, builder) {\r\n        var s = this._selection;\r\n        this._startLineNumberDelta = 0;\r\n        this._endLineNumberDelta = 0;\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._endLineNumberDelta = 1;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        var sourceLines = [];\r\n        for (var i = s.startLineNumber; i <= s.endLineNumber; i++) {\r\n            sourceLines.push(model.getLineContent(i));\r\n        }\r\n        var sourceText = sourceLines.join('\\n');\r\n        if (sourceText === '') {\r\n            // Duplicating empty line\r\n            if (this._isCopyingDown) {\r\n                this._startLineNumberDelta++;\r\n                this._endLineNumberDelta++;\r\n            }\r\n        }\r\n        if (!this._isCopyingDown) {\r\n            builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + sourceText);\r\n        }\r\n        else {\r\n            builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), sourceText + '\\n');\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n        this._selectionDirection = this._selection.getDirection();\r\n    };\r\n    CopyLinesCommand.prototype.computeCursorState = function (model, helper) {\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._startLineNumberDelta !== 0 || this._endLineNumberDelta !== 0) {\r\n            var startLineNumber = result.startLineNumber;\r\n            var startColumn = result.startColumn;\r\n            var endLineNumber = result.endLineNumber;\r\n            var endColumn = result.endColumn;\r\n            if (this._startLineNumberDelta !== 0) {\r\n                startLineNumber = startLineNumber + this._startLineNumberDelta;\r\n                startColumn = 1;\r\n            }\r\n            if (this._endLineNumberDelta !== 0) {\r\n                endLineNumber = endLineNumber + this._endLineNumberDelta;\r\n                endColumn = 1;\r\n            }\r\n            result = Selection.createWithDirection(startLineNumber, startColumn, endLineNumber, endColumn, this._selectionDirection);\r\n        }\r\n        return result;\r\n    };\r\n    return CopyLinesCommand;\r\n}());\r\nexport { CopyLinesCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport function getSpaceCnt(str, tabSize) {\r\n    var spacesCnt = 0;\r\n    for (var i = 0; i < str.length; i++) {\r\n        if (str.charAt(i) === '\\t') {\r\n            spacesCnt += tabSize;\r\n        }\r\n        else {\r\n            spacesCnt++;\r\n        }\r\n    }\r\n    return spacesCnt;\r\n}\r\nexport function generateIndent(spacesCnt, tabSize, insertSpaces) {\r\n    spacesCnt = spacesCnt < 0 ? 0 : spacesCnt;\r\n    var result = '';\r\n    if (!insertSpaces) {\r\n        var tabsCnt = Math.floor(spacesCnt / tabSize);\r\n        spacesCnt = spacesCnt % tabSize;\r\n        for (var i = 0; i < tabsCnt; i++) {\r\n            result += '\\t';\r\n        }\r\n    }\r\n    for (var i = 0; i < spacesCnt; i++) {\r\n        result += ' ';\r\n    }\r\n    return result;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { ShiftCommand } from '../../common/commands/shiftCommand.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { IndentAction } from '../../common/modes/languageConfiguration.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport * as indentUtils from '../indentation/indentUtils.js';\r\nvar MoveLinesCommand = /** @class */ (function () {\r\n    function MoveLinesCommand(selection, isMovingDown, autoIndent) {\r\n        this._selection = selection;\r\n        this._isMovingDown = isMovingDown;\r\n        this._autoIndent = autoIndent;\r\n        this._selectionId = null;\r\n        this._moveEndLineSelectionShrink = false;\r\n    }\r\n    MoveLinesCommand.prototype.getEditOperations = function (model, builder) {\r\n        var modelLineCount = model.getLineCount();\r\n        if (this._isMovingDown && this._selection.endLineNumber === modelLineCount) {\r\n            this._selectionId = builder.trackSelection(this._selection);\r\n            return;\r\n        }\r\n        if (!this._isMovingDown && this._selection.startLineNumber === 1) {\r\n            this._selectionId = builder.trackSelection(this._selection);\r\n            return;\r\n        }\r\n        this._moveEndPositionDown = false;\r\n        var s = this._selection;\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._moveEndPositionDown = true;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        var _a = model.getOptions(), tabSize = _a.tabSize, indentSize = _a.indentSize, insertSpaces = _a.insertSpaces;\r\n        var indentConverter = this.buildIndentConverter(tabSize, indentSize, insertSpaces);\r\n        var virtualModel = {\r\n            getLineTokens: function (lineNumber) {\r\n                return model.getLineTokens(lineNumber);\r\n            },\r\n            getLanguageIdentifier: function () {\r\n                return model.getLanguageIdentifier();\r\n            },\r\n            getLanguageIdAtPosition: function (lineNumber, column) {\r\n                return model.getLanguageIdAtPosition(lineNumber, column);\r\n            },\r\n            getLineContent: null,\r\n        };\r\n        if (s.startLineNumber === s.endLineNumber && model.getLineMaxColumn(s.startLineNumber) === 1) {\r\n            // Current line is empty\r\n            var lineNumber = s.startLineNumber;\r\n            var otherLineNumber = (this._isMovingDown ? lineNumber + 1 : lineNumber - 1);\r\n            if (model.getLineMaxColumn(otherLineNumber) === 1) {\r\n                // Other line number is empty too, so no editing is needed\r\n                // Add a no-op to force running by the model\r\n                builder.addEditOperation(new Range(1, 1, 1, 1), null);\r\n            }\r\n            else {\r\n                // Type content from other line number on line number\r\n                builder.addEditOperation(new Range(lineNumber, 1, lineNumber, 1), model.getLineContent(otherLineNumber));\r\n                // Remove content from other line number\r\n                builder.addEditOperation(new Range(otherLineNumber, 1, otherLineNumber, model.getLineMaxColumn(otherLineNumber)), null);\r\n            }\r\n            // Track selection at the other line number\r\n            s = new Selection(otherLineNumber, 1, otherLineNumber, 1);\r\n        }\r\n        else {\r\n            var movingLineNumber_1;\r\n            var movingLineText = void 0;\r\n            if (this._isMovingDown) {\r\n                movingLineNumber_1 = s.endLineNumber + 1;\r\n                movingLineText = model.getLineContent(movingLineNumber_1);\r\n                // Delete line that needs to be moved\r\n                builder.addEditOperation(new Range(movingLineNumber_1 - 1, model.getLineMaxColumn(movingLineNumber_1 - 1), movingLineNumber_1, model.getLineMaxColumn(movingLineNumber_1)), null);\r\n                var insertingText_1 = movingLineText;\r\n                if (this.shouldAutoIndent(model, s)) {\r\n                    var movingLineMatchResult = this.matchEnterRule(model, indentConverter, tabSize, movingLineNumber_1, s.startLineNumber - 1);\r\n                    // if s.startLineNumber - 1 matches onEnter rule, we still honor that.\r\n                    if (movingLineMatchResult !== null) {\r\n                        var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber_1));\r\n                        var newSpaceCnt = movingLineMatchResult + indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                        var newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\r\n                        insertingText_1 = newIndentation + this.trimLeft(movingLineText);\r\n                    }\r\n                    else {\r\n                        // no enter rule matches, let's check indentatin rules then.\r\n                        virtualModel.getLineContent = function (lineNumber) {\r\n                            if (lineNumber === s.startLineNumber) {\r\n                                return model.getLineContent(movingLineNumber_1);\r\n                            }\r\n                            else {\r\n                                return model.getLineContent(lineNumber);\r\n                            }\r\n                        };\r\n                        var indentOfMovingLine = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber_1, 1), s.startLineNumber, indentConverter);\r\n                        if (indentOfMovingLine !== null) {\r\n                            var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber_1));\r\n                            var newSpaceCnt = indentUtils.getSpaceCnt(indentOfMovingLine, tabSize);\r\n                            var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                var newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\r\n                                insertingText_1 = newIndentation + this.trimLeft(movingLineText);\r\n                            }\r\n                        }\r\n                    }\r\n                    // add edit operations for moving line first to make sure it's executed after we make indentation change\r\n                    // to s.startLineNumber\r\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText_1 + '\\n');\r\n                    var ret = this.matchEnterRule(model, indentConverter, tabSize, s.startLineNumber, s.startLineNumber, insertingText_1);\r\n                    // check if the line being moved before matches onEnter rules, if so let's adjust the indentation by onEnter rules.\r\n                    if (ret !== null) {\r\n                        if (ret !== 0) {\r\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // it doesn't match onEnter rules, let's check indentation rules then.\r\n                        virtualModel.getLineContent = function (lineNumber) {\r\n                            if (lineNumber === s.startLineNumber) {\r\n                                return insertingText_1;\r\n                            }\r\n                            else if (lineNumber >= s.startLineNumber + 1 && lineNumber <= s.endLineNumber + 1) {\r\n                                return model.getLineContent(lineNumber - 1);\r\n                            }\r\n                            else {\r\n                                return model.getLineContent(lineNumber);\r\n                            }\r\n                        };\r\n                        var newIndentatOfMovingBlock = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber_1, 1), s.startLineNumber + 1, indentConverter);\r\n                        if (newIndentatOfMovingBlock !== null) {\r\n                            var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\r\n                            var newSpaceCnt = indentUtils.getSpaceCnt(newIndentatOfMovingBlock, tabSize);\r\n                            var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                var spaceCntOffset = newSpaceCnt - oldSpaceCnt;\r\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // Insert line that needs to be moved before\r\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText_1 + '\\n');\r\n                }\r\n            }\r\n            else {\r\n                movingLineNumber_1 = s.startLineNumber - 1;\r\n                movingLineText = model.getLineContent(movingLineNumber_1);\r\n                // Delete line that needs to be moved\r\n                builder.addEditOperation(new Range(movingLineNumber_1, 1, movingLineNumber_1 + 1, 1), null);\r\n                // Insert line that needs to be moved after\r\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + movingLineText);\r\n                if (this.shouldAutoIndent(model, s)) {\r\n                    virtualModel.getLineContent = function (lineNumber) {\r\n                        if (lineNumber === movingLineNumber_1) {\r\n                            return model.getLineContent(s.startLineNumber);\r\n                        }\r\n                        else {\r\n                            return model.getLineContent(lineNumber);\r\n                        }\r\n                    };\r\n                    var ret = this.matchEnterRule(model, indentConverter, tabSize, s.startLineNumber, s.startLineNumber - 2);\r\n                    // check if s.startLineNumber - 2 matches onEnter rules, if so adjust the moving block by onEnter rules.\r\n                    if (ret !== null) {\r\n                        if (ret !== 0) {\r\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // it doesn't match any onEnter rule, let's check indentation rules then.\r\n                        var indentOfFirstLine = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(s.startLineNumber, 1), movingLineNumber_1, indentConverter);\r\n                        if (indentOfFirstLine !== null) {\r\n                            // adjust the indentation of the moving block\r\n                            var oldIndent = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\r\n                            var newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\r\n                            var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndent, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                var spaceCntOffset = newSpaceCnt - oldSpaceCnt;\r\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n    };\r\n    MoveLinesCommand.prototype.buildIndentConverter = function (tabSize, indentSize, insertSpaces) {\r\n        return {\r\n            shiftIndent: function (indentation) {\r\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\r\n            },\r\n            unshiftIndent: function (indentation) {\r\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\r\n            }\r\n        };\r\n    };\r\n    MoveLinesCommand.prototype.matchEnterRule = function (model, indentConverter, tabSize, line, oneLineAbove, oneLineAboveText) {\r\n        var validPrecedingLine = oneLineAbove;\r\n        while (validPrecedingLine >= 1) {\r\n            // ship empty lines as empty lines just inherit indentation\r\n            var lineContent = void 0;\r\n            if (validPrecedingLine === oneLineAbove && oneLineAboveText !== undefined) {\r\n                lineContent = oneLineAboveText;\r\n            }\r\n            else {\r\n                lineContent = model.getLineContent(validPrecedingLine);\r\n            }\r\n            var nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\r\n            if (nonWhitespaceIdx >= 0) {\r\n                break;\r\n            }\r\n            validPrecedingLine--;\r\n        }\r\n        if (validPrecedingLine < 1 || line > model.getLineCount()) {\r\n            return null;\r\n        }\r\n        var maxColumn = model.getLineMaxColumn(validPrecedingLine);\r\n        var enter = LanguageConfigurationRegistry.getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn));\r\n        if (enter) {\r\n            var enterPrefix = enter.indentation;\r\n            if (enter.indentAction === IndentAction.None) {\r\n                enterPrefix = enter.indentation + enter.appendText;\r\n            }\r\n            else if (enter.indentAction === IndentAction.Indent) {\r\n                enterPrefix = enter.indentation + enter.appendText;\r\n            }\r\n            else if (enter.indentAction === IndentAction.IndentOutdent) {\r\n                enterPrefix = enter.indentation;\r\n            }\r\n            else if (enter.indentAction === IndentAction.Outdent) {\r\n                enterPrefix = indentConverter.unshiftIndent(enter.indentation) + enter.appendText;\r\n            }\r\n            var movingLineText = model.getLineContent(line);\r\n            if (this.trimLeft(movingLineText).indexOf(this.trimLeft(enterPrefix)) >= 0) {\r\n                var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(line));\r\n                var newIndentation = strings.getLeadingWhitespace(enterPrefix);\r\n                var indentMetadataOfMovelingLine = LanguageConfigurationRegistry.getIndentMetadata(model, line);\r\n                if (indentMetadataOfMovelingLine !== null && indentMetadataOfMovelingLine & 2 /* DECREASE_MASK */) {\r\n                    newIndentation = indentConverter.unshiftIndent(newIndentation);\r\n                }\r\n                var newSpaceCnt = indentUtils.getSpaceCnt(newIndentation, tabSize);\r\n                var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                return newSpaceCnt - oldSpaceCnt;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    MoveLinesCommand.prototype.trimLeft = function (str) {\r\n        return str.replace(/^\\s+/, '');\r\n    };\r\n    MoveLinesCommand.prototype.shouldAutoIndent = function (model, selection) {\r\n        if (this._autoIndent < 4 /* Full */) {\r\n            return false;\r\n        }\r\n        // if it's not easy to tokenize, we stop auto indent.\r\n        if (!model.isCheapToTokenize(selection.startLineNumber)) {\r\n            return false;\r\n        }\r\n        var languageAtSelectionStart = model.getLanguageIdAtPosition(selection.startLineNumber, 1);\r\n        var languageAtSelectionEnd = model.getLanguageIdAtPosition(selection.endLineNumber, 1);\r\n        if (languageAtSelectionStart !== languageAtSelectionEnd) {\r\n            return false;\r\n        }\r\n        if (LanguageConfigurationRegistry.getIndentRulesSupport(languageAtSelectionStart) === null) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    MoveLinesCommand.prototype.getIndentEditsOfMovingBlock = function (model, builder, s, tabSize, insertSpaces, offset) {\r\n        for (var i = s.startLineNumber; i <= s.endLineNumber; i++) {\r\n            var lineContent = model.getLineContent(i);\r\n            var originalIndent = strings.getLeadingWhitespace(lineContent);\r\n            var originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\r\n            var newSpacesCnt = originalSpacesCnt + offset;\r\n            var newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\r\n            if (newIndent !== originalIndent) {\r\n                builder.addEditOperation(new Range(i, 1, i, originalIndent.length + 1), newIndent);\r\n                if (i === s.endLineNumber && s.endColumn <= originalIndent.length + 1 && newIndent === '') {\r\n                    // as users select part of the original indent white spaces\r\n                    // when we adjust the indentation of endLine, we should adjust the cursor position as well.\r\n                    this._moveEndLineSelectionShrink = true;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    MoveLinesCommand.prototype.computeCursorState = function (model, helper) {\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._moveEndPositionDown) {\r\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\r\n        }\r\n        if (this._moveEndLineSelectionShrink && result.startLineNumber < result.endLineNumber) {\r\n            result = result.setEndPosition(result.endLineNumber, 2);\r\n        }\r\n        return result;\r\n    };\r\n    return MoveLinesCommand;\r\n}());\r\nexport { MoveLinesCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar SortLinesCommand = /** @class */ (function () {\r\n    function SortLinesCommand(selection, descending) {\r\n        this.selection = selection;\r\n        this.descending = descending;\r\n        this.selectionId = null;\r\n    }\r\n    SortLinesCommand.getCollator = function () {\r\n        if (!SortLinesCommand._COLLATOR) {\r\n            SortLinesCommand._COLLATOR = new Intl.Collator();\r\n        }\r\n        return SortLinesCommand._COLLATOR;\r\n    };\r\n    SortLinesCommand.prototype.getEditOperations = function (model, builder) {\r\n        var op = sortLines(model, this.selection, this.descending);\r\n        if (op) {\r\n            builder.addEditOperation(op.range, op.text);\r\n        }\r\n        this.selectionId = builder.trackSelection(this.selection);\r\n    };\r\n    SortLinesCommand.prototype.computeCursorState = function (model, helper) {\r\n        return helper.getTrackedSelection(this.selectionId);\r\n    };\r\n    SortLinesCommand.canRun = function (model, selection, descending) {\r\n        if (model === null) {\r\n            return false;\r\n        }\r\n        var data = getSortData(model, selection, descending);\r\n        if (!data) {\r\n            return false;\r\n        }\r\n        for (var i = 0, len = data.before.length; i < len; i++) {\r\n            if (data.before[i] !== data.after[i]) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    SortLinesCommand._COLLATOR = null;\r\n    return SortLinesCommand;\r\n}());\r\nexport { SortLinesCommand };\r\nfunction getSortData(model, selection, descending) {\r\n    var startLineNumber = selection.startLineNumber;\r\n    var endLineNumber = selection.endLineNumber;\r\n    if (selection.endColumn === 1) {\r\n        endLineNumber--;\r\n    }\r\n    // Nothing to sort if user didn't select anything.\r\n    if (startLineNumber >= endLineNumber) {\r\n        return null;\r\n    }\r\n    var linesToSort = [];\r\n    // Get the contents of the selection to be sorted.\r\n    for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n        linesToSort.push(model.getLineContent(lineNumber));\r\n    }\r\n    var sorted = linesToSort.slice(0);\r\n    sorted.sort(SortLinesCommand.getCollator().compare);\r\n    // If descending, reverse the order.\r\n    if (descending === true) {\r\n        sorted = sorted.reverse();\r\n    }\r\n    return {\r\n        startLineNumber: startLineNumber,\r\n        endLineNumber: endLineNumber,\r\n        before: linesToSort,\r\n        after: sorted\r\n    };\r\n}\r\n/**\r\n * Generate commands for sorting lines on a model.\r\n */\r\nfunction sortLines(model, selection, descending) {\r\n    var data = getSortData(model, selection, descending);\r\n    if (!data) {\r\n        return null;\r\n    }\r\n    return EditOperation.replace(new Range(data.startLineNumber, 1, data.endLineNumber, model.getLineMaxColumn(data.endLineNumber)), data.after.join('\\n'));\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { CoreEditingCommands } from '../../browser/controller/coreCommands.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection, ReplaceCommandThatSelectsText } from '../../common/commands/replaceCommand.js';\r\nimport { TrimTrailingWhitespaceCommand } from '../../common/commands/trimTrailingWhitespaceCommand.js';\r\nimport { TypeOperations } from '../../common/controller/cursorTypeOperations.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { CopyLinesCommand } from './copyLinesCommand.js';\r\nimport { MoveLinesCommand } from './moveLinesCommand.js';\r\nimport { SortLinesCommand } from './sortLinesCommand.js';\r\n// copy lines\r\nvar AbstractCopyLinesAction = /** @class */ (function (_super) {\r\n    __extends(AbstractCopyLinesAction, _super);\r\n    function AbstractCopyLinesAction(down, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.down = down;\r\n        return _this;\r\n    }\r\n    AbstractCopyLinesAction.prototype.run = function (_accessor, editor) {\r\n        var commands = [];\r\n        var selections = editor.getSelections() || [];\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var selection = selections_1[_i];\r\n            commands.push(new CopyLinesCommand(selection, this.down));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractCopyLinesAction;\r\n}(EditorAction));\r\nvar CopyLinesUpAction = /** @class */ (function (_super) {\r\n    __extends(CopyLinesUpAction, _super);\r\n    function CopyLinesUpAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.copyLinesUpAction',\r\n            label: nls.localize('lines.copyUp', \"Copy Line Up\"),\r\n            alias: 'Copy Line Up',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 16 /* UpArrow */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 1024 /* Shift */ | 16 /* UpArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miCopyLinesUp', comment: ['&& denotes a mnemonic'] }, \"&&Copy Line Up\"),\r\n                order: 1\r\n            }\r\n        }) || this;\r\n    }\r\n    return CopyLinesUpAction;\r\n}(AbstractCopyLinesAction));\r\nvar CopyLinesDownAction = /** @class */ (function (_super) {\r\n    __extends(CopyLinesDownAction, _super);\r\n    function CopyLinesDownAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.copyLinesDownAction',\r\n            label: nls.localize('lines.copyDown', \"Copy Line Down\"),\r\n            alias: 'Copy Line Down',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 18 /* DownArrow */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 1024 /* Shift */ | 18 /* DownArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miCopyLinesDown', comment: ['&& denotes a mnemonic'] }, \"Co&&py Line Down\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    return CopyLinesDownAction;\r\n}(AbstractCopyLinesAction));\r\nvar DuplicateSelectionAction = /** @class */ (function (_super) {\r\n    __extends(DuplicateSelectionAction, _super);\r\n    function DuplicateSelectionAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.duplicateSelection',\r\n            label: nls.localize('duplicateSelection', \"Duplicate Selection\"),\r\n            alias: 'Duplicate Selection',\r\n            precondition: EditorContextKeys.writable,\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miDuplicateSelection', comment: ['&& denotes a mnemonic'] }, \"&&Duplicate Selection\"),\r\n                order: 5\r\n            }\r\n        }) || this;\r\n    }\r\n    DuplicateSelectionAction.prototype.run = function (accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        var model = editor.getModel();\r\n        for (var _i = 0, selections_2 = selections; _i < selections_2.length; _i++) {\r\n            var selection = selections_2[_i];\r\n            if (selection.isEmpty()) {\r\n                commands.push(new CopyLinesCommand(selection, true));\r\n            }\r\n            else {\r\n                var insertSelection = new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn);\r\n                commands.push(new ReplaceCommandThatSelectsText(insertSelection, model.getValueInRange(selection)));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return DuplicateSelectionAction;\r\n}(EditorAction));\r\nexport { DuplicateSelectionAction };\r\n// move lines\r\nvar AbstractMoveLinesAction = /** @class */ (function (_super) {\r\n    __extends(AbstractMoveLinesAction, _super);\r\n    function AbstractMoveLinesAction(down, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.down = down;\r\n        return _this;\r\n    }\r\n    AbstractMoveLinesAction.prototype.run = function (_accessor, editor) {\r\n        var commands = [];\r\n        var selections = editor.getSelections() || [];\r\n        var autoIndent = editor.getOption(8 /* autoIndent */);\r\n        for (var _i = 0, selections_3 = selections; _i < selections_3.length; _i++) {\r\n            var selection = selections_3[_i];\r\n            commands.push(new MoveLinesCommand(selection, this.down, autoIndent));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractMoveLinesAction;\r\n}(EditorAction));\r\nvar MoveLinesUpAction = /** @class */ (function (_super) {\r\n    __extends(MoveLinesUpAction, _super);\r\n    function MoveLinesUpAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.moveLinesUpAction',\r\n            label: nls.localize('lines.moveUp', \"Move Line Up\"),\r\n            alias: 'Move Line Up',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 16 /* UpArrow */,\r\n                linux: { primary: 512 /* Alt */ | 16 /* UpArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miMoveLinesUp', comment: ['&& denotes a mnemonic'] }, \"Mo&&ve Line Up\"),\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    return MoveLinesUpAction;\r\n}(AbstractMoveLinesAction));\r\nvar MoveLinesDownAction = /** @class */ (function (_super) {\r\n    __extends(MoveLinesDownAction, _super);\r\n    function MoveLinesDownAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.moveLinesDownAction',\r\n            label: nls.localize('lines.moveDown', \"Move Line Down\"),\r\n            alias: 'Move Line Down',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 18 /* DownArrow */,\r\n                linux: { primary: 512 /* Alt */ | 18 /* DownArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miMoveLinesDown', comment: ['&& denotes a mnemonic'] }, \"Move &&Line Down\"),\r\n                order: 4\r\n            }\r\n        }) || this;\r\n    }\r\n    return MoveLinesDownAction;\r\n}(AbstractMoveLinesAction));\r\nvar AbstractSortLinesAction = /** @class */ (function (_super) {\r\n    __extends(AbstractSortLinesAction, _super);\r\n    function AbstractSortLinesAction(descending, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.descending = descending;\r\n        return _this;\r\n    }\r\n    AbstractSortLinesAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections() || [];\r\n        for (var _i = 0, selections_4 = selections; _i < selections_4.length; _i++) {\r\n            var selection = selections_4[_i];\r\n            if (!SortLinesCommand.canRun(editor.getModel(), selection, this.descending)) {\r\n                return;\r\n            }\r\n        }\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            commands[i] = new SortLinesCommand(selections[i], this.descending);\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractSortLinesAction;\r\n}(EditorAction));\r\nexport { AbstractSortLinesAction };\r\nvar SortLinesAscendingAction = /** @class */ (function (_super) {\r\n    __extends(SortLinesAscendingAction, _super);\r\n    function SortLinesAscendingAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.sortLinesAscending',\r\n            label: nls.localize('lines.sortAscending', \"Sort Lines Ascending\"),\r\n            alias: 'Sort Lines Ascending',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return SortLinesAscendingAction;\r\n}(AbstractSortLinesAction));\r\nexport { SortLinesAscendingAction };\r\nvar SortLinesDescendingAction = /** @class */ (function (_super) {\r\n    __extends(SortLinesDescendingAction, _super);\r\n    function SortLinesDescendingAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.sortLinesDescending',\r\n            label: nls.localize('lines.sortDescending', \"Sort Lines Descending\"),\r\n            alias: 'Sort Lines Descending',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return SortLinesDescendingAction;\r\n}(AbstractSortLinesAction));\r\nexport { SortLinesDescendingAction };\r\nvar TrimTrailingWhitespaceAction = /** @class */ (function (_super) {\r\n    __extends(TrimTrailingWhitespaceAction, _super);\r\n    function TrimTrailingWhitespaceAction() {\r\n        return _super.call(this, {\r\n            id: TrimTrailingWhitespaceAction.ID,\r\n            label: nls.localize('lines.trimTrailingWhitespace', \"Trim Trailing Whitespace\"),\r\n            alias: 'Trim Trailing Whitespace',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 54 /* KEY_X */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TrimTrailingWhitespaceAction.prototype.run = function (_accessor, editor, args) {\r\n        var cursors = [];\r\n        if (args.reason === 'auto-save') {\r\n            // See https://github.com/editorconfig/editorconfig-vscode/issues/47\r\n            // It is very convenient for the editor config extension to invoke this action.\r\n            // So, if we get a reason:'auto-save' passed in, let's preserve cursor positions.\r\n            cursors = (editor.getSelections() || []).map(function (s) { return new Position(s.positionLineNumber, s.positionColumn); });\r\n        }\r\n        var selection = editor.getSelection();\r\n        if (selection === null) {\r\n            return;\r\n        }\r\n        var command = new TrimTrailingWhitespaceCommand(selection, cursors);\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, [command]);\r\n        editor.pushUndoStop();\r\n    };\r\n    TrimTrailingWhitespaceAction.ID = 'editor.action.trimTrailingWhitespace';\r\n    return TrimTrailingWhitespaceAction;\r\n}(EditorAction));\r\nexport { TrimTrailingWhitespaceAction };\r\nvar DeleteLinesAction = /** @class */ (function (_super) {\r\n    __extends(DeleteLinesAction, _super);\r\n    function DeleteLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.deleteLines',\r\n            label: nls.localize('lines.delete', \"Delete Line\"),\r\n            alias: 'Delete Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 41 /* KEY_K */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteLinesAction.prototype.run = function (_accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var ops = this._getLinesToRemove(editor);\r\n        var model = editor.getModel();\r\n        if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\r\n            // Model is empty\r\n            return;\r\n        }\r\n        var linesDeleted = 0;\r\n        var edits = [];\r\n        var cursorState = [];\r\n        for (var i = 0, len = ops.length; i < len; i++) {\r\n            var op = ops[i];\r\n            var startLineNumber = op.startLineNumber;\r\n            var endLineNumber = op.endLineNumber;\r\n            var startColumn = 1;\r\n            var endColumn = model.getLineMaxColumn(endLineNumber);\r\n            if (endLineNumber < model.getLineCount()) {\r\n                endLineNumber += 1;\r\n                endColumn = 1;\r\n            }\r\n            else if (startLineNumber > 1) {\r\n                startLineNumber -= 1;\r\n                startColumn = model.getLineMaxColumn(startLineNumber);\r\n            }\r\n            edits.push(EditOperation.replace(new Selection(startLineNumber, startColumn, endLineNumber, endColumn), ''));\r\n            cursorState.push(new Selection(startLineNumber - linesDeleted, op.positionColumn, startLineNumber - linesDeleted, op.positionColumn));\r\n            linesDeleted += (op.endLineNumber - op.startLineNumber + 1);\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, cursorState);\r\n        editor.pushUndoStop();\r\n    };\r\n    DeleteLinesAction.prototype._getLinesToRemove = function (editor) {\r\n        // Construct delete operations\r\n        var operations = editor.getSelections().map(function (s) {\r\n            var endLineNumber = s.endLineNumber;\r\n            if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n                endLineNumber -= 1;\r\n            }\r\n            return {\r\n                startLineNumber: s.startLineNumber,\r\n                selectionStartColumn: s.selectionStartColumn,\r\n                endLineNumber: endLineNumber,\r\n                positionColumn: s.positionColumn\r\n            };\r\n        });\r\n        // Sort delete operations\r\n        operations.sort(function (a, b) {\r\n            if (a.startLineNumber === b.startLineNumber) {\r\n                return a.endLineNumber - b.endLineNumber;\r\n            }\r\n            return a.startLineNumber - b.startLineNumber;\r\n        });\r\n        // Merge delete operations which are adjacent or overlapping\r\n        var mergedOperations = [];\r\n        var previousOperation = operations[0];\r\n        for (var i = 1; i < operations.length; i++) {\r\n            if (previousOperation.endLineNumber + 1 >= operations[i].startLineNumber) {\r\n                // Merge current operations into the previous one\r\n                previousOperation.endLineNumber = operations[i].endLineNumber;\r\n            }\r\n            else {\r\n                // Push previous operation\r\n                mergedOperations.push(previousOperation);\r\n                previousOperation = operations[i];\r\n            }\r\n        }\r\n        // Push the last operation\r\n        mergedOperations.push(previousOperation);\r\n        return mergedOperations;\r\n    };\r\n    return DeleteLinesAction;\r\n}(EditorAction));\r\nexport { DeleteLinesAction };\r\nvar IndentLinesAction = /** @class */ (function (_super) {\r\n    __extends(IndentLinesAction, _super);\r\n    function IndentLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.indentLines',\r\n            label: nls.localize('lines.indent', \"Indent Line\"),\r\n            alias: 'Indent Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 89 /* US_CLOSE_SQUARE_BRACKET */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    IndentLinesAction.prototype.run = function (_accessor, editor) {\r\n        var cursors = editor._getCursors();\r\n        if (!cursors) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.indent(cursors.context.config, editor.getModel(), editor.getSelections()));\r\n        editor.pushUndoStop();\r\n    };\r\n    return IndentLinesAction;\r\n}(EditorAction));\r\nexport { IndentLinesAction };\r\nvar OutdentLinesAction = /** @class */ (function (_super) {\r\n    __extends(OutdentLinesAction, _super);\r\n    function OutdentLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.outdentLines',\r\n            label: nls.localize('lines.outdent', \"Outdent Line\"),\r\n            alias: 'Outdent Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 87 /* US_OPEN_SQUARE_BRACKET */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    OutdentLinesAction.prototype.run = function (_accessor, editor) {\r\n        CoreEditingCommands.Outdent.runEditorCommand(_accessor, editor, null);\r\n    };\r\n    return OutdentLinesAction;\r\n}(EditorAction));\r\nvar InsertLineBeforeAction = /** @class */ (function (_super) {\r\n    __extends(InsertLineBeforeAction, _super);\r\n    function InsertLineBeforeAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertLineBefore',\r\n            label: nls.localize('lines.insertBefore', \"Insert Line Above\"),\r\n            alias: 'Insert Line Above',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertLineBeforeAction.prototype.run = function (_accessor, editor) {\r\n        var cursors = editor._getCursors();\r\n        if (!cursors) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.lineInsertBefore(cursors.context.config, editor.getModel(), editor.getSelections()));\r\n    };\r\n    return InsertLineBeforeAction;\r\n}(EditorAction));\r\nexport { InsertLineBeforeAction };\r\nvar InsertLineAfterAction = /** @class */ (function (_super) {\r\n    __extends(InsertLineAfterAction, _super);\r\n    function InsertLineAfterAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertLineAfter',\r\n            label: nls.localize('lines.insertAfter', \"Insert Line Below\"),\r\n            alias: 'Insert Line Below',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertLineAfterAction.prototype.run = function (_accessor, editor) {\r\n        var cursors = editor._getCursors();\r\n        if (!cursors) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.lineInsertAfter(cursors.context.config, editor.getModel(), editor.getSelections()));\r\n    };\r\n    return InsertLineAfterAction;\r\n}(EditorAction));\r\nexport { InsertLineAfterAction };\r\nvar AbstractDeleteAllToBoundaryAction = /** @class */ (function (_super) {\r\n    __extends(AbstractDeleteAllToBoundaryAction, _super);\r\n    function AbstractDeleteAllToBoundaryAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AbstractDeleteAllToBoundaryAction.prototype.run = function (_accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var primaryCursor = editor.getSelection();\r\n        var rangesToDelete = this._getRangesToDelete(editor);\r\n        // merge overlapping selections\r\n        var effectiveRanges = [];\r\n        for (var i = 0, count = rangesToDelete.length - 1; i < count; i++) {\r\n            var range = rangesToDelete[i];\r\n            var nextRange = rangesToDelete[i + 1];\r\n            if (Range.intersectRanges(range, nextRange) === null) {\r\n                effectiveRanges.push(range);\r\n            }\r\n            else {\r\n                rangesToDelete[i + 1] = Range.plusRange(range, nextRange);\r\n            }\r\n        }\r\n        effectiveRanges.push(rangesToDelete[rangesToDelete.length - 1]);\r\n        var endCursorState = this._getEndCursorState(primaryCursor, effectiveRanges);\r\n        var edits = effectiveRanges.map(function (range) {\r\n            return EditOperation.replace(range, '');\r\n        });\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, endCursorState);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractDeleteAllToBoundaryAction;\r\n}(EditorAction));\r\nexport { AbstractDeleteAllToBoundaryAction };\r\nvar DeleteAllLeftAction = /** @class */ (function (_super) {\r\n    __extends(DeleteAllLeftAction, _super);\r\n    function DeleteAllLeftAction() {\r\n        return _super.call(this, {\r\n            id: 'deleteAllLeft',\r\n            label: nls.localize('lines.deleteAllLeft', \"Delete All Left\"),\r\n            alias: 'Delete All Left',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 2048 /* CtrlCmd */ | 1 /* Backspace */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteAllLeftAction.prototype._getEndCursorState = function (primaryCursor, rangesToDelete) {\r\n        var endPrimaryCursor = null;\r\n        var endCursorState = [];\r\n        var deletedLines = 0;\r\n        rangesToDelete.forEach(function (range) {\r\n            var endCursor;\r\n            if (range.endColumn === 1 && deletedLines > 0) {\r\n                var newStartLine = range.startLineNumber - deletedLines;\r\n                endCursor = new Selection(newStartLine, range.startColumn, newStartLine, range.startColumn);\r\n            }\r\n            else {\r\n                endCursor = new Selection(range.startLineNumber, range.startColumn, range.startLineNumber, range.startColumn);\r\n            }\r\n            deletedLines += range.endLineNumber - range.startLineNumber;\r\n            if (range.intersectRanges(primaryCursor)) {\r\n                endPrimaryCursor = endCursor;\r\n            }\r\n            else {\r\n                endCursorState.push(endCursor);\r\n            }\r\n        });\r\n        if (endPrimaryCursor) {\r\n            endCursorState.unshift(endPrimaryCursor);\r\n        }\r\n        return endCursorState;\r\n    };\r\n    DeleteAllLeftAction.prototype._getRangesToDelete = function (editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return [];\r\n        }\r\n        var rangesToDelete = selections;\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return [];\r\n        }\r\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\r\n        rangesToDelete = rangesToDelete.map(function (selection) {\r\n            if (selection.isEmpty()) {\r\n                if (selection.startColumn === 1) {\r\n                    var deleteFromLine = Math.max(1, selection.startLineNumber - 1);\r\n                    var deleteFromColumn = selection.startLineNumber === 1 ? 1 : model.getLineContent(deleteFromLine).length + 1;\r\n                    return new Range(deleteFromLine, deleteFromColumn, selection.startLineNumber, 1);\r\n                }\r\n                else {\r\n                    return new Range(selection.startLineNumber, 1, selection.startLineNumber, selection.startColumn);\r\n                }\r\n            }\r\n            else {\r\n                return new Range(selection.startLineNumber, 1, selection.endLineNumber, selection.endColumn);\r\n            }\r\n        });\r\n        return rangesToDelete;\r\n    };\r\n    return DeleteAllLeftAction;\r\n}(AbstractDeleteAllToBoundaryAction));\r\nexport { DeleteAllLeftAction };\r\nvar DeleteAllRightAction = /** @class */ (function (_super) {\r\n    __extends(DeleteAllRightAction, _super);\r\n    function DeleteAllRightAction() {\r\n        return _super.call(this, {\r\n            id: 'deleteAllRight',\r\n            label: nls.localize('lines.deleteAllRight', \"Delete All Right\"),\r\n            alias: 'Delete All Right',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 41 /* KEY_K */, secondary: [2048 /* CtrlCmd */ | 20 /* Delete */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteAllRightAction.prototype._getEndCursorState = function (primaryCursor, rangesToDelete) {\r\n        var endPrimaryCursor = null;\r\n        var endCursorState = [];\r\n        for (var i = 0, len = rangesToDelete.length, offset = 0; i < len; i++) {\r\n            var range = rangesToDelete[i];\r\n            var endCursor = new Selection(range.startLineNumber - offset, range.startColumn, range.startLineNumber - offset, range.startColumn);\r\n            if (range.intersectRanges(primaryCursor)) {\r\n                endPrimaryCursor = endCursor;\r\n            }\r\n            else {\r\n                endCursorState.push(endCursor);\r\n            }\r\n        }\r\n        if (endPrimaryCursor) {\r\n            endCursorState.unshift(endPrimaryCursor);\r\n        }\r\n        return endCursorState;\r\n    };\r\n    DeleteAllRightAction.prototype._getRangesToDelete = function (editor) {\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return [];\r\n        }\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return [];\r\n        }\r\n        var rangesToDelete = selections.map(function (sel) {\r\n            if (sel.isEmpty()) {\r\n                var maxColumn = model.getLineMaxColumn(sel.startLineNumber);\r\n                if (sel.startColumn === maxColumn) {\r\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber + 1, 1);\r\n                }\r\n                else {\r\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber, maxColumn);\r\n                }\r\n            }\r\n            return sel;\r\n        });\r\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\r\n        return rangesToDelete;\r\n    };\r\n    return DeleteAllRightAction;\r\n}(AbstractDeleteAllToBoundaryAction));\r\nexport { DeleteAllRightAction };\r\nvar JoinLinesAction = /** @class */ (function (_super) {\r\n    __extends(JoinLinesAction, _super);\r\n    function JoinLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.joinLines',\r\n            label: nls.localize('lines.joinLines', \"Join Lines\"),\r\n            alias: 'Join Lines',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 40 /* KEY_J */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    JoinLinesAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        var primaryCursor = editor.getSelection();\r\n        if (primaryCursor === null) {\r\n            return;\r\n        }\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        var reducedSelections = [];\r\n        var lastSelection = selections.reduce(function (previousValue, currentValue) {\r\n            if (previousValue.isEmpty()) {\r\n                if (previousValue.endLineNumber === currentValue.startLineNumber) {\r\n                    if (primaryCursor.equalsSelection(previousValue)) {\r\n                        primaryCursor = currentValue;\r\n                    }\r\n                    return currentValue;\r\n                }\r\n                if (currentValue.startLineNumber > previousValue.endLineNumber + 1) {\r\n                    reducedSelections.push(previousValue);\r\n                    return currentValue;\r\n                }\r\n                else {\r\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\r\n                }\r\n            }\r\n            else {\r\n                if (currentValue.startLineNumber > previousValue.endLineNumber) {\r\n                    reducedSelections.push(previousValue);\r\n                    return currentValue;\r\n                }\r\n                else {\r\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\r\n                }\r\n            }\r\n        });\r\n        reducedSelections.push(lastSelection);\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        var edits = [];\r\n        var endCursorState = [];\r\n        var endPrimaryCursor = primaryCursor;\r\n        var lineOffset = 0;\r\n        for (var i = 0, len = reducedSelections.length; i < len; i++) {\r\n            var selection = reducedSelections[i];\r\n            var startLineNumber = selection.startLineNumber;\r\n            var startColumn = 1;\r\n            var columnDeltaOffset = 0;\r\n            var endLineNumber = void 0, endColumn = void 0;\r\n            var selectionEndPositionOffset = model.getLineContent(selection.endLineNumber).length - selection.endColumn;\r\n            if (selection.isEmpty() || selection.startLineNumber === selection.endLineNumber) {\r\n                var position = selection.getStartPosition();\r\n                if (position.lineNumber < model.getLineCount()) {\r\n                    endLineNumber = startLineNumber + 1;\r\n                    endColumn = model.getLineMaxColumn(endLineNumber);\r\n                }\r\n                else {\r\n                    endLineNumber = position.lineNumber;\r\n                    endColumn = model.getLineMaxColumn(position.lineNumber);\r\n                }\r\n            }\r\n            else {\r\n                endLineNumber = selection.endLineNumber;\r\n                endColumn = model.getLineMaxColumn(endLineNumber);\r\n            }\r\n            var trimmedLinesContent = model.getLineContent(startLineNumber);\r\n            for (var i_1 = startLineNumber + 1; i_1 <= endLineNumber; i_1++) {\r\n                var lineText = model.getLineContent(i_1);\r\n                var firstNonWhitespaceIdx = model.getLineFirstNonWhitespaceColumn(i_1);\r\n                if (firstNonWhitespaceIdx >= 1) {\r\n                    var insertSpace = true;\r\n                    if (trimmedLinesContent === '') {\r\n                        insertSpace = false;\r\n                    }\r\n                    if (insertSpace && (trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === ' ' ||\r\n                        trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === '\\t')) {\r\n                        insertSpace = false;\r\n                        trimmedLinesContent = trimmedLinesContent.replace(/[\\s\\uFEFF\\xA0]+$/g, ' ');\r\n                    }\r\n                    var lineTextWithoutIndent = lineText.substr(firstNonWhitespaceIdx - 1);\r\n                    trimmedLinesContent += (insertSpace ? ' ' : '') + lineTextWithoutIndent;\r\n                    if (insertSpace) {\r\n                        columnDeltaOffset = lineTextWithoutIndent.length + 1;\r\n                    }\r\n                    else {\r\n                        columnDeltaOffset = lineTextWithoutIndent.length;\r\n                    }\r\n                }\r\n                else {\r\n                    columnDeltaOffset = 0;\r\n                }\r\n            }\r\n            var deleteSelection = new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n            if (!deleteSelection.isEmpty()) {\r\n                var resultSelection = void 0;\r\n                if (selection.isEmpty()) {\r\n                    edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                    resultSelection = new Selection(deleteSelection.startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1, startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1);\r\n                }\r\n                else {\r\n                    if (selection.startLineNumber === selection.endLineNumber) {\r\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.endLineNumber - lineOffset, selection.endColumn);\r\n                    }\r\n                    else {\r\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.startLineNumber - lineOffset, trimmedLinesContent.length - selectionEndPositionOffset);\r\n                    }\r\n                }\r\n                if (Range.intersectRanges(deleteSelection, primaryCursor) !== null) {\r\n                    endPrimaryCursor = resultSelection;\r\n                }\r\n                else {\r\n                    endCursorState.push(resultSelection);\r\n                }\r\n            }\r\n            lineOffset += deleteSelection.endLineNumber - deleteSelection.startLineNumber;\r\n        }\r\n        endCursorState.unshift(endPrimaryCursor);\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, endCursorState);\r\n        editor.pushUndoStop();\r\n    };\r\n    return JoinLinesAction;\r\n}(EditorAction));\r\nexport { JoinLinesAction };\r\nvar TransposeAction = /** @class */ (function (_super) {\r\n    __extends(TransposeAction, _super);\r\n    function TransposeAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transpose',\r\n            label: nls.localize('editor.transpose', \"Transpose characters around the cursor\"),\r\n            alias: 'Transpose characters around the cursor',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    TransposeAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (!selection.isEmpty()) {\r\n                continue;\r\n            }\r\n            var cursor = selection.getStartPosition();\r\n            var maxColumn = model.getLineMaxColumn(cursor.lineNumber);\r\n            if (cursor.column >= maxColumn) {\r\n                if (cursor.lineNumber === model.getLineCount()) {\r\n                    continue;\r\n                }\r\n                // The cursor is at the end of current line and current line is not empty\r\n                // then we transpose the character before the cursor and the line break if there is any following line.\r\n                var deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1);\r\n                var chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\r\n                commands.push(new ReplaceCommand(new Selection(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1), chars));\r\n            }\r\n            else {\r\n                var deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber, cursor.column + 1);\r\n                var chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\r\n                commands.push(new ReplaceCommandThatPreservesSelection(deleteSelection, chars, new Selection(cursor.lineNumber, cursor.column + 1, cursor.lineNumber, cursor.column + 1)));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return TransposeAction;\r\n}(EditorAction));\r\nexport { TransposeAction };\r\nvar AbstractCaseAction = /** @class */ (function (_super) {\r\n    __extends(AbstractCaseAction, _super);\r\n    function AbstractCaseAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AbstractCaseAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        var wordSeparators = editor.getOption(92 /* wordSeparators */);\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (selection.isEmpty()) {\r\n                var cursor = selection.getStartPosition();\r\n                var word = model.getWordAtPosition(cursor);\r\n                if (!word) {\r\n                    continue;\r\n                }\r\n                var wordRange = new Range(cursor.lineNumber, word.startColumn, cursor.lineNumber, word.endColumn);\r\n                var text = model.getValueInRange(wordRange);\r\n                commands.push(new ReplaceCommandThatPreservesSelection(wordRange, this._modifyText(text, wordSeparators), new Selection(cursor.lineNumber, cursor.column, cursor.lineNumber, cursor.column)));\r\n            }\r\n            else {\r\n                var text = model.getValueInRange(selection);\r\n                commands.push(new ReplaceCommandThatPreservesSelection(selection, this._modifyText(text, wordSeparators), selection));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractCaseAction;\r\n}(EditorAction));\r\nexport { AbstractCaseAction };\r\nvar UpperCaseAction = /** @class */ (function (_super) {\r\n    __extends(UpperCaseAction, _super);\r\n    function UpperCaseAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transformToUppercase',\r\n            label: nls.localize('editor.transformToUppercase', \"Transform to Uppercase\"),\r\n            alias: 'Transform to Uppercase',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    UpperCaseAction.prototype._modifyText = function (text, wordSeparators) {\r\n        return text.toLocaleUpperCase();\r\n    };\r\n    return UpperCaseAction;\r\n}(AbstractCaseAction));\r\nexport { UpperCaseAction };\r\nvar LowerCaseAction = /** @class */ (function (_super) {\r\n    __extends(LowerCaseAction, _super);\r\n    function LowerCaseAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transformToLowercase',\r\n            label: nls.localize('editor.transformToLowercase', \"Transform to Lowercase\"),\r\n            alias: 'Transform to Lowercase',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    LowerCaseAction.prototype._modifyText = function (text, wordSeparators) {\r\n        return text.toLocaleLowerCase();\r\n    };\r\n    return LowerCaseAction;\r\n}(AbstractCaseAction));\r\nexport { LowerCaseAction };\r\nvar TitleCaseAction = /** @class */ (function (_super) {\r\n    __extends(TitleCaseAction, _super);\r\n    function TitleCaseAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transformToTitlecase',\r\n            label: nls.localize('editor.transformToTitlecase', \"Transform to Title Case\"),\r\n            alias: 'Transform to Title Case',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    TitleCaseAction.prototype._modifyText = function (text, wordSeparators) {\r\n        var separators = '\\r\\n\\t ' + wordSeparators;\r\n        var excludedChars = separators.split('');\r\n        var title = '';\r\n        var startUpperCase = true;\r\n        for (var i = 0; i < text.length; i++) {\r\n            var currentChar = text[i];\r\n            if (excludedChars.indexOf(currentChar) >= 0) {\r\n                startUpperCase = true;\r\n                title += currentChar;\r\n            }\r\n            else if (startUpperCase) {\r\n                startUpperCase = false;\r\n                title += currentChar.toLocaleUpperCase();\r\n            }\r\n            else {\r\n                title += currentChar.toLocaleLowerCase();\r\n            }\r\n        }\r\n        return title;\r\n    };\r\n    return TitleCaseAction;\r\n}(AbstractCaseAction));\r\nexport { TitleCaseAction };\r\nregisterEditorAction(CopyLinesUpAction);\r\nregisterEditorAction(CopyLinesDownAction);\r\nregisterEditorAction(DuplicateSelectionAction);\r\nregisterEditorAction(MoveLinesUpAction);\r\nregisterEditorAction(MoveLinesDownAction);\r\nregisterEditorAction(SortLinesAscendingAction);\r\nregisterEditorAction(SortLinesDescendingAction);\r\nregisterEditorAction(TrimTrailingWhitespaceAction);\r\nregisterEditorAction(DeleteLinesAction);\r\nregisterEditorAction(IndentLinesAction);\r\nregisterEditorAction(OutdentLinesAction);\r\nregisterEditorAction(InsertLineBeforeAction);\r\nregisterEditorAction(InsertLineAfterAction);\r\nregisterEditorAction(DeleteAllLeftAction);\r\nregisterEditorAction(DeleteAllRightAction);\r\nregisterEditorAction(JoinLinesAction);\r\nregisterEditorAction(TransposeAction);\r\nregisterEditorAction(UpperCaseAction);\r\nregisterEditorAction(LowerCaseAction);\r\nregisterEditorAction(TitleCaseAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { LinkProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { isDisposable, Disposable } from '../../../base/common/lifecycle.js';\r\nimport { coalesce } from '../../../base/common/arrays.js';\r\nvar Link = /** @class */ (function () {\r\n    function Link(link, provider) {\r\n        this._link = link;\r\n        this._provider = provider;\r\n    }\r\n    Link.prototype.toJSON = function () {\r\n        return {\r\n            range: this.range,\r\n            url: this.url,\r\n            tooltip: this.tooltip\r\n        };\r\n    };\r\n    Object.defineProperty(Link.prototype, \"range\", {\r\n        get: function () {\r\n            return this._link.range;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Link.prototype, \"url\", {\r\n        get: function () {\r\n            return this._link.url;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Link.prototype, \"tooltip\", {\r\n        get: function () {\r\n            return this._link.tooltip;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Link.prototype.resolve = function (token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                if (this._link.url) {\r\n                    return [2 /*return*/, this._link.url];\r\n                }\r\n                if (typeof this._provider.resolveLink === 'function') {\r\n                    return [2 /*return*/, Promise.resolve(this._provider.resolveLink(this._link, token)).then(function (value) {\r\n                            _this._link = value || _this._link;\r\n                            if (_this._link.url) {\r\n                                // recurse\r\n                                return _this.resolve(token);\r\n                            }\r\n                            return Promise.reject(new Error('missing'));\r\n                        })];\r\n                }\r\n                return [2 /*return*/, Promise.reject(new Error('missing'))];\r\n            });\r\n        });\r\n    };\r\n    return Link;\r\n}());\r\nexport { Link };\r\nvar LinksList = /** @class */ (function (_super) {\r\n    __extends(LinksList, _super);\r\n    function LinksList(tuples) {\r\n        var _this = _super.call(this) || this;\r\n        var links = [];\r\n        var _loop_1 = function (list, provider) {\r\n            // merge all links\r\n            var newLinks = list.links.map(function (link) { return new Link(link, provider); });\r\n            links = LinksList._union(links, newLinks);\r\n            // register disposables\r\n            if (isDisposable(provider)) {\r\n                this_1._register(provider);\r\n            }\r\n        };\r\n        var this_1 = this;\r\n        for (var _i = 0, tuples_1 = tuples; _i < tuples_1.length; _i++) {\r\n            var _a = tuples_1[_i], list = _a[0], provider = _a[1];\r\n            _loop_1(list, provider);\r\n        }\r\n        _this.links = links;\r\n        return _this;\r\n    }\r\n    LinksList._union = function (oldLinks, newLinks) {\r\n        // reunite oldLinks with newLinks and remove duplicates\r\n        var result = [];\r\n        var oldIndex;\r\n        var oldLen;\r\n        var newIndex;\r\n        var newLen;\r\n        for (oldIndex = 0, newIndex = 0, oldLen = oldLinks.length, newLen = newLinks.length; oldIndex < oldLen && newIndex < newLen;) {\r\n            var oldLink = oldLinks[oldIndex];\r\n            var newLink = newLinks[newIndex];\r\n            if (Range.areIntersectingOrTouching(oldLink.range, newLink.range)) {\r\n                // Remove the oldLink\r\n                oldIndex++;\r\n                continue;\r\n            }\r\n            var comparisonResult = Range.compareRangesUsingStarts(oldLink.range, newLink.range);\r\n            if (comparisonResult < 0) {\r\n                // oldLink is before\r\n                result.push(oldLink);\r\n                oldIndex++;\r\n            }\r\n            else {\r\n                // newLink is before\r\n                result.push(newLink);\r\n                newIndex++;\r\n            }\r\n        }\r\n        for (; oldIndex < oldLen; oldIndex++) {\r\n            result.push(oldLinks[oldIndex]);\r\n        }\r\n        for (; newIndex < newLen; newIndex++) {\r\n            result.push(newLinks[newIndex]);\r\n        }\r\n        return result;\r\n    };\r\n    return LinksList;\r\n}(Disposable));\r\nexport { LinksList };\r\nexport function getLinks(model, token) {\r\n    var lists = [];\r\n    // ask all providers for links in parallel\r\n    var promises = LinkProviderRegistry.ordered(model).reverse().map(function (provider, i) {\r\n        return Promise.resolve(provider.provideLinks(model, token)).then(function (result) {\r\n            if (result) {\r\n                lists[i] = [result, provider];\r\n            }\r\n        }, onUnexpectedExternalError);\r\n    });\r\n    return Promise.all(promises).then(function () {\r\n        var result = new LinksList(coalesce(lists));\r\n        if (!token.isCancellationRequested) {\r\n            return result;\r\n        }\r\n        result.dispose();\r\n        return new LinksList([]);\r\n    });\r\n}\r\nCommandsRegistry.registerCommand('_executeLinkProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    return __awaiter(void 0, void 0, void 0, function () {\r\n        var uri, model, list, result;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    uri = args[0];\r\n                    if (!(uri instanceof URI)) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    model = accessor.get(IModelService).getModel(uri);\r\n                    if (!model) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    return [4 /*yield*/, getLinks(model, CancellationToken.None)];\r\n                case 1:\r\n                    list = _a.sent();\r\n                    if (!list) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    result = list.links.slice(0);\r\n                    list.dispose();\r\n                    return [2 /*return*/, result];\r\n            }\r\n        });\r\n    });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport './links.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as async from '../../../base/common/async.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { LinkProviderRegistry } from '../../common/modes.js';\r\nimport { ClickLinkGesture } from '../gotoSymbol/link/clickLinkGesture.js';\r\nimport { getLinks } from './getLinks.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorActiveLinkForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nfunction getHoverMessage(link, useMetaKey) {\r\n    var executeCmd = link.url && /^command:/i.test(link.url.toString());\r\n    var label = link.tooltip\r\n        ? link.tooltip\r\n        : executeCmd\r\n            ? nls.localize('links.navigate.executeCmd', 'Execute command')\r\n            : nls.localize('links.navigate.follow', 'Follow link');\r\n    var kb = useMetaKey\r\n        ? platform.isMacintosh\r\n            ? nls.localize('links.navigate.kb.meta.mac', \"cmd + click\")\r\n            : nls.localize('links.navigate.kb.meta', \"ctrl + click\")\r\n        : platform.isMacintosh\r\n            ? nls.localize('links.navigate.kb.alt.mac', \"option + click\")\r\n            : nls.localize('links.navigate.kb.alt', \"alt + click\");\r\n    if (link.url) {\r\n        var hoverMessage = new MarkdownString('', true).appendMarkdown(\"[\" + label + \"](\" + link.url.toString() + \") (\" + kb + \")\");\r\n        return hoverMessage;\r\n    }\r\n    else {\r\n        return new MarkdownString().appendText(label + \" (\" + kb + \")\");\r\n    }\r\n}\r\nvar decoration = {\r\n    general: ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        collapseOnReplaceEdit: true,\r\n        inlineClassName: 'detected-link'\r\n    }),\r\n    active: ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        collapseOnReplaceEdit: true,\r\n        inlineClassName: 'detected-link-active'\r\n    })\r\n};\r\nvar LinkOccurrence = /** @class */ (function () {\r\n    function LinkOccurrence(link, decorationId) {\r\n        this.link = link;\r\n        this.decorationId = decorationId;\r\n    }\r\n    LinkOccurrence.decoration = function (link, useMetaKey) {\r\n        return {\r\n            range: link.range,\r\n            options: LinkOccurrence._getOptions(link, useMetaKey, false)\r\n        };\r\n    };\r\n    LinkOccurrence._getOptions = function (link, useMetaKey, isActive) {\r\n        var options = __assign({}, (isActive ? decoration.active : decoration.general));\r\n        options.hoverMessage = getHoverMessage(link, useMetaKey);\r\n        return options;\r\n    };\r\n    LinkOccurrence.prototype.activate = function (changeAccessor, useMetaKey) {\r\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, true));\r\n    };\r\n    LinkOccurrence.prototype.deactivate = function (changeAccessor, useMetaKey) {\r\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, false));\r\n    };\r\n    return LinkOccurrence;\r\n}());\r\nvar LinkDetector = /** @class */ (function () {\r\n    function LinkDetector(editor, openerService, notificationService) {\r\n        var _this = this;\r\n        this.listenersToRemove = new DisposableStore();\r\n        this.editor = editor;\r\n        this.openerService = openerService;\r\n        this.notificationService = notificationService;\r\n        var clickLinkGesture = new ClickLinkGesture(editor);\r\n        this.listenersToRemove.add(clickLinkGesture);\r\n        this.listenersToRemove.add(clickLinkGesture.onMouseMoveOrRelevantKeyDown(function (_a) {\r\n            var mouseEvent = _a[0], keyboardEvent = _a[1];\r\n            _this._onEditorMouseMove(mouseEvent, keyboardEvent);\r\n        }));\r\n        this.listenersToRemove.add(clickLinkGesture.onExecute(function (e) {\r\n            _this.onEditorMouseUp(e);\r\n        }));\r\n        this.listenersToRemove.add(clickLinkGesture.onCancel(function (e) {\r\n            _this.cleanUpActiveLinkDecoration();\r\n        }));\r\n        this.enabled = editor.getOption(50 /* links */);\r\n        this.listenersToRemove.add(editor.onDidChangeConfiguration(function (e) {\r\n            var enabled = editor.getOption(50 /* links */);\r\n            if (_this.enabled === enabled) {\r\n                // No change in our configuration option\r\n                return;\r\n            }\r\n            _this.enabled = enabled;\r\n            // Remove any links (for the getting disabled case)\r\n            _this.updateDecorations([]);\r\n            // Stop any computation (for the getting disabled case)\r\n            _this.stop();\r\n            // Start computing (for the getting enabled case)\r\n            _this.beginCompute();\r\n        }));\r\n        this.listenersToRemove.add(editor.onDidChangeModelContent(function (e) { return _this.onChange(); }));\r\n        this.listenersToRemove.add(editor.onDidChangeModel(function (e) { return _this.onModelChanged(); }));\r\n        this.listenersToRemove.add(editor.onDidChangeModelLanguage(function (e) { return _this.onModelModeChanged(); }));\r\n        this.listenersToRemove.add(LinkProviderRegistry.onDidChange(function (e) { return _this.onModelModeChanged(); }));\r\n        this.timeout = new async.TimeoutTimer();\r\n        this.computePromise = null;\r\n        this.activeLinksList = null;\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        this.beginCompute();\r\n    }\r\n    LinkDetector.get = function (editor) {\r\n        return editor.getContribution(LinkDetector.ID);\r\n    };\r\n    LinkDetector.prototype.onModelChanged = function () {\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        this.stop();\r\n        this.beginCompute();\r\n    };\r\n    LinkDetector.prototype.onModelModeChanged = function () {\r\n        this.stop();\r\n        this.beginCompute();\r\n    };\r\n    LinkDetector.prototype.onChange = function () {\r\n        var _this = this;\r\n        this.timeout.setIfNotSet(function () { return _this.beginCompute(); }, LinkDetector.RECOMPUTE_TIME);\r\n    };\r\n    LinkDetector.prototype.beginCompute = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var model, _a, err_1;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!this.editor.hasModel() || !this.enabled) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        model = this.editor.getModel();\r\n                        if (!LinkProviderRegistry.has(model)) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        if (this.activeLinksList) {\r\n                            this.activeLinksList.dispose();\r\n                            this.activeLinksList = null;\r\n                        }\r\n                        this.computePromise = async.createCancelablePromise(function (token) { return getLinks(model, token); });\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 3, 4, 5]);\r\n                        _a = this;\r\n                        return [4 /*yield*/, this.computePromise];\r\n                    case 2:\r\n                        _a.activeLinksList = _b.sent();\r\n                        this.updateDecorations(this.activeLinksList.links);\r\n                        return [3 /*break*/, 5];\r\n                    case 3:\r\n                        err_1 = _b.sent();\r\n                        onUnexpectedError(err_1);\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        this.computePromise = null;\r\n                        return [7 /*endfinally*/];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    LinkDetector.prototype.updateDecorations = function (links) {\r\n        var useMetaKey = (this.editor.getOption(57 /* multiCursorModifier */) === 'altKey');\r\n        var oldDecorations = [];\r\n        var keys = Object.keys(this.currentOccurrences);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var decorationId = keys[i];\r\n            var occurance = this.currentOccurrences[decorationId];\r\n            oldDecorations.push(occurance.decorationId);\r\n        }\r\n        var newDecorations = [];\r\n        if (links) {\r\n            // Not sure why this is sometimes null\r\n            for (var _i = 0, links_1 = links; _i < links_1.length; _i++) {\r\n                var link = links_1[_i];\r\n                newDecorations.push(LinkOccurrence.decoration(link, useMetaKey));\r\n            }\r\n        }\r\n        var decorations = this.editor.deltaDecorations(oldDecorations, newDecorations);\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var occurance = new LinkOccurrence(links[i], decorations[i]);\r\n            this.currentOccurrences[occurance.decorationId] = occurance;\r\n        }\r\n    };\r\n    LinkDetector.prototype._onEditorMouseMove = function (mouseEvent, withKey) {\r\n        var _this = this;\r\n        var useMetaKey = (this.editor.getOption(57 /* multiCursorModifier */) === 'altKey');\r\n        if (this.isEnabled(mouseEvent, withKey)) {\r\n            this.cleanUpActiveLinkDecoration(); // always remove previous link decoration as their can only be one\r\n            var occurrence_1 = this.getLinkOccurrence(mouseEvent.target.position);\r\n            if (occurrence_1) {\r\n                this.editor.changeDecorations(function (changeAccessor) {\r\n                    occurrence_1.activate(changeAccessor, useMetaKey);\r\n                    _this.activeLinkDecorationId = occurrence_1.decorationId;\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            this.cleanUpActiveLinkDecoration();\r\n        }\r\n    };\r\n    LinkDetector.prototype.cleanUpActiveLinkDecoration = function () {\r\n        var useMetaKey = (this.editor.getOption(57 /* multiCursorModifier */) === 'altKey');\r\n        if (this.activeLinkDecorationId) {\r\n            var occurrence_2 = this.currentOccurrences[this.activeLinkDecorationId];\r\n            if (occurrence_2) {\r\n                this.editor.changeDecorations(function (changeAccessor) {\r\n                    occurrence_2.deactivate(changeAccessor, useMetaKey);\r\n                });\r\n            }\r\n            this.activeLinkDecorationId = null;\r\n        }\r\n    };\r\n    LinkDetector.prototype.onEditorMouseUp = function (mouseEvent) {\r\n        if (!this.isEnabled(mouseEvent)) {\r\n            return;\r\n        }\r\n        var occurrence = this.getLinkOccurrence(mouseEvent.target.position);\r\n        if (!occurrence) {\r\n            return;\r\n        }\r\n        this.openLinkOccurrence(occurrence, mouseEvent.hasSideBySideModifier, true /* from user gesture */);\r\n    };\r\n    LinkDetector.prototype.openLinkOccurrence = function (occurrence, openToSide, fromUserGesture) {\r\n        var _this = this;\r\n        if (fromUserGesture === void 0) { fromUserGesture = false; }\r\n        if (!this.openerService) {\r\n            return;\r\n        }\r\n        var link = occurrence.link;\r\n        link.resolve(CancellationToken.None).then(function (uri) {\r\n            // open the uri\r\n            return _this.openerService.open(uri, { openToSide: openToSide, fromUserGesture: fromUserGesture });\r\n        }, function (err) {\r\n            var messageOrError = err instanceof Error ? err.message : err;\r\n            // different error cases\r\n            if (messageOrError === 'invalid') {\r\n                _this.notificationService.warn(nls.localize('invalid.url', 'Failed to open this link because it is not well-formed: {0}', link.url.toString()));\r\n            }\r\n            else if (messageOrError === 'missing') {\r\n                _this.notificationService.warn(nls.localize('missing.url', 'Failed to open this link because its target is missing.'));\r\n            }\r\n            else {\r\n                onUnexpectedError(err);\r\n            }\r\n        });\r\n    };\r\n    LinkDetector.prototype.getLinkOccurrence = function (position) {\r\n        if (!this.editor.hasModel() || !position) {\r\n            return null;\r\n        }\r\n        var decorations = this.editor.getModel().getDecorationsInRange({\r\n            startLineNumber: position.lineNumber,\r\n            startColumn: position.column,\r\n            endLineNumber: position.lineNumber,\r\n            endColumn: position.column\r\n        }, 0, true);\r\n        for (var _i = 0, decorations_1 = decorations; _i < decorations_1.length; _i++) {\r\n            var decoration_1 = decorations_1[_i];\r\n            var currentOccurrence = this.currentOccurrences[decoration_1.id];\r\n            if (currentOccurrence) {\r\n                return currentOccurrence;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    LinkDetector.prototype.isEnabled = function (mouseEvent, withKey) {\r\n        return Boolean((mouseEvent.target.type === 6 /* CONTENT_TEXT */)\r\n            && (mouseEvent.hasTriggerModifier || (withKey && withKey.keyCodeIsTriggerKey)));\r\n    };\r\n    LinkDetector.prototype.stop = function () {\r\n        this.timeout.cancel();\r\n        if (this.activeLinksList) {\r\n            this.activeLinksList.dispose();\r\n        }\r\n        if (this.computePromise) {\r\n            this.computePromise.cancel();\r\n            this.computePromise = null;\r\n        }\r\n    };\r\n    LinkDetector.prototype.dispose = function () {\r\n        this.listenersToRemove.dispose();\r\n        this.stop();\r\n        this.timeout.dispose();\r\n    };\r\n    LinkDetector.ID = 'editor.linkDetector';\r\n    LinkDetector.RECOMPUTE_TIME = 1000; // ms\r\n    LinkDetector = __decorate([\r\n        __param(1, IOpenerService),\r\n        __param(2, INotificationService)\r\n    ], LinkDetector);\r\n    return LinkDetector;\r\n}());\r\nvar OpenLinkAction = /** @class */ (function (_super) {\r\n    __extends(OpenLinkAction, _super);\r\n    function OpenLinkAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.openLink',\r\n            label: nls.localize('label', \"Open Link\"),\r\n            alias: 'Open Link',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    OpenLinkAction.prototype.run = function (accessor, editor) {\r\n        var linkDetector = LinkDetector.get(editor);\r\n        if (!linkDetector) {\r\n            return;\r\n        }\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = editor.getSelections();\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var sel = selections_1[_i];\r\n            var link = linkDetector.getLinkOccurrence(sel.getEndPosition());\r\n            if (link) {\r\n                linkDetector.openLinkOccurrence(link, false);\r\n            }\r\n        }\r\n    };\r\n    return OpenLinkAction;\r\n}(EditorAction));\r\nregisterEditorContribution(LinkDetector.ID, LinkDetector);\r\nregisterEditorAction(OpenLinkAction);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(\".monaco-editor .detected-link-active { color: \" + activeLinkForeground + \" !important; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { CursorMoveCommands } from '../../common/controller/cursorMoveCommands.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { DocumentHighlightProviderRegistry } from '../../common/modes.js';\r\nimport { CommonFindController } from '../find/findController.js';\r\nimport { overviewRulerSelectionHighlightForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nvar InsertCursorAbove = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAbove, _super);\r\n    function InsertCursorAbove() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertCursorAbove',\r\n            label: nls.localize('mutlicursor.insertAbove', \"Add Cursor Above\"),\r\n            alias: 'Add Cursor Above',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 16 /* UpArrow */,\r\n                linux: {\r\n                    primary: 1024 /* Shift */ | 512 /* Alt */ | 16 /* UpArrow */,\r\n                    secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 16 /* UpArrow */]\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorAbove', comment: ['&& denotes a mnemonic'] }, \"&&Add Cursor Above\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertCursorAbove.prototype.run = function (accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var useLogicalLine = (args && args.logicalLine === true);\r\n        var cursors = editor._getCursors();\r\n        var context = cursors.context;\r\n        if (context.config.readOnly) {\r\n            return;\r\n        }\r\n        context.model.pushStackElement();\r\n        cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.addCursorUp(context, cursors.getAll(), useLogicalLine));\r\n        cursors.reveal(args.source, true, 1 /* TopMost */, 0 /* Smooth */);\r\n    };\r\n    return InsertCursorAbove;\r\n}(EditorAction));\r\nexport { InsertCursorAbove };\r\nvar InsertCursorBelow = /** @class */ (function (_super) {\r\n    __extends(InsertCursorBelow, _super);\r\n    function InsertCursorBelow() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertCursorBelow',\r\n            label: nls.localize('mutlicursor.insertBelow', \"Add Cursor Below\"),\r\n            alias: 'Add Cursor Below',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 18 /* DownArrow */,\r\n                linux: {\r\n                    primary: 1024 /* Shift */ | 512 /* Alt */ | 18 /* DownArrow */,\r\n                    secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 18 /* DownArrow */]\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorBelow', comment: ['&& denotes a mnemonic'] }, \"A&&dd Cursor Below\"),\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertCursorBelow.prototype.run = function (accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var useLogicalLine = (args && args.logicalLine === true);\r\n        var cursors = editor._getCursors();\r\n        var context = cursors.context;\r\n        if (context.config.readOnly) {\r\n            return;\r\n        }\r\n        context.model.pushStackElement();\r\n        cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.addCursorDown(context, cursors.getAll(), useLogicalLine));\r\n        cursors.reveal(args.source, true, 2 /* BottomMost */, 0 /* Smooth */);\r\n    };\r\n    return InsertCursorBelow;\r\n}(EditorAction));\r\nexport { InsertCursorBelow };\r\nvar InsertCursorAtEndOfEachLineSelected = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAtEndOfEachLineSelected, _super);\r\n    function InsertCursorAtEndOfEachLineSelected() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertCursorAtEndOfEachLineSelected',\r\n            label: nls.localize('mutlicursor.insertAtEndOfEachLineSelected', \"Add Cursors to Line Ends\"),\r\n            alias: 'Add Cursors to Line Ends',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 39 /* KEY_I */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorAtEndOfEachLineSelected', comment: ['&& denotes a mnemonic'] }, \"Add C&&ursors to Line Ends\"),\r\n                order: 4\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertCursorAtEndOfEachLineSelected.prototype.getCursorsForSelection = function (selection, model, result) {\r\n        if (selection.isEmpty()) {\r\n            return;\r\n        }\r\n        for (var i = selection.startLineNumber; i < selection.endLineNumber; i++) {\r\n            var currentLineMaxColumn = model.getLineMaxColumn(i);\r\n            result.push(new Selection(i, currentLineMaxColumn, i, currentLineMaxColumn));\r\n        }\r\n        if (selection.endColumn > 1) {\r\n            result.push(new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn));\r\n        }\r\n    };\r\n    InsertCursorAtEndOfEachLineSelected.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        var selections = editor.getSelections();\r\n        var newSelections = [];\r\n        selections.forEach(function (sel) { return _this.getCursorsForSelection(sel, model, newSelections); });\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n    };\r\n    return InsertCursorAtEndOfEachLineSelected;\r\n}(EditorAction));\r\nvar InsertCursorAtEndOfLineSelected = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAtEndOfLineSelected, _super);\r\n    function InsertCursorAtEndOfLineSelected() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addCursorsToBottom',\r\n            label: nls.localize('mutlicursor.addCursorsToBottom', \"Add Cursors To Bottom\"),\r\n            alias: 'Add Cursors To Bottom',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    InsertCursorAtEndOfLineSelected.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = editor.getSelections();\r\n        var lineCount = editor.getModel().getLineCount();\r\n        var newSelections = [];\r\n        for (var i = selections[0].startLineNumber; i <= lineCount; i++) {\r\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\r\n        }\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n    };\r\n    return InsertCursorAtEndOfLineSelected;\r\n}(EditorAction));\r\nvar InsertCursorAtTopOfLineSelected = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAtTopOfLineSelected, _super);\r\n    function InsertCursorAtTopOfLineSelected() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addCursorsToTop',\r\n            label: nls.localize('mutlicursor.addCursorsToTop', \"Add Cursors To Top\"),\r\n            alias: 'Add Cursors To Top',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    InsertCursorAtTopOfLineSelected.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = editor.getSelections();\r\n        var newSelections = [];\r\n        for (var i = selections[0].startLineNumber; i >= 1; i--) {\r\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\r\n        }\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n    };\r\n    return InsertCursorAtTopOfLineSelected;\r\n}(EditorAction));\r\nvar MultiCursorSessionResult = /** @class */ (function () {\r\n    function MultiCursorSessionResult(selections, revealRange, revealScrollType) {\r\n        this.selections = selections;\r\n        this.revealRange = revealRange;\r\n        this.revealScrollType = revealScrollType;\r\n    }\r\n    return MultiCursorSessionResult;\r\n}());\r\nexport { MultiCursorSessionResult };\r\nvar MultiCursorSession = /** @class */ (function () {\r\n    function MultiCursorSession(_editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch) {\r\n        this._editor = _editor;\r\n        this.findController = findController;\r\n        this.isDisconnectedFromFindController = isDisconnectedFromFindController;\r\n        this.searchText = searchText;\r\n        this.wholeWord = wholeWord;\r\n        this.matchCase = matchCase;\r\n        this.currentMatch = currentMatch;\r\n    }\r\n    MultiCursorSession.create = function (editor, findController) {\r\n        if (!editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var findState = findController.getState();\r\n        // Find widget owns entirely what we search for if:\r\n        //  - focus is not in the editor (i.e. it is in the find widget)\r\n        //  - and the search widget is visible\r\n        //  - and the search string is non-empty\r\n        if (!editor.hasTextFocus() && findState.isRevealed && findState.searchString.length > 0) {\r\n            // Find widget owns what is searched for\r\n            return new MultiCursorSession(editor, findController, false, findState.searchString, findState.wholeWord, findState.matchCase, null);\r\n        }\r\n        // Otherwise, the selection gives the search text, and the find widget gives the search settings\r\n        // The exception is the find state disassociation case: when beginning with a single, collapsed selection\r\n        var isDisconnectedFromFindController = false;\r\n        var wholeWord;\r\n        var matchCase;\r\n        var selections = editor.getSelections();\r\n        if (selections.length === 1 && selections[0].isEmpty()) {\r\n            isDisconnectedFromFindController = true;\r\n            wholeWord = true;\r\n            matchCase = true;\r\n        }\r\n        else {\r\n            wholeWord = findState.wholeWord;\r\n            matchCase = findState.matchCase;\r\n        }\r\n        // Selection owns what is searched for\r\n        var s = editor.getSelection();\r\n        var searchText;\r\n        var currentMatch = null;\r\n        if (s.isEmpty()) {\r\n            // selection is empty => expand to current word\r\n            var word = editor.getModel().getWordAtPosition(s.getStartPosition());\r\n            if (!word) {\r\n                return null;\r\n            }\r\n            searchText = word.word;\r\n            currentMatch = new Selection(s.startLineNumber, word.startColumn, s.startLineNumber, word.endColumn);\r\n        }\r\n        else {\r\n            searchText = editor.getModel().getValueInRange(s).replace(/\\r\\n/g, '\\n');\r\n        }\r\n        return new MultiCursorSession(editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch);\r\n    };\r\n    MultiCursorSession.prototype.addSelectionToNextFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var nextMatch = this._getNextMatch();\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.concat(nextMatch), nextMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype.moveSelectionToNextFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var nextMatch = this._getNextMatch();\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(nextMatch), nextMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype._getNextMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        if (this.currentMatch) {\r\n            var result = this.currentMatch;\r\n            this.currentMatch = null;\r\n            return result;\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        var allSelections = this._editor.getSelections();\r\n        var lastAddedSelection = allSelections[allSelections.length - 1];\r\n        var nextMatch = this._editor.getModel().findNextMatch(this.searchText, lastAddedSelection.getEndPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(92 /* wordSeparators */) : null, false);\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        return new Selection(nextMatch.range.startLineNumber, nextMatch.range.startColumn, nextMatch.range.endLineNumber, nextMatch.range.endColumn);\r\n    };\r\n    MultiCursorSession.prototype.addSelectionToPreviousFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var previousMatch = this._getPreviousMatch();\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.concat(previousMatch), previousMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype.moveSelectionToPreviousFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var previousMatch = this._getPreviousMatch();\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(previousMatch), previousMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype._getPreviousMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        if (this.currentMatch) {\r\n            var result = this.currentMatch;\r\n            this.currentMatch = null;\r\n            return result;\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        var allSelections = this._editor.getSelections();\r\n        var lastAddedSelection = allSelections[allSelections.length - 1];\r\n        var previousMatch = this._editor.getModel().findPreviousMatch(this.searchText, lastAddedSelection.getStartPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(92 /* wordSeparators */) : null, false);\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        return new Selection(previousMatch.range.startLineNumber, previousMatch.range.startColumn, previousMatch.range.endLineNumber, previousMatch.range.endColumn);\r\n    };\r\n    MultiCursorSession.prototype.selectAll = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return [];\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        return this._editor.getModel().findMatches(this.searchText, true, false, this.matchCase, this.wholeWord ? this._editor.getOption(92 /* wordSeparators */) : null, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n    };\r\n    return MultiCursorSession;\r\n}());\r\nexport { MultiCursorSession };\r\nvar MultiCursorSelectionController = /** @class */ (function (_super) {\r\n    __extends(MultiCursorSelectionController, _super);\r\n    function MultiCursorSelectionController(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._sessionDispose = _this._register(new DisposableStore());\r\n        _this._editor = editor;\r\n        _this._ignoreSelectionChange = false;\r\n        _this._session = null;\r\n        return _this;\r\n    }\r\n    MultiCursorSelectionController.get = function (editor) {\r\n        return editor.getContribution(MultiCursorSelectionController.ID);\r\n    };\r\n    MultiCursorSelectionController.prototype.dispose = function () {\r\n        this._endSession();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    MultiCursorSelectionController.prototype._beginSessionIfNeeded = function (findController) {\r\n        var _this = this;\r\n        if (!this._session) {\r\n            // Create a new session\r\n            var session = MultiCursorSession.create(this._editor, findController);\r\n            if (!session) {\r\n                return;\r\n            }\r\n            this._session = session;\r\n            var newState = { searchString: this._session.searchText };\r\n            if (this._session.isDisconnectedFromFindController) {\r\n                newState.wholeWordOverride = 1 /* True */;\r\n                newState.matchCaseOverride = 1 /* True */;\r\n                newState.isRegexOverride = 2 /* False */;\r\n            }\r\n            findController.getState().change(newState, false);\r\n            this._sessionDispose.add(this._editor.onDidChangeCursorSelection(function (e) {\r\n                if (_this._ignoreSelectionChange) {\r\n                    return;\r\n                }\r\n                _this._endSession();\r\n            }));\r\n            this._sessionDispose.add(this._editor.onDidBlurEditorText(function () {\r\n                _this._endSession();\r\n            }));\r\n            this._sessionDispose.add(findController.getState().onFindReplaceStateChange(function (e) {\r\n                if (e.matchCase || e.wholeWord) {\r\n                    _this._endSession();\r\n                }\r\n            }));\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype._endSession = function () {\r\n        this._sessionDispose.clear();\r\n        if (this._session && this._session.isDisconnectedFromFindController) {\r\n            var newState = {\r\n                wholeWordOverride: 0 /* NotSet */,\r\n                matchCaseOverride: 0 /* NotSet */,\r\n                isRegexOverride: 0 /* NotSet */,\r\n            };\r\n            this._session.findController.getState().change(newState, false);\r\n        }\r\n        this._session = null;\r\n    };\r\n    MultiCursorSelectionController.prototype._setSelections = function (selections) {\r\n        this._ignoreSelectionChange = true;\r\n        this._editor.setSelections(selections);\r\n        this._ignoreSelectionChange = false;\r\n    };\r\n    MultiCursorSelectionController.prototype._expandEmptyToWord = function (model, selection) {\r\n        if (!selection.isEmpty()) {\r\n            return selection;\r\n        }\r\n        var word = model.getWordAtPosition(selection.getStartPosition());\r\n        if (!word) {\r\n            return selection;\r\n        }\r\n        return new Selection(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\r\n    };\r\n    MultiCursorSelectionController.prototype._applySessionResult = function (result) {\r\n        if (!result) {\r\n            return;\r\n        }\r\n        this._setSelections(result.selections);\r\n        if (result.revealRange) {\r\n            this._editor.revealRangeInCenterIfOutsideViewport(result.revealRange, result.revealScrollType);\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.getSession = function (findController) {\r\n        return this._session;\r\n    };\r\n    MultiCursorSelectionController.prototype.addSelectionToNextFindMatch = function (findController) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this._session) {\r\n            // If there are multiple cursors, handle the case where they do not all select the same text.\r\n            var allSelections = this._editor.getSelections();\r\n            if (allSelections.length > 1) {\r\n                var findState = findController.getState();\r\n                var matchCase = findState.matchCase;\r\n                var selectionsContainSameText = modelRangesContainSameText(this._editor.getModel(), allSelections, matchCase);\r\n                if (!selectionsContainSameText) {\r\n                    var model = this._editor.getModel();\r\n                    var resultingSelections = [];\r\n                    for (var i = 0, len = allSelections.length; i < len; i++) {\r\n                        resultingSelections[i] = this._expandEmptyToWord(model, allSelections[i]);\r\n                    }\r\n                    this._editor.setSelections(resultingSelections);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.addSelectionToNextFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.addSelectionToPreviousFindMatch = function (findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.addSelectionToPreviousFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.moveSelectionToNextFindMatch = function (findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.moveSelectionToNextFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.moveSelectionToPreviousFindMatch = function (findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.moveSelectionToPreviousFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.selectAll = function (findController) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var matches = null;\r\n        var findState = findController.getState();\r\n        // Special case: find widget owns entirely what we search for if:\r\n        // - focus is not in the editor (i.e. it is in the find widget)\r\n        // - and the search widget is visible\r\n        // - and the search string is non-empty\r\n        // - and we're searching for a regex\r\n        if (findState.isRevealed && findState.searchString.length > 0 && findState.isRegex) {\r\n            matches = this._editor.getModel().findMatches(findState.searchString, true, findState.isRegex, findState.matchCase, findState.wholeWord ? this._editor.getOption(92 /* wordSeparators */) : null, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        }\r\n        else {\r\n            this._beginSessionIfNeeded(findController);\r\n            if (!this._session) {\r\n                return;\r\n            }\r\n            matches = this._session.selectAll();\r\n        }\r\n        if (findState.searchScope) {\r\n            var state = findState.searchScope;\r\n            var inSelection = [];\r\n            for (var i = 0; i < matches.length; i++) {\r\n                if (matches[i].range.endLineNumber <= state.endLineNumber && matches[i].range.startLineNumber >= state.startLineNumber) {\r\n                    inSelection.push(matches[i]);\r\n                }\r\n            }\r\n            matches = inSelection;\r\n        }\r\n        if (matches.length > 0) {\r\n            var editorSelection = this._editor.getSelection();\r\n            // Have the primary cursor remain the one where the action was invoked\r\n            for (var i = 0, len = matches.length; i < len; i++) {\r\n                var match = matches[i];\r\n                var intersection = match.range.intersectRanges(editorSelection);\r\n                if (intersection) {\r\n                    // bingo!\r\n                    matches[i] = matches[0];\r\n                    matches[0] = match;\r\n                    break;\r\n                }\r\n            }\r\n            this._setSelections(matches.map(function (m) { return new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn); }));\r\n        }\r\n    };\r\n    MultiCursorSelectionController.ID = 'editor.contrib.multiCursorController';\r\n    return MultiCursorSelectionController;\r\n}(Disposable));\r\nexport { MultiCursorSelectionController };\r\nvar MultiCursorSelectionControllerAction = /** @class */ (function (_super) {\r\n    __extends(MultiCursorSelectionControllerAction, _super);\r\n    function MultiCursorSelectionControllerAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MultiCursorSelectionControllerAction.prototype.run = function (accessor, editor) {\r\n        var multiCursorController = MultiCursorSelectionController.get(editor);\r\n        if (!multiCursorController) {\r\n            return;\r\n        }\r\n        var findController = CommonFindController.get(editor);\r\n        if (!findController) {\r\n            return;\r\n        }\r\n        this._run(multiCursorController, findController);\r\n    };\r\n    return MultiCursorSelectionControllerAction;\r\n}(EditorAction));\r\nexport { MultiCursorSelectionControllerAction };\r\nvar AddSelectionToNextFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(AddSelectionToNextFindMatchAction, _super);\r\n    function AddSelectionToNextFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addSelectionToNextFindMatch',\r\n            label: nls.localize('addSelectionToNextFindMatch', \"Add Selection To Next Find Match\"),\r\n            alias: 'Add Selection To Next Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 34 /* KEY_D */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miAddSelectionToNextFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add &&Next Occurrence\"),\r\n                order: 5\r\n            }\r\n        }) || this;\r\n    }\r\n    AddSelectionToNextFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.addSelectionToNextFindMatch(findController);\r\n    };\r\n    return AddSelectionToNextFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { AddSelectionToNextFindMatchAction };\r\nvar AddSelectionToPreviousFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(AddSelectionToPreviousFindMatchAction, _super);\r\n    function AddSelectionToPreviousFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addSelectionToPreviousFindMatch',\r\n            label: nls.localize('addSelectionToPreviousFindMatch', \"Add Selection To Previous Find Match\"),\r\n            alias: 'Add Selection To Previous Find Match',\r\n            precondition: undefined,\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miAddSelectionToPreviousFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add P&&revious Occurrence\"),\r\n                order: 6\r\n            }\r\n        }) || this;\r\n    }\r\n    AddSelectionToPreviousFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.addSelectionToPreviousFindMatch(findController);\r\n    };\r\n    return AddSelectionToPreviousFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { AddSelectionToPreviousFindMatchAction };\r\nvar MoveSelectionToNextFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(MoveSelectionToNextFindMatchAction, _super);\r\n    function MoveSelectionToNextFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.moveSelectionToNextFindMatch',\r\n            label: nls.localize('moveSelectionToNextFindMatch', \"Move Last Selection To Next Find Match\"),\r\n            alias: 'Move Last Selection To Next Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 34 /* KEY_D */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    MoveSelectionToNextFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.moveSelectionToNextFindMatch(findController);\r\n    };\r\n    return MoveSelectionToNextFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { MoveSelectionToNextFindMatchAction };\r\nvar MoveSelectionToPreviousFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(MoveSelectionToPreviousFindMatchAction, _super);\r\n    function MoveSelectionToPreviousFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.moveSelectionToPreviousFindMatch',\r\n            label: nls.localize('moveSelectionToPreviousFindMatch', \"Move Last Selection To Previous Find Match\"),\r\n            alias: 'Move Last Selection To Previous Find Match',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    MoveSelectionToPreviousFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.moveSelectionToPreviousFindMatch(findController);\r\n    };\r\n    return MoveSelectionToPreviousFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { MoveSelectionToPreviousFindMatchAction };\r\nvar SelectHighlightsAction = /** @class */ (function (_super) {\r\n    __extends(SelectHighlightsAction, _super);\r\n    function SelectHighlightsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.selectHighlights',\r\n            label: nls.localize('selectAllOccurrencesOfFindMatch', \"Select All Occurrences of Find Match\"),\r\n            alias: 'Select All Occurrences of Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 42 /* KEY_L */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miSelectHighlights', comment: ['&& denotes a mnemonic'] }, \"Select All &&Occurrences\"),\r\n                order: 7\r\n            }\r\n        }) || this;\r\n    }\r\n    SelectHighlightsAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.selectAll(findController);\r\n    };\r\n    return SelectHighlightsAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { SelectHighlightsAction };\r\nvar CompatChangeAll = /** @class */ (function (_super) {\r\n    __extends(CompatChangeAll, _super);\r\n    function CompatChangeAll() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.changeAll',\r\n            label: nls.localize('changeAll.label', \"Change All Occurrences\"),\r\n            alias: 'Change All Occurrences',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.editorTextFocus),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 60 /* F2 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 1.2\r\n            }\r\n        }) || this;\r\n    }\r\n    CompatChangeAll.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.selectAll(findController);\r\n    };\r\n    return CompatChangeAll;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { CompatChangeAll };\r\nvar SelectionHighlighterState = /** @class */ (function () {\r\n    function SelectionHighlighterState(searchText, matchCase, wordSeparators) {\r\n        this.searchText = searchText;\r\n        this.matchCase = matchCase;\r\n        this.wordSeparators = wordSeparators;\r\n    }\r\n    /**\r\n     * Everything equals except for `lastWordUnderCursor`\r\n     */\r\n    SelectionHighlighterState.softEquals = function (a, b) {\r\n        if (!a && !b) {\r\n            return true;\r\n        }\r\n        if (!a || !b) {\r\n            return false;\r\n        }\r\n        return (a.searchText === b.searchText\r\n            && a.matchCase === b.matchCase\r\n            && a.wordSeparators === b.wordSeparators);\r\n    };\r\n    return SelectionHighlighterState;\r\n}());\r\nvar SelectionHighlighter = /** @class */ (function (_super) {\r\n    __extends(SelectionHighlighter, _super);\r\n    function SelectionHighlighter(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this._isEnabled = editor.getOption(78 /* selectionHighlight */);\r\n        _this.decorations = [];\r\n        _this.updateSoon = _this._register(new RunOnceScheduler(function () { return _this._update(); }, 300));\r\n        _this.state = null;\r\n        _this._register(editor.onDidChangeConfiguration(function (e) {\r\n            _this._isEnabled = editor.getOption(78 /* selectionHighlight */);\r\n        }));\r\n        _this._register(editor.onDidChangeCursorSelection(function (e) {\r\n            if (!_this._isEnabled) {\r\n                // Early exit if nothing needs to be done!\r\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n                return;\r\n            }\r\n            if (e.selection.isEmpty()) {\r\n                if (e.reason === 3 /* Explicit */) {\r\n                    if (_this.state) {\r\n                        // no longer valid\r\n                        _this._setState(null);\r\n                    }\r\n                    _this.updateSoon.schedule();\r\n                }\r\n                else {\r\n                    _this._setState(null);\r\n                }\r\n            }\r\n            else {\r\n                _this._update();\r\n            }\r\n        }));\r\n        _this._register(editor.onDidChangeModel(function (e) {\r\n            _this._setState(null);\r\n        }));\r\n        _this._register(CommonFindController.get(editor).getState().onFindReplaceStateChange(function (e) {\r\n            _this._update();\r\n        }));\r\n        return _this;\r\n    }\r\n    SelectionHighlighter.prototype._update = function () {\r\n        this._setState(SelectionHighlighter._createState(this._isEnabled, this.editor));\r\n    };\r\n    SelectionHighlighter._createState = function (isEnabled, editor) {\r\n        if (!isEnabled) {\r\n            return null;\r\n        }\r\n        if (!editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var s = editor.getSelection();\r\n        if (s.startLineNumber !== s.endLineNumber) {\r\n            // multiline forbidden for perf reasons\r\n            return null;\r\n        }\r\n        var multiCursorController = MultiCursorSelectionController.get(editor);\r\n        if (!multiCursorController) {\r\n            return null;\r\n        }\r\n        var findController = CommonFindController.get(editor);\r\n        if (!findController) {\r\n            return null;\r\n        }\r\n        var r = multiCursorController.getSession(findController);\r\n        if (!r) {\r\n            var allSelections = editor.getSelections();\r\n            if (allSelections.length > 1) {\r\n                var findState_1 = findController.getState();\r\n                var matchCase = findState_1.matchCase;\r\n                var selectionsContainSameText = modelRangesContainSameText(editor.getModel(), allSelections, matchCase);\r\n                if (!selectionsContainSameText) {\r\n                    return null;\r\n                }\r\n            }\r\n            r = MultiCursorSession.create(editor, findController);\r\n        }\r\n        if (!r) {\r\n            return null;\r\n        }\r\n        if (r.currentMatch) {\r\n            // This is an empty selection\r\n            // Do not interfere with semantic word highlighting in the no selection case\r\n            return null;\r\n        }\r\n        if (/^[ \\t]+$/.test(r.searchText)) {\r\n            // whitespace only selection\r\n            return null;\r\n        }\r\n        if (r.searchText.length > 200) {\r\n            // very long selection\r\n            return null;\r\n        }\r\n        // TODO: better handling of this case\r\n        var findState = findController.getState();\r\n        var caseSensitive = findState.matchCase;\r\n        // Return early if the find widget shows the exact same matches\r\n        if (findState.isRevealed) {\r\n            var findStateSearchString = findState.searchString;\r\n            if (!caseSensitive) {\r\n                findStateSearchString = findStateSearchString.toLowerCase();\r\n            }\r\n            var mySearchString = r.searchText;\r\n            if (!caseSensitive) {\r\n                mySearchString = mySearchString.toLowerCase();\r\n            }\r\n            if (findStateSearchString === mySearchString && r.matchCase === findState.matchCase && r.wholeWord === findState.wholeWord && !findState.isRegex) {\r\n                return null;\r\n            }\r\n        }\r\n        return new SelectionHighlighterState(r.searchText, r.matchCase, r.wholeWord ? editor.getOption(92 /* wordSeparators */) : null);\r\n    };\r\n    SelectionHighlighter.prototype._setState = function (state) {\r\n        if (SelectionHighlighterState.softEquals(this.state, state)) {\r\n            this.state = state;\r\n            return;\r\n        }\r\n        this.state = state;\r\n        if (!this.state) {\r\n            this.decorations = this.editor.deltaDecorations(this.decorations, []);\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this.editor.getModel();\r\n        if (model.isTooLargeForTokenization()) {\r\n            // the file is too large, so searching word under cursor in the whole document takes is blocking the UI.\r\n            return;\r\n        }\r\n        var hasFindOccurrences = DocumentHighlightProviderRegistry.has(model);\r\n        var allMatches = model.findMatches(this.state.searchText, true, false, this.state.matchCase, this.state.wordSeparators, false).map(function (m) { return m.range; });\r\n        allMatches.sort(Range.compareRangesUsingStarts);\r\n        var selections = this.editor.getSelections();\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        // do not overlap with selection (issue #64 and #512)\r\n        var matches = [];\r\n        for (var i = 0, j = 0, len = allMatches.length, lenJ = selections.length; i < len;) {\r\n            var match = allMatches[i];\r\n            if (j >= lenJ) {\r\n                // finished all editor selections\r\n                matches.push(match);\r\n                i++;\r\n            }\r\n            else {\r\n                var cmp = Range.compareRangesUsingStarts(match, selections[j]);\r\n                if (cmp < 0) {\r\n                    // match is before sel\r\n                    if (selections[j].isEmpty() || !Range.areIntersecting(match, selections[j])) {\r\n                        matches.push(match);\r\n                    }\r\n                    i++;\r\n                }\r\n                else if (cmp > 0) {\r\n                    // sel is before match\r\n                    j++;\r\n                }\r\n                else {\r\n                    // sel is equal to match\r\n                    i++;\r\n                    j++;\r\n                }\r\n            }\r\n        }\r\n        var decorations = matches.map(function (r) {\r\n            return {\r\n                range: r,\r\n                // Show in overviewRuler only if model has no semantic highlighting\r\n                options: (hasFindOccurrences ? SelectionHighlighter._SELECTION_HIGHLIGHT : SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW)\r\n            };\r\n        });\r\n        this.decorations = this.editor.deltaDecorations(this.decorations, decorations);\r\n    };\r\n    SelectionHighlighter.prototype.dispose = function () {\r\n        this._setState(null);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    SelectionHighlighter.ID = 'editor.contrib.selectionHighlighter';\r\n    SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'selectionHighlight',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerSelectionHighlightForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    SelectionHighlighter._SELECTION_HIGHLIGHT = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'selectionHighlight',\r\n    });\r\n    return SelectionHighlighter;\r\n}(Disposable));\r\nexport { SelectionHighlighter };\r\nfunction modelRangesContainSameText(model, ranges, matchCase) {\r\n    var selectedText = getValueInRange(model, ranges[0], !matchCase);\r\n    for (var i = 1, len = ranges.length; i < len; i++) {\r\n        var range = ranges[i];\r\n        if (range.isEmpty()) {\r\n            return false;\r\n        }\r\n        var thisSelectedText = getValueInRange(model, range, !matchCase);\r\n        if (selectedText !== thisSelectedText) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction getValueInRange(model, range, toLowerCase) {\r\n    var text = model.getValueInRange(range);\r\n    return (toLowerCase ? text.toLowerCase() : text);\r\n}\r\nregisterEditorContribution(MultiCursorSelectionController.ID, MultiCursorSelectionController);\r\nregisterEditorContribution(SelectionHighlighter.ID, SelectionHighlighter);\r\nregisterEditorAction(InsertCursorAbove);\r\nregisterEditorAction(InsertCursorBelow);\r\nregisterEditorAction(InsertCursorAtEndOfEachLineSelected);\r\nregisterEditorAction(AddSelectionToNextFindMatchAction);\r\nregisterEditorAction(AddSelectionToPreviousFindMatchAction);\r\nregisterEditorAction(MoveSelectionToNextFindMatchAction);\r\nregisterEditorAction(MoveSelectionToPreviousFindMatchAction);\r\nregisterEditorAction(SelectHighlightsAction);\r\nregisterEditorAction(CompatChangeAll);\r\nregisterEditorAction(InsertCursorAtEndOfLineSelected);\r\nregisterEditorAction(InsertCursorAtTopOfLineSelected);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { first } from '../../../base/common/async.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nexport var Context = {\r\n    Visible: new RawContextKey('parameterHintsVisible', false),\r\n    MultipleSignatures: new RawContextKey('parameterHintsMultipleSignatures', false),\r\n};\r\nexport function provideSignatureHelp(model, position, context, token) {\r\n    var supports = modes.SignatureHelpProviderRegistry.ordered(model);\r\n    return first(supports.map(function (support) { return function () {\r\n        return Promise.resolve(support.provideSignatureHelp(model, position, token, context))\r\n            .catch(function (e) { return onUnexpectedExternalError(e); });\r\n    }; }));\r\n}\r\nregisterDefaultLanguageCommand('_executeSignatureHelpProvider', function (model, position, args) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var result;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0: return [4 /*yield*/, provideSignatureHelp(model, position, {\r\n                    triggerKind: modes.SignatureHelpTriggerKind.Invoke,\r\n                    isRetrigger: false,\r\n                    triggerCharacter: args['triggerCharacter']\r\n                }, CancellationToken.None)];\r\n            case 1:\r\n                result = _a.sent();\r\n                if (!result) {\r\n                    return [2 /*return*/, undefined];\r\n                }\r\n                setTimeout(function () { return result.dispose(); }, 0);\r\n                return [2 /*return*/, result.value];\r\n        }\r\n    });\r\n}); });\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { createCancelablePromise, Delayer } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { provideSignatureHelp } from './provideSignatureHelp.js';\r\nvar ParameterHintState;\r\n(function (ParameterHintState) {\r\n    ParameterHintState.Default = { type: 0 /* Default */ };\r\n    var Pending = /** @class */ (function () {\r\n        function Pending(request) {\r\n            this.request = request;\r\n            this.type = 2 /* Pending */;\r\n        }\r\n        return Pending;\r\n    }());\r\n    ParameterHintState.Pending = Pending;\r\n    var Active = /** @class */ (function () {\r\n        function Active(hints) {\r\n            this.hints = hints;\r\n            this.type = 1 /* Active */;\r\n        }\r\n        return Active;\r\n    }());\r\n    ParameterHintState.Active = Active;\r\n})(ParameterHintState || (ParameterHintState = {}));\r\nvar ParameterHintsModel = /** @class */ (function (_super) {\r\n    __extends(ParameterHintsModel, _super);\r\n    function ParameterHintsModel(editor, delay) {\r\n        if (delay === void 0) { delay = ParameterHintsModel.DEFAULT_DELAY; }\r\n        var _this = _super.call(this) || this;\r\n        _this._onChangedHints = _this._register(new Emitter());\r\n        _this.onChangedHints = _this._onChangedHints.event;\r\n        _this.triggerOnType = false;\r\n        _this._state = ParameterHintState.Default;\r\n        _this._pendingTriggers = [];\r\n        _this._lastSignatureHelpResult = _this._register(new MutableDisposable());\r\n        _this.triggerChars = new CharacterSet();\r\n        _this.retriggerChars = new CharacterSet();\r\n        _this.triggerId = 0;\r\n        _this.editor = editor;\r\n        _this.throttledDelayer = new Delayer(delay);\r\n        _this._register(_this.editor.onDidChangeConfiguration(function () { return _this.onEditorConfigurationChange(); }));\r\n        _this._register(_this.editor.onDidChangeModel(function (e) { return _this.onModelChanged(); }));\r\n        _this._register(_this.editor.onDidChangeModelLanguage(function (_) { return _this.onModelChanged(); }));\r\n        _this._register(_this.editor.onDidChangeCursorSelection(function (e) { return _this.onCursorChange(e); }));\r\n        _this._register(_this.editor.onDidChangeModelContent(function (e) { return _this.onModelContentChange(); }));\r\n        _this._register(modes.SignatureHelpProviderRegistry.onDidChange(_this.onModelChanged, _this));\r\n        _this._register(_this.editor.onDidType(function (text) { return _this.onDidType(text); }));\r\n        _this.onEditorConfigurationChange();\r\n        _this.onModelChanged();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ParameterHintsModel.prototype, \"state\", {\r\n        get: function () { return this._state; },\r\n        set: function (value) {\r\n            if (this._state.type === 2 /* Pending */) {\r\n                this._state.request.cancel();\r\n            }\r\n            this._state = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ParameterHintsModel.prototype.cancel = function (silent) {\r\n        if (silent === void 0) { silent = false; }\r\n        this.state = ParameterHintState.Default;\r\n        this.throttledDelayer.cancel();\r\n        if (!silent) {\r\n            this._onChangedHints.fire(undefined);\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.trigger = function (context, delay) {\r\n        var _this = this;\r\n        var model = this.editor.getModel();\r\n        if (!model || !modes.SignatureHelpProviderRegistry.has(model)) {\r\n            return;\r\n        }\r\n        var triggerId = ++this.triggerId;\r\n        this._pendingTriggers.push(context);\r\n        this.throttledDelayer.trigger(function () {\r\n            return _this.doTrigger(triggerId);\r\n        }, delay)\r\n            .catch(onUnexpectedError);\r\n    };\r\n    ParameterHintsModel.prototype.next = function () {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        var length = this.state.hints.signatures.length;\r\n        var activeSignature = this.state.hints.activeSignature;\r\n        var last = (activeSignature % length) === (length - 1);\r\n        var cycle = this.editor.getOption(62 /* parameterHints */).cycle;\r\n        // If there is only one signature, or we're on last signature of list\r\n        if ((length < 2 || last) && !cycle) {\r\n            this.cancel();\r\n            return;\r\n        }\r\n        this.updateActiveSignature(last && cycle ? 0 : activeSignature + 1);\r\n    };\r\n    ParameterHintsModel.prototype.previous = function () {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        var length = this.state.hints.signatures.length;\r\n        var activeSignature = this.state.hints.activeSignature;\r\n        var first = activeSignature === 0;\r\n        var cycle = this.editor.getOption(62 /* parameterHints */).cycle;\r\n        // If there is only one signature, or we're on first signature of list\r\n        if ((length < 2 || first) && !cycle) {\r\n            this.cancel();\r\n            return;\r\n        }\r\n        this.updateActiveSignature(first && cycle ? length - 1 : activeSignature - 1);\r\n    };\r\n    ParameterHintsModel.prototype.updateActiveSignature = function (activeSignature) {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        this.state = new ParameterHintState.Active(__assign(__assign({}, this.state.hints), { activeSignature: activeSignature }));\r\n        this._onChangedHints.fire(this.state.hints);\r\n    };\r\n    ParameterHintsModel.prototype.doTrigger = function (triggerId) {\r\n        var _a, _b;\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var isRetrigger, activeSignatureHelp, context, triggerContext, model, position, result, error_1;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        isRetrigger = this.state.type === 1 /* Active */ || this.state.type === 2 /* Pending */;\r\n                        activeSignatureHelp = this.state.type === 1 /* Active */ ? this.state.hints : undefined;\r\n                        this.cancel(true);\r\n                        if (this._pendingTriggers.length === 0) {\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        context = this._pendingTriggers.reduce(mergeTriggerContexts);\r\n                        this._pendingTriggers = [];\r\n                        triggerContext = {\r\n                            triggerKind: context.triggerKind,\r\n                            triggerCharacter: context.triggerCharacter,\r\n                            isRetrigger: isRetrigger,\r\n                            activeSignatureHelp: activeSignatureHelp\r\n                        };\r\n                        if (!this.editor.hasModel()) {\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        model = this.editor.getModel();\r\n                        position = this.editor.getPosition();\r\n                        this.state = new ParameterHintState.Pending(createCancelablePromise(function (token) {\r\n                            return provideSignatureHelp(model, position, triggerContext, token);\r\n                        }));\r\n                        _c.label = 1;\r\n                    case 1:\r\n                        _c.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, this.state.request];\r\n                    case 2:\r\n                        result = _c.sent();\r\n                        // Check that we are still resolving the correct signature help\r\n                        if (triggerId !== this.triggerId) {\r\n                            (_a = result) === null || _a === void 0 ? void 0 : _a.dispose();\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        if (!result || !result.value.signatures || result.value.signatures.length === 0) {\r\n                            (_b = result) === null || _b === void 0 ? void 0 : _b.dispose();\r\n                            this._lastSignatureHelpResult.clear();\r\n                            this.cancel();\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        else {\r\n                            this.state = new ParameterHintState.Active(result.value);\r\n                            this._lastSignatureHelpResult.value = result;\r\n                            this._onChangedHints.fire(this.state.hints);\r\n                            return [2 /*return*/, true];\r\n                        }\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        error_1 = _c.sent();\r\n                        if (triggerId === this.triggerId) {\r\n                            this.state = ParameterHintState.Default;\r\n                        }\r\n                        onUnexpectedError(error_1);\r\n                        return [2 /*return*/, false];\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Object.defineProperty(ParameterHintsModel.prototype, \"isTriggered\", {\r\n        get: function () {\r\n            return this.state.type === 1 /* Active */\r\n                || this.state.type === 2 /* Pending */\r\n                || this.throttledDelayer.isTriggered();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ParameterHintsModel.prototype.onModelChanged = function () {\r\n        this.cancel();\r\n        // Update trigger characters\r\n        this.triggerChars = new CharacterSet();\r\n        this.retriggerChars = new CharacterSet();\r\n        var model = this.editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = modes.SignatureHelpProviderRegistry.ordered(model); _i < _a.length; _i++) {\r\n            var support = _a[_i];\r\n            for (var _b = 0, _c = support.signatureHelpTriggerCharacters || []; _b < _c.length; _b++) {\r\n                var ch = _c[_b];\r\n                this.triggerChars.add(ch.charCodeAt(0));\r\n                // All trigger characters are also considered retrigger characters\r\n                this.retriggerChars.add(ch.charCodeAt(0));\r\n            }\r\n            for (var _d = 0, _e = support.signatureHelpRetriggerCharacters || []; _d < _e.length; _d++) {\r\n                var ch = _e[_d];\r\n                this.retriggerChars.add(ch.charCodeAt(0));\r\n            }\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onDidType = function (text) {\r\n        if (!this.triggerOnType) {\r\n            return;\r\n        }\r\n        var lastCharIndex = text.length - 1;\r\n        var triggerCharCode = text.charCodeAt(lastCharIndex);\r\n        if (this.triggerChars.has(triggerCharCode) || this.isTriggered && this.retriggerChars.has(triggerCharCode)) {\r\n            this.trigger({\r\n                triggerKind: modes.SignatureHelpTriggerKind.TriggerCharacter,\r\n                triggerCharacter: text.charAt(lastCharIndex),\r\n            });\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onCursorChange = function (e) {\r\n        if (e.source === 'mouse') {\r\n            this.cancel();\r\n        }\r\n        else if (this.isTriggered) {\r\n            this.trigger({ triggerKind: modes.SignatureHelpTriggerKind.ContentChange });\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onModelContentChange = function () {\r\n        if (this.isTriggered) {\r\n            this.trigger({ triggerKind: modes.SignatureHelpTriggerKind.ContentChange });\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onEditorConfigurationChange = function () {\r\n        this.triggerOnType = this.editor.getOption(62 /* parameterHints */).enabled;\r\n        if (!this.triggerOnType) {\r\n            this.cancel();\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.dispose = function () {\r\n        this.cancel(true);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ParameterHintsModel.DEFAULT_DELAY = 120; // ms\r\n    return ParameterHintsModel;\r\n}(Disposable));\r\nexport { ParameterHintsModel };\r\nfunction mergeTriggerContexts(previous, current) {\r\n    switch (current.triggerKind) {\r\n        case modes.SignatureHelpTriggerKind.Invoke:\r\n            // Invoke overrides previous triggers.\r\n            return current;\r\n        case modes.SignatureHelpTriggerKind.ContentChange:\r\n            // Ignore content changes triggers\r\n            return previous;\r\n        case modes.SignatureHelpTriggerKind.TriggerCharacter:\r\n        default:\r\n            return current;\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { domEvent, stop } from '../../../base/browser/event.js';\r\nimport * as aria from '../../../base/browser/ui/aria/aria.js';\r\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { Event } from '../../../base/common/event.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport './parameterHints.css';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { MarkdownRenderer } from '../markdown/markdownRenderer.js';\r\nimport { Context } from './provideSignatureHelp.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorHoverBackground, editorHoverBorder, textCodeBlockBackground, textLinkForeground, editorHoverForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { HIGH_CONTRAST, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { ParameterHintsModel } from './parameterHintsModel.js';\r\nimport { pad } from '../../../base/common/strings.js';\r\nvar $ = dom.$;\r\nvar ParameterHintsWidget = /** @class */ (function (_super) {\r\n    __extends(ParameterHintsWidget, _super);\r\n    function ParameterHintsWidget(editor, contextKeyService, openerService, modeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this.renderDisposeables = _this._register(new DisposableStore());\r\n        _this.visible = false;\r\n        _this.announcedLabel = null;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        _this.allowEditorOverflow = true;\r\n        _this.markdownRenderer = _this._register(new MarkdownRenderer(editor, modeService, openerService));\r\n        _this.model = _this._register(new ParameterHintsModel(editor));\r\n        _this.keyVisible = Context.Visible.bindTo(contextKeyService);\r\n        _this.keyMultipleSignatures = Context.MultipleSignatures.bindTo(contextKeyService);\r\n        _this._register(_this.model.onChangedHints(function (newParameterHints) {\r\n            if (newParameterHints) {\r\n                _this.show();\r\n                _this.render(newParameterHints);\r\n            }\r\n            else {\r\n                _this.hide();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    ParameterHintsWidget.prototype.createParamaterHintDOMNodes = function () {\r\n        var _this = this;\r\n        var element = $('.editor-widget.parameter-hints-widget');\r\n        var wrapper = dom.append(element, $('.wrapper'));\r\n        wrapper.tabIndex = -1;\r\n        var controls = dom.append(wrapper, $('.controls'));\r\n        var previous = dom.append(controls, $('.button.previous'));\r\n        var overloads = dom.append(controls, $('.overloads'));\r\n        var next = dom.append(controls, $('.button.next'));\r\n        var onPreviousClick = stop(domEvent(previous, 'click'));\r\n        this._register(onPreviousClick(this.previous, this));\r\n        var onNextClick = stop(domEvent(next, 'click'));\r\n        this._register(onNextClick(this.next, this));\r\n        var body = $('.body');\r\n        var scrollbar = new DomScrollableElement(body, {});\r\n        this._register(scrollbar);\r\n        wrapper.appendChild(scrollbar.getDomNode());\r\n        var signature = dom.append(body, $('.signature'));\r\n        var docs = dom.append(body, $('.docs'));\r\n        element.style.userSelect = 'text';\r\n        this.domNodes = {\r\n            element: element,\r\n            signature: signature,\r\n            overloads: overloads,\r\n            docs: docs,\r\n            scrollbar: scrollbar,\r\n        };\r\n        this.editor.addContentWidget(this);\r\n        this.hide();\r\n        this._register(this.editor.onDidChangeCursorSelection(function (e) {\r\n            if (_this.visible) {\r\n                _this.editor.layoutContentWidget(_this);\r\n            }\r\n        }));\r\n        var updateFont = function () {\r\n            if (!_this.domNodes) {\r\n                return;\r\n            }\r\n            var fontInfo = _this.editor.getOption(32 /* fontInfo */);\r\n            _this.domNodes.element.style.fontSize = fontInfo.fontSize + \"px\";\r\n        };\r\n        updateFont();\r\n        this._register(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\r\n            .filter(function (e) { return e.hasChanged(32 /* fontInfo */); })\r\n            .on(updateFont, null));\r\n        this._register(this.editor.onDidLayoutChange(function (e) { return _this.updateMaxHeight(); }));\r\n        this.updateMaxHeight();\r\n    };\r\n    ParameterHintsWidget.prototype.show = function () {\r\n        var _this = this;\r\n        if (this.visible) {\r\n            return;\r\n        }\r\n        if (!this.domNodes) {\r\n            this.createParamaterHintDOMNodes();\r\n        }\r\n        this.keyVisible.set(true);\r\n        this.visible = true;\r\n        setTimeout(function () {\r\n            if (_this.domNodes) {\r\n                dom.addClass(_this.domNodes.element, 'visible');\r\n            }\r\n        }, 100);\r\n        this.editor.layoutContentWidget(this);\r\n    };\r\n    ParameterHintsWidget.prototype.hide = function () {\r\n        if (!this.visible) {\r\n            return;\r\n        }\r\n        this.keyVisible.reset();\r\n        this.visible = false;\r\n        this.announcedLabel = null;\r\n        if (this.domNodes) {\r\n            dom.removeClass(this.domNodes.element, 'visible');\r\n        }\r\n        this.editor.layoutContentWidget(this);\r\n    };\r\n    ParameterHintsWidget.prototype.getPosition = function () {\r\n        if (this.visible) {\r\n            return {\r\n                position: this.editor.getPosition(),\r\n                preference: [1 /* ABOVE */, 2 /* BELOW */]\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    ParameterHintsWidget.prototype.render = function (hints) {\r\n        if (!this.domNodes) {\r\n            return;\r\n        }\r\n        var multiple = hints.signatures.length > 1;\r\n        dom.toggleClass(this.domNodes.element, 'multiple', multiple);\r\n        this.keyMultipleSignatures.set(multiple);\r\n        this.domNodes.signature.innerHTML = '';\r\n        this.domNodes.docs.innerHTML = '';\r\n        var signature = hints.signatures[hints.activeSignature];\r\n        if (!signature) {\r\n            return;\r\n        }\r\n        var code = dom.append(this.domNodes.signature, $('.code'));\r\n        var hasParameters = signature.parameters.length > 0;\r\n        var fontInfo = this.editor.getOption(32 /* fontInfo */);\r\n        code.style.fontSize = fontInfo.fontSize + \"px\";\r\n        code.style.fontFamily = fontInfo.fontFamily;\r\n        if (!hasParameters) {\r\n            var label = dom.append(code, $('span'));\r\n            label.textContent = signature.label;\r\n        }\r\n        else {\r\n            this.renderParameters(code, signature, hints.activeParameter);\r\n        }\r\n        this.renderDisposeables.clear();\r\n        var activeParameter = signature.parameters[hints.activeParameter];\r\n        if (activeParameter && activeParameter.documentation) {\r\n            var documentation = $('span.documentation');\r\n            if (typeof activeParameter.documentation === 'string') {\r\n                documentation.textContent = activeParameter.documentation;\r\n            }\r\n            else {\r\n                var renderedContents = this.markdownRenderer.render(activeParameter.documentation);\r\n                dom.addClass(renderedContents.element, 'markdown-docs');\r\n                this.renderDisposeables.add(renderedContents);\r\n                documentation.appendChild(renderedContents.element);\r\n            }\r\n            dom.append(this.domNodes.docs, $('p', {}, documentation));\r\n        }\r\n        if (signature.documentation === undefined) { /** no op */ }\r\n        else if (typeof signature.documentation === 'string') {\r\n            dom.append(this.domNodes.docs, $('p', {}, signature.documentation));\r\n        }\r\n        else {\r\n            var renderedContents = this.markdownRenderer.render(signature.documentation);\r\n            dom.addClass(renderedContents.element, 'markdown-docs');\r\n            this.renderDisposeables.add(renderedContents);\r\n            dom.append(this.domNodes.docs, renderedContents.element);\r\n        }\r\n        var hasDocs = this.hasDocs(signature, activeParameter);\r\n        dom.toggleClass(this.domNodes.signature, 'has-docs', hasDocs);\r\n        dom.toggleClass(this.domNodes.docs, 'empty', !hasDocs);\r\n        this.domNodes.overloads.textContent =\r\n            pad(hints.activeSignature + 1, hints.signatures.length.toString().length) + '/' + hints.signatures.length;\r\n        if (activeParameter) {\r\n            var labelToAnnounce = this.getParameterLabel(signature, hints.activeParameter);\r\n            // Select method gets called on every user type while parameter hints are visible.\r\n            // We do not want to spam the user with same announcements, so we only announce if the current parameter changed.\r\n            if (this.announcedLabel !== labelToAnnounce) {\r\n                aria.alert(nls.localize('hint', \"{0}, hint\", labelToAnnounce));\r\n                this.announcedLabel = labelToAnnounce;\r\n            }\r\n        }\r\n        this.editor.layoutContentWidget(this);\r\n        this.domNodes.scrollbar.scanDomNode();\r\n    };\r\n    ParameterHintsWidget.prototype.hasDocs = function (signature, activeParameter) {\r\n        if (activeParameter && typeof (activeParameter.documentation) === 'string' && activeParameter.documentation.length > 0) {\r\n            return true;\r\n        }\r\n        if (activeParameter && typeof (activeParameter.documentation) === 'object' && activeParameter.documentation.value.length > 0) {\r\n            return true;\r\n        }\r\n        if (typeof (signature.documentation) === 'string' && signature.documentation.length > 0) {\r\n            return true;\r\n        }\r\n        if (typeof (signature.documentation) === 'object' && signature.documentation.value.length > 0) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ParameterHintsWidget.prototype.renderParameters = function (parent, signature, currentParameter) {\r\n        var _a = this.getParameterLabelOffsets(signature, currentParameter), start = _a[0], end = _a[1];\r\n        var beforeSpan = document.createElement('span');\r\n        beforeSpan.textContent = signature.label.substring(0, start);\r\n        var paramSpan = document.createElement('span');\r\n        paramSpan.textContent = signature.label.substring(start, end);\r\n        paramSpan.className = 'parameter active';\r\n        var afterSpan = document.createElement('span');\r\n        afterSpan.textContent = signature.label.substring(end);\r\n        dom.append(parent, beforeSpan, paramSpan, afterSpan);\r\n    };\r\n    ParameterHintsWidget.prototype.getParameterLabel = function (signature, paramIdx) {\r\n        var param = signature.parameters[paramIdx];\r\n        if (typeof param.label === 'string') {\r\n            return param.label;\r\n        }\r\n        else {\r\n            return signature.label.substring(param.label[0], param.label[1]);\r\n        }\r\n    };\r\n    ParameterHintsWidget.prototype.getParameterLabelOffsets = function (signature, paramIdx) {\r\n        var param = signature.parameters[paramIdx];\r\n        if (!param) {\r\n            return [0, 0];\r\n        }\r\n        else if (Array.isArray(param.label)) {\r\n            return param.label;\r\n        }\r\n        else {\r\n            var idx = signature.label.lastIndexOf(param.label);\r\n            return idx >= 0\r\n                ? [idx, idx + param.label.length]\r\n                : [0, 0];\r\n        }\r\n    };\r\n    ParameterHintsWidget.prototype.next = function () {\r\n        this.editor.focus();\r\n        this.model.next();\r\n    };\r\n    ParameterHintsWidget.prototype.previous = function () {\r\n        this.editor.focus();\r\n        this.model.previous();\r\n    };\r\n    ParameterHintsWidget.prototype.cancel = function () {\r\n        this.model.cancel();\r\n    };\r\n    ParameterHintsWidget.prototype.getDomNode = function () {\r\n        if (!this.domNodes) {\r\n            this.createParamaterHintDOMNodes();\r\n        }\r\n        return this.domNodes.element;\r\n    };\r\n    ParameterHintsWidget.prototype.getId = function () {\r\n        return ParameterHintsWidget.ID;\r\n    };\r\n    ParameterHintsWidget.prototype.trigger = function (context) {\r\n        this.model.trigger(context, 0);\r\n    };\r\n    ParameterHintsWidget.prototype.updateMaxHeight = function () {\r\n        if (!this.domNodes) {\r\n            return;\r\n        }\r\n        var height = Math.max(this.editor.getLayoutInfo().height / 4, 250);\r\n        var maxHeight = height + \"px\";\r\n        this.domNodes.element.style.maxHeight = maxHeight;\r\n        var wrapper = this.domNodes.element.getElementsByClassName('wrapper');\r\n        if (wrapper.length) {\r\n            wrapper[0].style.maxHeight = maxHeight;\r\n        }\r\n    };\r\n    ParameterHintsWidget.ID = 'editor.widget.parameterHintsWidget';\r\n    ParameterHintsWidget = __decorate([\r\n        __param(1, IContextKeyService),\r\n        __param(2, IOpenerService),\r\n        __param(3, IModeService)\r\n    ], ParameterHintsWidget);\r\n    return ParameterHintsWidget;\r\n}(Disposable));\r\nexport { ParameterHintsWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(editorHoverBorder);\r\n    if (border) {\r\n        var borderWidth = theme.type === HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget { border: \" + borderWidth + \"px solid \" + border + \"; }\");\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid \" + border.transparent(0.5) + \"; }\");\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid \" + border.transparent(0.5) + \"; }\");\r\n    }\r\n    var background = theme.getColor(editorHoverBackground);\r\n    if (background) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget { background-color: \" + background + \"; }\");\r\n    }\r\n    var link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget a { color: \" + link + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(editorHoverForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget { color: \" + foreground + \"; }\");\r\n    }\r\n    var codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget code { background-color: \" + codeBackground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { ParameterHintsWidget } from './parameterHintsWidget.js';\r\nimport { Context } from './provideSignatureHelp.js';\r\nimport * as modes from '../../common/modes.js';\r\nvar ParameterHintsController = /** @class */ (function (_super) {\r\n    __extends(ParameterHintsController, _super);\r\n    function ParameterHintsController(editor, instantiationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this.widget = _this._register(instantiationService.createInstance(ParameterHintsWidget, _this.editor));\r\n        return _this;\r\n    }\r\n    ParameterHintsController.get = function (editor) {\r\n        return editor.getContribution(ParameterHintsController.ID);\r\n    };\r\n    ParameterHintsController.prototype.cancel = function () {\r\n        this.widget.cancel();\r\n    };\r\n    ParameterHintsController.prototype.previous = function () {\r\n        this.widget.previous();\r\n    };\r\n    ParameterHintsController.prototype.next = function () {\r\n        this.widget.next();\r\n    };\r\n    ParameterHintsController.prototype.trigger = function (context) {\r\n        this.widget.trigger(context);\r\n    };\r\n    ParameterHintsController.ID = 'editor.controller.parameterHints';\r\n    ParameterHintsController = __decorate([\r\n        __param(1, IInstantiationService)\r\n    ], ParameterHintsController);\r\n    return ParameterHintsController;\r\n}(Disposable));\r\nvar TriggerParameterHintsAction = /** @class */ (function (_super) {\r\n    __extends(TriggerParameterHintsAction, _super);\r\n    function TriggerParameterHintsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.triggerParameterHints',\r\n            label: nls.localize('parameterHints.trigger.label', \"Trigger Parameter Hints\"),\r\n            alias: 'Trigger Parameter Hints',\r\n            precondition: EditorContextKeys.hasSignatureHelpProvider,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 10 /* Space */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TriggerParameterHintsAction.prototype.run = function (accessor, editor) {\r\n        var controller = ParameterHintsController.get(editor);\r\n        if (controller) {\r\n            controller.trigger({\r\n                triggerKind: modes.SignatureHelpTriggerKind.Invoke\r\n            });\r\n        }\r\n    };\r\n    return TriggerParameterHintsAction;\r\n}(EditorAction));\r\nexport { TriggerParameterHintsAction };\r\nregisterEditorContribution(ParameterHintsController.ID, ParameterHintsController);\r\nregisterEditorAction(TriggerParameterHintsAction);\r\nvar weight = 100 /* EditorContrib */ + 75;\r\nvar ParameterHintsCommand = EditorCommand.bindToContribution(ParameterHintsController.get);\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'closeParameterHints',\r\n    precondition: Context.Visible,\r\n    handler: function (x) { return x.cancel(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'showPrevParameterHint',\r\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\r\n    handler: function (x) { return x.previous(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 16 /* UpArrow */,\r\n        secondary: [512 /* Alt */ | 16 /* UpArrow */],\r\n        mac: { primary: 16 /* UpArrow */, secondary: [512 /* Alt */ | 16 /* UpArrow */, 256 /* WinCtrl */ | 46 /* KEY_P */] }\r\n    }\r\n}));\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'showNextParameterHint',\r\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\r\n    handler: function (x) { return x.next(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 18 /* DownArrow */,\r\n        secondary: [512 /* Alt */ | 18 /* DownArrow */],\r\n        mac: { primary: 18 /* DownArrow */, secondary: [512 /* Alt */ | 18 /* DownArrow */, 256 /* WinCtrl */ | 44 /* KEY_N */] }\r\n    }\r\n}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './renameInputField.css';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { inputBackground, inputBorder, inputForeground, widgetShadow } from '../../../platform/theme/common/colorRegistry.js';\r\nexport var CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false);\r\nvar RenameInputField = /** @class */ (function () {\r\n    function RenameInputField(editor, themeService, contextKeyService) {\r\n        var _this = this;\r\n        this.themeService = themeService;\r\n        this._disposables = new DisposableStore();\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = true;\r\n        this._currentAcceptInput = null;\r\n        this._currentCancelInput = null;\r\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\r\n        this._editor = editor;\r\n        this._editor.addContentWidget(this);\r\n        this._disposables.add(editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(32 /* fontInfo */)) {\r\n                _this.updateFont();\r\n            }\r\n        }));\r\n        this._disposables.add(themeService.onThemeChange(function (theme) { return _this.onThemeChange(theme); }));\r\n    }\r\n    RenameInputField.prototype.onThemeChange = function (theme) {\r\n        this.updateStyles(theme);\r\n    };\r\n    RenameInputField.prototype.dispose = function () {\r\n        this._disposables.dispose();\r\n        this._editor.removeContentWidget(this);\r\n    };\r\n    RenameInputField.prototype.getId = function () {\r\n        return '__renameInputWidget';\r\n    };\r\n    RenameInputField.prototype.getDomNode = function () {\r\n        if (!this._domNode) {\r\n            this._inputField = document.createElement('input');\r\n            this._inputField.className = 'rename-input';\r\n            this._inputField.type = 'text';\r\n            this._inputField.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\r\n            this._domNode = document.createElement('div');\r\n            this._domNode.style.height = this._editor.getOption(47 /* lineHeight */) + \"px\";\r\n            this._domNode.className = 'monaco-editor rename-box';\r\n            this._domNode.appendChild(this._inputField);\r\n            this.updateFont();\r\n            this.updateStyles(this.themeService.getTheme());\r\n        }\r\n        return this._domNode;\r\n    };\r\n    RenameInputField.prototype.updateStyles = function (theme) {\r\n        if (!this._inputField) {\r\n            return;\r\n        }\r\n        var background = theme.getColor(inputBackground);\r\n        var foreground = theme.getColor(inputForeground);\r\n        var widgetShadowColor = theme.getColor(widgetShadow);\r\n        var border = theme.getColor(inputBorder);\r\n        this._inputField.style.backgroundColor = background ? background.toString() : '';\r\n        this._inputField.style.color = foreground ? foreground.toString() : null;\r\n        this._inputField.style.borderWidth = border ? '1px' : '0px';\r\n        this._inputField.style.borderStyle = border ? 'solid' : 'none';\r\n        this._inputField.style.borderColor = border ? border.toString() : 'none';\r\n        this._domNode.style.boxShadow = widgetShadowColor ? \" 0 2px 8px \" + widgetShadowColor : '';\r\n    };\r\n    RenameInputField.prototype.updateFont = function () {\r\n        if (!this._inputField) {\r\n            return;\r\n        }\r\n        var fontInfo = this._editor.getOption(32 /* fontInfo */);\r\n        this._inputField.style.fontFamily = fontInfo.fontFamily;\r\n        this._inputField.style.fontWeight = fontInfo.fontWeight;\r\n        this._inputField.style.fontSize = fontInfo.fontSize + \"px\";\r\n    };\r\n    RenameInputField.prototype.getPosition = function () {\r\n        return this._visible\r\n            ? { position: this._position, preference: [2 /* BELOW */, 1 /* ABOVE */] }\r\n            : null;\r\n    };\r\n    RenameInputField.prototype.acceptInput = function () {\r\n        if (this._currentAcceptInput) {\r\n            this._currentAcceptInput();\r\n        }\r\n    };\r\n    RenameInputField.prototype.cancelInput = function (focusEditor) {\r\n        if (this._currentCancelInput) {\r\n            this._currentCancelInput(focusEditor);\r\n        }\r\n    };\r\n    RenameInputField.prototype.getInput = function (where, value, selectionStart, selectionEnd) {\r\n        var _this = this;\r\n        this._position = new Position(where.startLineNumber, where.startColumn);\r\n        this._inputField.value = value;\r\n        this._inputField.setAttribute('selectionStart', selectionStart.toString());\r\n        this._inputField.setAttribute('selectionEnd', selectionEnd.toString());\r\n        this._inputField.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20);\r\n        var disposeOnDone = new DisposableStore();\r\n        var always = function () {\r\n            disposeOnDone.dispose();\r\n            _this._hide();\r\n        };\r\n        return new Promise(function (resolve) {\r\n            _this._currentCancelInput = function (focusEditor) {\r\n                _this._currentAcceptInput = null;\r\n                _this._currentCancelInput = null;\r\n                resolve(focusEditor);\r\n                return true;\r\n            };\r\n            _this._currentAcceptInput = function () {\r\n                if (_this._inputField.value.trim().length === 0 || _this._inputField.value === value) {\r\n                    // empty or whitespace only or not changed\r\n                    _this.cancelInput(true);\r\n                    return;\r\n                }\r\n                _this._currentAcceptInput = null;\r\n                _this._currentCancelInput = null;\r\n                resolve(_this._inputField.value);\r\n            };\r\n            var onCursorChanged = function () {\r\n                var editorPosition = _this._editor.getPosition();\r\n                if (!editorPosition || !Range.containsPosition(where, editorPosition)) {\r\n                    _this.cancelInput(true);\r\n                }\r\n            };\r\n            disposeOnDone.add(_this._editor.onDidChangeCursorSelection(onCursorChanged));\r\n            disposeOnDone.add(_this._editor.onDidBlurEditorWidget(function () { return _this.cancelInput(false); }));\r\n            _this._show();\r\n        }).then(function (newValue) {\r\n            always();\r\n            return newValue;\r\n        }, function (err) {\r\n            always();\r\n            return Promise.reject(err);\r\n        });\r\n    };\r\n    RenameInputField.prototype._show = function () {\r\n        var _this = this;\r\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* Smooth */);\r\n        this._visible = true;\r\n        this._visibleContextKey.set(true);\r\n        this._editor.layoutContentWidget(this);\r\n        setTimeout(function () {\r\n            _this._inputField.focus();\r\n            _this._inputField.setSelectionRange(parseInt(_this._inputField.getAttribute('selectionStart')), parseInt(_this._inputField.getAttribute('selectionEnd')));\r\n        }, 100);\r\n    };\r\n    RenameInputField.prototype._hide = function () {\r\n        this._visible = false;\r\n        this._visibleContextKey.reset();\r\n        this._editor.layoutContentWidget(this);\r\n    };\r\n    return RenameInputField;\r\n}());\r\nexport { RenameInputField };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { illegalArgument, onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { IContextKeyService, ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand, registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { RenameInputField, CONTEXT_RENAME_INPUT_VISIBLE } from './renameInputField.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { RenameProviderRegistry } from '../../common/modes.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { EditorStateCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IBulkEditService } from '../../browser/services/bulkEditService.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { CancellationToken, CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { IdleValue, raceCancellation } from '../../../base/common/async.js';\r\nimport { withNullAsUndefined } from '../../../base/common/types.js';\r\nvar RenameSkeleton = /** @class */ (function () {\r\n    function RenameSkeleton(model, position) {\r\n        this.model = model;\r\n        this.position = position;\r\n        this._providers = RenameProviderRegistry.ordered(model);\r\n    }\r\n    RenameSkeleton.prototype.hasProvider = function () {\r\n        return this._providers.length > 0;\r\n    };\r\n    RenameSkeleton.prototype.resolveRenameLocation = function (token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var firstProvider, res, _a, word;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        firstProvider = this._providers[0];\r\n                        if (!firstProvider) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (!firstProvider.resolveRenameLocation) return [3 /*break*/, 2];\r\n                        _a = withNullAsUndefined;\r\n                        return [4 /*yield*/, firstProvider.resolveRenameLocation(this.model, this.position, token)];\r\n                    case 1:\r\n                        res = _a.apply(void 0, [_b.sent()]);\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        if (!res) {\r\n                            word = this.model.getWordAtPosition(this.position);\r\n                            if (word) {\r\n                                return [2 /*return*/, {\r\n                                        range: new Range(this.position.lineNumber, word.startColumn, this.position.lineNumber, word.endColumn),\r\n                                        text: word.word\r\n                                    }];\r\n                            }\r\n                        }\r\n                        return [2 /*return*/, res];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RenameSkeleton.prototype.provideRenameEdits = function (newName, i, rejects, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var provider, result;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        provider = this._providers[i];\r\n                        if (!provider) {\r\n                            return [2 /*return*/, {\r\n                                    edits: [],\r\n                                    rejectReason: rejects.join('\\n')\r\n                                }];\r\n                        }\r\n                        return [4 /*yield*/, provider.provideRenameEdits(this.model, this.position, newName, token)];\r\n                    case 1:\r\n                        result = _a.sent();\r\n                        if (!result) {\r\n                            return [2 /*return*/, this.provideRenameEdits(newName, i + 1, rejects.concat(nls.localize('no result', \"No result.\")), token)];\r\n                        }\r\n                        else if (result.rejectReason) {\r\n                            return [2 /*return*/, this.provideRenameEdits(newName, i + 1, rejects.concat(result.rejectReason), token)];\r\n                        }\r\n                        return [2 /*return*/, result];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return RenameSkeleton;\r\n}());\r\nexport function rename(model, position, newName) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            return [2 /*return*/, new RenameSkeleton(model, position).provideRenameEdits(newName, 0, [], CancellationToken.None)];\r\n        });\r\n    });\r\n}\r\n// ---  register actions and commands\r\nvar RenameController = /** @class */ (function () {\r\n    function RenameController(editor, _notificationService, _bulkEditService, _progressService, _contextKeyService, _themeService) {\r\n        var _this = this;\r\n        this.editor = editor;\r\n        this._notificationService = _notificationService;\r\n        this._bulkEditService = _bulkEditService;\r\n        this._progressService = _progressService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._themeService = _themeService;\r\n        this._dispoableStore = new DisposableStore();\r\n        this._cts = new CancellationTokenSource();\r\n        this._renameInputField = new IdleValue(function () { return _this._dispoableStore.add(new RenameInputField(_this.editor, _this._themeService, _this._contextKeyService)); });\r\n    }\r\n    RenameController.get = function (editor) {\r\n        return editor.getContribution(RenameController.ID);\r\n    };\r\n    RenameController.prototype.dispose = function () {\r\n        this._dispoableStore.dispose();\r\n        this._cts.dispose(true);\r\n    };\r\n    RenameController.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var position, skeleton, loc, resolveLocationOperation, e_1, selection, selectionStart, selectionEnd, newNameOrFocusFlag, renameOperation;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this._cts.dispose(true);\r\n                        if (!this.editor.hasModel()) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        position = this.editor.getPosition();\r\n                        skeleton = new RenameSkeleton(this.editor.getModel(), position);\r\n                        if (!skeleton.hasProvider()) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        this._cts = new EditorStateCancellationTokenSource(this.editor, 4 /* Position */ | 1 /* Value */);\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        resolveLocationOperation = skeleton.resolveRenameLocation(this._cts.token);\r\n                        this._progressService.showWhile(resolveLocationOperation, 250);\r\n                        return [4 /*yield*/, resolveLocationOperation];\r\n                    case 2:\r\n                        loc = _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        e_1 = _a.sent();\r\n                        MessageController.get(this.editor).showMessage(e_1 || nls.localize('resolveRenameLocationFailed', \"An unknown error occurred while resolving rename location\"), position);\r\n                        return [2 /*return*/, undefined];\r\n                    case 4:\r\n                        if (!loc) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (loc.rejectReason) {\r\n                            MessageController.get(this.editor).showMessage(loc.rejectReason, position);\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (this._cts.token.isCancellationRequested) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        selection = this.editor.getSelection();\r\n                        selectionStart = 0;\r\n                        selectionEnd = loc.text.length;\r\n                        if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(loc.range, selection)) {\r\n                            selectionStart = Math.max(0, selection.startColumn - loc.range.startColumn);\r\n                            selectionEnd = Math.min(loc.range.endColumn, selection.endColumn) - loc.range.startColumn;\r\n                        }\r\n                        return [4 /*yield*/, this._renameInputField.getValue().getInput(loc.range, loc.text, selectionStart, selectionEnd)];\r\n                    case 5:\r\n                        newNameOrFocusFlag = _a.sent();\r\n                        if (typeof newNameOrFocusFlag === 'boolean') {\r\n                            if (newNameOrFocusFlag) {\r\n                                this.editor.focus();\r\n                            }\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        this.editor.focus();\r\n                        renameOperation = raceCancellation(skeleton.provideRenameEdits(newNameOrFocusFlag, 0, [], this._cts.token), this._cts.token).then(function (renameResult) { return __awaiter(_this, void 0, void 0, function () {\r\n                            var editResult;\r\n                            return __generator(this, function (_a) {\r\n                                switch (_a.label) {\r\n                                    case 0:\r\n                                        if (!renameResult || !this.editor.hasModel()) {\r\n                                            return [2 /*return*/];\r\n                                        }\r\n                                        if (renameResult.rejectReason) {\r\n                                            this._notificationService.info(renameResult.rejectReason);\r\n                                            return [2 /*return*/];\r\n                                        }\r\n                                        return [4 /*yield*/, this._bulkEditService.apply(renameResult, { editor: this.editor })];\r\n                                    case 1:\r\n                                        editResult = _a.sent();\r\n                                        // alert\r\n                                        if (editResult.ariaSummary) {\r\n                                            alert(nls.localize('aria', \"Successfully renamed '{0}' to '{1}'. Summary: {2}\", loc.text, newNameOrFocusFlag, editResult.ariaSummary));\r\n                                        }\r\n                                        return [2 /*return*/];\r\n                                }\r\n                            });\r\n                        }); }, function (err) {\r\n                            _this._notificationService.error(nls.localize('rename.failed', \"Rename failed to execute.\"));\r\n                            return Promise.reject(err);\r\n                        });\r\n                        this._progressService.showWhile(renameOperation, 250);\r\n                        return [2 /*return*/, renameOperation];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RenameController.prototype.acceptRenameInput = function () {\r\n        this._renameInputField.getValue().acceptInput();\r\n    };\r\n    RenameController.prototype.cancelRenameInput = function () {\r\n        this._renameInputField.getValue().cancelInput(true);\r\n    };\r\n    RenameController.ID = 'editor.contrib.renameController';\r\n    RenameController = __decorate([\r\n        __param(1, INotificationService),\r\n        __param(2, IBulkEditService),\r\n        __param(3, IEditorProgressService),\r\n        __param(4, IContextKeyService),\r\n        __param(5, IThemeService)\r\n    ], RenameController);\r\n    return RenameController;\r\n}());\r\n// ---- action implementation\r\nvar RenameAction = /** @class */ (function (_super) {\r\n    __extends(RenameAction, _super);\r\n    function RenameAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.rename',\r\n            label: nls.localize('rename.label', \"Rename Symbol\"),\r\n            alias: 'Rename Symbol',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 60 /* F2 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 1.1\r\n            }\r\n        }) || this;\r\n    }\r\n    RenameAction.prototype.runCommand = function (accessor, args) {\r\n        var _this = this;\r\n        var editorService = accessor.get(ICodeEditorService);\r\n        var _a = Array.isArray(args) && args || [undefined, undefined], uri = _a[0], pos = _a[1];\r\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\r\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(function (editor) {\r\n                if (!editor) {\r\n                    return;\r\n                }\r\n                editor.setPosition(pos);\r\n                editor.invokeWithinContext(function (accessor) {\r\n                    _this.reportTelemetry(accessor, editor);\r\n                    return _this.run(accessor, editor);\r\n                });\r\n            }, onUnexpectedError);\r\n        }\r\n        return _super.prototype.runCommand.call(this, accessor, args);\r\n    };\r\n    RenameAction.prototype.run = function (accessor, editor) {\r\n        var controller = RenameController.get(editor);\r\n        if (controller) {\r\n            return controller.run();\r\n        }\r\n        return Promise.resolve();\r\n    };\r\n    return RenameAction;\r\n}(EditorAction));\r\nexport { RenameAction };\r\nregisterEditorContribution(RenameController.ID, RenameController);\r\nregisterEditorAction(RenameAction);\r\nvar RenameCommand = EditorCommand.bindToContribution(RenameController.get);\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'acceptRenameInput',\r\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\r\n    handler: function (x) { return x.acceptRenameInput(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'cancelRenameInput',\r\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\r\n    handler: function (x) { return x.cancelRenameInput(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\n// ---- api bridge command\r\nregisterDefaultLanguageCommand('_executeDocumentRenameProvider', function (model, position, args) {\r\n    var newName = args.newName;\r\n    if (typeof newName !== 'string') {\r\n        throw illegalArgument('newName');\r\n    }\r\n    return rename(model, position, newName);\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { isUpperAsciiLetter, isLowerAsciiLetter } from '../../../base/common/strings.js';\r\nvar WordSelectionRangeProvider = /** @class */ (function () {\r\n    function WordSelectionRangeProvider() {\r\n    }\r\n    WordSelectionRangeProvider.prototype.provideSelectionRanges = function (model, positions) {\r\n        var result = [];\r\n        for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {\r\n            var position = positions_1[_i];\r\n            var bucket = [];\r\n            result.push(bucket);\r\n            this._addInWordRanges(bucket, model, position);\r\n            this._addWordRanges(bucket, model, position);\r\n            this._addWhitespaceLine(bucket, model, position);\r\n            bucket.push({ range: model.getFullModelRange() });\r\n        }\r\n        return result;\r\n    };\r\n    WordSelectionRangeProvider.prototype._addInWordRanges = function (bucket, model, pos) {\r\n        var obj = model.getWordAtPosition(pos);\r\n        if (!obj) {\r\n            return;\r\n        }\r\n        var word = obj.word, startColumn = obj.startColumn;\r\n        var offset = pos.column - startColumn;\r\n        var start = offset;\r\n        var end = offset;\r\n        var lastCh = 0;\r\n        // LEFT anchor (start)\r\n        for (; start >= 0; start--) {\r\n            var ch = word.charCodeAt(start);\r\n            if (ch === 95 /* Underline */ || ch === 45 /* Dash */) {\r\n                // foo-bar OR foo_bar\r\n                break;\r\n            }\r\n            else if (isLowerAsciiLetter(ch) && isUpperAsciiLetter(lastCh)) {\r\n                // fooBar\r\n                break;\r\n            }\r\n            lastCh = ch;\r\n        }\r\n        start += 1;\r\n        // RIGHT anchor (end)\r\n        for (; end < word.length; end++) {\r\n            var ch = word.charCodeAt(end);\r\n            if (isUpperAsciiLetter(ch) && isLowerAsciiLetter(lastCh)) {\r\n                // fooBar\r\n                break;\r\n            }\r\n            else if (ch === 95 /* Underline */ || ch === 45 /* Dash */) {\r\n                // foo-bar OR foo_bar\r\n                break;\r\n            }\r\n            lastCh = ch;\r\n        }\r\n        if (start < end) {\r\n            bucket.push({ range: new Range(pos.lineNumber, startColumn + start, pos.lineNumber, startColumn + end) });\r\n        }\r\n    };\r\n    WordSelectionRangeProvider.prototype._addWordRanges = function (bucket, model, pos) {\r\n        var word = model.getWordAtPosition(pos);\r\n        if (word) {\r\n            bucket.push({ range: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn) });\r\n        }\r\n    };\r\n    WordSelectionRangeProvider.prototype._addWhitespaceLine = function (bucket, model, pos) {\r\n        if (model.getLineLength(pos.lineNumber) > 0\r\n            && model.getLineFirstNonWhitespaceColumn(pos.lineNumber) === 0\r\n            && model.getLineLastNonWhitespaceColumn(pos.lineNumber) === 0) {\r\n            bucket.push({ range: new Range(pos.lineNumber, 1, pos.lineNumber, model.getLineMaxColumn(pos.lineNumber)) });\r\n        }\r\n    };\r\n    return WordSelectionRangeProvider;\r\n}());\r\nexport { WordSelectionRangeProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nvar BracketSelectionRangeProvider = /** @class */ (function () {\r\n    function BracketSelectionRangeProvider() {\r\n    }\r\n    BracketSelectionRangeProvider.prototype.provideSelectionRanges = function (model, positions) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var result, _loop_1, _i, positions_1, position;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        result = [];\r\n                        _loop_1 = function (position) {\r\n                            var bucket, ranges;\r\n                            return __generator(this, function (_a) {\r\n                                switch (_a.label) {\r\n                                    case 0:\r\n                                        bucket = [];\r\n                                        result.push(bucket);\r\n                                        ranges = new Map();\r\n                                        return [4 /*yield*/, new Promise(function (resolve) { return BracketSelectionRangeProvider._bracketsRightYield(resolve, 0, model, position, ranges); })];\r\n                                    case 1:\r\n                                        _a.sent();\r\n                                        return [4 /*yield*/, new Promise(function (resolve) { return BracketSelectionRangeProvider._bracketsLeftYield(resolve, 0, model, position, ranges, bucket); })];\r\n                                    case 2:\r\n                                        _a.sent();\r\n                                        return [2 /*return*/];\r\n                                }\r\n                            });\r\n                        };\r\n                        _i = 0, positions_1 = positions;\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        if (!(_i < positions_1.length)) return [3 /*break*/, 4];\r\n                        position = positions_1[_i];\r\n                        return [5 /*yield**/, _loop_1(position)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3:\r\n                        _i++;\r\n                        return [3 /*break*/, 1];\r\n                    case 4: return [2 /*return*/, result];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    BracketSelectionRangeProvider._bracketsRightYield = function (resolve, round, model, pos, ranges) {\r\n        var counts = new Map();\r\n        var t1 = Date.now();\r\n        while (true) {\r\n            if (round >= BracketSelectionRangeProvider._maxRounds) {\r\n                resolve();\r\n                break;\r\n            }\r\n            if (!pos) {\r\n                resolve();\r\n                break;\r\n            }\r\n            var bracket = model.findNextBracket(pos);\r\n            if (!bracket) {\r\n                resolve();\r\n                break;\r\n            }\r\n            var d = Date.now() - t1;\r\n            if (d > BracketSelectionRangeProvider._maxDuration) {\r\n                setTimeout(function () { return BracketSelectionRangeProvider._bracketsRightYield(resolve, round + 1, model, pos, ranges); });\r\n                break;\r\n            }\r\n            var key = bracket.close[0];\r\n            if (bracket.isOpen) {\r\n                // wait for closing\r\n                var val = counts.has(key) ? counts.get(key) : 0;\r\n                counts.set(key, val + 1);\r\n            }\r\n            else {\r\n                // process closing\r\n                var val = counts.has(key) ? counts.get(key) : 0;\r\n                val -= 1;\r\n                counts.set(key, Math.max(0, val));\r\n                if (val < 0) {\r\n                    var list = ranges.get(key);\r\n                    if (!list) {\r\n                        list = new LinkedList();\r\n                        ranges.set(key, list);\r\n                    }\r\n                    list.push(bracket.range);\r\n                }\r\n            }\r\n            pos = bracket.range.getEndPosition();\r\n        }\r\n    };\r\n    BracketSelectionRangeProvider._bracketsLeftYield = function (resolve, round, model, pos, ranges, bucket) {\r\n        var counts = new Map();\r\n        var t1 = Date.now();\r\n        while (true) {\r\n            if (round >= BracketSelectionRangeProvider._maxRounds && ranges.size === 0) {\r\n                resolve();\r\n                break;\r\n            }\r\n            if (!pos) {\r\n                resolve();\r\n                break;\r\n            }\r\n            var bracket = model.findPrevBracket(pos);\r\n            if (!bracket) {\r\n                resolve();\r\n                break;\r\n            }\r\n            var d = Date.now() - t1;\r\n            if (d > BracketSelectionRangeProvider._maxDuration) {\r\n                setTimeout(function () { return BracketSelectionRangeProvider._bracketsLeftYield(resolve, round + 1, model, pos, ranges, bucket); });\r\n                break;\r\n            }\r\n            var key = bracket.close[0];\r\n            if (!bracket.isOpen) {\r\n                // wait for opening\r\n                var val = counts.has(key) ? counts.get(key) : 0;\r\n                counts.set(key, val + 1);\r\n            }\r\n            else {\r\n                // opening\r\n                var val = counts.has(key) ? counts.get(key) : 0;\r\n                val -= 1;\r\n                counts.set(key, Math.max(0, val));\r\n                if (val < 0) {\r\n                    var list = ranges.get(key);\r\n                    if (list) {\r\n                        var closing = list.shift();\r\n                        if (list.size === 0) {\r\n                            ranges.delete(key);\r\n                        }\r\n                        var innerBracket = Range.fromPositions(bracket.range.getEndPosition(), closing.getStartPosition());\r\n                        var outerBracket = Range.fromPositions(bracket.range.getStartPosition(), closing.getEndPosition());\r\n                        bucket.push({ range: innerBracket });\r\n                        bucket.push({ range: outerBracket });\r\n                        BracketSelectionRangeProvider._addBracketLeading(model, outerBracket, bucket);\r\n                    }\r\n                }\r\n            }\r\n            pos = bracket.range.getStartPosition();\r\n        }\r\n    };\r\n    BracketSelectionRangeProvider._addBracketLeading = function (model, bracket, bucket) {\r\n        if (bracket.startLineNumber === bracket.endLineNumber) {\r\n            return;\r\n        }\r\n        // xxxxxxxx {\r\n        //\r\n        // }\r\n        var startLine = bracket.startLineNumber;\r\n        var column = model.getLineFirstNonWhitespaceColumn(startLine);\r\n        if (column !== 0 && column !== bracket.startColumn) {\r\n            bucket.push({ range: Range.fromPositions(new Position(startLine, column), bracket.getEndPosition()) });\r\n            bucket.push({ range: Range.fromPositions(new Position(startLine, 1), bracket.getEndPosition()) });\r\n        }\r\n        // xxxxxxxx\r\n        // {\r\n        //\r\n        // }\r\n        var aboveLine = startLine - 1;\r\n        if (aboveLine > 0) {\r\n            var column_1 = model.getLineFirstNonWhitespaceColumn(aboveLine);\r\n            if (column_1 === bracket.startColumn && column_1 !== model.getLineLastNonWhitespaceColumn(aboveLine)) {\r\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, column_1), bracket.getEndPosition()) });\r\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, 1), bracket.getEndPosition()) });\r\n            }\r\n        }\r\n    };\r\n    BracketSelectionRangeProvider._maxDuration = 30;\r\n    BracketSelectionRangeProvider._maxRounds = 2;\r\n    return BracketSelectionRangeProvider;\r\n}());\r\nexport { BracketSelectionRangeProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as arrays from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport { WordSelectionRangeProvider } from './wordSelections.js';\r\nimport { BracketSelectionRangeProvider } from './bracketSelections.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nvar SelectionRanges = /** @class */ (function () {\r\n    function SelectionRanges(index, ranges) {\r\n        this.index = index;\r\n        this.ranges = ranges;\r\n    }\r\n    SelectionRanges.prototype.mov = function (fwd) {\r\n        var index = this.index + (fwd ? 1 : -1);\r\n        if (index < 0 || index >= this.ranges.length) {\r\n            return this;\r\n        }\r\n        var res = new SelectionRanges(index, this.ranges);\r\n        if (res.ranges[index].equalsRange(this.ranges[this.index])) {\r\n            // next range equals this range, retry with next-next\r\n            return res.mov(fwd);\r\n        }\r\n        return res;\r\n    };\r\n    return SelectionRanges;\r\n}());\r\nvar SmartSelectController = /** @class */ (function () {\r\n    function SmartSelectController(editor) {\r\n        this._ignoreSelection = false;\r\n        this._editor = editor;\r\n    }\r\n    SmartSelectController.get = function (editor) {\r\n        return editor.getContribution(SmartSelectController.ID);\r\n    };\r\n    SmartSelectController.prototype.dispose = function () {\r\n        dispose(this._selectionListener);\r\n    };\r\n    SmartSelectController.prototype.run = function (forward) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = this._editor.getSelections();\r\n        var model = this._editor.getModel();\r\n        if (!modes.SelectionRangeRegistry.has(model)) {\r\n            return;\r\n        }\r\n        var promise = Promise.resolve(undefined);\r\n        if (!this._state) {\r\n            promise = provideSelectionRanges(model, selections.map(function (s) { return s.getPosition(); }), CancellationToken.None).then(function (ranges) {\r\n                if (!arrays.isNonEmptyArray(ranges) || ranges.length !== selections.length) {\r\n                    // invalid result\r\n                    return;\r\n                }\r\n                if (!_this._editor.hasModel() || !arrays.equals(_this._editor.getSelections(), selections, function (a, b) { return a.equalsSelection(b); })) {\r\n                    // invalid editor state\r\n                    return;\r\n                }\r\n                var _loop_1 = function (i) {\r\n                    ranges[i] = ranges[i].filter(function (range) {\r\n                        // filter ranges inside the selection\r\n                        return range.containsPosition(selections[i].getStartPosition()) && range.containsPosition(selections[i].getEndPosition());\r\n                    });\r\n                    // prepend current selection\r\n                    ranges[i].unshift(selections[i]);\r\n                };\r\n                for (var i = 0; i < ranges.length; i++) {\r\n                    _loop_1(i);\r\n                }\r\n                _this._state = ranges.map(function (ranges) { return new SelectionRanges(0, ranges); });\r\n                // listen to caret move and forget about state\r\n                dispose(_this._selectionListener);\r\n                _this._selectionListener = _this._editor.onDidChangeCursorPosition(function () {\r\n                    if (!_this._ignoreSelection) {\r\n                        dispose(_this._selectionListener);\r\n                        _this._state = undefined;\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        return promise.then(function () {\r\n            if (!_this._state) {\r\n                // no state\r\n                return;\r\n            }\r\n            _this._state = _this._state.map(function (state) { return state.mov(forward); });\r\n            var selections = _this._state.map(function (state) { return Selection.fromPositions(state.ranges[state.index].getStartPosition(), state.ranges[state.index].getEndPosition()); });\r\n            _this._ignoreSelection = true;\r\n            try {\r\n                _this._editor.setSelections(selections);\r\n            }\r\n            finally {\r\n                _this._ignoreSelection = false;\r\n            }\r\n        });\r\n    };\r\n    SmartSelectController.ID = 'editor.contrib.smartSelectController';\r\n    return SmartSelectController;\r\n}());\r\nvar AbstractSmartSelect = /** @class */ (function (_super) {\r\n    __extends(AbstractSmartSelect, _super);\r\n    function AbstractSmartSelect(forward, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._forward = forward;\r\n        return _this;\r\n    }\r\n    AbstractSmartSelect.prototype.run = function (_accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var controller;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        controller = SmartSelectController.get(editor);\r\n                        if (!controller) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, controller.run(this._forward)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return AbstractSmartSelect;\r\n}(EditorAction));\r\nvar GrowSelectionAction = /** @class */ (function (_super) {\r\n    __extends(GrowSelectionAction, _super);\r\n    function GrowSelectionAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.smartSelect.expand',\r\n            label: nls.localize('smartSelect.expand', \"Expand Selection\"),\r\n            alias: 'Expand Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 17 /* RightArrow */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 256 /* WinCtrl */ | 1024 /* Shift */ | 17 /* RightArrow */,\r\n                    secondary: [256 /* WinCtrl */ | 1024 /* Shift */ | 17 /* RightArrow */],\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '1_basic',\r\n                title: nls.localize({ key: 'miSmartSelectGrow', comment: ['&& denotes a mnemonic'] }, \"&&Expand Selection\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    return GrowSelectionAction;\r\n}(AbstractSmartSelect));\r\n// renamed command id\r\nCommandsRegistry.registerCommandAlias('editor.action.smartSelect.grow', 'editor.action.smartSelect.expand');\r\nvar ShrinkSelectionAction = /** @class */ (function (_super) {\r\n    __extends(ShrinkSelectionAction, _super);\r\n    function ShrinkSelectionAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.smartSelect.shrink',\r\n            label: nls.localize('smartSelect.shrink', \"Shrink Selection\"),\r\n            alias: 'Shrink Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 15 /* LeftArrow */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 256 /* WinCtrl */ | 1024 /* Shift */ | 15 /* LeftArrow */,\r\n                    secondary: [256 /* WinCtrl */ | 1024 /* Shift */ | 15 /* LeftArrow */],\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 23 /* MenubarSelectionMenu */,\r\n                group: '1_basic',\r\n                title: nls.localize({ key: 'miSmartSelectShrink', comment: ['&& denotes a mnemonic'] }, \"&&Shrink Selection\"),\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    return ShrinkSelectionAction;\r\n}(AbstractSmartSelect));\r\nregisterEditorContribution(SmartSelectController.ID, SmartSelectController);\r\nregisterEditorAction(GrowSelectionAction);\r\nregisterEditorAction(ShrinkSelectionAction);\r\n// word selection\r\nmodes.SelectionRangeRegistry.register('*', new WordSelectionRangeProvider());\r\nexport function provideSelectionRanges(model, positions, token) {\r\n    var providers = modes.SelectionRangeRegistry.all(model);\r\n    if (providers.length === 1) {\r\n        // add word selection and bracket selection when no provider exists\r\n        providers.unshift(new BracketSelectionRangeProvider());\r\n    }\r\n    var work = [];\r\n    var allRawRanges = [];\r\n    for (var _i = 0, providers_1 = providers; _i < providers_1.length; _i++) {\r\n        var provider = providers_1[_i];\r\n        work.push(Promise.resolve(provider.provideSelectionRanges(model, positions, token)).then(function (allProviderRanges) {\r\n            if (arrays.isNonEmptyArray(allProviderRanges) && allProviderRanges.length === positions.length) {\r\n                for (var i = 0; i < positions.length; i++) {\r\n                    if (!allRawRanges[i]) {\r\n                        allRawRanges[i] = [];\r\n                    }\r\n                    for (var _i = 0, _a = allProviderRanges[i]; _i < _a.length; _i++) {\r\n                        var oneProviderRanges = _a[_i];\r\n                        if (Range.isIRange(oneProviderRanges.range) && Range.containsPosition(oneProviderRanges.range, positions[i])) {\r\n                            allRawRanges[i].push(Range.lift(oneProviderRanges.range));\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }, onUnexpectedExternalError));\r\n    }\r\n    return Promise.all(work).then(function () {\r\n        return allRawRanges.map(function (oneRawRanges) {\r\n            if (oneRawRanges.length === 0) {\r\n                return [];\r\n            }\r\n            // sort all by start/end position\r\n            oneRawRanges.sort(function (a, b) {\r\n                if (Position.isBefore(a.getStartPosition(), b.getStartPosition())) {\r\n                    return 1;\r\n                }\r\n                else if (Position.isBefore(b.getStartPosition(), a.getStartPosition())) {\r\n                    return -1;\r\n                }\r\n                else if (Position.isBefore(a.getEndPosition(), b.getEndPosition())) {\r\n                    return -1;\r\n                }\r\n                else if (Position.isBefore(b.getEndPosition(), a.getEndPosition())) {\r\n                    return 1;\r\n                }\r\n                else {\r\n                    return 0;\r\n                }\r\n            });\r\n            // remove ranges that don't contain the former range or that are equal to the\r\n            // former range\r\n            var oneRanges = [];\r\n            var last;\r\n            for (var _i = 0, oneRawRanges_1 = oneRawRanges; _i < oneRawRanges_1.length; _i++) {\r\n                var range = oneRawRanges_1[_i];\r\n                if (!last || (Range.containsRange(range, last) && !Range.equalsRange(range, last))) {\r\n                    oneRanges.push(range);\r\n                    last = range;\r\n                }\r\n            }\r\n            // add ranges that expand trivia at line starts and ends whenever a range\r\n            // wraps onto the a new line\r\n            var oneRangesWithTrivia = [oneRanges[0]];\r\n            for (var i = 1; i < oneRanges.length; i++) {\r\n                var prev = oneRanges[i - 1];\r\n                var cur = oneRanges[i];\r\n                if (cur.startLineNumber !== prev.startLineNumber || cur.endLineNumber !== prev.endLineNumber) {\r\n                    // add line/block range without leading/failing whitespace\r\n                    var rangeNoWhitespace = new Range(prev.startLineNumber, model.getLineFirstNonWhitespaceColumn(prev.startLineNumber), prev.endLineNumber, model.getLineLastNonWhitespaceColumn(prev.endLineNumber));\r\n                    if (rangeNoWhitespace.containsRange(prev) && !rangeNoWhitespace.equalsRange(prev) && cur.containsRange(rangeNoWhitespace) && !cur.equalsRange(rangeNoWhitespace)) {\r\n                        oneRangesWithTrivia.push(rangeNoWhitespace);\r\n                    }\r\n                    // add line/block range\r\n                    var rangeFull = new Range(prev.startLineNumber, 1, prev.endLineNumber, model.getLineMaxColumn(prev.endLineNumber));\r\n                    if (rangeFull.containsRange(prev) && !rangeFull.equalsRange(rangeNoWhitespace) && cur.containsRange(rangeFull) && !cur.equalsRange(rangeFull)) {\r\n                        oneRangesWithTrivia.push(rangeFull);\r\n                    }\r\n                }\r\n                oneRangesWithTrivia.push(cur);\r\n            }\r\n            return oneRangesWithTrivia;\r\n        });\r\n    });\r\n}\r\nregisterDefaultLanguageCommand('_executeSelectionRangeProvider', function (model, _position, args) {\r\n    return provideSelectionRanges(model, args.positions, CancellationToken.None);\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { first } from '../../../base/common/async.js';\r\nimport { assign } from '../../../base/common/objects.js';\r\nimport { onUnexpectedExternalError, canceled, isPromiseCanceledError } from '../../../base/common/errors.js';\r\nimport { registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { FuzzyScore } from '../../../base/common/filters.js';\r\nimport { isDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nexport var Context = {\r\n    Visible: new RawContextKey('suggestWidgetVisible', false),\r\n    MultipleSuggestions: new RawContextKey('suggestWidgetMultipleSuggestions', false),\r\n    MakesTextEdit: new RawContextKey('suggestionMakesTextEdit', true),\r\n    AcceptSuggestionsOnEnter: new RawContextKey('acceptSuggestionOnEnter', true)\r\n};\r\nvar CompletionItem = /** @class */ (function () {\r\n    function CompletionItem(position, completion, container, provider, model) {\r\n        this.position = position;\r\n        this.completion = completion;\r\n        this.container = container;\r\n        this.provider = provider;\r\n        // sorting, filtering\r\n        this.score = FuzzyScore.Default;\r\n        this.distance = 0;\r\n        // ensure lower-variants (perf)\r\n        this.labelLow = completion.label.toLowerCase();\r\n        this.sortTextLow = completion.sortText && completion.sortText.toLowerCase();\r\n        this.filterTextLow = completion.filterText && completion.filterText.toLowerCase();\r\n        // normalize ranges\r\n        if (Range.isIRange(completion.range)) {\r\n            this.editStart = new Position(completion.range.startLineNumber, completion.range.startColumn);\r\n            this.editInsertEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\r\n            this.editReplaceEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\r\n        }\r\n        else {\r\n            this.editStart = new Position(completion.range.insert.startLineNumber, completion.range.insert.startColumn);\r\n            this.editInsertEnd = new Position(completion.range.insert.endLineNumber, completion.range.insert.endColumn);\r\n            this.editReplaceEnd = new Position(completion.range.replace.endLineNumber, completion.range.replace.endColumn);\r\n        }\r\n        // create the suggestion resolver\r\n        var resolveCompletionItem = provider.resolveCompletionItem;\r\n        if (typeof resolveCompletionItem !== 'function') {\r\n            this.resolve = function () { return Promise.resolve(); };\r\n        }\r\n        else {\r\n            var cached_1;\r\n            this.resolve = function (token) {\r\n                if (!cached_1) {\r\n                    var isDone_1 = false;\r\n                    cached_1 = Promise.resolve(resolveCompletionItem.call(provider, model, position, completion, token)).then(function (value) {\r\n                        assign(completion, value);\r\n                        isDone_1 = true;\r\n                    }, function (err) {\r\n                        if (isPromiseCanceledError(err)) {\r\n                            // the IPC queue will reject the request with the\r\n                            // cancellation error -> reset cached\r\n                            cached_1 = undefined;\r\n                        }\r\n                    });\r\n                    token.onCancellationRequested(function () {\r\n                        if (!isDone_1) {\r\n                            // cancellation after the request has been\r\n                            // dispatched -> reset cache\r\n                            cached_1 = undefined;\r\n                        }\r\n                    });\r\n                }\r\n                return cached_1;\r\n            };\r\n        }\r\n    }\r\n    return CompletionItem;\r\n}());\r\nexport { CompletionItem };\r\nvar CompletionOptions = /** @class */ (function () {\r\n    function CompletionOptions(snippetSortOrder, kindFilter, providerFilter) {\r\n        if (snippetSortOrder === void 0) { snippetSortOrder = 2 /* Bottom */; }\r\n        if (kindFilter === void 0) { kindFilter = new Set(); }\r\n        if (providerFilter === void 0) { providerFilter = new Set(); }\r\n        this.snippetSortOrder = snippetSortOrder;\r\n        this.kindFilter = kindFilter;\r\n        this.providerFilter = providerFilter;\r\n    }\r\n    CompletionOptions.default = new CompletionOptions();\r\n    return CompletionOptions;\r\n}());\r\nexport { CompletionOptions };\r\nvar _snippetSuggestSupport;\r\nexport function getSnippetSuggestSupport() {\r\n    return _snippetSuggestSupport;\r\n}\r\nexport function provideSuggestionItems(model, position, options, context, token) {\r\n    if (options === void 0) { options = CompletionOptions.default; }\r\n    if (context === void 0) { context = { triggerKind: 0 /* Invoke */ }; }\r\n    if (token === void 0) { token = CancellationToken.None; }\r\n    var word = model.getWordAtPosition(position);\r\n    var defaultReplaceRange = word ? new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn) : Range.fromPositions(position);\r\n    var defaultInsertRange = defaultReplaceRange.setEndPosition(position.lineNumber, position.column);\r\n    // const wordUntil = model.getWordUntilPosition(position);\r\n    // const defaultRange = new Range(position.lineNumber, wordUntil.startColumn, position.lineNumber, wordUntil.endColumn);\r\n    position = position.clone();\r\n    // get provider groups, always add snippet suggestion provider\r\n    var supports = modes.CompletionProviderRegistry.orderedGroups(model);\r\n    // add snippets provider unless turned off\r\n    if (!options.kindFilter.has(25 /* Snippet */) && _snippetSuggestSupport) {\r\n        supports.unshift([_snippetSuggestSupport]);\r\n    }\r\n    var allSuggestions = [];\r\n    var disposables = new DisposableStore();\r\n    var hasResult = false;\r\n    // add suggestions from contributed providers - providers are ordered in groups of\r\n    // equal score and once a group produces a result the process stops\r\n    var factory = supports.map(function (supports) { return function () {\r\n        // for each support in the group ask for suggestions\r\n        return Promise.all(supports.map(function (provider) {\r\n            if (options.providerFilter.size > 0 && !options.providerFilter.has(provider)) {\r\n                return undefined;\r\n            }\r\n            return Promise.resolve(provider.provideCompletionItems(model, position, context, token)).then(function (container) {\r\n                var len = allSuggestions.length;\r\n                if (container) {\r\n                    for (var _i = 0, _a = container.suggestions || []; _i < _a.length; _i++) {\r\n                        var suggestion = _a[_i];\r\n                        if (!options.kindFilter.has(suggestion.kind)) {\r\n                            // fill in default range when missing\r\n                            if (!suggestion.range) {\r\n                                suggestion.range = { insert: defaultInsertRange, replace: defaultReplaceRange };\r\n                            }\r\n                            // fill in default sortText when missing\r\n                            if (!suggestion.sortText) {\r\n                                suggestion.sortText = suggestion.label;\r\n                            }\r\n                            allSuggestions.push(new CompletionItem(position, suggestion, container, provider, model));\r\n                        }\r\n                    }\r\n                    if (isDisposable(container)) {\r\n                        disposables.add(container);\r\n                    }\r\n                }\r\n                if (len !== allSuggestions.length && provider !== _snippetSuggestSupport) {\r\n                    hasResult = true;\r\n                }\r\n            }, onUnexpectedExternalError);\r\n        }));\r\n    }; });\r\n    var result = first(factory, function () {\r\n        // stop on result or cancellation\r\n        return hasResult || token.isCancellationRequested;\r\n    }).then(function () {\r\n        if (token.isCancellationRequested) {\r\n            disposables.dispose();\r\n            return Promise.reject(canceled());\r\n        }\r\n        return allSuggestions.sort(getSuggestionComparator(options.snippetSortOrder));\r\n    });\r\n    // result.then(items => {\r\n    // \tconsole.log(model.getWordUntilPosition(position), items.map(item => `${item.suggestion.label}, type=${item.suggestion.type}, incomplete?${item.container.incomplete}, overwriteBefore=${item.suggestion.overwriteBefore}`));\r\n    // \treturn items;\r\n    // }, err => {\r\n    // \tconsole.warn(model.getWordUntilPosition(position), err);\r\n    // });\r\n    return result;\r\n}\r\nfunction defaultComparator(a, b) {\r\n    // check with 'sortText'\r\n    if (a.sortTextLow && b.sortTextLow) {\r\n        if (a.sortTextLow < b.sortTextLow) {\r\n            return -1;\r\n        }\r\n        else if (a.sortTextLow > b.sortTextLow) {\r\n            return 1;\r\n        }\r\n    }\r\n    // check with 'label'\r\n    if (a.completion.label < b.completion.label) {\r\n        return -1;\r\n    }\r\n    else if (a.completion.label > b.completion.label) {\r\n        return 1;\r\n    }\r\n    // check with 'type'\r\n    return a.completion.kind - b.completion.kind;\r\n}\r\nfunction snippetUpComparator(a, b) {\r\n    if (a.completion.kind !== b.completion.kind) {\r\n        if (a.completion.kind === 25 /* Snippet */) {\r\n            return -1;\r\n        }\r\n        else if (b.completion.kind === 25 /* Snippet */) {\r\n            return 1;\r\n        }\r\n    }\r\n    return defaultComparator(a, b);\r\n}\r\nfunction snippetDownComparator(a, b) {\r\n    if (a.completion.kind !== b.completion.kind) {\r\n        if (a.completion.kind === 25 /* Snippet */) {\r\n            return 1;\r\n        }\r\n        else if (b.completion.kind === 25 /* Snippet */) {\r\n            return -1;\r\n        }\r\n    }\r\n    return defaultComparator(a, b);\r\n}\r\nvar _snippetComparators = new Map();\r\n_snippetComparators.set(0 /* Top */, snippetUpComparator);\r\n_snippetComparators.set(2 /* Bottom */, snippetDownComparator);\r\n_snippetComparators.set(1 /* Inline */, defaultComparator);\r\nexport function getSuggestionComparator(snippetConfig) {\r\n    return _snippetComparators.get(snippetConfig);\r\n}\r\nregisterDefaultLanguageCommand('_executeCompletionItemProvider', function (model, position, args) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var result, disposables, resolving, maxItemsToResolve, items, _i, items_1, item;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0:\r\n                result = {\r\n                    incomplete: false,\r\n                    suggestions: []\r\n                };\r\n                disposables = new DisposableStore();\r\n                resolving = [];\r\n                maxItemsToResolve = args['maxItemsToResolve'] || 0;\r\n                return [4 /*yield*/, provideSuggestionItems(model, position)];\r\n            case 1:\r\n                items = _a.sent();\r\n                for (_i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n                    item = items_1[_i];\r\n                    if (resolving.length < maxItemsToResolve) {\r\n                        resolving.push(item.resolve(CancellationToken.None));\r\n                    }\r\n                    result.incomplete = result.incomplete || item.container.incomplete;\r\n                    result.suggestions.push(item.completion);\r\n                    if (isDisposable(item.container)) {\r\n                        disposables.add(item.container);\r\n                    }\r\n                }\r\n                _a.label = 2;\r\n            case 2:\r\n                _a.trys.push([2, , 4, 5]);\r\n                return [4 /*yield*/, Promise.all(resolving)];\r\n            case 3:\r\n                _a.sent();\r\n                return [2 /*return*/, result];\r\n            case 4:\r\n                setTimeout(function () { return disposables.dispose(); }, 100);\r\n                return [7 /*endfinally*/];\r\n            case 5: return [2 /*return*/];\r\n        }\r\n    });\r\n}); });\r\nvar _provider = new /** @class */ (function () {\r\n    function class_1() {\r\n        this.onlyOnceSuggestions = [];\r\n    }\r\n    class_1.prototype.provideCompletionItems = function () {\r\n        var suggestions = this.onlyOnceSuggestions.slice(0);\r\n        var result = { suggestions: suggestions };\r\n        this.onlyOnceSuggestions.length = 0;\r\n        return result;\r\n    };\r\n    return class_1;\r\n}());\r\nmodes.CompletionProviderRegistry.register('*', _provider);\r\nexport function showSimpleSuggestions(editor, suggestions) {\r\n    setTimeout(function () {\r\n        var _a;\r\n        (_a = _provider.onlyOnceSuggestions).push.apply(_a, suggestions);\r\n        editor.getContribution('editor.contrib.suggestController').triggerSuggest(new Set().add(_provider));\r\n    }, 0);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nvar _a;\r\nvar Scanner = /** @class */ (function () {\r\n    function Scanner() {\r\n        this.value = '';\r\n        this.pos = 0;\r\n    }\r\n    Scanner.isDigitCharacter = function (ch) {\r\n        return ch >= 48 /* Digit0 */ && ch <= 57 /* Digit9 */;\r\n    };\r\n    Scanner.isVariableCharacter = function (ch) {\r\n        return ch === 95 /* Underline */\r\n            || (ch >= 97 /* a */ && ch <= 122 /* z */)\r\n            || (ch >= 65 /* A */ && ch <= 90 /* Z */);\r\n    };\r\n    Scanner.prototype.text = function (value) {\r\n        this.value = value;\r\n        this.pos = 0;\r\n    };\r\n    Scanner.prototype.tokenText = function (token) {\r\n        return this.value.substr(token.pos, token.len);\r\n    };\r\n    Scanner.prototype.next = function () {\r\n        if (this.pos >= this.value.length) {\r\n            return { type: 14 /* EOF */, pos: this.pos, len: 0 };\r\n        }\r\n        var pos = this.pos;\r\n        var len = 0;\r\n        var ch = this.value.charCodeAt(pos);\r\n        var type;\r\n        // static types\r\n        type = Scanner._table[ch];\r\n        if (typeof type === 'number') {\r\n            this.pos += 1;\r\n            return { type: type, pos: pos, len: 1 };\r\n        }\r\n        // number\r\n        if (Scanner.isDigitCharacter(ch)) {\r\n            type = 8 /* Int */;\r\n            do {\r\n                len += 1;\r\n                ch = this.value.charCodeAt(pos + len);\r\n            } while (Scanner.isDigitCharacter(ch));\r\n            this.pos += len;\r\n            return { type: type, pos: pos, len: len };\r\n        }\r\n        // variable name\r\n        if (Scanner.isVariableCharacter(ch)) {\r\n            type = 9 /* VariableName */;\r\n            do {\r\n                ch = this.value.charCodeAt(pos + (++len));\r\n            } while (Scanner.isVariableCharacter(ch) || Scanner.isDigitCharacter(ch));\r\n            this.pos += len;\r\n            return { type: type, pos: pos, len: len };\r\n        }\r\n        // format\r\n        type = 10 /* Format */;\r\n        do {\r\n            len += 1;\r\n            ch = this.value.charCodeAt(pos + len);\r\n        } while (!isNaN(ch)\r\n            && typeof Scanner._table[ch] === 'undefined' // not static token\r\n            && !Scanner.isDigitCharacter(ch) // not number\r\n            && !Scanner.isVariableCharacter(ch) // not variable\r\n        );\r\n        this.pos += len;\r\n        return { type: type, pos: pos, len: len };\r\n    };\r\n    Scanner._table = (_a = {},\r\n        _a[36 /* DollarSign */] = 0 /* Dollar */,\r\n        _a[58 /* Colon */] = 1 /* Colon */,\r\n        _a[44 /* Comma */] = 2 /* Comma */,\r\n        _a[123 /* OpenCurlyBrace */] = 3 /* CurlyOpen */,\r\n        _a[125 /* CloseCurlyBrace */] = 4 /* CurlyClose */,\r\n        _a[92 /* Backslash */] = 5 /* Backslash */,\r\n        _a[47 /* Slash */] = 6 /* Forwardslash */,\r\n        _a[124 /* Pipe */] = 7 /* Pipe */,\r\n        _a[43 /* Plus */] = 11 /* Plus */,\r\n        _a[45 /* Dash */] = 12 /* Dash */,\r\n        _a[63 /* QuestionMark */] = 13 /* QuestionMark */,\r\n        _a);\r\n    return Scanner;\r\n}());\r\nexport { Scanner };\r\nvar Marker = /** @class */ (function () {\r\n    function Marker() {\r\n        this._children = [];\r\n    }\r\n    Marker.prototype.appendChild = function (child) {\r\n        if (child instanceof Text && this._children[this._children.length - 1] instanceof Text) {\r\n            // this and previous child are text -> merge them\r\n            this._children[this._children.length - 1].value += child.value;\r\n        }\r\n        else {\r\n            // normal adoption of child\r\n            child.parent = this;\r\n            this._children.push(child);\r\n        }\r\n        return this;\r\n    };\r\n    Marker.prototype.replace = function (child, others) {\r\n        var parent = child.parent;\r\n        var idx = parent.children.indexOf(child);\r\n        var newChildren = parent.children.slice(0);\r\n        newChildren.splice.apply(newChildren, __spreadArrays([idx, 1], others));\r\n        parent._children = newChildren;\r\n        (function _fixParent(children, parent) {\r\n            for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\r\n                var child_1 = children_1[_i];\r\n                child_1.parent = parent;\r\n                _fixParent(child_1.children, child_1);\r\n            }\r\n        })(others, parent);\r\n    };\r\n    Object.defineProperty(Marker.prototype, \"children\", {\r\n        get: function () {\r\n            return this._children;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Marker.prototype, \"snippet\", {\r\n        get: function () {\r\n            var candidate = this;\r\n            while (true) {\r\n                if (!candidate) {\r\n                    return undefined;\r\n                }\r\n                if (candidate instanceof TextmateSnippet) {\r\n                    return candidate;\r\n                }\r\n                candidate = candidate.parent;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Marker.prototype.toString = function () {\r\n        return this.children.reduce(function (prev, cur) { return prev + cur.toString(); }, '');\r\n    };\r\n    Marker.prototype.len = function () {\r\n        return 0;\r\n    };\r\n    return Marker;\r\n}());\r\nexport { Marker };\r\nvar Text = /** @class */ (function (_super) {\r\n    __extends(Text, _super);\r\n    function Text(value) {\r\n        var _this_1 = _super.call(this) || this;\r\n        _this_1.value = value;\r\n        return _this_1;\r\n    }\r\n    Text.prototype.toString = function () {\r\n        return this.value;\r\n    };\r\n    Text.prototype.len = function () {\r\n        return this.value.length;\r\n    };\r\n    Text.prototype.clone = function () {\r\n        return new Text(this.value);\r\n    };\r\n    return Text;\r\n}(Marker));\r\nexport { Text };\r\nvar TransformableMarker = /** @class */ (function (_super) {\r\n    __extends(TransformableMarker, _super);\r\n    function TransformableMarker() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return TransformableMarker;\r\n}(Marker));\r\nexport { TransformableMarker };\r\nvar Placeholder = /** @class */ (function (_super) {\r\n    __extends(Placeholder, _super);\r\n    function Placeholder(index) {\r\n        var _this_1 = _super.call(this) || this;\r\n        _this_1.index = index;\r\n        return _this_1;\r\n    }\r\n    Placeholder.compareByIndex = function (a, b) {\r\n        if (a.index === b.index) {\r\n            return 0;\r\n        }\r\n        else if (a.isFinalTabstop) {\r\n            return 1;\r\n        }\r\n        else if (b.isFinalTabstop) {\r\n            return -1;\r\n        }\r\n        else if (a.index < b.index) {\r\n            return -1;\r\n        }\r\n        else if (a.index > b.index) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    Object.defineProperty(Placeholder.prototype, \"isFinalTabstop\", {\r\n        get: function () {\r\n            return this.index === 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Placeholder.prototype, \"choice\", {\r\n        get: function () {\r\n            return this._children.length === 1 && this._children[0] instanceof Choice\r\n                ? this._children[0]\r\n                : undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Placeholder.prototype.clone = function () {\r\n        var ret = new Placeholder(this.index);\r\n        if (this.transform) {\r\n            ret.transform = this.transform.clone();\r\n        }\r\n        ret._children = this.children.map(function (child) { return child.clone(); });\r\n        return ret;\r\n    };\r\n    return Placeholder;\r\n}(TransformableMarker));\r\nexport { Placeholder };\r\nvar Choice = /** @class */ (function (_super) {\r\n    __extends(Choice, _super);\r\n    function Choice() {\r\n        var _this_1 = _super !== null && _super.apply(this, arguments) || this;\r\n        _this_1.options = [];\r\n        return _this_1;\r\n    }\r\n    Choice.prototype.appendChild = function (marker) {\r\n        if (marker instanceof Text) {\r\n            marker.parent = this;\r\n            this.options.push(marker);\r\n        }\r\n        return this;\r\n    };\r\n    Choice.prototype.toString = function () {\r\n        return this.options[0].value;\r\n    };\r\n    Choice.prototype.len = function () {\r\n        return this.options[0].len();\r\n    };\r\n    Choice.prototype.clone = function () {\r\n        var ret = new Choice();\r\n        this.options.forEach(ret.appendChild, ret);\r\n        return ret;\r\n    };\r\n    return Choice;\r\n}(Marker));\r\nexport { Choice };\r\nvar Transform = /** @class */ (function (_super) {\r\n    __extends(Transform, _super);\r\n    function Transform() {\r\n        var _this_1 = _super !== null && _super.apply(this, arguments) || this;\r\n        _this_1.regexp = new RegExp('');\r\n        return _this_1;\r\n    }\r\n    Transform.prototype.resolve = function (value) {\r\n        var _this = this;\r\n        var didMatch = false;\r\n        var ret = value.replace(this.regexp, function () {\r\n            didMatch = true;\r\n            return _this._replace(Array.prototype.slice.call(arguments, 0, -2));\r\n        });\r\n        // when the regex didn't match and when the transform has\r\n        // else branches, then run those\r\n        if (!didMatch && this._children.some(function (child) { return child instanceof FormatString && Boolean(child.elseValue); })) {\r\n            ret = this._replace([]);\r\n        }\r\n        return ret;\r\n    };\r\n    Transform.prototype._replace = function (groups) {\r\n        var ret = '';\r\n        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {\r\n            var marker = _a[_i];\r\n            if (marker instanceof FormatString) {\r\n                var value = groups[marker.index] || '';\r\n                value = marker.resolve(value);\r\n                ret += value;\r\n            }\r\n            else {\r\n                ret += marker.toString();\r\n            }\r\n        }\r\n        return ret;\r\n    };\r\n    Transform.prototype.toString = function () {\r\n        return '';\r\n    };\r\n    Transform.prototype.clone = function () {\r\n        var ret = new Transform();\r\n        ret.regexp = new RegExp(this.regexp.source, '' + (this.regexp.ignoreCase ? 'i' : '') + (this.regexp.global ? 'g' : ''));\r\n        ret._children = this.children.map(function (child) { return child.clone(); });\r\n        return ret;\r\n    };\r\n    return Transform;\r\n}(Marker));\r\nexport { Transform };\r\nvar FormatString = /** @class */ (function (_super) {\r\n    __extends(FormatString, _super);\r\n    function FormatString(index, shorthandName, ifValue, elseValue) {\r\n        var _this_1 = _super.call(this) || this;\r\n        _this_1.index = index;\r\n        _this_1.shorthandName = shorthandName;\r\n        _this_1.ifValue = ifValue;\r\n        _this_1.elseValue = elseValue;\r\n        return _this_1;\r\n    }\r\n    FormatString.prototype.resolve = function (value) {\r\n        if (this.shorthandName === 'upcase') {\r\n            return !value ? '' : value.toLocaleUpperCase();\r\n        }\r\n        else if (this.shorthandName === 'downcase') {\r\n            return !value ? '' : value.toLocaleLowerCase();\r\n        }\r\n        else if (this.shorthandName === 'capitalize') {\r\n            return !value ? '' : (value[0].toLocaleUpperCase() + value.substr(1));\r\n        }\r\n        else if (this.shorthandName === 'pascalcase') {\r\n            return !value ? '' : this._toPascalCase(value);\r\n        }\r\n        else if (Boolean(value) && typeof this.ifValue === 'string') {\r\n            return this.ifValue;\r\n        }\r\n        else if (!Boolean(value) && typeof this.elseValue === 'string') {\r\n            return this.elseValue;\r\n        }\r\n        else {\r\n            return value || '';\r\n        }\r\n    };\r\n    FormatString.prototype._toPascalCase = function (value) {\r\n        var match = value.match(/[a-z]+/gi);\r\n        if (!match) {\r\n            return value;\r\n        }\r\n        return match.map(function (word) {\r\n            return word.charAt(0).toUpperCase()\r\n                + word.substr(1).toLowerCase();\r\n        })\r\n            .join('');\r\n    };\r\n    FormatString.prototype.clone = function () {\r\n        var ret = new FormatString(this.index, this.shorthandName, this.ifValue, this.elseValue);\r\n        return ret;\r\n    };\r\n    return FormatString;\r\n}(Marker));\r\nexport { FormatString };\r\nvar Variable = /** @class */ (function (_super) {\r\n    __extends(Variable, _super);\r\n    function Variable(name) {\r\n        var _this_1 = _super.call(this) || this;\r\n        _this_1.name = name;\r\n        return _this_1;\r\n    }\r\n    Variable.prototype.resolve = function (resolver) {\r\n        var value = resolver.resolve(this);\r\n        if (this.transform) {\r\n            value = this.transform.resolve(value || '');\r\n        }\r\n        if (value !== undefined) {\r\n            this._children = [new Text(value)];\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Variable.prototype.clone = function () {\r\n        var ret = new Variable(this.name);\r\n        if (this.transform) {\r\n            ret.transform = this.transform.clone();\r\n        }\r\n        ret._children = this.children.map(function (child) { return child.clone(); });\r\n        return ret;\r\n    };\r\n    return Variable;\r\n}(TransformableMarker));\r\nexport { Variable };\r\nfunction walk(marker, visitor) {\r\n    var stack = __spreadArrays(marker);\r\n    while (stack.length > 0) {\r\n        var marker_1 = stack.shift();\r\n        var recurse = visitor(marker_1);\r\n        if (!recurse) {\r\n            break;\r\n        }\r\n        stack.unshift.apply(stack, marker_1.children);\r\n    }\r\n}\r\nvar TextmateSnippet = /** @class */ (function (_super) {\r\n    __extends(TextmateSnippet, _super);\r\n    function TextmateSnippet() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Object.defineProperty(TextmateSnippet.prototype, \"placeholderInfo\", {\r\n        get: function () {\r\n            if (!this._placeholders) {\r\n                // fill in placeholders\r\n                var all_1 = [];\r\n                var last_1;\r\n                this.walk(function (candidate) {\r\n                    if (candidate instanceof Placeholder) {\r\n                        all_1.push(candidate);\r\n                        last_1 = !last_1 || last_1.index < candidate.index ? candidate : last_1;\r\n                    }\r\n                    return true;\r\n                });\r\n                this._placeholders = { all: all_1, last: last_1 };\r\n            }\r\n            return this._placeholders;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TextmateSnippet.prototype, \"placeholders\", {\r\n        get: function () {\r\n            var all = this.placeholderInfo.all;\r\n            return all;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    TextmateSnippet.prototype.offset = function (marker) {\r\n        var pos = 0;\r\n        var found = false;\r\n        this.walk(function (candidate) {\r\n            if (candidate === marker) {\r\n                found = true;\r\n                return false;\r\n            }\r\n            pos += candidate.len();\r\n            return true;\r\n        });\r\n        if (!found) {\r\n            return -1;\r\n        }\r\n        return pos;\r\n    };\r\n    TextmateSnippet.prototype.fullLen = function (marker) {\r\n        var ret = 0;\r\n        walk([marker], function (marker) {\r\n            ret += marker.len();\r\n            return true;\r\n        });\r\n        return ret;\r\n    };\r\n    TextmateSnippet.prototype.enclosingPlaceholders = function (placeholder) {\r\n        var ret = [];\r\n        var parent = placeholder.parent;\r\n        while (parent) {\r\n            if (parent instanceof Placeholder) {\r\n                ret.push(parent);\r\n            }\r\n            parent = parent.parent;\r\n        }\r\n        return ret;\r\n    };\r\n    TextmateSnippet.prototype.resolveVariables = function (resolver) {\r\n        var _this_1 = this;\r\n        this.walk(function (candidate) {\r\n            if (candidate instanceof Variable) {\r\n                if (candidate.resolve(resolver)) {\r\n                    _this_1._placeholders = undefined;\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n        return this;\r\n    };\r\n    TextmateSnippet.prototype.appendChild = function (child) {\r\n        this._placeholders = undefined;\r\n        return _super.prototype.appendChild.call(this, child);\r\n    };\r\n    TextmateSnippet.prototype.replace = function (child, others) {\r\n        this._placeholders = undefined;\r\n        return _super.prototype.replace.call(this, child, others);\r\n    };\r\n    TextmateSnippet.prototype.clone = function () {\r\n        var ret = new TextmateSnippet();\r\n        this._children = this.children.map(function (child) { return child.clone(); });\r\n        return ret;\r\n    };\r\n    TextmateSnippet.prototype.walk = function (visitor) {\r\n        walk(this.children, visitor);\r\n    };\r\n    return TextmateSnippet;\r\n}(Marker));\r\nexport { TextmateSnippet };\r\nvar SnippetParser = /** @class */ (function () {\r\n    function SnippetParser() {\r\n        this._scanner = new Scanner();\r\n        this._token = { type: 14 /* EOF */, pos: 0, len: 0 };\r\n    }\r\n    SnippetParser.escape = function (value) {\r\n        return value.replace(/\\$|}|\\\\/g, '\\\\$&');\r\n    };\r\n    SnippetParser.prototype.parse = function (value, insertFinalTabstop, enforceFinalTabstop) {\r\n        this._scanner.text(value);\r\n        this._token = this._scanner.next();\r\n        var snippet = new TextmateSnippet();\r\n        while (this._parse(snippet)) {\r\n            // nothing\r\n        }\r\n        // fill in values for placeholders. the first placeholder of an index\r\n        // that has a value defines the value for all placeholders with that index\r\n        var placeholderDefaultValues = new Map();\r\n        var incompletePlaceholders = [];\r\n        var placeholderCount = 0;\r\n        snippet.walk(function (marker) {\r\n            if (marker instanceof Placeholder) {\r\n                placeholderCount += 1;\r\n                if (marker.isFinalTabstop) {\r\n                    placeholderDefaultValues.set(0, undefined);\r\n                }\r\n                else if (!placeholderDefaultValues.has(marker.index) && marker.children.length > 0) {\r\n                    placeholderDefaultValues.set(marker.index, marker.children);\r\n                }\r\n                else {\r\n                    incompletePlaceholders.push(marker);\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n        for (var _i = 0, incompletePlaceholders_1 = incompletePlaceholders; _i < incompletePlaceholders_1.length; _i++) {\r\n            var placeholder = incompletePlaceholders_1[_i];\r\n            var defaultValues = placeholderDefaultValues.get(placeholder.index);\r\n            if (defaultValues) {\r\n                var clone = new Placeholder(placeholder.index);\r\n                clone.transform = placeholder.transform;\r\n                for (var _a = 0, defaultValues_1 = defaultValues; _a < defaultValues_1.length; _a++) {\r\n                    var child = defaultValues_1[_a];\r\n                    clone.appendChild(child.clone());\r\n                }\r\n                snippet.replace(placeholder, [clone]);\r\n            }\r\n        }\r\n        if (!enforceFinalTabstop) {\r\n            enforceFinalTabstop = placeholderCount > 0 && insertFinalTabstop;\r\n        }\r\n        if (!placeholderDefaultValues.has(0) && enforceFinalTabstop) {\r\n            // the snippet uses placeholders but has no\r\n            // final tabstop defined -> insert at the end\r\n            snippet.appendChild(new Placeholder(0));\r\n        }\r\n        return snippet;\r\n    };\r\n    SnippetParser.prototype._accept = function (type, value) {\r\n        if (type === undefined || this._token.type === type) {\r\n            var ret = !value ? true : this._scanner.tokenText(this._token);\r\n            this._token = this._scanner.next();\r\n            return ret;\r\n        }\r\n        return false;\r\n    };\r\n    SnippetParser.prototype._backTo = function (token) {\r\n        this._scanner.pos = token.pos + token.len;\r\n        this._token = token;\r\n        return false;\r\n    };\r\n    SnippetParser.prototype._until = function (type) {\r\n        var start = this._token;\r\n        while (this._token.type !== type) {\r\n            if (this._token.type === 14 /* EOF */) {\r\n                return false;\r\n            }\r\n            else if (this._token.type === 5 /* Backslash */) {\r\n                var nextToken = this._scanner.next();\r\n                if (nextToken.type !== 0 /* Dollar */\r\n                    && nextToken.type !== 4 /* CurlyClose */\r\n                    && nextToken.type !== 5 /* Backslash */) {\r\n                    return false;\r\n                }\r\n            }\r\n            this._token = this._scanner.next();\r\n        }\r\n        var value = this._scanner.value.substring(start.pos, this._token.pos).replace(/\\\\(\\$|}|\\\\)/g, '$1');\r\n        this._token = this._scanner.next();\r\n        return value;\r\n    };\r\n    SnippetParser.prototype._parse = function (marker) {\r\n        return this._parseEscaped(marker)\r\n            || this._parseTabstopOrVariableName(marker)\r\n            || this._parseComplexPlaceholder(marker)\r\n            || this._parseComplexVariable(marker)\r\n            || this._parseAnything(marker);\r\n    };\r\n    // \\$, \\\\, \\} -> just text\r\n    SnippetParser.prototype._parseEscaped = function (marker) {\r\n        var value;\r\n        if (value = this._accept(5 /* Backslash */, true)) {\r\n            // saw a backslash, append escaped token or that backslash\r\n            value = this._accept(0 /* Dollar */, true)\r\n                || this._accept(4 /* CurlyClose */, true)\r\n                || this._accept(5 /* Backslash */, true)\r\n                || value;\r\n            marker.appendChild(new Text(value));\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    // $foo -> variable, $1 -> tabstop\r\n    SnippetParser.prototype._parseTabstopOrVariableName = function (parent) {\r\n        var value;\r\n        var token = this._token;\r\n        var match = this._accept(0 /* Dollar */)\r\n            && (value = this._accept(9 /* VariableName */, true) || this._accept(8 /* Int */, true));\r\n        if (!match) {\r\n            return this._backTo(token);\r\n        }\r\n        parent.appendChild(/^\\d+$/.test(value)\r\n            ? new Placeholder(Number(value))\r\n            : new Variable(value));\r\n        return true;\r\n    };\r\n    // ${1:<children>}, ${1} -> placeholder\r\n    SnippetParser.prototype._parseComplexPlaceholder = function (parent) {\r\n        var index;\r\n        var token = this._token;\r\n        var match = this._accept(0 /* Dollar */)\r\n            && this._accept(3 /* CurlyOpen */)\r\n            && (index = this._accept(8 /* Int */, true));\r\n        if (!match) {\r\n            return this._backTo(token);\r\n        }\r\n        var placeholder = new Placeholder(Number(index));\r\n        if (this._accept(1 /* Colon */)) {\r\n            // ${1:<children>}\r\n            while (true) {\r\n                // ...} -> done\r\n                if (this._accept(4 /* CurlyClose */)) {\r\n                    parent.appendChild(placeholder);\r\n                    return true;\r\n                }\r\n                if (this._parse(placeholder)) {\r\n                    continue;\r\n                }\r\n                // fallback\r\n                parent.appendChild(new Text('${' + index + ':'));\r\n                placeholder.children.forEach(parent.appendChild, parent);\r\n                return true;\r\n            }\r\n        }\r\n        else if (placeholder.index > 0 && this._accept(7 /* Pipe */)) {\r\n            // ${1|one,two,three|}\r\n            var choice = new Choice();\r\n            while (true) {\r\n                if (this._parseChoiceElement(choice)) {\r\n                    if (this._accept(2 /* Comma */)) {\r\n                        // opt, -> more\r\n                        continue;\r\n                    }\r\n                    if (this._accept(7 /* Pipe */)) {\r\n                        placeholder.appendChild(choice);\r\n                        if (this._accept(4 /* CurlyClose */)) {\r\n                            // ..|} -> done\r\n                            parent.appendChild(placeholder);\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n                this._backTo(token);\r\n                return false;\r\n            }\r\n        }\r\n        else if (this._accept(6 /* Forwardslash */)) {\r\n            // ${1/<regex>/<format>/<options>}\r\n            if (this._parseTransform(placeholder)) {\r\n                parent.appendChild(placeholder);\r\n                return true;\r\n            }\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        else if (this._accept(4 /* CurlyClose */)) {\r\n            // ${1}\r\n            parent.appendChild(placeholder);\r\n            return true;\r\n        }\r\n        else {\r\n            // ${1 <- missing curly or colon\r\n            return this._backTo(token);\r\n        }\r\n    };\r\n    SnippetParser.prototype._parseChoiceElement = function (parent) {\r\n        var token = this._token;\r\n        var values = [];\r\n        while (true) {\r\n            if (this._token.type === 2 /* Comma */ || this._token.type === 7 /* Pipe */) {\r\n                break;\r\n            }\r\n            var value = void 0;\r\n            if (value = this._accept(5 /* Backslash */, true)) {\r\n                // \\, \\|, or \\\\\r\n                value = this._accept(2 /* Comma */, true)\r\n                    || this._accept(7 /* Pipe */, true)\r\n                    || this._accept(5 /* Backslash */, true)\r\n                    || value;\r\n            }\r\n            else {\r\n                value = this._accept(undefined, true);\r\n            }\r\n            if (!value) {\r\n                // EOF\r\n                this._backTo(token);\r\n                return false;\r\n            }\r\n            values.push(value);\r\n        }\r\n        if (values.length === 0) {\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        parent.appendChild(new Text(values.join('')));\r\n        return true;\r\n    };\r\n    // ${foo:<children>}, ${foo} -> variable\r\n    SnippetParser.prototype._parseComplexVariable = function (parent) {\r\n        var name;\r\n        var token = this._token;\r\n        var match = this._accept(0 /* Dollar */)\r\n            && this._accept(3 /* CurlyOpen */)\r\n            && (name = this._accept(9 /* VariableName */, true));\r\n        if (!match) {\r\n            return this._backTo(token);\r\n        }\r\n        var variable = new Variable(name);\r\n        if (this._accept(1 /* Colon */)) {\r\n            // ${foo:<children>}\r\n            while (true) {\r\n                // ...} -> done\r\n                if (this._accept(4 /* CurlyClose */)) {\r\n                    parent.appendChild(variable);\r\n                    return true;\r\n                }\r\n                if (this._parse(variable)) {\r\n                    continue;\r\n                }\r\n                // fallback\r\n                parent.appendChild(new Text('${' + name + ':'));\r\n                variable.children.forEach(parent.appendChild, parent);\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(6 /* Forwardslash */)) {\r\n            // ${foo/<regex>/<format>/<options>}\r\n            if (this._parseTransform(variable)) {\r\n                parent.appendChild(variable);\r\n                return true;\r\n            }\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        else if (this._accept(4 /* CurlyClose */)) {\r\n            // ${foo}\r\n            parent.appendChild(variable);\r\n            return true;\r\n        }\r\n        else {\r\n            // ${foo <- missing curly or colon\r\n            return this._backTo(token);\r\n        }\r\n    };\r\n    SnippetParser.prototype._parseTransform = function (parent) {\r\n        // ...<regex>/<format>/<options>}\r\n        var transform = new Transform();\r\n        var regexValue = '';\r\n        var regexOptions = '';\r\n        // (1) /regex\r\n        while (true) {\r\n            if (this._accept(6 /* Forwardslash */)) {\r\n                break;\r\n            }\r\n            var escaped = void 0;\r\n            if (escaped = this._accept(5 /* Backslash */, true)) {\r\n                escaped = this._accept(6 /* Forwardslash */, true) || escaped;\r\n                regexValue += escaped;\r\n                continue;\r\n            }\r\n            if (this._token.type !== 14 /* EOF */) {\r\n                regexValue += this._accept(undefined, true);\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        // (2) /format\r\n        while (true) {\r\n            if (this._accept(6 /* Forwardslash */)) {\r\n                break;\r\n            }\r\n            var escaped = void 0;\r\n            if (escaped = this._accept(5 /* Backslash */, true)) {\r\n                escaped = this._accept(5 /* Backslash */, true) || this._accept(6 /* Forwardslash */, true) || escaped;\r\n                transform.appendChild(new Text(escaped));\r\n                continue;\r\n            }\r\n            if (this._parseFormatString(transform) || this._parseAnything(transform)) {\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        // (3) /option\r\n        while (true) {\r\n            if (this._accept(4 /* CurlyClose */)) {\r\n                break;\r\n            }\r\n            if (this._token.type !== 14 /* EOF */) {\r\n                regexOptions += this._accept(undefined, true);\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        try {\r\n            transform.regexp = new RegExp(regexValue, regexOptions);\r\n        }\r\n        catch (e) {\r\n            // invalid regexp\r\n            return false;\r\n        }\r\n        parent.transform = transform;\r\n        return true;\r\n    };\r\n    SnippetParser.prototype._parseFormatString = function (parent) {\r\n        var token = this._token;\r\n        if (!this._accept(0 /* Dollar */)) {\r\n            return false;\r\n        }\r\n        var complex = false;\r\n        if (this._accept(3 /* CurlyOpen */)) {\r\n            complex = true;\r\n        }\r\n        var index = this._accept(8 /* Int */, true);\r\n        if (!index) {\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        else if (!complex) {\r\n            // $1\r\n            parent.appendChild(new FormatString(Number(index)));\r\n            return true;\r\n        }\r\n        else if (this._accept(4 /* CurlyClose */)) {\r\n            // ${1}\r\n            parent.appendChild(new FormatString(Number(index)));\r\n            return true;\r\n        }\r\n        else if (!this._accept(1 /* Colon */)) {\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        if (this._accept(6 /* Forwardslash */)) {\r\n            // ${1:/upcase}\r\n            var shorthand = this._accept(9 /* VariableName */, true);\r\n            if (!shorthand || !this._accept(4 /* CurlyClose */)) {\r\n                this._backTo(token);\r\n                return false;\r\n            }\r\n            else {\r\n                parent.appendChild(new FormatString(Number(index), shorthand));\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(11 /* Plus */)) {\r\n            // ${1:+<if>}\r\n            var ifValue = this._until(4 /* CurlyClose */);\r\n            if (ifValue) {\r\n                parent.appendChild(new FormatString(Number(index), undefined, ifValue, undefined));\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(12 /* Dash */)) {\r\n            // ${2:-<else>}\r\n            var elseValue = this._until(4 /* CurlyClose */);\r\n            if (elseValue) {\r\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(13 /* QuestionMark */)) {\r\n            // ${2:?<if>:<else>}\r\n            var ifValue = this._until(1 /* Colon */);\r\n            if (ifValue) {\r\n                var elseValue = this._until(4 /* CurlyClose */);\r\n                if (elseValue) {\r\n                    parent.appendChild(new FormatString(Number(index), undefined, ifValue, elseValue));\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            // ${1:<else>}\r\n            var elseValue = this._until(4 /* CurlyClose */);\r\n            if (elseValue) {\r\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\r\n                return true;\r\n            }\r\n        }\r\n        this._backTo(token);\r\n        return false;\r\n    };\r\n    SnippetParser.prototype._parseAnything = function (marker) {\r\n        if (this._token.type !== 14 /* EOF */) {\r\n            marker.appendChild(new Text(this._scanner.tokenText(this._token)));\r\n            this._accept(undefined);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return SnippetParser;\r\n}());\r\nexport { SnippetParser };\r\n","import { URI } from '../../../base/common/uri.js';\r\nexport var WORKSPACE_EXTENSION = 'code-workspace';\r\nexport function isSingleFolderWorkspaceIdentifier(obj) {\r\n    return obj instanceof URI;\r\n}\r\nexport function toWorkspaceIdentifier(workspace) {\r\n    if (workspace.configuration) {\r\n        return {\r\n            configPath: workspace.configuration,\r\n            id: workspace.id\r\n        };\r\n    }\r\n    if (workspace.folders.length === 1) {\r\n        return workspace.folders[0].uri;\r\n    }\r\n    // Empty workspace\r\n    return undefined;\r\n}\r\n//#endregion\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport * as path from '../../../base/common/path.js';\r\nimport { dirname } from '../../../base/common/resources.js';\r\nimport { Text } from './snippetParser.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { getLeadingWhitespace, commonPrefixLength, isFalsyOrWhitespace, pad, endsWith } from '../../../base/common/strings.js';\r\nimport { isSingleFolderWorkspaceIdentifier, toWorkspaceIdentifier, WORKSPACE_EXTENSION } from '../../../platform/workspaces/common/workspaces.js';\r\nimport { normalizeDriveLetter } from '../../../base/common/labels.js';\r\nvar CompositeSnippetVariableResolver = /** @class */ (function () {\r\n    function CompositeSnippetVariableResolver(_delegates) {\r\n        this._delegates = _delegates;\r\n        //\r\n    }\r\n    CompositeSnippetVariableResolver.prototype.resolve = function (variable) {\r\n        for (var _i = 0, _a = this._delegates; _i < _a.length; _i++) {\r\n            var delegate = _a[_i];\r\n            var value = delegate.resolve(variable);\r\n            if (value !== undefined) {\r\n                return value;\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    return CompositeSnippetVariableResolver;\r\n}());\r\nexport { CompositeSnippetVariableResolver };\r\nvar SelectionBasedVariableResolver = /** @class */ (function () {\r\n    function SelectionBasedVariableResolver(_model, _selection) {\r\n        this._model = _model;\r\n        this._selection = _selection;\r\n        //\r\n    }\r\n    SelectionBasedVariableResolver.prototype.resolve = function (variable) {\r\n        var name = variable.name;\r\n        if (name === 'SELECTION' || name === 'TM_SELECTED_TEXT') {\r\n            var value = this._model.getValueInRange(this._selection) || undefined;\r\n            if (value && this._selection.startLineNumber !== this._selection.endLineNumber && variable.snippet) {\r\n                // Selection is a multiline string which we indentation we now\r\n                // need to adjust. We compare the indentation of this variable\r\n                // with the indentation at the editor position and add potential\r\n                // extra indentation to the value\r\n                var line = this._model.getLineContent(this._selection.startLineNumber);\r\n                var lineLeadingWhitespace = getLeadingWhitespace(line, 0, this._selection.startColumn - 1);\r\n                var varLeadingWhitespace_1 = lineLeadingWhitespace;\r\n                variable.snippet.walk(function (marker) {\r\n                    if (marker === variable) {\r\n                        return false;\r\n                    }\r\n                    if (marker instanceof Text) {\r\n                        varLeadingWhitespace_1 = getLeadingWhitespace(marker.value.split(/\\r\\n|\\r|\\n/).pop());\r\n                    }\r\n                    return true;\r\n                });\r\n                var whitespaceCommonLength_1 = commonPrefixLength(varLeadingWhitespace_1, lineLeadingWhitespace);\r\n                value = value.replace(/(\\r\\n|\\r|\\n)(.*)/g, function (m, newline, rest) { return \"\" + newline + varLeadingWhitespace_1.substr(whitespaceCommonLength_1) + rest; });\r\n            }\r\n            return value;\r\n        }\r\n        else if (name === 'TM_CURRENT_LINE') {\r\n            return this._model.getLineContent(this._selection.positionLineNumber);\r\n        }\r\n        else if (name === 'TM_CURRENT_WORD') {\r\n            var info = this._model.getWordAtPosition({\r\n                lineNumber: this._selection.positionLineNumber,\r\n                column: this._selection.positionColumn\r\n            });\r\n            return info && info.word || undefined;\r\n        }\r\n        else if (name === 'TM_LINE_INDEX') {\r\n            return String(this._selection.positionLineNumber - 1);\r\n        }\r\n        else if (name === 'TM_LINE_NUMBER') {\r\n            return String(this._selection.positionLineNumber);\r\n        }\r\n        return undefined;\r\n    };\r\n    return SelectionBasedVariableResolver;\r\n}());\r\nexport { SelectionBasedVariableResolver };\r\nvar ModelBasedVariableResolver = /** @class */ (function () {\r\n    function ModelBasedVariableResolver(_labelService, _model) {\r\n        this._labelService = _labelService;\r\n        this._model = _model;\r\n        //\r\n    }\r\n    ModelBasedVariableResolver.prototype.resolve = function (variable) {\r\n        var name = variable.name;\r\n        if (name === 'TM_FILENAME') {\r\n            return path.basename(this._model.uri.fsPath);\r\n        }\r\n        else if (name === 'TM_FILENAME_BASE') {\r\n            var name_1 = path.basename(this._model.uri.fsPath);\r\n            var idx = name_1.lastIndexOf('.');\r\n            if (idx <= 0) {\r\n                return name_1;\r\n            }\r\n            else {\r\n                return name_1.slice(0, idx);\r\n            }\r\n        }\r\n        else if (name === 'TM_DIRECTORY' && this._labelService) {\r\n            if (path.dirname(this._model.uri.fsPath) === '.') {\r\n                return '';\r\n            }\r\n            return this._labelService.getUriLabel(dirname(this._model.uri));\r\n        }\r\n        else if (name === 'TM_FILEPATH' && this._labelService) {\r\n            return this._labelService.getUriLabel(this._model.uri);\r\n        }\r\n        return undefined;\r\n    };\r\n    return ModelBasedVariableResolver;\r\n}());\r\nexport { ModelBasedVariableResolver };\r\nvar ClipboardBasedVariableResolver = /** @class */ (function () {\r\n    function ClipboardBasedVariableResolver(_readClipboardText, _selectionIdx, _selectionCount, _spread) {\r\n        this._readClipboardText = _readClipboardText;\r\n        this._selectionIdx = _selectionIdx;\r\n        this._selectionCount = _selectionCount;\r\n        this._spread = _spread;\r\n        //\r\n    }\r\n    ClipboardBasedVariableResolver.prototype.resolve = function (variable) {\r\n        if (variable.name !== 'CLIPBOARD') {\r\n            return undefined;\r\n        }\r\n        var clipboardText = this._readClipboardText();\r\n        if (!clipboardText) {\r\n            return undefined;\r\n        }\r\n        // `spread` is assigning each cursor a line of the clipboard\r\n        // text whenever there the line count equals the cursor count\r\n        // and when enabled\r\n        if (this._spread) {\r\n            var lines = clipboardText.split(/\\r\\n|\\n|\\r/).filter(function (s) { return !isFalsyOrWhitespace(s); });\r\n            if (lines.length === this._selectionCount) {\r\n                return lines[this._selectionIdx];\r\n            }\r\n        }\r\n        return clipboardText;\r\n    };\r\n    return ClipboardBasedVariableResolver;\r\n}());\r\nexport { ClipboardBasedVariableResolver };\r\nvar CommentBasedVariableResolver = /** @class */ (function () {\r\n    function CommentBasedVariableResolver(_model) {\r\n        this._model = _model;\r\n        //\r\n    }\r\n    CommentBasedVariableResolver.prototype.resolve = function (variable) {\r\n        var name = variable.name;\r\n        var language = this._model.getLanguageIdentifier();\r\n        var config = LanguageConfigurationRegistry.getComments(language.id);\r\n        if (!config) {\r\n            return undefined;\r\n        }\r\n        if (name === 'LINE_COMMENT') {\r\n            return config.lineCommentToken || undefined;\r\n        }\r\n        else if (name === 'BLOCK_COMMENT_START') {\r\n            return config.blockCommentStartToken || undefined;\r\n        }\r\n        else if (name === 'BLOCK_COMMENT_END') {\r\n            return config.blockCommentEndToken || undefined;\r\n        }\r\n        return undefined;\r\n    };\r\n    return CommentBasedVariableResolver;\r\n}());\r\nexport { CommentBasedVariableResolver };\r\nvar TimeBasedVariableResolver = /** @class */ (function () {\r\n    function TimeBasedVariableResolver() {\r\n    }\r\n    TimeBasedVariableResolver.prototype.resolve = function (variable) {\r\n        var name = variable.name;\r\n        if (name === 'CURRENT_YEAR') {\r\n            return String(new Date().getFullYear());\r\n        }\r\n        else if (name === 'CURRENT_YEAR_SHORT') {\r\n            return String(new Date().getFullYear()).slice(-2);\r\n        }\r\n        else if (name === 'CURRENT_MONTH') {\r\n            return pad((new Date().getMonth().valueOf() + 1), 2);\r\n        }\r\n        else if (name === 'CURRENT_DATE') {\r\n            return pad(new Date().getDate().valueOf(), 2);\r\n        }\r\n        else if (name === 'CURRENT_HOUR') {\r\n            return pad(new Date().getHours().valueOf(), 2);\r\n        }\r\n        else if (name === 'CURRENT_MINUTE') {\r\n            return pad(new Date().getMinutes().valueOf(), 2);\r\n        }\r\n        else if (name === 'CURRENT_SECOND') {\r\n            return pad(new Date().getSeconds().valueOf(), 2);\r\n        }\r\n        else if (name === 'CURRENT_DAY_NAME') {\r\n            return TimeBasedVariableResolver.dayNames[new Date().getDay()];\r\n        }\r\n        else if (name === 'CURRENT_DAY_NAME_SHORT') {\r\n            return TimeBasedVariableResolver.dayNamesShort[new Date().getDay()];\r\n        }\r\n        else if (name === 'CURRENT_MONTH_NAME') {\r\n            return TimeBasedVariableResolver.monthNames[new Date().getMonth()];\r\n        }\r\n        else if (name === 'CURRENT_MONTH_NAME_SHORT') {\r\n            return TimeBasedVariableResolver.monthNamesShort[new Date().getMonth()];\r\n        }\r\n        else if (name === 'CURRENT_SECONDS_UNIX') {\r\n            return String(Math.floor(Date.now() / 1000));\r\n        }\r\n        return undefined;\r\n    };\r\n    TimeBasedVariableResolver.dayNames = [nls.localize('Sunday', \"Sunday\"), nls.localize('Monday', \"Monday\"), nls.localize('Tuesday', \"Tuesday\"), nls.localize('Wednesday', \"Wednesday\"), nls.localize('Thursday', \"Thursday\"), nls.localize('Friday', \"Friday\"), nls.localize('Saturday', \"Saturday\")];\r\n    TimeBasedVariableResolver.dayNamesShort = [nls.localize('SundayShort', \"Sun\"), nls.localize('MondayShort', \"Mon\"), nls.localize('TuesdayShort', \"Tue\"), nls.localize('WednesdayShort', \"Wed\"), nls.localize('ThursdayShort', \"Thu\"), nls.localize('FridayShort', \"Fri\"), nls.localize('SaturdayShort', \"Sat\")];\r\n    TimeBasedVariableResolver.monthNames = [nls.localize('January', \"January\"), nls.localize('February', \"February\"), nls.localize('March', \"March\"), nls.localize('April', \"April\"), nls.localize('May', \"May\"), nls.localize('June', \"June\"), nls.localize('July', \"July\"), nls.localize('August', \"August\"), nls.localize('September', \"September\"), nls.localize('October', \"October\"), nls.localize('November', \"November\"), nls.localize('December', \"December\")];\r\n    TimeBasedVariableResolver.monthNamesShort = [nls.localize('JanuaryShort', \"Jan\"), nls.localize('FebruaryShort', \"Feb\"), nls.localize('MarchShort', \"Mar\"), nls.localize('AprilShort', \"Apr\"), nls.localize('MayShort', \"May\"), nls.localize('JuneShort', \"Jun\"), nls.localize('JulyShort', \"Jul\"), nls.localize('AugustShort', \"Aug\"), nls.localize('SeptemberShort', \"Sep\"), nls.localize('OctoberShort', \"Oct\"), nls.localize('NovemberShort', \"Nov\"), nls.localize('DecemberShort', \"Dec\")];\r\n    return TimeBasedVariableResolver;\r\n}());\r\nexport { TimeBasedVariableResolver };\r\nvar WorkspaceBasedVariableResolver = /** @class */ (function () {\r\n    function WorkspaceBasedVariableResolver(_workspaceService) {\r\n        this._workspaceService = _workspaceService;\r\n        //\r\n    }\r\n    WorkspaceBasedVariableResolver.prototype.resolve = function (variable) {\r\n        if (!this._workspaceService) {\r\n            return undefined;\r\n        }\r\n        var workspaceIdentifier = toWorkspaceIdentifier(this._workspaceService.getWorkspace());\r\n        if (!workspaceIdentifier) {\r\n            return undefined;\r\n        }\r\n        if (variable.name === 'WORKSPACE_NAME') {\r\n            return this._resolveWorkspaceName(workspaceIdentifier);\r\n        }\r\n        else if (variable.name === 'WORKSPACE_FOLDER') {\r\n            return this._resoveWorkspacePath(workspaceIdentifier);\r\n        }\r\n        return undefined;\r\n    };\r\n    WorkspaceBasedVariableResolver.prototype._resolveWorkspaceName = function (workspaceIdentifier) {\r\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\r\n            return path.basename(workspaceIdentifier.path);\r\n        }\r\n        var filename = path.basename(workspaceIdentifier.configPath.path);\r\n        if (endsWith(filename, WORKSPACE_EXTENSION)) {\r\n            filename = filename.substr(0, filename.length - WORKSPACE_EXTENSION.length - 1);\r\n        }\r\n        return filename;\r\n    };\r\n    WorkspaceBasedVariableResolver.prototype._resoveWorkspacePath = function (workspaceIdentifier) {\r\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\r\n            return normalizeDriveLetter(workspaceIdentifier.fsPath);\r\n        }\r\n        var filename = path.basename(workspaceIdentifier.configPath.path);\r\n        var folderpath = workspaceIdentifier.configPath.fsPath;\r\n        if (endsWith(folderpath, filename)) {\r\n            folderpath = folderpath.substr(0, folderpath.length - filename.length - 1);\r\n        }\r\n        return (folderpath ? normalizeDriveLetter(folderpath) : '/');\r\n    };\r\n    return WorkspaceBasedVariableResolver;\r\n}());\r\nexport { WorkspaceBasedVariableResolver };\r\nvar RandomBasedVariableResolver = /** @class */ (function () {\r\n    function RandomBasedVariableResolver() {\r\n    }\r\n    RandomBasedVariableResolver.prototype.resolve = function (variable) {\r\n        var name = variable.name;\r\n        if (name === 'RANDOM') {\r\n            return Math.random().toString().slice(-6);\r\n        }\r\n        else if (name === 'RANDOM_HEX') {\r\n            return Math.random().toString(16).slice(-6);\r\n        }\r\n        return undefined;\r\n    };\r\n    return RandomBasedVariableResolver;\r\n}());\r\nexport { RandomBasedVariableResolver };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { groupBy } from '../../../base/common/arrays.js';\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport { getLeadingWhitespace } from '../../../base/common/strings.js';\r\nimport './snippetSession.css';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\r\nimport { IWorkspaceContextService } from '../../../platform/workspace/common/workspace.js';\r\nimport { optional } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { Choice, Placeholder, SnippetParser, Text } from './snippetParser.js';\r\nimport { ClipboardBasedVariableResolver, CompositeSnippetVariableResolver, ModelBasedVariableResolver, SelectionBasedVariableResolver, TimeBasedVariableResolver, CommentBasedVariableResolver, WorkspaceBasedVariableResolver, RandomBasedVariableResolver } from './snippetVariables.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport * as colors from '../../../platform/theme/common/colorRegistry.js';\r\nimport { ILabelService } from '../../../platform/label/common/label.js';\r\nregisterThemingParticipant(function (theme, collector) {\r\n    function getColorGraceful(name) {\r\n        var color = theme.getColor(name);\r\n        return color ? color.toString() : 'transparent';\r\n    }\r\n    collector.addRule(\".monaco-editor .snippet-placeholder { background-color: \" + getColorGraceful(colors.snippetTabstopHighlightBackground) + \"; outline-color: \" + getColorGraceful(colors.snippetTabstopHighlightBorder) + \"; }\");\r\n    collector.addRule(\".monaco-editor .finish-snippet-placeholder { background-color: \" + getColorGraceful(colors.snippetFinalTabstopHighlightBackground) + \"; outline-color: \" + getColorGraceful(colors.snippetFinalTabstopHighlightBorder) + \"; }\");\r\n});\r\nvar OneSnippet = /** @class */ (function () {\r\n    function OneSnippet(editor, snippet, offset) {\r\n        this._nestingLevel = 1;\r\n        this._editor = editor;\r\n        this._snippet = snippet;\r\n        this._offset = offset;\r\n        this._placeholderGroups = groupBy(snippet.placeholders, Placeholder.compareByIndex);\r\n        this._placeholderGroupsIdx = -1;\r\n    }\r\n    OneSnippet.prototype.dispose = function () {\r\n        if (this._placeholderDecorations) {\r\n            var toRemove_1 = [];\r\n            this._placeholderDecorations.forEach(function (handle) { return toRemove_1.push(handle); });\r\n            this._editor.deltaDecorations(toRemove_1, []);\r\n        }\r\n        this._placeholderGroups.length = 0;\r\n    };\r\n    OneSnippet.prototype._initDecorations = function () {\r\n        var _this = this;\r\n        if (this._placeholderDecorations) {\r\n            // already initialized\r\n            return;\r\n        }\r\n        this._placeholderDecorations = new Map();\r\n        var model = this._editor.getModel();\r\n        this._editor.changeDecorations(function (accessor) {\r\n            // create a decoration for each placeholder\r\n            for (var _i = 0, _a = _this._snippet.placeholders; _i < _a.length; _i++) {\r\n                var placeholder = _a[_i];\r\n                var placeholderOffset = _this._snippet.offset(placeholder);\r\n                var placeholderLen = _this._snippet.fullLen(placeholder);\r\n                var range = Range.fromPositions(model.getPositionAt(_this._offset + placeholderOffset), model.getPositionAt(_this._offset + placeholderOffset + placeholderLen));\r\n                var options = placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive;\r\n                var handle = accessor.addDecoration(range, options);\r\n                _this._placeholderDecorations.set(placeholder, handle);\r\n            }\r\n        });\r\n    };\r\n    OneSnippet.prototype.move = function (fwd) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return [];\r\n        }\r\n        this._initDecorations();\r\n        // Transform placeholder text if necessary\r\n        if (this._placeholderGroupsIdx >= 0) {\r\n            var operations = [];\r\n            for (var _i = 0, _a = this._placeholderGroups[this._placeholderGroupsIdx]; _i < _a.length; _i++) {\r\n                var placeholder = _a[_i];\r\n                // Check if the placeholder has a transformation\r\n                if (placeholder.transform) {\r\n                    var id = this._placeholderDecorations.get(placeholder);\r\n                    var range = this._editor.getModel().getDecorationRange(id);\r\n                    var currentValue = this._editor.getModel().getValueInRange(range);\r\n                    operations.push(EditOperation.replaceMove(range, placeholder.transform.resolve(currentValue)));\r\n                }\r\n            }\r\n            if (operations.length > 0) {\r\n                this._editor.executeEdits('snippet.placeholderTransform', operations);\r\n            }\r\n        }\r\n        var couldSkipThisPlaceholder = false;\r\n        if (fwd === true && this._placeholderGroupsIdx < this._placeholderGroups.length - 1) {\r\n            this._placeholderGroupsIdx += 1;\r\n            couldSkipThisPlaceholder = true;\r\n        }\r\n        else if (fwd === false && this._placeholderGroupsIdx > 0) {\r\n            this._placeholderGroupsIdx -= 1;\r\n            couldSkipThisPlaceholder = true;\r\n        }\r\n        else {\r\n            // the selection of the current placeholder might\r\n            // not acurate any more -> simply restore it\r\n        }\r\n        var newSelections = this._editor.getModel().changeDecorations(function (accessor) {\r\n            var activePlaceholders = new Set();\r\n            // change stickiness to always grow when typing at its edges\r\n            // because these decorations represent the currently active\r\n            // tabstop.\r\n            // Special case #1: reaching the final tabstop\r\n            // Special case #2: placeholders enclosing active placeholders\r\n            var selections = [];\r\n            for (var _i = 0, _a = _this._placeholderGroups[_this._placeholderGroupsIdx]; _i < _a.length; _i++) {\r\n                var placeholder = _a[_i];\r\n                var id = _this._placeholderDecorations.get(placeholder);\r\n                var range = _this._editor.getModel().getDecorationRange(id);\r\n                selections.push(new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn));\r\n                // consider to skip this placeholder index when the decoration\r\n                // range is empty but when the placeholder wasn't. that's a strong\r\n                // hint that the placeholder has been deleted. (all placeholder must match this)\r\n                couldSkipThisPlaceholder = couldSkipThisPlaceholder && _this._hasPlaceholderBeenCollapsed(placeholder);\r\n                accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\r\n                activePlaceholders.add(placeholder);\r\n                for (var _b = 0, _c = _this._snippet.enclosingPlaceholders(placeholder); _b < _c.length; _b++) {\r\n                    var enclosingPlaceholder = _c[_b];\r\n                    var id_1 = _this._placeholderDecorations.get(enclosingPlaceholder);\r\n                    accessor.changeDecorationOptions(id_1, enclosingPlaceholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\r\n                    activePlaceholders.add(enclosingPlaceholder);\r\n                }\r\n            }\r\n            // change stickness to never grow when typing at its edges\r\n            // so that in-active tabstops never grow\r\n            _this._placeholderDecorations.forEach(function (id, placeholder) {\r\n                if (!activePlaceholders.has(placeholder)) {\r\n                    accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive);\r\n                }\r\n            });\r\n            return selections;\r\n        });\r\n        return !couldSkipThisPlaceholder ? newSelections : this.move(fwd);\r\n    };\r\n    OneSnippet.prototype._hasPlaceholderBeenCollapsed = function (placeholder) {\r\n        // A placeholder is empty when it wasn't empty when authored but\r\n        // when its tracking decoration is empty. This also applies to all\r\n        // potential parent placeholders\r\n        var marker = placeholder;\r\n        while (marker) {\r\n            if (marker instanceof Placeholder) {\r\n                var id = this._placeholderDecorations.get(marker);\r\n                var range = this._editor.getModel().getDecorationRange(id);\r\n                if (range.isEmpty() && marker.toString().length > 0) {\r\n                    return true;\r\n                }\r\n            }\r\n            marker = marker.parent;\r\n        }\r\n        return false;\r\n    };\r\n    Object.defineProperty(OneSnippet.prototype, \"isAtFirstPlaceholder\", {\r\n        get: function () {\r\n            return this._placeholderGroupsIdx <= 0 || this._placeholderGroups.length === 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OneSnippet.prototype, \"isAtLastPlaceholder\", {\r\n        get: function () {\r\n            return this._placeholderGroupsIdx === this._placeholderGroups.length - 1;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OneSnippet.prototype, \"hasPlaceholder\", {\r\n        get: function () {\r\n            return this._snippet.placeholders.length > 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    OneSnippet.prototype.computePossibleSelections = function () {\r\n        var result = new Map();\r\n        for (var _i = 0, _a = this._placeholderGroups; _i < _a.length; _i++) {\r\n            var placeholdersWithEqualIndex = _a[_i];\r\n            var ranges = void 0;\r\n            for (var _b = 0, placeholdersWithEqualIndex_1 = placeholdersWithEqualIndex; _b < placeholdersWithEqualIndex_1.length; _b++) {\r\n                var placeholder = placeholdersWithEqualIndex_1[_b];\r\n                if (placeholder.isFinalTabstop) {\r\n                    // ignore those\r\n                    break;\r\n                }\r\n                if (!ranges) {\r\n                    ranges = [];\r\n                    result.set(placeholder.index, ranges);\r\n                }\r\n                var id = this._placeholderDecorations.get(placeholder);\r\n                var range = this._editor.getModel().getDecorationRange(id);\r\n                if (!range) {\r\n                    // one of the placeholder lost its decoration and\r\n                    // therefore we bail out and pretend the placeholder\r\n                    // (with its mirrors) doesn't exist anymore.\r\n                    result.delete(placeholder.index);\r\n                    break;\r\n                }\r\n                ranges.push(range);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    Object.defineProperty(OneSnippet.prototype, \"choice\", {\r\n        get: function () {\r\n            return this._placeholderGroups[this._placeholderGroupsIdx][0].choice;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    OneSnippet.prototype.merge = function (others) {\r\n        var _this = this;\r\n        var model = this._editor.getModel();\r\n        this._nestingLevel *= 10;\r\n        this._editor.changeDecorations(function (accessor) {\r\n            // For each active placeholder take one snippet and merge it\r\n            // in that the placeholder (can be many for `$1foo$1foo`). Because\r\n            // everything is sorted by editor selection we can simply remove\r\n            // elements from the beginning of the array\r\n            for (var _i = 0, _a = _this._placeholderGroups[_this._placeholderGroupsIdx]; _i < _a.length; _i++) {\r\n                var placeholder = _a[_i];\r\n                var nested = others.shift();\r\n                console.assert(!nested._placeholderDecorations);\r\n                // Massage placeholder-indicies of the nested snippet to be\r\n                // sorted right after the insertion point. This ensures we move\r\n                // through the placeholders in the correct order\r\n                var indexLastPlaceholder = nested._snippet.placeholderInfo.last.index;\r\n                for (var _b = 0, _c = nested._snippet.placeholderInfo.all; _b < _c.length; _b++) {\r\n                    var nestedPlaceholder = _c[_b];\r\n                    if (nestedPlaceholder.isFinalTabstop) {\r\n                        nestedPlaceholder.index = placeholder.index + ((indexLastPlaceholder + 1) / _this._nestingLevel);\r\n                    }\r\n                    else {\r\n                        nestedPlaceholder.index = placeholder.index + (nestedPlaceholder.index / _this._nestingLevel);\r\n                    }\r\n                }\r\n                _this._snippet.replace(placeholder, nested._snippet.children);\r\n                // Remove the placeholder at which position are inserting\r\n                // the snippet and also remove its decoration.\r\n                var id = _this._placeholderDecorations.get(placeholder);\r\n                accessor.removeDecoration(id);\r\n                _this._placeholderDecorations.delete(placeholder);\r\n                // For each *new* placeholder we create decoration to monitor\r\n                // how and if it grows/shrinks.\r\n                for (var _d = 0, _e = nested._snippet.placeholders; _d < _e.length; _d++) {\r\n                    var placeholder_1 = _e[_d];\r\n                    var placeholderOffset = nested._snippet.offset(placeholder_1);\r\n                    var placeholderLen = nested._snippet.fullLen(placeholder_1);\r\n                    var range = Range.fromPositions(model.getPositionAt(nested._offset + placeholderOffset), model.getPositionAt(nested._offset + placeholderOffset + placeholderLen));\r\n                    var handle = accessor.addDecoration(range, OneSnippet._decor.inactive);\r\n                    _this._placeholderDecorations.set(placeholder_1, handle);\r\n                }\r\n            }\r\n            // Last, re-create the placeholder groups by sorting placeholders by their index.\r\n            _this._placeholderGroups = groupBy(_this._snippet.placeholders, Placeholder.compareByIndex);\r\n        });\r\n    };\r\n    OneSnippet._decor = {\r\n        active: ModelDecorationOptions.register({ stickiness: 0 /* AlwaysGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\r\n        inactive: ModelDecorationOptions.register({ stickiness: 1 /* NeverGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\r\n        activeFinal: ModelDecorationOptions.register({ stickiness: 1 /* NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\r\n        inactiveFinal: ModelDecorationOptions.register({ stickiness: 1 /* NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\r\n    };\r\n    return OneSnippet;\r\n}());\r\nexport { OneSnippet };\r\nvar _defaultOptions = {\r\n    overwriteBefore: 0,\r\n    overwriteAfter: 0,\r\n    adjustWhitespace: true,\r\n    clipboardText: undefined\r\n};\r\nvar SnippetSession = /** @class */ (function () {\r\n    function SnippetSession(editor, template, options) {\r\n        if (options === void 0) { options = _defaultOptions; }\r\n        this._templateMerges = [];\r\n        this._snippets = [];\r\n        this._editor = editor;\r\n        this._template = template;\r\n        this._options = options;\r\n    }\r\n    SnippetSession.adjustWhitespace = function (model, position, snippet, adjustIndentation, adjustNewlines) {\r\n        var line = model.getLineContent(position.lineNumber);\r\n        var lineLeadingWhitespace = getLeadingWhitespace(line, 0, position.column - 1);\r\n        snippet.walk(function (marker) {\r\n            if (marker instanceof Text && !(marker.parent instanceof Choice)) {\r\n                // adjust indentation of text markers, except for choise elements\r\n                // which get adjusted when being selected\r\n                var lines = marker.value.split(/\\r\\n|\\r|\\n/);\r\n                if (adjustIndentation) {\r\n                    for (var i = 1; i < lines.length; i++) {\r\n                        var templateLeadingWhitespace = getLeadingWhitespace(lines[i]);\r\n                        lines[i] = model.normalizeIndentation(lineLeadingWhitespace + templateLeadingWhitespace) + lines[i].substr(templateLeadingWhitespace.length);\r\n                    }\r\n                }\r\n                if (adjustNewlines) {\r\n                    var newValue = lines.join(model.getEOL());\r\n                    if (newValue !== marker.value) {\r\n                        marker.parent.replace(marker, [new Text(newValue)]);\r\n                    }\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n    };\r\n    SnippetSession.adjustSelection = function (model, selection, overwriteBefore, overwriteAfter) {\r\n        if (overwriteBefore !== 0 || overwriteAfter !== 0) {\r\n            // overwrite[Before|After] is compute using the position, not the whole\r\n            // selection. therefore we adjust the selection around that position\r\n            var positionLineNumber = selection.positionLineNumber, positionColumn = selection.positionColumn;\r\n            var positionColumnBefore = positionColumn - overwriteBefore;\r\n            var positionColumnAfter = positionColumn + overwriteAfter;\r\n            var range = model.validateRange({\r\n                startLineNumber: positionLineNumber,\r\n                startColumn: positionColumnBefore,\r\n                endLineNumber: positionLineNumber,\r\n                endColumn: positionColumnAfter\r\n            });\r\n            selection = Selection.createWithDirection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn, selection.getDirection());\r\n        }\r\n        return selection;\r\n    };\r\n    SnippetSession.createEditsAndSnippets = function (editor, template, overwriteBefore, overwriteAfter, enforceFinalTabstop, adjustWhitespace, clipboardText) {\r\n        var edits = [];\r\n        var snippets = [];\r\n        if (!editor.hasModel()) {\r\n            return { edits: edits, snippets: snippets };\r\n        }\r\n        var model = editor.getModel();\r\n        var workspaceService = editor.invokeWithinContext(function (accessor) { return accessor.get(IWorkspaceContextService, optional); });\r\n        var modelBasedVariableResolver = editor.invokeWithinContext(function (accessor) { return new ModelBasedVariableResolver(accessor.get(ILabelService, optional), model); });\r\n        var clipboardService = editor.invokeWithinContext(function (accessor) { return accessor.get(IClipboardService, optional); });\r\n        var readClipboardText = function () { return clipboardText || clipboardService && clipboardService.readTextSync(); };\r\n        var delta = 0;\r\n        // know what text the overwrite[Before|After] extensions\r\n        // of the primary curser have selected because only when\r\n        // secondary selections extend to the same text we can grow them\r\n        var firstBeforeText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), overwriteBefore, 0));\r\n        var firstAfterText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), 0, overwriteAfter));\r\n        // remember the first non-whitespace column to decide if\r\n        // `keepWhitespace` should be overruled for secondary selections\r\n        var firstLineFirstNonWhitespace = model.getLineFirstNonWhitespaceColumn(editor.getSelection().positionLineNumber);\r\n        // sort selections by their start position but remeber\r\n        // the original index. that allows you to create correct\r\n        // offset-based selection logic without changing the\r\n        // primary selection\r\n        var indexedSelections = editor.getSelections()\r\n            .map(function (selection, idx) { return ({ selection: selection, idx: idx }); })\r\n            .sort(function (a, b) { return Range.compareRangesUsingStarts(a.selection, b.selection); });\r\n        for (var _i = 0, indexedSelections_1 = indexedSelections; _i < indexedSelections_1.length; _i++) {\r\n            var _a = indexedSelections_1[_i], selection = _a.selection, idx = _a.idx;\r\n            // extend selection with the `overwriteBefore` and `overwriteAfter` and then\r\n            // compare if this matches the extensions of the primary selection\r\n            var extensionBefore = SnippetSession.adjustSelection(model, selection, overwriteBefore, 0);\r\n            var extensionAfter = SnippetSession.adjustSelection(model, selection, 0, overwriteAfter);\r\n            if (firstBeforeText !== model.getValueInRange(extensionBefore)) {\r\n                extensionBefore = selection;\r\n            }\r\n            if (firstAfterText !== model.getValueInRange(extensionAfter)) {\r\n                extensionAfter = selection;\r\n            }\r\n            // merge the before and after selection into one\r\n            var snippetSelection = selection\r\n                .setStartPosition(extensionBefore.startLineNumber, extensionBefore.startColumn)\r\n                .setEndPosition(extensionAfter.endLineNumber, extensionAfter.endColumn);\r\n            var snippet = new SnippetParser().parse(template, true, enforceFinalTabstop);\r\n            // adjust the template string to match the indentation and\r\n            // whitespace rules of this insert location (can be different for each cursor)\r\n            // happens when being asked for (default) or when this is a secondary\r\n            // cursor and the leading whitespace is different\r\n            var start = snippetSelection.getStartPosition();\r\n            SnippetSession.adjustWhitespace(model, start, snippet, adjustWhitespace || (idx > 0 && firstLineFirstNonWhitespace !== model.getLineFirstNonWhitespaceColumn(selection.positionLineNumber)), true);\r\n            snippet.resolveVariables(new CompositeSnippetVariableResolver([\r\n                modelBasedVariableResolver,\r\n                new ClipboardBasedVariableResolver(readClipboardText, idx, indexedSelections.length, editor.getOption(58 /* multiCursorPaste */) === 'spread'),\r\n                new SelectionBasedVariableResolver(model, selection),\r\n                new CommentBasedVariableResolver(model),\r\n                new TimeBasedVariableResolver,\r\n                new WorkspaceBasedVariableResolver(workspaceService),\r\n                new RandomBasedVariableResolver,\r\n            ]));\r\n            var offset = model.getOffsetAt(start) + delta;\r\n            delta += snippet.toString().length - model.getValueLengthInRange(snippetSelection);\r\n            // store snippets with the index of their originating selection.\r\n            // that ensures the primiary cursor stays primary despite not being\r\n            // the one with lowest start position\r\n            edits[idx] = EditOperation.replace(snippetSelection, snippet.toString());\r\n            snippets[idx] = new OneSnippet(editor, snippet, offset);\r\n        }\r\n        return { edits: edits, snippets: snippets };\r\n    };\r\n    SnippetSession.prototype.dispose = function () {\r\n        dispose(this._snippets);\r\n    };\r\n    SnippetSession.prototype._logInfo = function () {\r\n        return \"template=\\\"\" + this._template + \"\\\", merged_templates=\\\"\" + this._templateMerges.join(' -> ') + \"\\\"\";\r\n    };\r\n    SnippetSession.prototype.insert = function () {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        // make insert edit and start with first selections\r\n        var _a = SnippetSession.createEditsAndSnippets(this._editor, this._template, this._options.overwriteBefore, this._options.overwriteAfter, false, this._options.adjustWhitespace, this._options.clipboardText), edits = _a.edits, snippets = _a.snippets;\r\n        this._snippets = snippets;\r\n        this._editor.executeEdits('snippet', edits, function (undoEdits) {\r\n            if (_this._snippets[0].hasPlaceholder) {\r\n                return _this._move(true);\r\n            }\r\n            else {\r\n                return undoEdits.map(function (edit) { return Selection.fromPositions(edit.range.getEndPosition()); });\r\n            }\r\n        });\r\n        this._editor.revealRange(this._editor.getSelections()[0]);\r\n    };\r\n    SnippetSession.prototype.merge = function (template, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = _defaultOptions; }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        this._templateMerges.push([this._snippets[0]._nestingLevel, this._snippets[0]._placeholderGroupsIdx, template]);\r\n        var _a = SnippetSession.createEditsAndSnippets(this._editor, template, options.overwriteBefore, options.overwriteAfter, true, options.adjustWhitespace, options.clipboardText), edits = _a.edits, snippets = _a.snippets;\r\n        this._editor.executeEdits('snippet', edits, function (undoEdits) {\r\n            for (var _i = 0, _a = _this._snippets; _i < _a.length; _i++) {\r\n                var snippet = _a[_i];\r\n                snippet.merge(snippets);\r\n            }\r\n            console.assert(snippets.length === 0);\r\n            if (_this._snippets[0].hasPlaceholder) {\r\n                return _this._move(undefined);\r\n            }\r\n            else {\r\n                return undoEdits.map(function (edit) { return Selection.fromPositions(edit.range.getEndPosition()); });\r\n            }\r\n        });\r\n    };\r\n    SnippetSession.prototype.next = function () {\r\n        var newSelections = this._move(true);\r\n        this._editor.setSelections(newSelections);\r\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\r\n    };\r\n    SnippetSession.prototype.prev = function () {\r\n        var newSelections = this._move(false);\r\n        this._editor.setSelections(newSelections);\r\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\r\n    };\r\n    SnippetSession.prototype._move = function (fwd) {\r\n        var selections = [];\r\n        for (var _i = 0, _a = this._snippets; _i < _a.length; _i++) {\r\n            var snippet = _a[_i];\r\n            var oneSelection = snippet.move(fwd);\r\n            selections.push.apply(selections, oneSelection);\r\n        }\r\n        return selections;\r\n    };\r\n    Object.defineProperty(SnippetSession.prototype, \"isAtFirstPlaceholder\", {\r\n        get: function () {\r\n            return this._snippets[0].isAtFirstPlaceholder;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SnippetSession.prototype, \"isAtLastPlaceholder\", {\r\n        get: function () {\r\n            return this._snippets[0].isAtLastPlaceholder;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SnippetSession.prototype, \"hasPlaceholder\", {\r\n        get: function () {\r\n            return this._snippets[0].hasPlaceholder;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SnippetSession.prototype, \"choice\", {\r\n        get: function () {\r\n            return this._snippets[0].choice;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SnippetSession.prototype.isSelectionWithinPlaceholders = function () {\r\n        if (!this.hasPlaceholder) {\r\n            return false;\r\n        }\r\n        var selections = this._editor.getSelections();\r\n        if (selections.length < this._snippets.length) {\r\n            // this means we started snippet mode with N\r\n            // selections and have M (N > M) selections.\r\n            // So one snippet is without selection -> cancel\r\n            return false;\r\n        }\r\n        var allPossibleSelections = new Map();\r\n        var _loop_1 = function (snippet) {\r\n            var possibleSelections = snippet.computePossibleSelections();\r\n            // for the first snippet find the placeholder (and its ranges)\r\n            // that contain at least one selection. for all remaining snippets\r\n            // the same placeholder (and their ranges) must be used.\r\n            if (allPossibleSelections.size === 0) {\r\n                possibleSelections.forEach(function (ranges, index) {\r\n                    ranges.sort(Range.compareRangesUsingStarts);\r\n                    for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n                        var selection = selections_1[_i];\r\n                        if (ranges[0].containsRange(selection)) {\r\n                            allPossibleSelections.set(index, []);\r\n                            break;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n            if (allPossibleSelections.size === 0) {\r\n                return { value: false };\r\n            }\r\n            // add selections from 'this' snippet so that we know all\r\n            // selections for this placeholder\r\n            allPossibleSelections.forEach(function (array, index) {\r\n                array.push.apply(array, possibleSelections.get(index));\r\n            });\r\n        };\r\n        for (var _i = 0, _a = this._snippets; _i < _a.length; _i++) {\r\n            var snippet = _a[_i];\r\n            var state_1 = _loop_1(snippet);\r\n            if (typeof state_1 === \"object\")\r\n                return state_1.value;\r\n        }\r\n        // sort selections (and later placeholder-ranges). then walk both\r\n        // arrays and make sure the placeholder-ranges contain the corresponding\r\n        // selection\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        allPossibleSelections.forEach(function (ranges, index) {\r\n            if (ranges.length !== selections.length) {\r\n                allPossibleSelections.delete(index);\r\n                return;\r\n            }\r\n            ranges.sort(Range.compareRangesUsingStarts);\r\n            for (var i = 0; i < ranges.length; i++) {\r\n                if (!ranges[i].containsRange(selections[i])) {\r\n                    allPossibleSelections.delete(index);\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n        // from all possible selections we have deleted those\r\n        // that don't match with the current selection. if we don't\r\n        // have any left, we don't have a selection anymore\r\n        return allPossibleSelections.size > 0;\r\n    };\r\n    return SnippetSession;\r\n}());\r\nexport { SnippetSession };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { repeat } from '../../../base/common/strings.js';\r\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { showSimpleSuggestions } from '../suggest/suggest.js';\r\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { ILogService } from '../../../platform/log/common/log.js';\r\nimport { SnippetSession } from './snippetSession.js';\r\nvar _defaultOptions = {\r\n    overwriteBefore: 0,\r\n    overwriteAfter: 0,\r\n    undoStopBefore: true,\r\n    undoStopAfter: true,\r\n    adjustWhitespace: true,\r\n    clipboardText: undefined\r\n};\r\nvar SnippetController2 = /** @class */ (function () {\r\n    function SnippetController2(_editor, _logService, contextKeyService) {\r\n        this._editor = _editor;\r\n        this._logService = _logService;\r\n        this._snippetListener = new DisposableStore();\r\n        this._modelVersionId = -1;\r\n        this._inSnippet = SnippetController2.InSnippetMode.bindTo(contextKeyService);\r\n        this._hasNextTabstop = SnippetController2.HasNextTabstop.bindTo(contextKeyService);\r\n        this._hasPrevTabstop = SnippetController2.HasPrevTabstop.bindTo(contextKeyService);\r\n    }\r\n    SnippetController2.get = function (editor) {\r\n        return editor.getContribution(SnippetController2.ID);\r\n    };\r\n    SnippetController2.prototype.dispose = function () {\r\n        this._inSnippet.reset();\r\n        this._hasPrevTabstop.reset();\r\n        this._hasNextTabstop.reset();\r\n        dispose(this._session);\r\n        this._snippetListener.dispose();\r\n    };\r\n    SnippetController2.prototype.insert = function (template, opts) {\r\n        // this is here to find out more about the yet-not-understood\r\n        // error that sometimes happens when we fail to inserted a nested\r\n        // snippet\r\n        try {\r\n            this._doInsert(template, typeof opts === 'undefined' ? _defaultOptions : __assign(__assign({}, _defaultOptions), opts));\r\n        }\r\n        catch (e) {\r\n            this.cancel();\r\n            this._logService.error(e);\r\n            this._logService.error('snippet_error');\r\n            this._logService.error('insert_template=', template);\r\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\r\n        }\r\n    };\r\n    SnippetController2.prototype._doInsert = function (template, opts) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        // don't listen while inserting the snippet\r\n        // as that is the inflight state causing cancelation\r\n        this._snippetListener.clear();\r\n        if (opts.undoStopBefore) {\r\n            this._editor.getModel().pushStackElement();\r\n        }\r\n        if (!this._session) {\r\n            this._modelVersionId = this._editor.getModel().getAlternativeVersionId();\r\n            this._session = new SnippetSession(this._editor, template, opts);\r\n            this._session.insert();\r\n        }\r\n        else {\r\n            this._session.merge(template, opts);\r\n        }\r\n        if (opts.undoStopAfter) {\r\n            this._editor.getModel().pushStackElement();\r\n        }\r\n        this._updateState();\r\n        this._snippetListener.add(this._editor.onDidChangeModelContent(function (e) { return e.isFlush && _this.cancel(); }));\r\n        this._snippetListener.add(this._editor.onDidChangeModel(function () { return _this.cancel(); }));\r\n        this._snippetListener.add(this._editor.onDidChangeCursorSelection(function () { return _this._updateState(); }));\r\n    };\r\n    SnippetController2.prototype._updateState = function () {\r\n        if (!this._session || !this._editor.hasModel()) {\r\n            // canceled in the meanwhile\r\n            return;\r\n        }\r\n        if (this._modelVersionId === this._editor.getModel().getAlternativeVersionId()) {\r\n            // undo until the 'before' state happened\r\n            // and makes use cancel snippet mode\r\n            return this.cancel();\r\n        }\r\n        if (!this._session.hasPlaceholder) {\r\n            // don't listen for selection changes and don't\r\n            // update context keys when the snippet is plain text\r\n            return this.cancel();\r\n        }\r\n        if (this._session.isAtLastPlaceholder || !this._session.isSelectionWithinPlaceholders()) {\r\n            return this.cancel();\r\n        }\r\n        this._inSnippet.set(true);\r\n        this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder);\r\n        this._hasNextTabstop.set(!this._session.isAtLastPlaceholder);\r\n        this._handleChoice();\r\n    };\r\n    SnippetController2.prototype._handleChoice = function () {\r\n        var _this = this;\r\n        if (!this._session || !this._editor.hasModel()) {\r\n            this._currentChoice = undefined;\r\n            return;\r\n        }\r\n        var choice = this._session.choice;\r\n        if (!choice) {\r\n            this._currentChoice = undefined;\r\n            return;\r\n        }\r\n        if (this._currentChoice !== choice) {\r\n            this._currentChoice = choice;\r\n            this._editor.setSelections(this._editor.getSelections()\r\n                .map(function (s) { return Selection.fromPositions(s.getStartPosition()); }));\r\n            var first_1 = choice.options[0];\r\n            showSimpleSuggestions(this._editor, choice.options.map(function (option, i) {\r\n                // let before = choice.options.slice(0, i);\r\n                // let after = choice.options.slice(i);\r\n                return {\r\n                    kind: 13 /* Value */,\r\n                    label: option.value,\r\n                    insertText: option.value,\r\n                    // insertText: `\\${1|${after.concat(before).join(',')}|}$0`,\r\n                    // snippetType: 'textmate',\r\n                    sortText: repeat('a', i + 1),\r\n                    range: Range.fromPositions(_this._editor.getPosition(), _this._editor.getPosition().delta(0, first_1.value.length))\r\n                };\r\n            }));\r\n        }\r\n    };\r\n    SnippetController2.prototype.finish = function () {\r\n        while (this._inSnippet.get()) {\r\n            this.next();\r\n        }\r\n    };\r\n    SnippetController2.prototype.cancel = function (resetSelection) {\r\n        if (resetSelection === void 0) { resetSelection = false; }\r\n        this._inSnippet.reset();\r\n        this._hasPrevTabstop.reset();\r\n        this._hasNextTabstop.reset();\r\n        this._snippetListener.clear();\r\n        dispose(this._session);\r\n        this._session = undefined;\r\n        this._modelVersionId = -1;\r\n        if (resetSelection) {\r\n            // reset selection to the primary cursor when being asked\r\n            // for. this happens when explicitly cancelling snippet mode,\r\n            // e.g. when pressing ESC\r\n            this._editor.setSelections([this._editor.getSelection()]);\r\n        }\r\n    };\r\n    SnippetController2.prototype.prev = function () {\r\n        if (this._session) {\r\n            this._session.prev();\r\n        }\r\n        this._updateState();\r\n    };\r\n    SnippetController2.prototype.next = function () {\r\n        if (this._session) {\r\n            this._session.next();\r\n        }\r\n        this._updateState();\r\n    };\r\n    SnippetController2.prototype.isInSnippet = function () {\r\n        return Boolean(this._inSnippet.get());\r\n    };\r\n    SnippetController2.ID = 'snippetController2';\r\n    SnippetController2.InSnippetMode = new RawContextKey('inSnippetMode', false);\r\n    SnippetController2.HasNextTabstop = new RawContextKey('hasNextTabstop', false);\r\n    SnippetController2.HasPrevTabstop = new RawContextKey('hasPrevTabstop', false);\r\n    SnippetController2 = __decorate([\r\n        __param(1, ILogService),\r\n        __param(2, IContextKeyService)\r\n    ], SnippetController2);\r\n    return SnippetController2;\r\n}());\r\nexport { SnippetController2 };\r\nregisterEditorContribution(SnippetController2.ID, SnippetController2);\r\nvar CommandCtor = EditorCommand.bindToContribution(SnippetController2.get);\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'jumpToNextSnippetPlaceholder',\r\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasNextTabstop),\r\n    handler: function (ctrl) { return ctrl.next(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        kbExpr: EditorContextKeys.editorTextFocus,\r\n        primary: 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'jumpToPrevSnippetPlaceholder',\r\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasPrevTabstop),\r\n    handler: function (ctrl) { return ctrl.prev(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        kbExpr: EditorContextKeys.editorTextFocus,\r\n        primary: 1024 /* Shift */ | 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'leaveSnippet',\r\n    precondition: SnippetController2.InSnippetMode,\r\n    handler: function (ctrl) { return ctrl.cancel(true); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        kbExpr: EditorContextKeys.editorTextFocus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'acceptSnippet',\r\n    precondition: SnippetController2.InSnippetMode,\r\n    handler: function (ctrl) { return ctrl.finish(); },\r\n}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { LRUCache, TernarySearchTree } from '../../../base/common/map.js';\r\nimport { IStorageService, WillSaveStateReason } from '../../../platform/storage/common/storage.js';\r\nimport { completionKindFromString } from '../../common/modes.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nvar Memory = /** @class */ (function () {\r\n    function Memory() {\r\n    }\r\n    Memory.prototype.select = function (model, pos, items) {\r\n        if (items.length === 0) {\r\n            return 0;\r\n        }\r\n        var topScore = items[0].score[0];\r\n        for (var i = 1; i < items.length; i++) {\r\n            var _a = items[i], score = _a.score, suggestion = _a.completion;\r\n            if (score[0] !== topScore) {\r\n                // stop when leaving the group of top matches\r\n                break;\r\n            }\r\n            if (suggestion.preselect) {\r\n                // stop when seeing an auto-select-item\r\n                return i;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    return Memory;\r\n}());\r\nexport { Memory };\r\nvar NoMemory = /** @class */ (function (_super) {\r\n    __extends(NoMemory, _super);\r\n    function NoMemory() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    NoMemory.prototype.memorize = function (model, pos, item) {\r\n        // no-op\r\n    };\r\n    NoMemory.prototype.toJSON = function () {\r\n        return undefined;\r\n    };\r\n    NoMemory.prototype.fromJSON = function () {\r\n        //\r\n    };\r\n    return NoMemory;\r\n}(Memory));\r\nexport { NoMemory };\r\nvar LRUMemory = /** @class */ (function (_super) {\r\n    __extends(LRUMemory, _super);\r\n    function LRUMemory() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._cache = new LRUCache(300, 0.66);\r\n        _this._seq = 0;\r\n        return _this;\r\n    }\r\n    LRUMemory.prototype.memorize = function (model, pos, item) {\r\n        var label = item.completion.label;\r\n        var key = model.getLanguageIdentifier().language + \"/\" + label;\r\n        this._cache.set(key, {\r\n            touch: this._seq++,\r\n            type: item.completion.kind,\r\n            insertText: item.completion.insertText\r\n        });\r\n    };\r\n    LRUMemory.prototype.select = function (model, pos, items) {\r\n        if (items.length === 0) {\r\n            return 0;\r\n        }\r\n        var lineSuffix = model.getLineContent(pos.lineNumber).substr(pos.column - 10, pos.column - 1);\r\n        if (/\\s$/.test(lineSuffix)) {\r\n            return _super.prototype.select.call(this, model, pos, items);\r\n        }\r\n        var topScore = items[0].score[0];\r\n        var indexPreselect = -1;\r\n        var indexRecency = -1;\r\n        var seq = -1;\r\n        for (var i = 0; i < items.length; i++) {\r\n            if (items[i].score[0] !== topScore) {\r\n                // consider only top items\r\n                break;\r\n            }\r\n            var key = model.getLanguageIdentifier().language + \"/\" + items[i].completion.label;\r\n            var item = this._cache.peek(key);\r\n            if (item && item.touch > seq && item.type === items[i].completion.kind && item.insertText === items[i].completion.insertText) {\r\n                seq = item.touch;\r\n                indexRecency = i;\r\n            }\r\n            if (items[i].completion.preselect && indexPreselect === -1) {\r\n                // stop when seeing an auto-select-item\r\n                return indexPreselect = i;\r\n            }\r\n        }\r\n        if (indexRecency !== -1) {\r\n            return indexRecency;\r\n        }\r\n        else if (indexPreselect !== -1) {\r\n            return indexPreselect;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    LRUMemory.prototype.toJSON = function () {\r\n        var data = [];\r\n        this._cache.forEach(function (value, key) {\r\n            data.push([key, value]);\r\n        });\r\n        return data;\r\n    };\r\n    LRUMemory.prototype.fromJSON = function (data) {\r\n        this._cache.clear();\r\n        var seq = 0;\r\n        for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\r\n            var _a = data_1[_i], key = _a[0], value = _a[1];\r\n            value.touch = seq;\r\n            value.type = typeof value.type === 'number' ? value.type : completionKindFromString(value.type);\r\n            this._cache.set(key, value);\r\n        }\r\n        this._seq = this._cache.size;\r\n    };\r\n    return LRUMemory;\r\n}(Memory));\r\nexport { LRUMemory };\r\nvar PrefixMemory = /** @class */ (function (_super) {\r\n    __extends(PrefixMemory, _super);\r\n    function PrefixMemory() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._trie = TernarySearchTree.forStrings();\r\n        _this._seq = 0;\r\n        return _this;\r\n    }\r\n    PrefixMemory.prototype.memorize = function (model, pos, item) {\r\n        var word = model.getWordUntilPosition(pos).word;\r\n        var key = model.getLanguageIdentifier().language + \"/\" + word;\r\n        this._trie.set(key, {\r\n            type: item.completion.kind,\r\n            insertText: item.completion.insertText,\r\n            touch: this._seq++\r\n        });\r\n    };\r\n    PrefixMemory.prototype.select = function (model, pos, items) {\r\n        var word = model.getWordUntilPosition(pos).word;\r\n        if (!word) {\r\n            return _super.prototype.select.call(this, model, pos, items);\r\n        }\r\n        var key = model.getLanguageIdentifier().language + \"/\" + word;\r\n        var item = this._trie.get(key);\r\n        if (!item) {\r\n            item = this._trie.findSubstr(key);\r\n        }\r\n        if (item) {\r\n            for (var i = 0; i < items.length; i++) {\r\n                var _a = items[i].completion, kind = _a.kind, insertText = _a.insertText;\r\n                if (kind === item.type && insertText === item.insertText) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        return _super.prototype.select.call(this, model, pos, items);\r\n    };\r\n    PrefixMemory.prototype.toJSON = function () {\r\n        var entries = [];\r\n        this._trie.forEach(function (value, key) { return entries.push([key, value]); });\r\n        // sort by last recently used (touch), then\r\n        // take the top 200 item and normalize their\r\n        // touch\r\n        entries\r\n            .sort(function (a, b) { return -(a[1].touch - b[1].touch); })\r\n            .forEach(function (value, i) { return value[1].touch = i; });\r\n        return entries.slice(0, 200);\r\n    };\r\n    PrefixMemory.prototype.fromJSON = function (data) {\r\n        this._trie.clear();\r\n        if (data.length > 0) {\r\n            this._seq = data[0][1].touch + 1;\r\n            for (var _i = 0, data_2 = data; _i < data_2.length; _i++) {\r\n                var _a = data_2[_i], key = _a[0], value = _a[1];\r\n                value.type = typeof value.type === 'number' ? value.type : completionKindFromString(value.type);\r\n                this._trie.set(key, value);\r\n            }\r\n        }\r\n    };\r\n    return PrefixMemory;\r\n}(Memory));\r\nexport { PrefixMemory };\r\nvar SuggestMemoryService = /** @class */ (function (_super) {\r\n    __extends(SuggestMemoryService, _super);\r\n    function SuggestMemoryService(_storageService, _configService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._storageService = _storageService;\r\n        _this._configService = _configService;\r\n        _this._storagePrefix = 'suggest/memories';\r\n        var update = function () {\r\n            var mode = _this._configService.getValue('editor.suggestSelection');\r\n            var share = _this._configService.getValue('editor.suggest.shareSuggestSelections');\r\n            _this._update(mode, share, false);\r\n        };\r\n        _this._persistSoon = _this._register(new RunOnceScheduler(function () { return _this._saveState(); }, 500));\r\n        _this._register(_storageService.onWillSaveState(function (e) {\r\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\r\n                _this._saveState();\r\n            }\r\n        }));\r\n        _this._register(_this._configService.onDidChangeConfiguration(function (e) {\r\n            if (e.affectsConfiguration('editor.suggestSelection') || e.affectsConfiguration('editor.suggest.shareSuggestSelections')) {\r\n                update();\r\n            }\r\n        }));\r\n        _this._register(_this._storageService.onDidChangeStorage(function (e) {\r\n            if (e.scope === 0 /* GLOBAL */ && e.key.indexOf(_this._storagePrefix) === 0) {\r\n                if (!document.hasFocus()) {\r\n                    // windows that aren't focused have to drop their current\r\n                    // storage value and accept what's stored now\r\n                    _this._update(_this._mode, _this._shareMem, true);\r\n                }\r\n            }\r\n        }));\r\n        update();\r\n        return _this;\r\n    }\r\n    SuggestMemoryService.prototype._update = function (mode, shareMem, force) {\r\n        if (!force && this._mode === mode && this._shareMem === shareMem) {\r\n            return;\r\n        }\r\n        this._shareMem = shareMem;\r\n        this._mode = mode;\r\n        this._strategy = mode === 'recentlyUsedByPrefix' ? new PrefixMemory() : mode === 'recentlyUsed' ? new LRUMemory() : new NoMemory();\r\n        try {\r\n            var scope = shareMem ? 0 /* GLOBAL */ : 1 /* WORKSPACE */;\r\n            var raw = this._storageService.get(this._storagePrefix + \"/\" + this._mode, scope);\r\n            if (raw) {\r\n                this._strategy.fromJSON(JSON.parse(raw));\r\n            }\r\n        }\r\n        catch (e) {\r\n            // things can go wrong with JSON...\r\n        }\r\n    };\r\n    SuggestMemoryService.prototype.memorize = function (model, pos, item) {\r\n        this._strategy.memorize(model, pos, item);\r\n        this._persistSoon.schedule();\r\n    };\r\n    SuggestMemoryService.prototype.select = function (model, pos, items) {\r\n        return this._strategy.select(model, pos, items);\r\n    };\r\n    SuggestMemoryService.prototype._saveState = function () {\r\n        var raw = JSON.stringify(this._strategy);\r\n        var scope = this._shareMem ? 0 /* GLOBAL */ : 1 /* WORKSPACE */;\r\n        this._storageService.store(this._storagePrefix + \"/\" + this._mode, raw, scope);\r\n    };\r\n    SuggestMemoryService = __decorate([\r\n        __param(0, IStorageService),\r\n        __param(1, IConfigurationService)\r\n    ], SuggestMemoryService);\r\n    return SuggestMemoryService;\r\n}(Disposable));\r\nexport { SuggestMemoryService };\r\nexport var ISuggestMemoryService = createDecorator('ISuggestMemories');\r\nregisterSingleton(ISuggestMemoryService, SuggestMemoryService, true);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nvar SuggestAlternatives = /** @class */ (function () {\r\n    function SuggestAlternatives(_editor, contextKeyService) {\r\n        this._editor = _editor;\r\n        this._index = 0;\r\n        this._ckOtherSuggestions = SuggestAlternatives.OtherSuggestions.bindTo(contextKeyService);\r\n    }\r\n    SuggestAlternatives.prototype.dispose = function () {\r\n        this.reset();\r\n    };\r\n    SuggestAlternatives.prototype.reset = function () {\r\n        this._ckOtherSuggestions.reset();\r\n        dispose(this._listener);\r\n        this._model = undefined;\r\n        this._acceptNext = undefined;\r\n        this._ignore = false;\r\n    };\r\n    SuggestAlternatives.prototype.set = function (_a, acceptNext) {\r\n        var _this = this;\r\n        var model = _a.model, index = _a.index;\r\n        // no suggestions -> nothing to do\r\n        if (model.items.length === 0) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        // no alternative suggestions -> nothing to do\r\n        var nextIndex = SuggestAlternatives._moveIndex(true, model, index);\r\n        if (nextIndex === index) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        this._acceptNext = acceptNext;\r\n        this._model = model;\r\n        this._index = index;\r\n        this._listener = this._editor.onDidChangeCursorPosition(function () {\r\n            if (!_this._ignore) {\r\n                _this.reset();\r\n            }\r\n        });\r\n        this._ckOtherSuggestions.set(true);\r\n    };\r\n    SuggestAlternatives._moveIndex = function (fwd, model, index) {\r\n        var newIndex = index;\r\n        while (true) {\r\n            newIndex = (newIndex + model.items.length + (fwd ? +1 : -1)) % model.items.length;\r\n            if (newIndex === index) {\r\n                break;\r\n            }\r\n            if (!model.items[newIndex].completion.additionalTextEdits) {\r\n                break;\r\n            }\r\n        }\r\n        return newIndex;\r\n    };\r\n    SuggestAlternatives.prototype.next = function () {\r\n        this._move(true);\r\n    };\r\n    SuggestAlternatives.prototype.prev = function () {\r\n        this._move(false);\r\n    };\r\n    SuggestAlternatives.prototype._move = function (fwd) {\r\n        if (!this._model) {\r\n            // nothing to reason about\r\n            return;\r\n        }\r\n        try {\r\n            this._ignore = true;\r\n            this._index = SuggestAlternatives._moveIndex(fwd, this._model, this._index);\r\n            this._acceptNext({ index: this._index, item: this._model.items[this._index], model: this._model });\r\n        }\r\n        finally {\r\n            this._ignore = false;\r\n        }\r\n    };\r\n    SuggestAlternatives.OtherSuggestions = new RawContextKey('hasOtherSuggestions', false);\r\n    SuggestAlternatives = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], SuggestAlternatives);\r\n    return SuggestAlternatives;\r\n}());\r\nexport { SuggestAlternatives };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { fuzzyScore, fuzzyScoreGracefulAggressive, FuzzyScore, anyScore } from '../../../base/common/filters.js';\r\nimport { compareIgnoreCase } from '../../../base/common/strings.js';\r\nvar LineContext = /** @class */ (function () {\r\n    function LineContext(leadingLineContent, characterCountDelta) {\r\n        this.leadingLineContent = leadingLineContent;\r\n        this.characterCountDelta = characterCountDelta;\r\n    }\r\n    return LineContext;\r\n}());\r\nexport { LineContext };\r\nvar CompletionModel = /** @class */ (function () {\r\n    function CompletionModel(items, column, lineContext, wordDistance, options, snippetSuggestions) {\r\n        this._snippetCompareFn = CompletionModel._compareCompletionItems;\r\n        this._items = items;\r\n        this._column = column;\r\n        this._wordDistance = wordDistance;\r\n        this._options = options;\r\n        this._refilterKind = 1 /* All */;\r\n        this._lineContext = lineContext;\r\n        if (snippetSuggestions === 'top') {\r\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsUp;\r\n        }\r\n        else if (snippetSuggestions === 'bottom') {\r\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsDown;\r\n        }\r\n    }\r\n    Object.defineProperty(CompletionModel.prototype, \"lineContext\", {\r\n        get: function () {\r\n            return this._lineContext;\r\n        },\r\n        set: function (value) {\r\n            if (this._lineContext.leadingLineContent !== value.leadingLineContent\r\n                || this._lineContext.characterCountDelta !== value.characterCountDelta) {\r\n                this._refilterKind = this._lineContext.characterCountDelta < value.characterCountDelta && this._filteredItems ? 2 /* Incr */ : 1 /* All */;\r\n                this._lineContext = value;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompletionModel.prototype, \"items\", {\r\n        get: function () {\r\n            this._ensureCachedState();\r\n            return this._filteredItems;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompletionModel.prototype, \"incomplete\", {\r\n        get: function () {\r\n            this._ensureCachedState();\r\n            return this._isIncomplete;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CompletionModel.prototype.adopt = function (except) {\r\n        var res = new Array();\r\n        for (var i = 0; i < this._items.length;) {\r\n            if (!except.has(this._items[i].provider)) {\r\n                res.push(this._items[i]);\r\n                // unordered removed\r\n                this._items[i] = this._items[this._items.length - 1];\r\n                this._items.pop();\r\n            }\r\n            else {\r\n                // continue with next item\r\n                i++;\r\n            }\r\n        }\r\n        this._refilterKind = 1 /* All */;\r\n        return res;\r\n    };\r\n    Object.defineProperty(CompletionModel.prototype, \"stats\", {\r\n        get: function () {\r\n            this._ensureCachedState();\r\n            return this._stats;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CompletionModel.prototype._ensureCachedState = function () {\r\n        if (this._refilterKind !== 0 /* Nothing */) {\r\n            this._createCachedState();\r\n        }\r\n    };\r\n    CompletionModel.prototype._createCachedState = function () {\r\n        this._isIncomplete = new Set();\r\n        this._stats = { suggestionCount: 0, snippetCount: 0, textCount: 0 };\r\n        var _a = this._lineContext, leadingLineContent = _a.leadingLineContent, characterCountDelta = _a.characterCountDelta;\r\n        var word = '';\r\n        var wordLow = '';\r\n        // incrementally filter less\r\n        var source = this._refilterKind === 1 /* All */ ? this._items : this._filteredItems;\r\n        var target = [];\r\n        // picks a score function based on the number of\r\n        // items that we have to score/filter and based on the\r\n        // user-configuration\r\n        var scoreFn = (!this._options.filterGraceful || source.length > 2000) ? fuzzyScore : fuzzyScoreGracefulAggressive;\r\n        for (var i = 0; i < source.length; i++) {\r\n            var item = source[i];\r\n            // collect those supports that signaled having\r\n            // an incomplete result\r\n            if (item.container.incomplete) {\r\n                this._isIncomplete.add(item.provider);\r\n            }\r\n            // 'word' is that remainder of the current line that we\r\n            // filter and score against. In theory each suggestion uses a\r\n            // different word, but in practice not - that's why we cache\r\n            var overwriteBefore = item.position.column - item.editStart.column;\r\n            var wordLen = overwriteBefore + characterCountDelta - (item.position.column - this._column);\r\n            if (word.length !== wordLen) {\r\n                word = wordLen === 0 ? '' : leadingLineContent.slice(-wordLen);\r\n                wordLow = word.toLowerCase();\r\n            }\r\n            // remember the word against which this item was\r\n            // scored\r\n            item.word = word;\r\n            if (wordLen === 0) {\r\n                // when there is nothing to score against, don't\r\n                // event try to do. Use a const rank and rely on\r\n                // the fallback-sort using the initial sort order.\r\n                // use a score of `-100` because that is out of the\r\n                // bound of values `fuzzyScore` will return\r\n                item.score = FuzzyScore.Default;\r\n            }\r\n            else {\r\n                // skip word characters that are whitespace until\r\n                // we have hit the replace range (overwriteBefore)\r\n                var wordPos = 0;\r\n                while (wordPos < overwriteBefore) {\r\n                    var ch = word.charCodeAt(wordPos);\r\n                    if (ch === 32 /* Space */ || ch === 9 /* Tab */) {\r\n                        wordPos += 1;\r\n                    }\r\n                    else {\r\n                        break;\r\n                    }\r\n                }\r\n                if (wordPos >= wordLen) {\r\n                    // the wordPos at which scoring starts is the whole word\r\n                    // and therefore the same rules as not having a word apply\r\n                    item.score = FuzzyScore.Default;\r\n                }\r\n                else if (typeof item.completion.filterText === 'string') {\r\n                    // when there is a `filterText` it must match the `word`.\r\n                    // if it matches we check with the label to compute highlights\r\n                    // and if that doesn't yield a result we have no highlights,\r\n                    // despite having the match\r\n                    var match = scoreFn(word, wordLow, wordPos, item.completion.filterText, item.filterTextLow, 0, false);\r\n                    if (!match) {\r\n                        continue; // NO match\r\n                    }\r\n                    if (compareIgnoreCase(item.completion.filterText, item.completion.label) === 0) {\r\n                        // filterText and label are actually the same -> use good highlights\r\n                        item.score = match;\r\n                    }\r\n                    else {\r\n                        // re-run the scorer on the label in the hope of a result BUT use the rank\r\n                        // of the filterText-match\r\n                        item.score = anyScore(word, wordLow, wordPos, item.completion.label, item.labelLow, 0);\r\n                        item.score[0] = match[0]; // use score from filterText\r\n                    }\r\n                }\r\n                else {\r\n                    // by default match `word` against the `label`\r\n                    var match = scoreFn(word, wordLow, wordPos, item.completion.label, item.labelLow, 0, false);\r\n                    if (!match) {\r\n                        continue; // NO match\r\n                    }\r\n                    item.score = match;\r\n                }\r\n            }\r\n            item.idx = i;\r\n            item.distance = this._wordDistance.distance(item.position, item.completion);\r\n            target.push(item);\r\n            // update stats\r\n            this._stats.suggestionCount++;\r\n            switch (item.completion.kind) {\r\n                case 25 /* Snippet */:\r\n                    this._stats.snippetCount++;\r\n                    break;\r\n                case 18 /* Text */:\r\n                    this._stats.textCount++;\r\n                    break;\r\n            }\r\n        }\r\n        this._filteredItems = target.sort(this._snippetCompareFn);\r\n        this._refilterKind = 0 /* Nothing */;\r\n    };\r\n    CompletionModel._compareCompletionItems = function (a, b) {\r\n        if (a.score[0] > b.score[0]) {\r\n            return -1;\r\n        }\r\n        else if (a.score[0] < b.score[0]) {\r\n            return 1;\r\n        }\r\n        else if (a.distance < b.distance) {\r\n            return -1;\r\n        }\r\n        else if (a.distance > b.distance) {\r\n            return 1;\r\n        }\r\n        else if (a.idx < b.idx) {\r\n            return -1;\r\n        }\r\n        else if (a.idx > b.idx) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    CompletionModel._compareCompletionItemsSnippetsDown = function (a, b) {\r\n        if (a.completion.kind !== b.completion.kind) {\r\n            if (a.completion.kind === 25 /* Snippet */) {\r\n                return 1;\r\n            }\r\n            else if (b.completion.kind === 25 /* Snippet */) {\r\n                return -1;\r\n            }\r\n        }\r\n        return CompletionModel._compareCompletionItems(a, b);\r\n    };\r\n    CompletionModel._compareCompletionItemsSnippetsUp = function (a, b) {\r\n        if (a.completion.kind !== b.completion.kind) {\r\n            if (a.completion.kind === 25 /* Snippet */) {\r\n                return -1;\r\n            }\r\n            else if (b.completion.kind === 25 /* Snippet */) {\r\n                return 1;\r\n            }\r\n        }\r\n        return CompletionModel._compareCompletionItems(a, b);\r\n    };\r\n    return CompletionModel;\r\n}());\r\nexport { CompletionModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { binarySearch, isFalsyOrEmpty } from '../../../base/common/arrays.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { BracketSelectionRangeProvider } from '../smartSelect/bracketSelections.js';\r\nvar WordDistance = /** @class */ (function () {\r\n    function WordDistance() {\r\n    }\r\n    WordDistance.create = function (service, editor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var model, position, ranges, wordRanges;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!editor.getOption(85 /* suggest */).localityBonus) {\r\n                            return [2 /*return*/, WordDistance.None];\r\n                        }\r\n                        if (!editor.hasModel()) {\r\n                            return [2 /*return*/, WordDistance.None];\r\n                        }\r\n                        model = editor.getModel();\r\n                        position = editor.getPosition();\r\n                        if (!service.canComputeWordRanges(model.uri)) {\r\n                            return [2 /*return*/, WordDistance.None];\r\n                        }\r\n                        return [4 /*yield*/, new BracketSelectionRangeProvider().provideSelectionRanges(model, [position])];\r\n                    case 1:\r\n                        ranges = _a.sent();\r\n                        if (!ranges || ranges.length === 0 || ranges[0].length === 0) {\r\n                            return [2 /*return*/, WordDistance.None];\r\n                        }\r\n                        return [4 /*yield*/, service.computeWordRanges(model.uri, ranges[0][0].range)];\r\n                    case 2:\r\n                        wordRanges = _a.sent();\r\n                        return [2 /*return*/, new /** @class */ (function (_super) {\r\n                                __extends(class_1, _super);\r\n                                function class_1() {\r\n                                    return _super !== null && _super.apply(this, arguments) || this;\r\n                                }\r\n                                class_1.prototype.distance = function (anchor, suggestion) {\r\n                                    if (!wordRanges || !position.equals(editor.getPosition())) {\r\n                                        return 0;\r\n                                    }\r\n                                    if (suggestion.kind === 17 /* Keyword */) {\r\n                                        return 2 << 20;\r\n                                    }\r\n                                    var word = suggestion.label;\r\n                                    var wordLines = wordRanges[word];\r\n                                    if (isFalsyOrEmpty(wordLines)) {\r\n                                        return 2 << 20;\r\n                                    }\r\n                                    var idx = binarySearch(wordLines, Range.fromPositions(anchor), Range.compareRangesUsingStarts);\r\n                                    var bestWordRange = idx >= 0 ? wordLines[idx] : wordLines[Math.max(0, ~idx - 1)];\r\n                                    var blockDistance = ranges.length;\r\n                                    for (var _i = 0, _a = ranges[0]; _i < _a.length; _i++) {\r\n                                        var range = _a[_i];\r\n                                        if (!Range.containsRange(range.range, bestWordRange)) {\r\n                                            break;\r\n                                        }\r\n                                        blockDistance -= 1;\r\n                                    }\r\n                                    return blockDistance;\r\n                                };\r\n                                return class_1;\r\n                            }(WordDistance))];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    WordDistance.None = new /** @class */ (function (_super) {\r\n        __extends(class_2, _super);\r\n        function class_2() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        class_2.prototype.distance = function () { return 0; };\r\n        return class_2;\r\n    }(WordDistance));\r\n    return WordDistance;\r\n}());\r\nexport { WordDistance };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { TimeoutTimer } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { dispose, DisposableStore, isDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { CompletionProviderRegistry } from '../../common/modes.js';\r\nimport { CompletionModel } from './completionModel.js';\r\nimport { getSuggestionComparator, provideSuggestionItems, getSnippetSuggestSupport, CompletionOptions } from './suggest.js';\r\nimport { SnippetController2 } from '../snippet/snippetController2.js';\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { WordDistance } from './wordDistance.js';\r\nvar LineContext = /** @class */ (function () {\r\n    function LineContext(model, position, auto, shy) {\r\n        this.leadingLineContent = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\r\n        this.leadingWord = model.getWordUntilPosition(position);\r\n        this.lineNumber = position.lineNumber;\r\n        this.column = position.column;\r\n        this.auto = auto;\r\n        this.shy = shy;\r\n    }\r\n    LineContext.shouldAutoTrigger = function (editor) {\r\n        if (!editor.hasModel()) {\r\n            return false;\r\n        }\r\n        var model = editor.getModel();\r\n        var pos = editor.getPosition();\r\n        model.tokenizeIfCheap(pos.lineNumber);\r\n        var word = model.getWordAtPosition(pos);\r\n        if (!word) {\r\n            return false;\r\n        }\r\n        if (word.endColumn !== pos.column) {\r\n            return false;\r\n        }\r\n        if (!isNaN(Number(word.word))) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    return LineContext;\r\n}());\r\nexport { LineContext };\r\nvar SuggestModel = /** @class */ (function () {\r\n    function SuggestModel(_editor, _editorWorker) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._editorWorker = _editorWorker;\r\n        this._toDispose = new DisposableStore();\r\n        this._quickSuggestDelay = 10;\r\n        this._triggerQuickSuggest = new TimeoutTimer();\r\n        this._state = 0 /* Idle */;\r\n        this._completionDisposables = new DisposableStore();\r\n        this._onDidCancel = new Emitter();\r\n        this._onDidTrigger = new Emitter();\r\n        this._onDidSuggest = new Emitter();\r\n        this.onDidCancel = this._onDidCancel.event;\r\n        this.onDidTrigger = this._onDidTrigger.event;\r\n        this.onDidSuggest = this._onDidSuggest.event;\r\n        this._currentSelection = this._editor.getSelection() || new Selection(1, 1, 1, 1);\r\n        // wire up various listeners\r\n        this._toDispose.add(this._editor.onDidChangeModel(function () {\r\n            _this._updateTriggerCharacters();\r\n            _this.cancel();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeModelLanguage(function () {\r\n            _this._updateTriggerCharacters();\r\n            _this.cancel();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeConfiguration(function () {\r\n            _this._updateTriggerCharacters();\r\n            _this._updateQuickSuggest();\r\n        }));\r\n        this._toDispose.add(CompletionProviderRegistry.onDidChange(function () {\r\n            _this._updateTriggerCharacters();\r\n            _this._updateActiveSuggestSession();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeCursorSelection(function (e) {\r\n            _this._onCursorChange(e);\r\n        }));\r\n        var editorIsComposing = false;\r\n        this._toDispose.add(this._editor.onCompositionStart(function () {\r\n            editorIsComposing = true;\r\n        }));\r\n        this._toDispose.add(this._editor.onCompositionEnd(function () {\r\n            // refilter when composition ends\r\n            editorIsComposing = false;\r\n            _this._refilterCompletionItems();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeModelContent(function () {\r\n            // only filter completions when the editor isn't\r\n            // composing a character, e.g.  + u makes  but just\r\n            //  cannot be used for filtering\r\n            if (!editorIsComposing) {\r\n                _this._refilterCompletionItems();\r\n            }\r\n        }));\r\n        this._updateTriggerCharacters();\r\n        this._updateQuickSuggest();\r\n    }\r\n    SuggestModel.prototype.dispose = function () {\r\n        dispose(this._triggerCharacterListener);\r\n        dispose([this._onDidCancel, this._onDidSuggest, this._onDidTrigger, this._triggerQuickSuggest]);\r\n        this._toDispose.dispose();\r\n        this._completionDisposables.dispose();\r\n        this.cancel();\r\n    };\r\n    // --- handle configuration & precondition changes\r\n    SuggestModel.prototype._updateQuickSuggest = function () {\r\n        this._quickSuggestDelay = this._editor.getOption(64 /* quickSuggestionsDelay */);\r\n        if (isNaN(this._quickSuggestDelay) || (!this._quickSuggestDelay && this._quickSuggestDelay !== 0) || this._quickSuggestDelay < 0) {\r\n            this._quickSuggestDelay = 10;\r\n        }\r\n    };\r\n    SuggestModel.prototype._updateTriggerCharacters = function () {\r\n        var _this = this;\r\n        dispose(this._triggerCharacterListener);\r\n        if (this._editor.getOption(65 /* readOnly */)\r\n            || !this._editor.hasModel()\r\n            || !this._editor.getOption(88 /* suggestOnTriggerCharacters */)) {\r\n            return;\r\n        }\r\n        var supportsByTriggerCharacter = Object.create(null);\r\n        for (var _i = 0, _a = CompletionProviderRegistry.all(this._editor.getModel()); _i < _a.length; _i++) {\r\n            var support = _a[_i];\r\n            for (var _b = 0, _c = support.triggerCharacters || []; _b < _c.length; _b++) {\r\n                var ch = _c[_b];\r\n                var set = supportsByTriggerCharacter[ch];\r\n                if (!set) {\r\n                    set = supportsByTriggerCharacter[ch] = new Set();\r\n                    set.add(getSnippetSuggestSupport());\r\n                }\r\n                set.add(support);\r\n            }\r\n        }\r\n        this._triggerCharacterListener = this._editor.onDidType(function (text) {\r\n            var lastChar = text.charAt(text.length - 1);\r\n            var supports = supportsByTriggerCharacter[lastChar];\r\n            if (supports) {\r\n                // keep existing items that where not computed by the\r\n                // supports/providers that want to trigger now\r\n                var items = _this._completionModel ? _this._completionModel.adopt(supports) : undefined;\r\n                _this.trigger({ auto: true, shy: false, triggerCharacter: lastChar }, Boolean(_this._completionModel), supports, items);\r\n            }\r\n        });\r\n    };\r\n    Object.defineProperty(SuggestModel.prototype, \"state\", {\r\n        // --- trigger/retrigger/cancel suggest\r\n        get: function () {\r\n            return this._state;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SuggestModel.prototype.cancel = function (retrigger) {\r\n        if (retrigger === void 0) { retrigger = false; }\r\n        if (this._state !== 0 /* Idle */) {\r\n            this._triggerQuickSuggest.cancel();\r\n            if (this._requestToken) {\r\n                this._requestToken.cancel();\r\n                this._requestToken = undefined;\r\n            }\r\n            this._state = 0 /* Idle */;\r\n            this._completionModel = undefined;\r\n            this._context = undefined;\r\n            this._onDidCancel.fire({ retrigger: retrigger });\r\n        }\r\n    };\r\n    SuggestModel.prototype.clear = function () {\r\n        this._completionDisposables.clear();\r\n    };\r\n    SuggestModel.prototype._updateActiveSuggestSession = function () {\r\n        if (this._state !== 0 /* Idle */) {\r\n            if (!this._editor.hasModel() || !CompletionProviderRegistry.has(this._editor.getModel())) {\r\n                this.cancel();\r\n            }\r\n            else {\r\n                this.trigger({ auto: this._state === 2 /* Auto */, shy: false }, true);\r\n            }\r\n        }\r\n    };\r\n    SuggestModel.prototype._onCursorChange = function (e) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var prevSelection = this._currentSelection;\r\n        this._currentSelection = this._editor.getSelection();\r\n        if (!e.selection.isEmpty()\r\n            || e.reason !== 0 /* NotSet */\r\n            || (e.source !== 'keyboard' && e.source !== 'deleteLeft')) {\r\n            // Early exit if nothing needs to be done!\r\n            // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n            if (this._state !== 0 /* Idle */) {\r\n                this.cancel();\r\n            }\r\n            return;\r\n        }\r\n        if (!CompletionProviderRegistry.has(model)) {\r\n            return;\r\n        }\r\n        if (this._state === 0 /* Idle */) {\r\n            if (this._editor.getOption(63 /* quickSuggestions */) === false) {\r\n                // not enabled\r\n                return;\r\n            }\r\n            if (!prevSelection.containsRange(this._currentSelection) && !prevSelection.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition())) {\r\n                // cursor didn't move RIGHT\r\n                return;\r\n            }\r\n            if (this._editor.getOption(85 /* suggest */).snippetsPreventQuickSuggestions && SnippetController2.get(this._editor).isInSnippet()) {\r\n                // no quick suggestion when in snippet mode\r\n                return;\r\n            }\r\n            this.cancel();\r\n            this._triggerQuickSuggest.cancelAndSet(function () {\r\n                if (_this._state !== 0 /* Idle */) {\r\n                    return;\r\n                }\r\n                if (!LineContext.shouldAutoTrigger(_this._editor)) {\r\n                    return;\r\n                }\r\n                if (!_this._editor.hasModel()) {\r\n                    return;\r\n                }\r\n                var model = _this._editor.getModel();\r\n                var pos = _this._editor.getPosition();\r\n                // validate enabled now\r\n                var quickSuggestions = _this._editor.getOption(63 /* quickSuggestions */);\r\n                if (quickSuggestions === false) {\r\n                    return;\r\n                }\r\n                else if (quickSuggestions === true) {\r\n                    // all good\r\n                }\r\n                else {\r\n                    // Check the type of the token that triggered this\r\n                    model.tokenizeIfCheap(pos.lineNumber);\r\n                    var lineTokens = model.getLineTokens(pos.lineNumber);\r\n                    var tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(pos.column - 1 - 1, 0)));\r\n                    var inValidScope = quickSuggestions.other && tokenType === 0 /* Other */\r\n                        || quickSuggestions.comments && tokenType === 1 /* Comment */\r\n                        || quickSuggestions.strings && tokenType === 2 /* String */;\r\n                    if (!inValidScope) {\r\n                        return;\r\n                    }\r\n                }\r\n                // we made it till here -> trigger now\r\n                _this.trigger({ auto: true, shy: false });\r\n            }, this._quickSuggestDelay);\r\n        }\r\n    };\r\n    SuggestModel.prototype._refilterCompletionItems = function () {\r\n        var _this = this;\r\n        // Re-filter suggestions. This MUST run async because filtering/scoring\r\n        // uses the model content AND the cursor position. The latter is NOT\r\n        // updated when the document has changed (the event which drives this method)\r\n        // and therefore a little pause (next mirco task) is needed. See:\r\n        // https://stackoverflow.com/questions/25915634/difference-between-microtask-and-macrotask-within-an-event-loop-context#25933985\r\n        Promise.resolve().then(function () {\r\n            if (_this._state === 0 /* Idle */) {\r\n                return;\r\n            }\r\n            if (!_this._editor.hasModel()) {\r\n                return;\r\n            }\r\n            var model = _this._editor.getModel();\r\n            var position = _this._editor.getPosition();\r\n            var ctx = new LineContext(model, position, _this._state === 2 /* Auto */, false);\r\n            _this._onNewContext(ctx);\r\n        });\r\n    };\r\n    SuggestModel.prototype.trigger = function (context, retrigger, onlyFrom, existingItems) {\r\n        var _this = this;\r\n        if (retrigger === void 0) { retrigger = false; }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var auto = context.auto;\r\n        var ctx = new LineContext(model, this._editor.getPosition(), auto, context.shy);\r\n        // Cancel previous requests, change state & update UI\r\n        this.cancel(retrigger);\r\n        this._state = auto ? 2 /* Auto */ : 1 /* Manual */;\r\n        this._onDidTrigger.fire({ auto: auto, shy: context.shy, position: this._editor.getPosition() });\r\n        // Capture context when request was sent\r\n        this._context = ctx;\r\n        // Build context for request\r\n        var suggestCtx;\r\n        if (context.triggerCharacter) {\r\n            suggestCtx = {\r\n                triggerKind: 1 /* TriggerCharacter */,\r\n                triggerCharacter: context.triggerCharacter\r\n            };\r\n        }\r\n        else if (onlyFrom && onlyFrom.size > 0) {\r\n            suggestCtx = { triggerKind: 2 /* TriggerForIncompleteCompletions */ };\r\n        }\r\n        else {\r\n            suggestCtx = { triggerKind: 0 /* Invoke */ };\r\n        }\r\n        this._requestToken = new CancellationTokenSource();\r\n        // kind filter and snippet sort rules\r\n        var snippetSuggestions = this._editor.getOption(82 /* snippetSuggestions */);\r\n        var snippetSortOrder = 1 /* Inline */;\r\n        switch (snippetSuggestions) {\r\n            case 'top':\r\n                snippetSortOrder = 0 /* Top */;\r\n                break;\r\n            // \t that's the default anyways...\r\n            // case 'inline':\r\n            // \tsnippetSortOrder = SnippetSortOrder.Inline;\r\n            // \tbreak;\r\n            case 'bottom':\r\n                snippetSortOrder = 2 /* Bottom */;\r\n                break;\r\n        }\r\n        var itemKindFilter = SuggestModel._createItemKindFilter(this._editor);\r\n        var wordDistance = WordDistance.create(this._editorWorker, this._editor);\r\n        var items = provideSuggestionItems(model, this._editor.getPosition(), new CompletionOptions(snippetSortOrder, itemKindFilter, onlyFrom), suggestCtx, this._requestToken.token);\r\n        Promise.all([items, wordDistance]).then(function (_a) {\r\n            var items = _a[0], wordDistance = _a[1];\r\n            dispose(_this._requestToken);\r\n            if (_this._state === 0 /* Idle */) {\r\n                return;\r\n            }\r\n            if (!_this._editor.hasModel()) {\r\n                return;\r\n            }\r\n            var model = _this._editor.getModel();\r\n            if (isNonEmptyArray(existingItems)) {\r\n                var cmpFn = getSuggestionComparator(snippetSortOrder);\r\n                items = items.concat(existingItems).sort(cmpFn);\r\n            }\r\n            var ctx = new LineContext(model, _this._editor.getPosition(), auto, context.shy);\r\n            _this._completionModel = new CompletionModel(items, _this._context.column, {\r\n                leadingLineContent: ctx.leadingLineContent,\r\n                characterCountDelta: ctx.column - _this._context.column\r\n            }, wordDistance, _this._editor.getOption(85 /* suggest */), _this._editor.getOption(82 /* snippetSuggestions */));\r\n            // store containers so that they can be disposed later\r\n            for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n                var item = items_1[_i];\r\n                if (isDisposable(item.container)) {\r\n                    _this._completionDisposables.add(item.container);\r\n                }\r\n            }\r\n            _this._onNewContext(ctx);\r\n        }).catch(onUnexpectedError);\r\n    };\r\n    SuggestModel._createItemKindFilter = function (editor) {\r\n        // kind filter and snippet sort rules\r\n        var result = new Set();\r\n        // snippet setting\r\n        var snippetSuggestions = editor.getOption(82 /* snippetSuggestions */);\r\n        if (snippetSuggestions === 'none') {\r\n            result.add(25 /* Snippet */);\r\n        }\r\n        // type setting\r\n        var suggestOptions = editor.getOption(85 /* suggest */);\r\n        if (!suggestOptions.showMethods) {\r\n            result.add(0 /* Method */);\r\n        }\r\n        if (!suggestOptions.showFunctions) {\r\n            result.add(1 /* Function */);\r\n        }\r\n        if (!suggestOptions.showConstructors) {\r\n            result.add(2 /* Constructor */);\r\n        }\r\n        if (!suggestOptions.showFields) {\r\n            result.add(3 /* Field */);\r\n        }\r\n        if (!suggestOptions.showVariables) {\r\n            result.add(4 /* Variable */);\r\n        }\r\n        if (!suggestOptions.showClasses) {\r\n            result.add(5 /* Class */);\r\n        }\r\n        if (!suggestOptions.showStructs) {\r\n            result.add(6 /* Struct */);\r\n        }\r\n        if (!suggestOptions.showInterfaces) {\r\n            result.add(7 /* Interface */);\r\n        }\r\n        if (!suggestOptions.showModules) {\r\n            result.add(8 /* Module */);\r\n        }\r\n        if (!suggestOptions.showProperties) {\r\n            result.add(9 /* Property */);\r\n        }\r\n        if (!suggestOptions.showEvents) {\r\n            result.add(10 /* Event */);\r\n        }\r\n        if (!suggestOptions.showOperators) {\r\n            result.add(11 /* Operator */);\r\n        }\r\n        if (!suggestOptions.showUnits) {\r\n            result.add(12 /* Unit */);\r\n        }\r\n        if (!suggestOptions.showValues) {\r\n            result.add(13 /* Value */);\r\n        }\r\n        if (!suggestOptions.showConstants) {\r\n            result.add(14 /* Constant */);\r\n        }\r\n        if (!suggestOptions.showEnums) {\r\n            result.add(15 /* Enum */);\r\n        }\r\n        if (!suggestOptions.showEnumMembers) {\r\n            result.add(16 /* EnumMember */);\r\n        }\r\n        if (!suggestOptions.showKeywords) {\r\n            result.add(17 /* Keyword */);\r\n        }\r\n        if (!suggestOptions.showWords) {\r\n            result.add(18 /* Text */);\r\n        }\r\n        if (!suggestOptions.showColors) {\r\n            result.add(19 /* Color */);\r\n        }\r\n        if (!suggestOptions.showFiles) {\r\n            result.add(20 /* File */);\r\n        }\r\n        if (!suggestOptions.showReferences) {\r\n            result.add(21 /* Reference */);\r\n        }\r\n        if (!suggestOptions.showColors) {\r\n            result.add(22 /* Customcolor */);\r\n        }\r\n        if (!suggestOptions.showFolders) {\r\n            result.add(23 /* Folder */);\r\n        }\r\n        if (!suggestOptions.showTypeParameters) {\r\n            result.add(24 /* TypeParameter */);\r\n        }\r\n        if (!suggestOptions.showSnippets) {\r\n            result.add(25 /* Snippet */);\r\n        }\r\n        return result;\r\n    };\r\n    SuggestModel.prototype._onNewContext = function (ctx) {\r\n        if (!this._context) {\r\n            // happens when 24x7 IntelliSense is enabled and still in its delay\r\n            return;\r\n        }\r\n        if (ctx.lineNumber !== this._context.lineNumber) {\r\n            // e.g. happens when pressing Enter while IntelliSense is computed\r\n            this.cancel();\r\n            return;\r\n        }\r\n        if (ctx.leadingWord.startColumn < this._context.leadingWord.startColumn) {\r\n            // happens when the current word gets outdented\r\n            this.cancel();\r\n            return;\r\n        }\r\n        if (ctx.column < this._context.column) {\r\n            // typed -> moved cursor LEFT -> retrigger if still on a word\r\n            if (ctx.leadingWord.word) {\r\n                this.trigger({ auto: this._context.auto, shy: false }, true);\r\n            }\r\n            else {\r\n                this.cancel();\r\n            }\r\n            return;\r\n        }\r\n        if (!this._completionModel) {\r\n            // happens when IntelliSense is not yet computed\r\n            return;\r\n        }\r\n        if (ctx.column > this._context.column && this._completionModel.incomplete.size > 0 && ctx.leadingWord.word.length !== 0) {\r\n            // typed -> moved cursor RIGHT & incomple model & still on a word -> retrigger\r\n            var incomplete = this._completionModel.incomplete;\r\n            var adopted = this._completionModel.adopt(incomplete);\r\n            this.trigger({ auto: this._state === 2 /* Auto */, shy: false }, true, incomplete, adopted);\r\n        }\r\n        else {\r\n            // typed -> moved cursor RIGHT -> update UI\r\n            var oldLineContext = this._completionModel.lineContext;\r\n            var isFrozen = false;\r\n            this._completionModel.lineContext = {\r\n                leadingLineContent: ctx.leadingLineContent,\r\n                characterCountDelta: ctx.column - this._context.column\r\n            };\r\n            if (this._completionModel.items.length === 0) {\r\n                if (LineContext.shouldAutoTrigger(this._editor) && this._context.leadingWord.endColumn < ctx.leadingWord.startColumn) {\r\n                    // retrigger when heading into a new word\r\n                    this.trigger({ auto: this._context.auto, shy: false }, true);\r\n                    return;\r\n                }\r\n                if (!this._context.auto) {\r\n                    // freeze when IntelliSense was manually requested\r\n                    this._completionModel.lineContext = oldLineContext;\r\n                    isFrozen = this._completionModel.items.length > 0;\r\n                    if (isFrozen && ctx.leadingWord.word.length === 0) {\r\n                        // there were results before but now there aren't\r\n                        // and also we are not on a word anymore -> cancel\r\n                        this.cancel();\r\n                        return;\r\n                    }\r\n                }\r\n                else {\r\n                    // nothing left\r\n                    this.cancel();\r\n                    return;\r\n                }\r\n            }\r\n            this._onDidSuggest.fire({\r\n                completionModel: this._completionModel,\r\n                auto: this._context.auto,\r\n                shy: this._context.shy,\r\n                isFrozen: isFrozen,\r\n            });\r\n        }\r\n    };\r\n    return SuggestModel;\r\n}());\r\nexport { SuggestModel };\r\n","import './media/outlineTree.css';\r\nimport './media/symbol-icons.css';\r\nimport { localize } from '../../../nls.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { registerColor, foreground } from '../../../platform/theme/common/colorRegistry.js';\r\nexport var SYMBOL_ICON_ARRAY_FOREGROUND = registerColor('symbolIcon.arrayForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.arrayForeground', 'The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_BOOLEAN_FOREGROUND = registerColor('symbolIcon.booleanForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.booleanForeground', 'The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_CLASS_FOREGROUND = registerColor('symbolIcon.classForeground', {\r\n    dark: '#EE9D28',\r\n    light: '#D67E00',\r\n    hc: '#EE9D28'\r\n}, localize('symbolIcon.classForeground', 'The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_COLOR_FOREGROUND = registerColor('symbolIcon.colorForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.colorForeground', 'The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_CONSTANT_FOREGROUND = registerColor('symbolIcon.constantForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.constantForeground', 'The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_CONSTRUCTOR_FOREGROUND = registerColor('symbolIcon.constructorForeground', {\r\n    dark: '#B180D7',\r\n    light: '#652D90',\r\n    hc: '#B180D7'\r\n}, localize('symbolIcon.constructorForeground', 'The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_ENUMERATOR_FOREGROUND = registerColor('symbolIcon.enumeratorForeground', {\r\n    dark: '#EE9D28',\r\n    light: '#D67E00',\r\n    hc: '#EE9D28'\r\n}, localize('symbolIcon.enumeratorForeground', 'The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND = registerColor('symbolIcon.enumeratorMemberForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.enumeratorMemberForeground', 'The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_EVENT_FOREGROUND = registerColor('symbolIcon.eventForeground', {\r\n    dark: '#EE9D28',\r\n    light: '#D67E00',\r\n    hc: '#EE9D28'\r\n}, localize('symbolIcon.eventForeground', 'The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_FIELD_FOREGROUND = registerColor('symbolIcon.fieldForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.fieldForeground', 'The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_FILE_FOREGROUND = registerColor('symbolIcon.fileForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.fileForeground', 'The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_FOLDER_FOREGROUND = registerColor('symbolIcon.folderForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.folderForeground', 'The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_FUNCTION_FOREGROUND = registerColor('symbolIcon.functionForeground', {\r\n    dark: '#B180D7',\r\n    light: '#652D90',\r\n    hc: '#B180D7'\r\n}, localize('symbolIcon.functionForeground', 'The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_INTERFACE_FOREGROUND = registerColor('symbolIcon.interfaceForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.interfaceForeground', 'The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_KEY_FOREGROUND = registerColor('symbolIcon.keyForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.keyForeground', 'The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_KEYWORD_FOREGROUND = registerColor('symbolIcon.keywordForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.keywordForeground', 'The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_METHOD_FOREGROUND = registerColor('symbolIcon.methodForeground', {\r\n    dark: '#B180D7',\r\n    light: '#652D90',\r\n    hc: '#B180D7'\r\n}, localize('symbolIcon.methodForeground', 'The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_MODULE_FOREGROUND = registerColor('symbolIcon.moduleForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.moduleForeground', 'The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_NAMESPACE_FOREGROUND = registerColor('symbolIcon.namespaceForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.namespaceForeground', 'The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_NULL_FOREGROUND = registerColor('symbolIcon.nullForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.nullForeground', 'The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_NUMBER_FOREGROUND = registerColor('symbolIcon.numberForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.numberForeground', 'The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_OBJECT_FOREGROUND = registerColor('symbolIcon.objectForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.objectForeground', 'The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_OPERATOR_FOREGROUND = registerColor('symbolIcon.operatorForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.operatorForeground', 'The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_PACKAGE_FOREGROUND = registerColor('symbolIcon.packageForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.packageForeground', 'The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_PROPERTY_FOREGROUND = registerColor('symbolIcon.propertyForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.propertyForeground', 'The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_REFERENCE_FOREGROUND = registerColor('symbolIcon.referenceForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.referenceForeground', 'The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_SNIPPET_FOREGROUND = registerColor('symbolIcon.snippetForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.snippetForeground', 'The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_STRING_FOREGROUND = registerColor('symbolIcon.stringForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.stringForeground', 'The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_STRUCT_FOREGROUND = registerColor('symbolIcon.structForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.structForeground', 'The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_TEXT_FOREGROUND = registerColor('symbolIcon.textForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.textForeground', 'The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_TYPEPARAMETER_FOREGROUND = registerColor('symbolIcon.typeParameterForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.typeParameterForeground', 'The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_UNIT_FOREGROUND = registerColor('symbolIcon.unitForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.unitForeground', 'The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_VARIABLE_FOREGROUND = registerColor('symbolIcon.variableForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.variableForeground', 'The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var symbolIconArrayColor = theme.getColor(SYMBOL_ICON_ARRAY_FOREGROUND);\r\n    if (symbolIconArrayColor) {\r\n        collector.addRule(\".codicon-symbol-array { color: \" + symbolIconArrayColor + \" !important; }\");\r\n    }\r\n    var symbolIconBooleanColor = theme.getColor(SYMBOL_ICON_BOOLEAN_FOREGROUND);\r\n    if (symbolIconBooleanColor) {\r\n        collector.addRule(\".codicon-symbol-boolean { color: \" + symbolIconBooleanColor + \" !important; }\");\r\n    }\r\n    var symbolIconClassColor = theme.getColor(SYMBOL_ICON_CLASS_FOREGROUND);\r\n    if (symbolIconClassColor) {\r\n        collector.addRule(\".codicon-symbol-class { color: \" + symbolIconClassColor + \" !important; }\");\r\n    }\r\n    var symbolIconMethodColor = theme.getColor(SYMBOL_ICON_METHOD_FOREGROUND);\r\n    if (symbolIconMethodColor) {\r\n        collector.addRule(\".codicon-symbol-method { color: \" + symbolIconMethodColor + \" !important; }\");\r\n    }\r\n    var symbolIconColorColor = theme.getColor(SYMBOL_ICON_COLOR_FOREGROUND);\r\n    if (symbolIconColorColor) {\r\n        collector.addRule(\".codicon-symbol-color { color: \" + symbolIconColorColor + \" !important; }\");\r\n    }\r\n    var symbolIconConstantColor = theme.getColor(SYMBOL_ICON_CONSTANT_FOREGROUND);\r\n    if (symbolIconConstantColor) {\r\n        collector.addRule(\".codicon-symbol-constant { color: \" + symbolIconConstantColor + \" !important; }\");\r\n    }\r\n    var symbolIconConstructorColor = theme.getColor(SYMBOL_ICON_CONSTRUCTOR_FOREGROUND);\r\n    if (symbolIconConstructorColor) {\r\n        collector.addRule(\".codicon-symbol-constructor { color: \" + symbolIconConstructorColor + \" !important; }\");\r\n    }\r\n    var symbolIconEnumeratorColor = theme.getColor(SYMBOL_ICON_ENUMERATOR_FOREGROUND);\r\n    if (symbolIconEnumeratorColor) {\r\n        collector.addRule(\"\\n\\t\\t\\t.codicon-symbol-value,.codicon-symbol-enum { color: \" + symbolIconEnumeratorColor + \" !important; }\");\r\n    }\r\n    var symbolIconEnumeratorMemberColor = theme.getColor(SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND);\r\n    if (symbolIconEnumeratorMemberColor) {\r\n        collector.addRule(\".codicon-symbol-enum-member { color: \" + symbolIconEnumeratorMemberColor + \" !important; }\");\r\n    }\r\n    var symbolIconEventColor = theme.getColor(SYMBOL_ICON_EVENT_FOREGROUND);\r\n    if (symbolIconEventColor) {\r\n        collector.addRule(\".codicon-symbol-event { color: \" + symbolIconEventColor + \" !important; }\");\r\n    }\r\n    var symbolIconFieldColor = theme.getColor(SYMBOL_ICON_FIELD_FOREGROUND);\r\n    if (symbolIconFieldColor) {\r\n        collector.addRule(\".codicon-symbol-field { color: \" + symbolIconFieldColor + \" !important; }\");\r\n    }\r\n    var symbolIconFileColor = theme.getColor(SYMBOL_ICON_FILE_FOREGROUND);\r\n    if (symbolIconFileColor) {\r\n        collector.addRule(\".codicon-symbol-file { color: \" + symbolIconFileColor + \" !important; }\");\r\n    }\r\n    var symbolIconFolderColor = theme.getColor(SYMBOL_ICON_FOLDER_FOREGROUND);\r\n    if (symbolIconFolderColor) {\r\n        collector.addRule(\".codicon-symbol-folder { color: \" + symbolIconFolderColor + \" !important; }\");\r\n    }\r\n    var symbolIconFunctionColor = theme.getColor(SYMBOL_ICON_FUNCTION_FOREGROUND);\r\n    if (symbolIconFunctionColor) {\r\n        collector.addRule(\".codicon-symbol-function { color: \" + symbolIconFunctionColor + \" !important; }\");\r\n    }\r\n    var symbolIconInterfaceColor = theme.getColor(SYMBOL_ICON_INTERFACE_FOREGROUND);\r\n    if (symbolIconInterfaceColor) {\r\n        collector.addRule(\".codicon-symbol-interface { color: \" + symbolIconInterfaceColor + \" !important; }\");\r\n    }\r\n    var symbolIconKeyColor = theme.getColor(SYMBOL_ICON_KEY_FOREGROUND);\r\n    if (symbolIconKeyColor) {\r\n        collector.addRule(\".codicon-symbol-key { color: \" + symbolIconKeyColor + \" !important; }\");\r\n    }\r\n    var symbolIconKeywordColor = theme.getColor(SYMBOL_ICON_KEYWORD_FOREGROUND);\r\n    if (symbolIconKeywordColor) {\r\n        collector.addRule(\".codicon-symbol-keyword { color: \" + symbolIconKeywordColor + \" !important; }\");\r\n    }\r\n    var symbolIconModuleColor = theme.getColor(SYMBOL_ICON_MODULE_FOREGROUND);\r\n    if (symbolIconModuleColor) {\r\n        collector.addRule(\".codicon-symbol-module { color: \" + symbolIconModuleColor + \" !important; }\");\r\n    }\r\n    var outlineNamespaceColor = theme.getColor(SYMBOL_ICON_NAMESPACE_FOREGROUND);\r\n    if (outlineNamespaceColor) {\r\n        collector.addRule(\".codicon-symbol-namespace { color: \" + outlineNamespaceColor + \" !important; }\");\r\n    }\r\n    var symbolIconNullColor = theme.getColor(SYMBOL_ICON_NULL_FOREGROUND);\r\n    if (symbolIconNullColor) {\r\n        collector.addRule(\".codicon-symbol-null { color: \" + symbolIconNullColor + \" !important; }\");\r\n    }\r\n    var symbolIconNumberColor = theme.getColor(SYMBOL_ICON_NUMBER_FOREGROUND);\r\n    if (symbolIconNumberColor) {\r\n        collector.addRule(\".codicon-symbol-number { color: \" + symbolIconNumberColor + \" !important; }\");\r\n    }\r\n    var symbolIconObjectColor = theme.getColor(SYMBOL_ICON_OBJECT_FOREGROUND);\r\n    if (symbolIconObjectColor) {\r\n        collector.addRule(\".codicon-symbol-object { color: \" + symbolIconObjectColor + \" !important; }\");\r\n    }\r\n    var symbolIconOperatorColor = theme.getColor(SYMBOL_ICON_OPERATOR_FOREGROUND);\r\n    if (symbolIconOperatorColor) {\r\n        collector.addRule(\".codicon-symbol-operator { color: \" + symbolIconOperatorColor + \" !important; }\");\r\n    }\r\n    var symbolIconPackageColor = theme.getColor(SYMBOL_ICON_PACKAGE_FOREGROUND);\r\n    if (symbolIconPackageColor) {\r\n        collector.addRule(\".codicon-symbol-package { color: \" + symbolIconPackageColor + \" !important; }\");\r\n    }\r\n    var symbolIconPropertyColor = theme.getColor(SYMBOL_ICON_PROPERTY_FOREGROUND);\r\n    if (symbolIconPropertyColor) {\r\n        collector.addRule(\".codicon-symbol-property { color: \" + symbolIconPropertyColor + \" !important; }\");\r\n    }\r\n    var symbolIconReferenceColor = theme.getColor(SYMBOL_ICON_REFERENCE_FOREGROUND);\r\n    if (symbolIconReferenceColor) {\r\n        collector.addRule(\".codicon-symbol-reference { color: \" + symbolIconReferenceColor + \" !important; }\");\r\n    }\r\n    var symbolIconSnippetColor = theme.getColor(SYMBOL_ICON_SNIPPET_FOREGROUND);\r\n    if (symbolIconSnippetColor) {\r\n        collector.addRule(\".codicon-symbol-snippet { color: \" + symbolIconSnippetColor + \" !important; }\");\r\n    }\r\n    var symbolIconStringColor = theme.getColor(SYMBOL_ICON_STRING_FOREGROUND);\r\n    if (symbolIconStringColor) {\r\n        collector.addRule(\".codicon-symbol-string { color: \" + symbolIconStringColor + \" !important; }\");\r\n    }\r\n    var symbolIconStructColor = theme.getColor(SYMBOL_ICON_STRUCT_FOREGROUND);\r\n    if (symbolIconStructColor) {\r\n        collector.addRule(\".codicon-symbol-struct { color: \" + symbolIconStructColor + \" !important; }\");\r\n    }\r\n    var symbolIconTextColor = theme.getColor(SYMBOL_ICON_TEXT_FOREGROUND);\r\n    if (symbolIconTextColor) {\r\n        collector.addRule(\".codicon-symbol-text { color: \" + symbolIconTextColor + \" !important; }\");\r\n    }\r\n    var symbolIconTypeParameterColor = theme.getColor(SYMBOL_ICON_TYPEPARAMETER_FOREGROUND);\r\n    if (symbolIconTypeParameterColor) {\r\n        collector.addRule(\".codicon-symbol-type-parameter { color: \" + symbolIconTypeParameterColor + \" !important; }\");\r\n    }\r\n    var symbolIconUnitColor = theme.getColor(SYMBOL_ICON_UNIT_FOREGROUND);\r\n    if (symbolIconUnitColor) {\r\n        collector.addRule(\".codicon-symbol-unit { color: \" + symbolIconUnitColor + \" !important; }\");\r\n    }\r\n    var symbolIconVariableColor = theme.getColor(SYMBOL_ICON_VARIABLE_FOREGROUND);\r\n    if (symbolIconVariableColor) {\r\n        collector.addRule(\".codicon-symbol-variable { color: \" + symbolIconVariableColor + \" !important; }\");\r\n    }\r\n});\r\n","export var FileKind;\r\n(function (FileKind) {\r\n    FileKind[FileKind[\"FILE\"] = 0] = \"FILE\";\r\n    FileKind[FileKind[\"FOLDER\"] = 1] = \"FOLDER\";\r\n    FileKind[FileKind[\"ROOT_FOLDER\"] = 2] = \"ROOT_FOLDER\";\r\n})(FileKind || (FileKind = {}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport { DataUri, basenameOrAuthority } from '../../../base/common/resources.js';\r\nimport { PLAINTEXT_MODE_ID } from '../modes/modesRegistry.js';\r\nimport { FileKind } from '../../../platform/files/common/files.js';\r\nexport function getIconClasses(modelService, modeService, resource, fileKind) {\r\n    // we always set these base classes even if we do not have a path\r\n    var classes = fileKind === FileKind.ROOT_FOLDER ? ['rootfolder-icon'] : fileKind === FileKind.FOLDER ? ['folder-icon'] : ['file-icon'];\r\n    if (resource) {\r\n        // Get the path and name of the resource. For data-URIs, we need to parse specially\r\n        var name_1;\r\n        if (resource.scheme === Schemas.data) {\r\n            var metadata = DataUri.parseMetaData(resource);\r\n            name_1 = metadata.get(DataUri.META_DATA_LABEL);\r\n        }\r\n        else {\r\n            name_1 = cssEscape(basenameOrAuthority(resource).toLowerCase());\r\n        }\r\n        // Folders\r\n        if (fileKind === FileKind.FOLDER) {\r\n            classes.push(name_1 + \"-name-folder-icon\");\r\n        }\r\n        // Files\r\n        else {\r\n            // Name & Extension(s)\r\n            if (name_1) {\r\n                classes.push(name_1 + \"-name-file-icon\");\r\n                var dotSegments = name_1.split('.');\r\n                for (var i = 1; i < dotSegments.length; i++) {\r\n                    classes.push(dotSegments.slice(i).join('.') + \"-ext-file-icon\"); // add each combination of all found extensions if more than one\r\n                }\r\n                classes.push(\"ext-file-icon\"); // extra segment to increase file-ext score\r\n            }\r\n            // Detected Mode\r\n            var detectedModeId = detectModeId(modelService, modeService, resource);\r\n            if (detectedModeId) {\r\n                classes.push(cssEscape(detectedModeId) + \"-lang-file-icon\");\r\n            }\r\n        }\r\n    }\r\n    return classes;\r\n}\r\nexport function detectModeId(modelService, modeService, resource) {\r\n    if (!resource) {\r\n        return null; // we need a resource at least\r\n    }\r\n    var modeId = null;\r\n    // Data URI: check for encoded metadata\r\n    if (resource.scheme === Schemas.data) {\r\n        var metadata = DataUri.parseMetaData(resource);\r\n        var mime = metadata.get(DataUri.META_DATA_MIME);\r\n        if (mime) {\r\n            modeId = modeService.getModeId(mime);\r\n        }\r\n    }\r\n    // Any other URI: check for model if existing\r\n    else {\r\n        var model = modelService.getModel(resource);\r\n        if (model) {\r\n            modeId = model.getModeId();\r\n        }\r\n    }\r\n    // only take if the mode is specific (aka no just plain text)\r\n    if (modeId && modeId !== PLAINTEXT_MODE_ID) {\r\n        return modeId;\r\n    }\r\n    // otherwise fallback to path based detection\r\n    return modeService.getModeIdByFilepathOrFirstLine(resource);\r\n}\r\nexport function cssEscape(val) {\r\n    return val.replace(/\\s/g, '\\\\$&'); // make sure to not introduce CSS classes from files that contain whitespace\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport './media/suggest.css';\r\nimport '../../../base/browser/ui/codiconLabel/codiconLabel.js'; // The codicon symbol styles are defined here and must be loaded\r\nimport '../documentSymbols/outlineTree.js'; // The codicon symbol colors are defined here and must be loaded\r\nimport * as nls from '../../../nls.js';\r\nimport { createMatches } from '../../../base/common/filters.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Event, Emitter } from '../../../base/common/event.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { dispose, toDisposable, DisposableStore, Disposable } from '../../../base/common/lifecycle.js';\r\nimport { addClass, append, $, hide, removeClass, show, toggleClass, getDomNodePagePosition, hasClass, addDisposableListener, addStandardDisposableListener, addClasses } from '../../../base/browser/dom.js';\r\nimport { List } from '../../../base/browser/ui/list/listWidget.js';\r\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { Context as SuggestContext } from './suggest.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { ITelemetryService } from '../../../platform/telemetry/common/telemetry.js';\r\nimport { attachListStyler } from '../../../platform/theme/common/styler.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { registerColor, editorWidgetBackground, listFocusBackground, activeContrastBorder, listHighlightForeground, editorForeground, editorWidgetBorder, focusBorder, textLinkForeground, textCodeBlockBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IStorageService } from '../../../platform/storage/common/storage.js';\r\nimport { MarkdownRenderer } from '../markdown/markdownRenderer.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { TimeoutTimer, createCancelablePromise, disposableTimeout } from '../../../base/common/async.js';\r\nimport { completionKindToCssClass } from '../../common/modes.js';\r\nimport { IconLabel } from '../../../base/browser/ui/iconLabel/iconLabel.js';\r\nimport { getIconClasses } from '../../common/services/getIconClasses.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { FileKind } from '../../../platform/files/common/files.js';\r\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { flatten } from '../../../base/common/arrays.js';\r\nvar expandSuggestionDocsByDefault = false;\r\n/**\r\n * Suggest widget colors\r\n */\r\nexport var editorSuggestWidgetBackground = registerColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hc: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\r\nexport var editorSuggestWidgetBorder = registerColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hc: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\r\nexport var editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hc: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\r\nexport var editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: listFocusBackground, light: listFocusBackground, hc: listFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\r\nexport var editorSuggestWidgetHighlightForeground = registerColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hc: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\r\nvar colorRegExp = /^(#([\\da-f]{3}){1,2}|(rgb|hsl)a\\(\\s*(\\d{1,3}%?\\s*,\\s*){3}(1|0?\\.\\d+)\\)|(rgb|hsl)\\(\\s*\\d{1,3}%?(\\s*,\\s*\\d{1,3}%?){2}\\s*\\))$/i;\r\nfunction extractColor(item, out) {\r\n    if (item.completion.label.match(colorRegExp)) {\r\n        out[0] = item.completion.label;\r\n        return true;\r\n    }\r\n    if (typeof item.completion.documentation === 'string' && item.completion.documentation.match(colorRegExp)) {\r\n        out[0] = item.completion.documentation;\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction canExpandCompletionItem(item) {\r\n    if (!item) {\r\n        return false;\r\n    }\r\n    var suggestion = item.completion;\r\n    if (suggestion.documentation) {\r\n        return true;\r\n    }\r\n    return (suggestion.detail && suggestion.detail !== suggestion.label);\r\n}\r\nvar Renderer = /** @class */ (function () {\r\n    function Renderer(widget, editor, triggerKeybindingLabel, _modelService, _modeService, _themeService) {\r\n        this.widget = widget;\r\n        this.editor = editor;\r\n        this.triggerKeybindingLabel = triggerKeybindingLabel;\r\n        this._modelService = _modelService;\r\n        this._modeService = _modeService;\r\n        this._themeService = _themeService;\r\n    }\r\n    Object.defineProperty(Renderer.prototype, \"templateId\", {\r\n        get: function () {\r\n            return 'suggestion';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Renderer.prototype.renderTemplate = function (container) {\r\n        var _this = this;\r\n        var data = Object.create(null);\r\n        data.disposables = new DisposableStore();\r\n        data.root = container;\r\n        addClass(data.root, 'show-file-icons');\r\n        data.icon = append(container, $('.icon'));\r\n        data.colorspan = append(data.icon, $('span.colorspan'));\r\n        var text = append(container, $('.contents'));\r\n        var main = append(text, $('.main'));\r\n        data.iconContainer = append(main, $('.icon-label.codicon'));\r\n        data.iconLabel = new IconLabel(main, { supportHighlights: true, supportCodicons: true });\r\n        data.disposables.add(data.iconLabel);\r\n        data.typeLabel = append(main, $('span.type-label'));\r\n        data.readMore = append(main, $('span.readMore.codicon.codicon-info'));\r\n        data.readMore.title = nls.localize('readMore', \"Read More...{0}\", this.triggerKeybindingLabel);\r\n        var configureFont = function () {\r\n            var options = _this.editor.getOptions();\r\n            var fontInfo = options.get(32 /* fontInfo */);\r\n            var fontFamily = fontInfo.fontFamily;\r\n            var fontSize = options.get(86 /* suggestFontSize */) || fontInfo.fontSize;\r\n            var lineHeight = options.get(87 /* suggestLineHeight */) || fontInfo.lineHeight;\r\n            var fontWeight = fontInfo.fontWeight;\r\n            var fontSizePx = fontSize + \"px\";\r\n            var lineHeightPx = lineHeight + \"px\";\r\n            data.root.style.fontSize = fontSizePx;\r\n            data.root.style.fontWeight = fontWeight;\r\n            main.style.fontFamily = fontFamily;\r\n            main.style.lineHeight = lineHeightPx;\r\n            data.icon.style.height = lineHeightPx;\r\n            data.icon.style.width = lineHeightPx;\r\n            data.readMore.style.height = lineHeightPx;\r\n            data.readMore.style.width = lineHeightPx;\r\n        };\r\n        configureFont();\r\n        data.disposables.add(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\r\n            .filter(function (e) { return e.hasChanged(32 /* fontInfo */) || e.hasChanged(86 /* suggestFontSize */) || e.hasChanged(87 /* suggestLineHeight */); })\r\n            .on(configureFont, null));\r\n        return data;\r\n    };\r\n    Renderer.prototype.renderElement = function (element, _index, templateData) {\r\n        var _this = this;\r\n        var data = templateData;\r\n        var suggestion = element.completion;\r\n        data.icon.className = 'icon ' + completionKindToCssClass(suggestion.kind);\r\n        data.colorspan.style.backgroundColor = '';\r\n        var labelOptions = {\r\n            labelEscapeNewLines: true,\r\n            matches: createMatches(element.score)\r\n        };\r\n        var color = [];\r\n        if (suggestion.kind === 19 /* Color */ && extractColor(element, color)) {\r\n            // special logic for 'color' completion items\r\n            data.icon.className = 'icon customcolor';\r\n            data.iconContainer.className = 'icon hide';\r\n            data.colorspan.style.backgroundColor = color[0];\r\n        }\r\n        else if (suggestion.kind === 20 /* File */ && this._themeService.getIconTheme().hasFileIcons) {\r\n            // special logic for 'file' completion items\r\n            data.icon.className = 'icon hide';\r\n            data.iconContainer.className = 'icon hide';\r\n            var labelClasses = getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: suggestion.label }), FileKind.FILE);\r\n            var detailClasses = getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: suggestion.detail }), FileKind.FILE);\r\n            labelOptions.extraClasses = labelClasses.length > detailClasses.length ? labelClasses : detailClasses;\r\n        }\r\n        else if (suggestion.kind === 23 /* Folder */ && this._themeService.getIconTheme().hasFolderIcons) {\r\n            // special logic for 'folder' completion items\r\n            data.icon.className = 'icon hide';\r\n            data.iconContainer.className = 'icon hide';\r\n            labelOptions.extraClasses = flatten([\r\n                getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: suggestion.label }), FileKind.FOLDER),\r\n                getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: suggestion.detail }), FileKind.FOLDER)\r\n            ]);\r\n        }\r\n        else {\r\n            // normal icon\r\n            data.icon.className = 'icon hide';\r\n            data.iconContainer.className = '';\r\n            addClasses(data.iconContainer, \"suggest-icon codicon codicon-symbol-\" + completionKindToCssClass(suggestion.kind));\r\n        }\r\n        if (suggestion.tags && suggestion.tags.indexOf(1 /* Deprecated */) >= 0) {\r\n            labelOptions.extraClasses = (labelOptions.extraClasses || []).concat(['deprecated']);\r\n            labelOptions.matches = [];\r\n        }\r\n        data.iconLabel.setLabel(suggestion.label, undefined, labelOptions);\r\n        data.typeLabel.textContent = (suggestion.detail || '').replace(/\\n.*$/m, '');\r\n        if (canExpandCompletionItem(element)) {\r\n            show(data.readMore);\r\n            data.readMore.onmousedown = function (e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n            };\r\n            data.readMore.onclick = function (e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n                _this.widget.toggleDetails();\r\n            };\r\n        }\r\n        else {\r\n            hide(data.readMore);\r\n            data.readMore.onmousedown = null;\r\n            data.readMore.onclick = null;\r\n        }\r\n    };\r\n    Renderer.prototype.disposeTemplate = function (templateData) {\r\n        templateData.disposables.dispose();\r\n    };\r\n    Renderer = __decorate([\r\n        __param(3, IModelService),\r\n        __param(4, IModeService),\r\n        __param(5, IThemeService)\r\n    ], Renderer);\r\n    return Renderer;\r\n}());\r\nvar SuggestionDetails = /** @class */ (function () {\r\n    function SuggestionDetails(container, widget, editor, markdownRenderer, triggerKeybindingLabel) {\r\n        var _this = this;\r\n        this.widget = widget;\r\n        this.editor = editor;\r\n        this.markdownRenderer = markdownRenderer;\r\n        this.triggerKeybindingLabel = triggerKeybindingLabel;\r\n        this.borderWidth = 1;\r\n        this.disposables = new DisposableStore();\r\n        this.el = append(container, $('.details'));\r\n        this.disposables.add(toDisposable(function () { return container.removeChild(_this.el); }));\r\n        this.body = $('.body');\r\n        this.scrollbar = new DomScrollableElement(this.body, {});\r\n        append(this.el, this.scrollbar.getDomNode());\r\n        this.disposables.add(this.scrollbar);\r\n        this.header = append(this.body, $('.header'));\r\n        this.close = append(this.header, $('span.codicon.codicon-close'));\r\n        this.close.title = nls.localize('readLess', \"Read less...{0}\", this.triggerKeybindingLabel);\r\n        this.type = append(this.header, $('p.type'));\r\n        this.docs = append(this.body, $('p.docs'));\r\n        this.ariaLabel = null;\r\n        this.configureFont();\r\n        Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\r\n            .filter(function (e) { return e.hasChanged(32 /* fontInfo */); })\r\n            .on(this.configureFont, this, this.disposables);\r\n        markdownRenderer.onDidRenderCodeBlock(function () { return _this.scrollbar.scanDomNode(); }, this, this.disposables);\r\n    }\r\n    Object.defineProperty(SuggestionDetails.prototype, \"element\", {\r\n        get: function () {\r\n            return this.el;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SuggestionDetails.prototype.renderLoading = function () {\r\n        this.type.textContent = nls.localize('loading', \"Loading...\");\r\n        this.docs.textContent = '';\r\n    };\r\n    SuggestionDetails.prototype.renderItem = function (item, explainMode) {\r\n        var _this = this;\r\n        this.renderDisposeable = dispose(this.renderDisposeable);\r\n        var _a = item.completion, documentation = _a.documentation, detail = _a.detail;\r\n        // --- documentation\r\n        if (explainMode) {\r\n            var md = '';\r\n            md += \"score: \" + item.score[0] + (item.word ? \", compared '\" + (item.completion.filterText && (item.completion.filterText + ' (filterText)') || item.completion.label) + \"' with '\" + item.word + \"'\" : ' (no prefix)') + \"\\n\";\r\n            md += \"distance: \" + item.distance + \", see localityBonus-setting\\n\";\r\n            md += \"index: \" + item.idx + \", based on \" + (item.completion.sortText && \"sortText: \\\"\" + item.completion.sortText + \"\\\"\" || 'label') + \"\\n\";\r\n            documentation = new MarkdownString().appendCodeblock('empty', md);\r\n            detail = \"Provider: \" + item.provider._debugDisplayName;\r\n        }\r\n        if (!explainMode && !canExpandCompletionItem(item)) {\r\n            this.type.textContent = '';\r\n            this.docs.textContent = '';\r\n            addClass(this.el, 'no-docs');\r\n            this.ariaLabel = null;\r\n            return;\r\n        }\r\n        removeClass(this.el, 'no-docs');\r\n        if (typeof documentation === 'string') {\r\n            removeClass(this.docs, 'markdown-docs');\r\n            this.docs.textContent = documentation;\r\n        }\r\n        else {\r\n            addClass(this.docs, 'markdown-docs');\r\n            this.docs.innerHTML = '';\r\n            var renderedContents = this.markdownRenderer.render(documentation);\r\n            this.renderDisposeable = renderedContents;\r\n            this.docs.appendChild(renderedContents.element);\r\n        }\r\n        // --- details\r\n        if (detail) {\r\n            this.type.innerText = detail;\r\n            show(this.type);\r\n        }\r\n        else {\r\n            this.type.innerText = '';\r\n            hide(this.type);\r\n        }\r\n        this.el.style.height = this.header.offsetHeight + this.docs.offsetHeight + (this.borderWidth * 2) + 'px';\r\n        this.el.style.userSelect = 'text';\r\n        this.el.tabIndex = -1;\r\n        this.close.onmousedown = function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        };\r\n        this.close.onclick = function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            _this.widget.toggleDetails();\r\n        };\r\n        this.body.scrollTop = 0;\r\n        this.scrollbar.scanDomNode();\r\n        this.ariaLabel = strings.format('{0}{1}', detail || '', documentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\r\n    };\r\n    SuggestionDetails.prototype.getAriaLabel = function () {\r\n        return this.ariaLabel;\r\n    };\r\n    SuggestionDetails.prototype.scrollDown = function (much) {\r\n        if (much === void 0) { much = 8; }\r\n        this.body.scrollTop += much;\r\n    };\r\n    SuggestionDetails.prototype.scrollUp = function (much) {\r\n        if (much === void 0) { much = 8; }\r\n        this.body.scrollTop -= much;\r\n    };\r\n    SuggestionDetails.prototype.scrollTop = function () {\r\n        this.body.scrollTop = 0;\r\n    };\r\n    SuggestionDetails.prototype.scrollBottom = function () {\r\n        this.body.scrollTop = this.body.scrollHeight;\r\n    };\r\n    SuggestionDetails.prototype.pageDown = function () {\r\n        this.scrollDown(80);\r\n    };\r\n    SuggestionDetails.prototype.pageUp = function () {\r\n        this.scrollUp(80);\r\n    };\r\n    SuggestionDetails.prototype.setBorderWidth = function (width) {\r\n        this.borderWidth = width;\r\n    };\r\n    SuggestionDetails.prototype.configureFont = function () {\r\n        var options = this.editor.getOptions();\r\n        var fontInfo = options.get(32 /* fontInfo */);\r\n        var fontFamily = fontInfo.fontFamily;\r\n        var fontSize = options.get(86 /* suggestFontSize */) || fontInfo.fontSize;\r\n        var lineHeight = options.get(87 /* suggestLineHeight */) || fontInfo.lineHeight;\r\n        var fontWeight = fontInfo.fontWeight;\r\n        var fontSizePx = fontSize + \"px\";\r\n        var lineHeightPx = lineHeight + \"px\";\r\n        this.el.style.fontSize = fontSizePx;\r\n        this.el.style.fontWeight = fontWeight;\r\n        this.type.style.fontFamily = fontFamily;\r\n        this.close.style.height = lineHeightPx;\r\n        this.close.style.width = lineHeightPx;\r\n    };\r\n    SuggestionDetails.prototype.dispose = function () {\r\n        this.disposables.dispose();\r\n        this.renderDisposeable = dispose(this.renderDisposeable);\r\n    };\r\n    return SuggestionDetails;\r\n}());\r\nvar SuggestWidget = /** @class */ (function () {\r\n    function SuggestWidget(editor, telemetryService, contextKeyService, themeService, storageService, keybindingService, modeService, openerService, instantiationService) {\r\n        var _this = this;\r\n        this.editor = editor;\r\n        this.telemetryService = telemetryService;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = true;\r\n        this.suppressMouseDown = false;\r\n        this.state = null;\r\n        this.isAuto = false;\r\n        this.loadingTimeout = Disposable.None;\r\n        this.currentSuggestionDetails = null;\r\n        this.ignoreFocusEvents = false;\r\n        this.completionModel = null;\r\n        this.showTimeout = new TimeoutTimer();\r\n        this.toDispose = new DisposableStore();\r\n        this.onDidSelectEmitter = new Emitter();\r\n        this.onDidFocusEmitter = new Emitter();\r\n        this.onDidHideEmitter = new Emitter();\r\n        this.onDidShowEmitter = new Emitter();\r\n        this.onDidSelect = this.onDidSelectEmitter.event;\r\n        this.onDidFocus = this.onDidFocusEmitter.event;\r\n        this.onDidHide = this.onDidHideEmitter.event;\r\n        this.onDidShow = this.onDidShowEmitter.event;\r\n        this.maxWidgetWidth = 660;\r\n        this.listWidth = 330;\r\n        this.firstFocusInCurrentList = false;\r\n        this.preferDocPositionTop = false;\r\n        this.docsPositionPreviousWidgetY = null;\r\n        this.explainMode = false;\r\n        this._onDetailsKeydown = new Emitter();\r\n        this.onDetailsKeyDown = this._onDetailsKeydown.event;\r\n        this._lastAriaAlertLabel = null;\r\n        var kb = keybindingService.lookupKeybinding('editor.action.triggerSuggest');\r\n        var triggerKeybindingLabel = !kb ? '' : \" (\" + kb.getLabel() + \")\";\r\n        var markdownRenderer = this.toDispose.add(new MarkdownRenderer(editor, modeService, openerService));\r\n        this.isAuto = false;\r\n        this.focusedItem = null;\r\n        this.storageService = storageService;\r\n        this.element = $('.editor-widget.suggest-widget');\r\n        this.toDispose.add(addDisposableListener(this.element, 'click', function (e) {\r\n            if (e.target === _this.element) {\r\n                _this.hideWidget();\r\n            }\r\n        }));\r\n        this.messageElement = append(this.element, $('.message'));\r\n        this.listElement = append(this.element, $('.tree'));\r\n        this.details = instantiationService.createInstance(SuggestionDetails, this.element, this, this.editor, markdownRenderer, triggerKeybindingLabel);\r\n        var applyIconStyle = function () { return toggleClass(_this.element, 'no-icons', !_this.editor.getOption(85 /* suggest */).showIcons); };\r\n        applyIconStyle();\r\n        var renderer = instantiationService.createInstance(Renderer, this, this.editor, triggerKeybindingLabel);\r\n        this.list = new List('SuggestWidget', this.listElement, this, [renderer], {\r\n            useShadows: false,\r\n            openController: { shouldOpen: function () { return false; } },\r\n            mouseSupport: false\r\n        });\r\n        this.toDispose.add(attachListStyler(this.list, themeService, {\r\n            listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\r\n            listInactiveFocusOutline: activeContrastBorder\r\n        }));\r\n        this.toDispose.add(themeService.onThemeChange(function (t) { return _this.onThemeChange(t); }));\r\n        this.toDispose.add(editor.onDidLayoutChange(function () { return _this.onEditorLayoutChange(); }));\r\n        this.toDispose.add(this.list.onMouseDown(function (e) { return _this.onListMouseDownOrTap(e); }));\r\n        this.toDispose.add(this.list.onTap(function (e) { return _this.onListMouseDownOrTap(e); }));\r\n        this.toDispose.add(this.list.onSelectionChange(function (e) { return _this.onListSelection(e); }));\r\n        this.toDispose.add(this.list.onFocusChange(function (e) { return _this.onListFocus(e); }));\r\n        this.toDispose.add(this.editor.onDidChangeCursorSelection(function () { return _this.onCursorSelectionChanged(); }));\r\n        this.toDispose.add(this.editor.onDidChangeConfiguration(function (e) { return e.hasChanged(85 /* suggest */) && applyIconStyle(); }));\r\n        this.suggestWidgetVisible = SuggestContext.Visible.bindTo(contextKeyService);\r\n        this.suggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(contextKeyService);\r\n        this.editor.addContentWidget(this);\r\n        this.setState(0 /* Hidden */);\r\n        this.onThemeChange(themeService.getTheme());\r\n        this.toDispose.add(addStandardDisposableListener(this.details.element, 'keydown', function (e) {\r\n            _this._onDetailsKeydown.fire(e);\r\n        }));\r\n        this.toDispose.add(this.editor.onMouseDown(function (e) { return _this.onEditorMouseDown(e); }));\r\n    }\r\n    SuggestWidget.prototype.onEditorMouseDown = function (mouseEvent) {\r\n        // Clicking inside details\r\n        if (this.details.element.contains(mouseEvent.target.element)) {\r\n            this.details.element.focus();\r\n        }\r\n        // Clicking outside details and inside suggest\r\n        else {\r\n            if (this.element.contains(mouseEvent.target.element)) {\r\n                this.editor.focus();\r\n            }\r\n        }\r\n    };\r\n    SuggestWidget.prototype.onCursorSelectionChanged = function () {\r\n        if (this.state === 0 /* Hidden */) {\r\n            return;\r\n        }\r\n        this.editor.layoutContentWidget(this);\r\n    };\r\n    SuggestWidget.prototype.onEditorLayoutChange = function () {\r\n        if ((this.state === 3 /* Open */ || this.state === 5 /* Details */) && this.expandDocsSettingFromStorage()) {\r\n            this.expandSideOrBelow();\r\n        }\r\n    };\r\n    SuggestWidget.prototype.onListMouseDownOrTap = function (e) {\r\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\r\n            return;\r\n        }\r\n        // prevent stealing browser focus from the editor\r\n        e.browserEvent.preventDefault();\r\n        e.browserEvent.stopPropagation();\r\n        this.select(e.element, e.index);\r\n    };\r\n    SuggestWidget.prototype.onListSelection = function (e) {\r\n        if (!e.elements.length) {\r\n            return;\r\n        }\r\n        this.select(e.elements[0], e.indexes[0]);\r\n    };\r\n    SuggestWidget.prototype.select = function (item, index) {\r\n        var completionModel = this.completionModel;\r\n        if (!completionModel) {\r\n            return;\r\n        }\r\n        this.onDidSelectEmitter.fire({ item: item, index: index, model: completionModel });\r\n        this.editor.focus();\r\n    };\r\n    SuggestWidget.prototype._getSuggestionAriaAlertLabel = function (item) {\r\n        if (this.expandDocsSettingFromStorage()) {\r\n            return nls.localize('ariaCurrenttSuggestionReadDetails', \"Item {0}, docs: {1}\", item.completion.label, this.details.getAriaLabel());\r\n        }\r\n        else {\r\n            return item.completion.label;\r\n        }\r\n    };\r\n    SuggestWidget.prototype._ariaAlert = function (newAriaAlertLabel) {\r\n        if (this._lastAriaAlertLabel === newAriaAlertLabel) {\r\n            return;\r\n        }\r\n        this._lastAriaAlertLabel = newAriaAlertLabel;\r\n        if (this._lastAriaAlertLabel) {\r\n            alert(this._lastAriaAlertLabel, true);\r\n        }\r\n    };\r\n    SuggestWidget.prototype.onThemeChange = function (theme) {\r\n        var backgroundColor = theme.getColor(editorSuggestWidgetBackground);\r\n        if (backgroundColor) {\r\n            this.listElement.style.backgroundColor = backgroundColor.toString();\r\n            this.details.element.style.backgroundColor = backgroundColor.toString();\r\n            this.messageElement.style.backgroundColor = backgroundColor.toString();\r\n        }\r\n        var borderColor = theme.getColor(editorSuggestWidgetBorder);\r\n        if (borderColor) {\r\n            this.listElement.style.borderColor = borderColor.toString();\r\n            this.details.element.style.borderColor = borderColor.toString();\r\n            this.messageElement.style.borderColor = borderColor.toString();\r\n            this.detailsBorderColor = borderColor.toString();\r\n        }\r\n        var focusBorderColor = theme.getColor(focusBorder);\r\n        if (focusBorderColor) {\r\n            this.detailsFocusBorderColor = focusBorderColor.toString();\r\n        }\r\n        this.details.setBorderWidth(theme.type === 'hc' ? 2 : 1);\r\n    };\r\n    SuggestWidget.prototype.onListFocus = function (e) {\r\n        var _this = this;\r\n        if (this.ignoreFocusEvents) {\r\n            return;\r\n        }\r\n        if (!e.elements.length) {\r\n            if (this.currentSuggestionDetails) {\r\n                this.currentSuggestionDetails.cancel();\r\n                this.currentSuggestionDetails = null;\r\n                this.focusedItem = null;\r\n            }\r\n            this._ariaAlert(null);\r\n            return;\r\n        }\r\n        if (!this.completionModel) {\r\n            return;\r\n        }\r\n        var item = e.elements[0];\r\n        var index = e.indexes[0];\r\n        this.firstFocusInCurrentList = !this.focusedItem;\r\n        if (item !== this.focusedItem) {\r\n            if (this.currentSuggestionDetails) {\r\n                this.currentSuggestionDetails.cancel();\r\n                this.currentSuggestionDetails = null;\r\n            }\r\n            this.focusedItem = item;\r\n            this.list.reveal(index);\r\n            this.currentSuggestionDetails = createCancelablePromise(function (token) { return __awaiter(_this, void 0, void 0, function () {\r\n                var loading, result;\r\n                var _this = this;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            loading = disposableTimeout(function () { return _this.showDetails(true); }, 250);\r\n                            token.onCancellationRequested(function () { return loading.dispose(); });\r\n                            return [4 /*yield*/, item.resolve(token)];\r\n                        case 1:\r\n                            result = _a.sent();\r\n                            loading.dispose();\r\n                            return [2 /*return*/, result];\r\n                    }\r\n                });\r\n            }); });\r\n            this.currentSuggestionDetails.then(function () {\r\n                if (index >= _this.list.length || item !== _this.list.element(index)) {\r\n                    return;\r\n                }\r\n                // item can have extra information, so re-render\r\n                _this.ignoreFocusEvents = true;\r\n                _this.list.splice(index, 1, [item]);\r\n                _this.list.setFocus([index]);\r\n                _this.ignoreFocusEvents = false;\r\n                if (_this.expandDocsSettingFromStorage()) {\r\n                    _this.showDetails(false);\r\n                }\r\n                else {\r\n                    removeClass(_this.element, 'docs-side');\r\n                }\r\n                _this._ariaAlert(_this._getSuggestionAriaAlertLabel(item));\r\n            }).catch(onUnexpectedError);\r\n        }\r\n        // emit an event\r\n        this.onDidFocusEmitter.fire({ item: item, index: index, model: this.completionModel });\r\n    };\r\n    SuggestWidget.prototype.setState = function (state) {\r\n        if (!this.element) {\r\n            return;\r\n        }\r\n        var stateChanged = this.state !== state;\r\n        this.state = state;\r\n        toggleClass(this.element, 'frozen', state === 4 /* Frozen */);\r\n        switch (state) {\r\n            case 0 /* Hidden */:\r\n                hide(this.messageElement, this.details.element, this.listElement);\r\n                this.hide();\r\n                this.listHeight = 0;\r\n                if (stateChanged) {\r\n                    this.list.splice(0, this.list.length);\r\n                }\r\n                this.focusedItem = null;\r\n                break;\r\n            case 1 /* Loading */:\r\n                this.messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\r\n                hide(this.listElement, this.details.element);\r\n                show(this.messageElement);\r\n                removeClass(this.element, 'docs-side');\r\n                this.show();\r\n                this.focusedItem = null;\r\n                break;\r\n            case 2 /* Empty */:\r\n                this.messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\r\n                hide(this.listElement, this.details.element);\r\n                show(this.messageElement);\r\n                removeClass(this.element, 'docs-side');\r\n                this.show();\r\n                this.focusedItem = null;\r\n                break;\r\n            case 3 /* Open */:\r\n                hide(this.messageElement);\r\n                show(this.listElement);\r\n                this.show();\r\n                break;\r\n            case 4 /* Frozen */:\r\n                hide(this.messageElement);\r\n                show(this.listElement);\r\n                this.show();\r\n                break;\r\n            case 5 /* Details */:\r\n                hide(this.messageElement);\r\n                show(this.details.element, this.listElement);\r\n                this.show();\r\n                this._ariaAlert(this.details.getAriaLabel());\r\n                break;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.showTriggered = function (auto, delay) {\r\n        var _this = this;\r\n        if (this.state !== 0 /* Hidden */) {\r\n            return;\r\n        }\r\n        this.isAuto = !!auto;\r\n        if (!this.isAuto) {\r\n            this.loadingTimeout = disposableTimeout(function () { return _this.setState(1 /* Loading */); }, delay);\r\n        }\r\n    };\r\n    SuggestWidget.prototype.showSuggestions = function (completionModel, selectionIndex, isFrozen, isAuto) {\r\n        this.preferDocPositionTop = false;\r\n        this.docsPositionPreviousWidgetY = null;\r\n        this.loadingTimeout.dispose();\r\n        if (this.currentSuggestionDetails) {\r\n            this.currentSuggestionDetails.cancel();\r\n            this.currentSuggestionDetails = null;\r\n        }\r\n        if (this.completionModel !== completionModel) {\r\n            this.completionModel = completionModel;\r\n        }\r\n        if (isFrozen && this.state !== 2 /* Empty */ && this.state !== 0 /* Hidden */) {\r\n            this.setState(4 /* Frozen */);\r\n            return;\r\n        }\r\n        var visibleCount = this.completionModel.items.length;\r\n        var isEmpty = visibleCount === 0;\r\n        this.suggestWidgetMultipleSuggestions.set(visibleCount > 1);\r\n        if (isEmpty) {\r\n            if (isAuto) {\r\n                this.setState(0 /* Hidden */);\r\n            }\r\n            else {\r\n                this.setState(2 /* Empty */);\r\n            }\r\n            this.completionModel = null;\r\n        }\r\n        else {\r\n            if (this.state !== 3 /* Open */) {\r\n                var stats = this.completionModel.stats;\r\n                stats['wasAutomaticallyTriggered'] = !!isAuto;\r\n                /* __GDPR__\r\n                    \"suggestWidget\" : {\r\n                        \"wasAutomaticallyTriggered\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\r\n                        \"${include}\": [\r\n                            \"${ICompletionStats}\"\r\n                        ]\r\n                    }\r\n                */\r\n                this.telemetryService.publicLog('suggestWidget', __assign({}, stats));\r\n            }\r\n            this.focusedItem = null;\r\n            this.list.splice(0, this.list.length, this.completionModel.items);\r\n            if (isFrozen) {\r\n                this.setState(4 /* Frozen */);\r\n            }\r\n            else {\r\n                this.setState(3 /* Open */);\r\n            }\r\n            this.list.reveal(selectionIndex, 0);\r\n            this.list.setFocus([selectionIndex]);\r\n            // Reset focus border\r\n            if (this.detailsBorderColor) {\r\n                this.details.element.style.borderColor = this.detailsBorderColor;\r\n            }\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectNextPage = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this.details.pageDown();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusNextPage();\r\n                return true;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectNext = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusNext(1, true);\r\n                return true;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectLast = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this.details.scrollBottom();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusLast();\r\n                return true;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectPreviousPage = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this.details.pageUp();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusPreviousPage();\r\n                return true;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectPrevious = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusPrevious(1, true);\r\n                return false;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectFirst = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this.details.scrollTop();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusFirst();\r\n                return true;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.getFocusedItem = function () {\r\n        if (this.state !== 0 /* Hidden */\r\n            && this.state !== 2 /* Empty */\r\n            && this.state !== 1 /* Loading */\r\n            && this.completionModel) {\r\n            return {\r\n                item: this.list.getFocusedElements()[0],\r\n                index: this.list.getFocus()[0],\r\n                model: this.completionModel\r\n            };\r\n        }\r\n        return undefined;\r\n    };\r\n    SuggestWidget.prototype.toggleDetailsFocus = function () {\r\n        if (this.state === 5 /* Details */) {\r\n            this.setState(3 /* Open */);\r\n            if (this.detailsBorderColor) {\r\n                this.details.element.style.borderColor = this.detailsBorderColor;\r\n            }\r\n        }\r\n        else if (this.state === 3 /* Open */ && this.expandDocsSettingFromStorage()) {\r\n            this.setState(5 /* Details */);\r\n            if (this.detailsFocusBorderColor) {\r\n                this.details.element.style.borderColor = this.detailsFocusBorderColor;\r\n            }\r\n        }\r\n        this.telemetryService.publicLog2('suggestWidget:toggleDetailsFocus');\r\n    };\r\n    SuggestWidget.prototype.toggleDetails = function () {\r\n        if (!canExpandCompletionItem(this.list.getFocusedElements()[0])) {\r\n            return;\r\n        }\r\n        if (this.expandDocsSettingFromStorage()) {\r\n            this.updateExpandDocsSetting(false);\r\n            hide(this.details.element);\r\n            removeClass(this.element, 'docs-side');\r\n            removeClass(this.element, 'docs-below');\r\n            this.editor.layoutContentWidget(this);\r\n            this.telemetryService.publicLog2('suggestWidget:collapseDetails');\r\n        }\r\n        else {\r\n            if (this.state !== 3 /* Open */ && this.state !== 5 /* Details */ && this.state !== 4 /* Frozen */) {\r\n                return;\r\n            }\r\n            this.updateExpandDocsSetting(true);\r\n            this.showDetails(false);\r\n            this._ariaAlert(this.details.getAriaLabel());\r\n            this.telemetryService.publicLog2('suggestWidget:expandDetails');\r\n        }\r\n    };\r\n    SuggestWidget.prototype.showDetails = function (loading) {\r\n        this.expandSideOrBelow();\r\n        show(this.details.element);\r\n        this.details.element.style.maxHeight = this.maxWidgetHeight + 'px';\r\n        if (loading) {\r\n            this.details.renderLoading();\r\n        }\r\n        else {\r\n            this.details.renderItem(this.list.getFocusedElements()[0], this.explainMode);\r\n        }\r\n        // Reset margin-top that was set as Fix for #26416\r\n        this.listElement.style.marginTop = '0px';\r\n        // with docs showing up widget width/height may change, so reposition the widget\r\n        this.editor.layoutContentWidget(this);\r\n        this.adjustDocsPosition();\r\n        this.editor.focus();\r\n    };\r\n    SuggestWidget.prototype.toggleExplainMode = function () {\r\n        if (this.list.getFocusedElements()[0] && this.expandDocsSettingFromStorage()) {\r\n            this.explainMode = !this.explainMode;\r\n            this.showDetails(false);\r\n        }\r\n    };\r\n    SuggestWidget.prototype.show = function () {\r\n        var _this = this;\r\n        var newHeight = this.updateListHeight();\r\n        if (newHeight !== this.listHeight) {\r\n            this.editor.layoutContentWidget(this);\r\n            this.listHeight = newHeight;\r\n        }\r\n        this.suggestWidgetVisible.set(true);\r\n        this.showTimeout.cancelAndSet(function () {\r\n            addClass(_this.element, 'visible');\r\n            _this.onDidShowEmitter.fire(_this);\r\n        }, 100);\r\n    };\r\n    SuggestWidget.prototype.hide = function () {\r\n        this.suggestWidgetVisible.reset();\r\n        this.suggestWidgetMultipleSuggestions.reset();\r\n        removeClass(this.element, 'visible');\r\n    };\r\n    SuggestWidget.prototype.hideWidget = function () {\r\n        this.loadingTimeout.dispose();\r\n        this.setState(0 /* Hidden */);\r\n        this.onDidHideEmitter.fire(this);\r\n    };\r\n    SuggestWidget.prototype.getPosition = function () {\r\n        if (this.state === 0 /* Hidden */) {\r\n            return null;\r\n        }\r\n        var preference = [2 /* BELOW */, 1 /* ABOVE */];\r\n        if (this.preferDocPositionTop) {\r\n            preference = [1 /* ABOVE */];\r\n        }\r\n        return {\r\n            position: this.editor.getPosition(),\r\n            preference: preference\r\n        };\r\n    };\r\n    SuggestWidget.prototype.getDomNode = function () {\r\n        return this.element;\r\n    };\r\n    SuggestWidget.prototype.getId = function () {\r\n        return SuggestWidget.ID;\r\n    };\r\n    SuggestWidget.prototype.isFrozen = function () {\r\n        return this.state === 4 /* Frozen */;\r\n    };\r\n    SuggestWidget.prototype.updateListHeight = function () {\r\n        var height = 0;\r\n        if (this.state === 2 /* Empty */ || this.state === 1 /* Loading */) {\r\n            height = this.unfocusedHeight;\r\n        }\r\n        else {\r\n            var suggestionCount = this.list.contentHeight / this.unfocusedHeight;\r\n            var maxVisibleSuggestions = this.editor.getOption(85 /* suggest */).maxVisibleSuggestions;\r\n            height = Math.min(suggestionCount, maxVisibleSuggestions) * this.unfocusedHeight;\r\n        }\r\n        this.element.style.lineHeight = this.unfocusedHeight + \"px\";\r\n        this.listElement.style.height = height + \"px\";\r\n        this.list.layout(height);\r\n        return height;\r\n    };\r\n    /**\r\n     * Adds the propert classes, margins when positioning the docs to the side\r\n     */\r\n    SuggestWidget.prototype.adjustDocsPosition = function () {\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        var lineHeight = this.editor.getOption(47 /* lineHeight */);\r\n        var cursorCoords = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\r\n        var editorCoords = getDomNodePagePosition(this.editor.getDomNode());\r\n        var cursorX = editorCoords.left + cursorCoords.left;\r\n        var cursorY = editorCoords.top + cursorCoords.top + cursorCoords.height;\r\n        var widgetCoords = getDomNodePagePosition(this.element);\r\n        var widgetX = widgetCoords.left;\r\n        var widgetY = widgetCoords.top;\r\n        // Fixes #27649\r\n        // Check if the Y changed to the top of the cursor and keep the widget flagged to prefer top\r\n        if (this.docsPositionPreviousWidgetY &&\r\n            this.docsPositionPreviousWidgetY < widgetY &&\r\n            !this.preferDocPositionTop) {\r\n            this.preferDocPositionTop = true;\r\n            this.adjustDocsPosition();\r\n            return;\r\n        }\r\n        this.docsPositionPreviousWidgetY = widgetY;\r\n        if (widgetX < cursorX - this.listWidth) {\r\n            // Widget is too far to the left of cursor, swap list and docs\r\n            addClass(this.element, 'list-right');\r\n        }\r\n        else {\r\n            removeClass(this.element, 'list-right');\r\n        }\r\n        // Compare top of the cursor (cursorY - lineheight) with widgetTop to determine if\r\n        // margin-top needs to be applied on list to make it appear right above the cursor\r\n        // Cannot compare cursorY directly as it may be a few decimals off due to zoooming\r\n        if (hasClass(this.element, 'docs-side')\r\n            && cursorY - lineHeight > widgetY\r\n            && this.details.element.offsetHeight > this.listElement.offsetHeight) {\r\n            // Fix for #26416\r\n            // Docs is bigger than list and widget is above cursor, apply margin-top so that list appears right above cursor\r\n            this.listElement.style.marginTop = this.details.element.offsetHeight - this.listElement.offsetHeight + \"px\";\r\n        }\r\n    };\r\n    /**\r\n     * Adds the proper classes for positioning the docs to the side or below\r\n     */\r\n    SuggestWidget.prototype.expandSideOrBelow = function () {\r\n        if (!canExpandCompletionItem(this.focusedItem) && this.firstFocusInCurrentList) {\r\n            removeClass(this.element, 'docs-side');\r\n            removeClass(this.element, 'docs-below');\r\n            return;\r\n        }\r\n        var matches = this.element.style.maxWidth.match(/(\\d+)px/);\r\n        if (!matches || Number(matches[1]) < this.maxWidgetWidth) {\r\n            addClass(this.element, 'docs-below');\r\n            removeClass(this.element, 'docs-side');\r\n        }\r\n        else if (canExpandCompletionItem(this.focusedItem)) {\r\n            addClass(this.element, 'docs-side');\r\n            removeClass(this.element, 'docs-below');\r\n        }\r\n    };\r\n    Object.defineProperty(SuggestWidget.prototype, \"maxWidgetHeight\", {\r\n        // Heights\r\n        get: function () {\r\n            return this.unfocusedHeight * this.editor.getOption(85 /* suggest */).maxVisibleSuggestions;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SuggestWidget.prototype, \"unfocusedHeight\", {\r\n        get: function () {\r\n            var options = this.editor.getOptions();\r\n            return options.get(87 /* suggestLineHeight */) || options.get(32 /* fontInfo */).lineHeight;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // IDelegate\r\n    SuggestWidget.prototype.getHeight = function (element) {\r\n        return this.unfocusedHeight;\r\n    };\r\n    SuggestWidget.prototype.getTemplateId = function (element) {\r\n        return 'suggestion';\r\n    };\r\n    SuggestWidget.prototype.expandDocsSettingFromStorage = function () {\r\n        return this.storageService.getBoolean('expandSuggestionDocs', 0 /* GLOBAL */, expandSuggestionDocsByDefault);\r\n    };\r\n    SuggestWidget.prototype.updateExpandDocsSetting = function (value) {\r\n        this.storageService.store('expandSuggestionDocs', value, 0 /* GLOBAL */);\r\n    };\r\n    SuggestWidget.prototype.dispose = function () {\r\n        this.details.dispose();\r\n        this.list.dispose();\r\n        this.toDispose.dispose();\r\n        this.loadingTimeout.dispose();\r\n        this.showTimeout.dispose();\r\n    };\r\n    SuggestWidget.ID = 'editor.widget.suggestWidget';\r\n    SuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\r\n    SuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\r\n    SuggestWidget = __decorate([\r\n        __param(1, ITelemetryService),\r\n        __param(2, IContextKeyService),\r\n        __param(3, IThemeService),\r\n        __param(4, IStorageService),\r\n        __param(5, IKeybindingService),\r\n        __param(6, IModeService),\r\n        __param(7, IOpenerService),\r\n        __param(8, IInstantiationService)\r\n    ], SuggestWidget);\r\n    return SuggestWidget;\r\n}());\r\nexport { SuggestWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var matchHighlight = theme.getColor(editorSuggestWidgetHighlightForeground);\r\n    if (matchHighlight) {\r\n        collector.addRule(\".monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: \" + matchHighlight + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(editorSuggestWidgetForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .suggest-widget { color: \" + foreground + \"; }\");\r\n    }\r\n    var link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(\".monaco-editor .suggest-widget a { color: \" + link + \"; }\");\r\n    }\r\n    var codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(\".monaco-editor .suggest-widget code { background-color: \" + codeBackground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { dispose, Disposable } from '../../../base/common/lifecycle.js';\r\nvar WordContextKey = /** @class */ (function (_super) {\r\n    __extends(WordContextKey, _super);\r\n    function WordContextKey(_editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._enabled = false;\r\n        _this._ckAtEnd = WordContextKey.AtEnd.bindTo(contextKeyService);\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) { return e.hasChanged(90 /* tabCompletion */) && _this._update(); }));\r\n        _this._update();\r\n        return _this;\r\n    }\r\n    WordContextKey.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        dispose(this._selectionListener);\r\n        this._ckAtEnd.reset();\r\n    };\r\n    WordContextKey.prototype._update = function () {\r\n        var _this = this;\r\n        // only update this when tab completions are enabled\r\n        var enabled = this._editor.getOption(90 /* tabCompletion */) === 'on';\r\n        if (this._enabled === enabled) {\r\n            return;\r\n        }\r\n        this._enabled = enabled;\r\n        if (this._enabled) {\r\n            var checkForWordEnd = function () {\r\n                if (!_this._editor.hasModel()) {\r\n                    _this._ckAtEnd.set(false);\r\n                    return;\r\n                }\r\n                var model = _this._editor.getModel();\r\n                var selection = _this._editor.getSelection();\r\n                var word = model.getWordAtPosition(selection.getStartPosition());\r\n                if (!word) {\r\n                    _this._ckAtEnd.set(false);\r\n                    return;\r\n                }\r\n                _this._ckAtEnd.set(word.endColumn === selection.getStartPosition().column);\r\n            };\r\n            this._selectionListener = this._editor.onDidChangeCursorSelection(checkForWordEnd);\r\n            checkForWordEnd();\r\n        }\r\n        else if (this._selectionListener) {\r\n            this._ckAtEnd.reset();\r\n            this._selectionListener.dispose();\r\n            this._selectionListener = undefined;\r\n        }\r\n    };\r\n    WordContextKey.AtEnd = new RawContextKey('atEndOfWord', false);\r\n    WordContextKey = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], WordContextKey);\r\n    return WordContextKey;\r\n}(Disposable));\r\nexport { WordContextKey };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nvar CommitCharacterController = /** @class */ (function () {\r\n    function CommitCharacterController(editor, widget, accept) {\r\n        var _this = this;\r\n        this._disposables = new DisposableStore();\r\n        this._disposables.add(widget.onDidShow(function () { return _this._onItem(widget.getFocusedItem()); }));\r\n        this._disposables.add(widget.onDidFocus(this._onItem, this));\r\n        this._disposables.add(widget.onDidHide(this.reset, this));\r\n        this._disposables.add(editor.onWillType(function (text) {\r\n            if (_this._active && !widget.isFrozen()) {\r\n                var ch = text.charCodeAt(text.length - 1);\r\n                if (_this._active.acceptCharacters.has(ch) && editor.getOption(0 /* acceptSuggestionOnCommitCharacter */)) {\r\n                    accept(_this._active.item);\r\n                }\r\n            }\r\n        }));\r\n    }\r\n    CommitCharacterController.prototype._onItem = function (selected) {\r\n        if (!selected || !isNonEmptyArray(selected.item.completion.commitCharacters)) {\r\n            // no item or no commit characters\r\n            this.reset();\r\n            return;\r\n        }\r\n        if (this._active && this._active.item.item === selected.item) {\r\n            // still the same item\r\n            return;\r\n        }\r\n        // keep item and its commit characters\r\n        var acceptCharacters = new CharacterSet();\r\n        for (var _i = 0, _a = selected.item.completion.commitCharacters; _i < _a.length; _i++) {\r\n            var ch = _a[_i];\r\n            if (ch.length > 0) {\r\n                acceptCharacters.add(ch.charCodeAt(0));\r\n            }\r\n        }\r\n        this._active = { acceptCharacters: acceptCharacters, item: selected };\r\n    };\r\n    CommitCharacterController.prototype.reset = function () {\r\n        this._active = undefined;\r\n    };\r\n    CommitCharacterController.prototype.dispose = function () {\r\n        this._disposables.dispose();\r\n    };\r\n    return CommitCharacterController;\r\n}());\r\nexport { CommitCharacterController };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { DisposableStore, dispose } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { domEvent } from '../../../base/browser/event.js';\r\nvar SuggestRangeHighlighter = /** @class */ (function () {\r\n    function SuggestRangeHighlighter(_controller) {\r\n        var _this = this;\r\n        this._controller = _controller;\r\n        this._disposables = new DisposableStore();\r\n        this._decorations = [];\r\n        this._disposables.add(_controller.model.onDidSuggest(function (e) {\r\n            if (!e.shy) {\r\n                var widget = _this._controller.widget.getValue();\r\n                var focused = widget.getFocusedItem();\r\n                if (focused) {\r\n                    _this._highlight(focused.item);\r\n                }\r\n                if (!_this._widgetListener) {\r\n                    _this._widgetListener = widget.onDidFocus(function (e) { return _this._highlight(e.item); });\r\n                }\r\n            }\r\n        }));\r\n        this._disposables.add(_controller.model.onDidCancel(function () {\r\n            _this._reset();\r\n        }));\r\n    }\r\n    SuggestRangeHighlighter.prototype.dispose = function () {\r\n        this._reset();\r\n        this._disposables.dispose();\r\n        dispose(this._widgetListener);\r\n        dispose(this._shiftKeyListener);\r\n    };\r\n    SuggestRangeHighlighter.prototype._reset = function () {\r\n        this._decorations = this._controller.editor.deltaDecorations(this._decorations, []);\r\n        if (this._shiftKeyListener) {\r\n            this._shiftKeyListener.dispose();\r\n            this._shiftKeyListener = undefined;\r\n        }\r\n    };\r\n    SuggestRangeHighlighter.prototype._highlight = function (item) {\r\n        var _this = this;\r\n        var _a;\r\n        this._currentItem = item;\r\n        var opts = this._controller.editor.getOption(85 /* suggest */);\r\n        var newDeco = [];\r\n        if (opts.insertHighlight) {\r\n            if (!this._shiftKeyListener) {\r\n                this._shiftKeyListener = shiftKey.event(function () { return _this._highlight(_this._currentItem); });\r\n            }\r\n            var info = this._controller.getOverwriteInfo(item, shiftKey.isPressed);\r\n            var position = this._controller.editor.getPosition();\r\n            if (opts.insertMode === 'insert' && info.overwriteAfter > 0) {\r\n                // wants inserts but got replace-mode -> highlight AFTER range\r\n                newDeco = [{\r\n                        range: new Range(position.lineNumber, position.column, position.lineNumber, position.column + info.overwriteAfter),\r\n                        options: { inlineClassName: 'suggest-insert-unexpected' }\r\n                    }];\r\n            }\r\n            else if (opts.insertMode === 'replace' && info.overwriteAfter === 0) {\r\n                // want replace but likely got insert -> highlight AFTER range\r\n                var wordInfo = (_a = this._controller.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position);\r\n                if (wordInfo && wordInfo.endColumn > position.column) {\r\n                    newDeco = [{\r\n                            range: new Range(position.lineNumber, position.column, position.lineNumber, wordInfo.endColumn),\r\n                            options: { inlineClassName: 'suggest-insert-unexpected' }\r\n                        }];\r\n                }\r\n            }\r\n        }\r\n        // update editor decorations\r\n        this._decorations = this._controller.editor.deltaDecorations(this._decorations, newDeco);\r\n    };\r\n    return SuggestRangeHighlighter;\r\n}());\r\nexport { SuggestRangeHighlighter };\r\nvar shiftKey = new /** @class */ (function (_super) {\r\n    __extends(ShiftKey, _super);\r\n    function ShiftKey() {\r\n        var _this = _super.call(this) || this;\r\n        _this._subscriptions = new DisposableStore();\r\n        _this._isPressed = false;\r\n        _this._subscriptions.add(domEvent(document.body, 'keydown')(function (e) { return _this.isPressed = e.shiftKey; }));\r\n        _this._subscriptions.add(domEvent(document.body, 'keyup')(function () { return _this.isPressed = false; }));\r\n        _this._subscriptions.add(domEvent(document.body, 'mouseleave')(function () { return _this.isPressed = false; }));\r\n        _this._subscriptions.add(domEvent(document.body, 'blur')(function () { return _this.isPressed = false; }));\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ShiftKey.prototype, \"isPressed\", {\r\n        get: function () {\r\n            return this._isPressed;\r\n        },\r\n        set: function (value) {\r\n            if (this._isPressed !== value) {\r\n                this._isPressed = value;\r\n                this.fire(value);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ShiftKey.prototype.dispose = function () {\r\n        this._subscriptions.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return ShiftKey;\r\n}(Emitter));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { SimpleKeybinding } from '../../../base/common/keyCodes.js';\r\nimport { dispose, DisposableStore, toDisposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { SnippetController2 } from '../snippet/snippetController2.js';\r\nimport { SnippetParser } from '../snippet/snippetParser.js';\r\nimport { ISuggestMemoryService } from './suggestMemory.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ICommandService, CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { Context as SuggestContext } from './suggest.js';\r\nimport { SuggestAlternatives } from './suggestAlternatives.js';\r\nimport { SuggestModel } from './suggestModel.js';\r\nimport { SuggestWidget } from './suggestWidget.js';\r\nimport { WordContextKey } from './wordContextKey.js';\r\nimport { Event } from '../../../base/common/event.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { IdleValue } from '../../../base/common/async.js';\r\nimport { isObject, assertType } from '../../../base/common/types.js';\r\nimport { CommitCharacterController } from './suggestCommitCharacters.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { SuggestRangeHighlighter } from './suggestRangeHighlighter.js';\r\n/**\r\n * Stop suggest widget from disappearing when clicking into other areas\r\n * For development purpose only\r\n */\r\nvar _sticky = false;\r\nvar LineSuffix = /** @class */ (function () {\r\n    function LineSuffix(_model, _position) {\r\n        this._model = _model;\r\n        this._position = _position;\r\n        // spy on what's happening right of the cursor. two cases:\r\n        // 1. end of line -> check that it's still end of line\r\n        // 2. mid of line -> add a marker and compute the delta\r\n        var maxColumn = _model.getLineMaxColumn(_position.lineNumber);\r\n        if (maxColumn !== _position.column) {\r\n            var offset = _model.getOffsetAt(_position);\r\n            var end = _model.getPositionAt(offset + 1);\r\n            this._marker = _model.deltaDecorations([], [{\r\n                    range: Range.fromPositions(_position, end),\r\n                    options: { stickiness: 1 /* NeverGrowsWhenTypingAtEdges */ }\r\n                }]);\r\n        }\r\n    }\r\n    LineSuffix.prototype.dispose = function () {\r\n        if (this._marker && !this._model.isDisposed()) {\r\n            this._model.deltaDecorations(this._marker, []);\r\n        }\r\n    };\r\n    LineSuffix.prototype.delta = function (position) {\r\n        if (this._model.isDisposed() || this._position.lineNumber !== position.lineNumber) {\r\n            // bail out early if things seems fishy\r\n            return 0;\r\n        }\r\n        // read the marker (in case suggest was triggered at line end) or compare\r\n        // the cursor to the line end.\r\n        if (this._marker) {\r\n            var range = this._model.getDecorationRange(this._marker[0]);\r\n            var end = this._model.getOffsetAt(range.getStartPosition());\r\n            return end - this._model.getOffsetAt(position);\r\n        }\r\n        else {\r\n            return this._model.getLineMaxColumn(position.lineNumber) - position.column;\r\n        }\r\n    };\r\n    return LineSuffix;\r\n}());\r\nvar SuggestController = /** @class */ (function () {\r\n    function SuggestController(editor, editorWorker, _memoryService, _commandService, _contextKeyService, _instantiationService) {\r\n        var _this = this;\r\n        this._memoryService = _memoryService;\r\n        this._commandService = _commandService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._instantiationService = _instantiationService;\r\n        this._lineSuffix = new MutableDisposable();\r\n        this._toDispose = new DisposableStore();\r\n        this.editor = editor;\r\n        this.model = new SuggestModel(this.editor, editorWorker);\r\n        this.widget = new IdleValue(function () {\r\n            var widget = _this._instantiationService.createInstance(SuggestWidget, _this.editor);\r\n            _this._toDispose.add(widget);\r\n            _this._toDispose.add(widget.onDidSelect(function (item) { return _this._insertSuggestion(item, 0); }, _this));\r\n            // Wire up logic to accept a suggestion on certain characters\r\n            var commitCharacterController = new CommitCharacterController(_this.editor, widget, function (item) { return _this._insertSuggestion(item, 2 /* NoAfterUndoStop */); });\r\n            _this._toDispose.add(commitCharacterController);\r\n            _this._toDispose.add(_this.model.onDidSuggest(function (e) {\r\n                if (e.completionModel.items.length === 0) {\r\n                    commitCharacterController.reset();\r\n                }\r\n            }));\r\n            // Wire up makes text edit context key\r\n            var makesTextEdit = SuggestContext.MakesTextEdit.bindTo(_this._contextKeyService);\r\n            _this._toDispose.add(widget.onDidFocus(function (_a) {\r\n                var item = _a.item;\r\n                var position = _this.editor.getPosition();\r\n                var startColumn = item.editStart.column;\r\n                var endColumn = position.column;\r\n                var value = true;\r\n                if (_this.editor.getOption(1 /* acceptSuggestionOnEnter */) === 'smart'\r\n                    && _this.model.state === 2 /* Auto */\r\n                    && !item.completion.command\r\n                    && !item.completion.additionalTextEdits\r\n                    && !(item.completion.insertTextRules & 4 /* InsertAsSnippet */)\r\n                    && endColumn - startColumn === item.completion.insertText.length) {\r\n                    var oldText = _this.editor.getModel().getValueInRange({\r\n                        startLineNumber: position.lineNumber,\r\n                        startColumn: startColumn,\r\n                        endLineNumber: position.lineNumber,\r\n                        endColumn: endColumn\r\n                    });\r\n                    value = oldText !== item.completion.insertText;\r\n                }\r\n                makesTextEdit.set(value);\r\n            }));\r\n            _this._toDispose.add(toDisposable(function () { return makesTextEdit.reset(); }));\r\n            return widget;\r\n        });\r\n        this._alternatives = new IdleValue(function () {\r\n            return _this._toDispose.add(new SuggestAlternatives(_this.editor, _this._contextKeyService));\r\n        });\r\n        this._toDispose.add(_instantiationService.createInstance(WordContextKey, editor));\r\n        this._toDispose.add(this.model.onDidTrigger(function (e) {\r\n            _this.widget.getValue().showTriggered(e.auto, e.shy ? 250 : 50);\r\n            _this._lineSuffix.value = new LineSuffix(_this.editor.getModel(), e.position);\r\n        }));\r\n        this._toDispose.add(this.model.onDidSuggest(function (e) {\r\n            if (!e.shy) {\r\n                var index = _this._memoryService.select(_this.editor.getModel(), _this.editor.getPosition(), e.completionModel.items);\r\n                _this.widget.getValue().showSuggestions(e.completionModel, index, e.isFrozen, e.auto);\r\n            }\r\n        }));\r\n        this._toDispose.add(this.model.onDidCancel(function (e) {\r\n            if (!e.retrigger) {\r\n                _this.widget.getValue().hideWidget();\r\n            }\r\n        }));\r\n        this._toDispose.add(this.editor.onDidBlurEditorWidget(function () {\r\n            if (!_sticky) {\r\n                _this.model.cancel();\r\n                _this.model.clear();\r\n            }\r\n        }));\r\n        this._toDispose.add(this.widget.getValue().onDetailsKeyDown(function (e) {\r\n            // cmd + c on macOS, ctrl + c on Win / Linux\r\n            if (e.toKeybinding().equals(new SimpleKeybinding(true, false, false, false, 33 /* KEY_C */)) ||\r\n                (platform.isMacintosh && e.toKeybinding().equals(new SimpleKeybinding(false, false, false, true, 33 /* KEY_C */)))) {\r\n                e.stopPropagation();\r\n                return;\r\n            }\r\n            if (!e.toKeybinding().isModifierKey()) {\r\n                _this.editor.focus();\r\n            }\r\n        }));\r\n        // Manage the acceptSuggestionsOnEnter context key\r\n        var acceptSuggestionsOnEnter = SuggestContext.AcceptSuggestionsOnEnter.bindTo(_contextKeyService);\r\n        var updateFromConfig = function () {\r\n            var acceptSuggestionOnEnter = _this.editor.getOption(1 /* acceptSuggestionOnEnter */);\r\n            acceptSuggestionsOnEnter.set(acceptSuggestionOnEnter === 'on' || acceptSuggestionOnEnter === 'smart');\r\n        };\r\n        this._toDispose.add(this.editor.onDidChangeConfiguration(function () { return updateFromConfig(); }));\r\n        updateFromConfig();\r\n        // create range highlighter\r\n        this._toDispose.add(new SuggestRangeHighlighter(this));\r\n    }\r\n    SuggestController.get = function (editor) {\r\n        return editor.getContribution(SuggestController.ID);\r\n    };\r\n    SuggestController.prototype.dispose = function () {\r\n        this._alternatives.dispose();\r\n        this._toDispose.dispose();\r\n        this.widget.dispose();\r\n        this.model.dispose();\r\n        this._lineSuffix.dispose();\r\n    };\r\n    SuggestController.prototype._insertSuggestion = function (event, flags) {\r\n        var _a;\r\n        var _this = this;\r\n        if (!event || !event.item) {\r\n            this._alternatives.getValue().reset();\r\n            this.model.cancel();\r\n            this.model.clear();\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this.editor.getModel();\r\n        var modelVersionNow = model.getAlternativeVersionId();\r\n        var item = event.item;\r\n        var suggestion = item.completion;\r\n        // pushing undo stops *before* additional text edits and\r\n        // *after* the main edit\r\n        if (!(flags & 1 /* NoBeforeUndoStop */)) {\r\n            this.editor.pushUndoStop();\r\n        }\r\n        // compute overwrite[Before|After] deltas BEFORE applying extra edits\r\n        var info = this.getOverwriteInfo(item, Boolean(flags & 8 /* AlternativeOverwriteConfig */));\r\n        // keep item in memory\r\n        this._memoryService.memorize(model, this.editor.getPosition(), item);\r\n        if (Array.isArray(suggestion.additionalTextEdits)) {\r\n            this.editor.executeEdits('suggestController.additionalTextEdits', suggestion.additionalTextEdits.map(function (edit) { return EditOperation.replace(Range.lift(edit.range), edit.text); }));\r\n        }\r\n        var insertText = suggestion.insertText;\r\n        if (!(suggestion.insertTextRules & 4 /* InsertAsSnippet */)) {\r\n            insertText = SnippetParser.escape(insertText);\r\n        }\r\n        SnippetController2.get(this.editor).insert(insertText, {\r\n            overwriteBefore: info.overwriteBefore,\r\n            overwriteAfter: info.overwriteAfter,\r\n            undoStopBefore: false,\r\n            undoStopAfter: false,\r\n            adjustWhitespace: !(suggestion.insertTextRules & 1 /* KeepWhitespace */)\r\n        });\r\n        if (!(flags & 2 /* NoAfterUndoStop */)) {\r\n            this.editor.pushUndoStop();\r\n        }\r\n        if (!suggestion.command) {\r\n            // done\r\n            this.model.cancel();\r\n            this.model.clear();\r\n        }\r\n        else if (suggestion.command.id === TriggerSuggestAction.id) {\r\n            // retigger\r\n            this.model.trigger({ auto: true, shy: false }, true);\r\n        }\r\n        else {\r\n            // exec command, done\r\n            (_a = this._commandService).executeCommand.apply(_a, __spreadArrays([suggestion.command.id], (suggestion.command.arguments ? __spreadArrays(suggestion.command.arguments) : []))).catch(onUnexpectedError)\r\n                .finally(function () { return _this.model.clear(); }); // <- clear only now, keep commands alive\r\n            this.model.cancel();\r\n        }\r\n        if (flags & 4 /* KeepAlternativeSuggestions */) {\r\n            this._alternatives.getValue().set(event, function (next) {\r\n                // this is not so pretty. when inserting the 'next'\r\n                // suggestion we undo until we are at the state at\r\n                // which we were before inserting the previous suggestion...\r\n                while (model.canUndo()) {\r\n                    if (modelVersionNow !== model.getAlternativeVersionId()) {\r\n                        model.undo();\r\n                    }\r\n                    _this._insertSuggestion(next, 1 /* NoBeforeUndoStop */ | 2 /* NoAfterUndoStop */ | (flags & 8 /* AlternativeOverwriteConfig */ ? 8 /* AlternativeOverwriteConfig */ : 0));\r\n                    break;\r\n                }\r\n            });\r\n        }\r\n        this._alertCompletionItem(event.item);\r\n    };\r\n    SuggestController.prototype.getOverwriteInfo = function (item, toggleMode) {\r\n        assertType(this.editor.hasModel());\r\n        var replace = this.editor.getOption(85 /* suggest */).insertMode === 'replace';\r\n        if (toggleMode) {\r\n            replace = !replace;\r\n        }\r\n        var overwriteBefore = item.position.column - item.editStart.column;\r\n        var overwriteAfter = (replace ? item.editReplaceEnd.column : item.editInsertEnd.column) - item.position.column;\r\n        var columnDelta = this.editor.getPosition().column - item.position.column;\r\n        var suffixDelta = this._lineSuffix.value ? this._lineSuffix.value.delta(this.editor.getPosition()) : 0;\r\n        return {\r\n            overwriteBefore: overwriteBefore + columnDelta,\r\n            overwriteAfter: overwriteAfter + suffixDelta\r\n        };\r\n    };\r\n    SuggestController.prototype._alertCompletionItem = function (_a) {\r\n        var suggestion = _a.completion;\r\n        if (isNonEmptyArray(suggestion.additionalTextEdits)) {\r\n            var msg = nls.localize('arai.alert.snippet', \"Accepting '{0}' made {1} additional edits\", suggestion.label, suggestion.additionalTextEdits.length);\r\n            alert(msg);\r\n        }\r\n    };\r\n    SuggestController.prototype.triggerSuggest = function (onlyFrom) {\r\n        if (this.editor.hasModel()) {\r\n            this.model.trigger({ auto: false, shy: false }, false, onlyFrom);\r\n            this.editor.revealLine(this.editor.getPosition().lineNumber, 0 /* Smooth */);\r\n            this.editor.focus();\r\n        }\r\n    };\r\n    SuggestController.prototype.triggerSuggestAndAcceptBest = function (arg) {\r\n        var _this = this;\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        var positionNow = this.editor.getPosition();\r\n        var fallback = function () {\r\n            if (positionNow.equals(_this.editor.getPosition())) {\r\n                _this._commandService.executeCommand(arg.fallback);\r\n            }\r\n        };\r\n        var makesTextEdit = function (item) {\r\n            if (item.completion.insertTextRules & 4 /* InsertAsSnippet */ || item.completion.additionalTextEdits) {\r\n                // snippet, other editor -> makes edit\r\n                return true;\r\n            }\r\n            var position = _this.editor.getPosition();\r\n            var startColumn = item.editStart.column;\r\n            var endColumn = position.column;\r\n            if (endColumn - startColumn !== item.completion.insertText.length) {\r\n                // unequal lengths -> makes edit\r\n                return true;\r\n            }\r\n            var textNow = _this.editor.getModel().getValueInRange({\r\n                startLineNumber: position.lineNumber,\r\n                startColumn: startColumn,\r\n                endLineNumber: position.lineNumber,\r\n                endColumn: endColumn\r\n            });\r\n            // unequal text -> makes edit\r\n            return textNow !== item.completion.insertText;\r\n        };\r\n        Event.once(this.model.onDidTrigger)(function (_) {\r\n            // wait for trigger because only then the cancel-event is trustworthy\r\n            var listener = [];\r\n            Event.any(_this.model.onDidTrigger, _this.model.onDidCancel)(function () {\r\n                // retrigger or cancel -> try to type default text\r\n                dispose(listener);\r\n                fallback();\r\n            }, undefined, listener);\r\n            _this.model.onDidSuggest(function (_a) {\r\n                var completionModel = _a.completionModel;\r\n                dispose(listener);\r\n                if (completionModel.items.length === 0) {\r\n                    fallback();\r\n                    return;\r\n                }\r\n                var index = _this._memoryService.select(_this.editor.getModel(), _this.editor.getPosition(), completionModel.items);\r\n                var item = completionModel.items[index];\r\n                if (!makesTextEdit(item)) {\r\n                    fallback();\r\n                    return;\r\n                }\r\n                _this.editor.pushUndoStop();\r\n                _this._insertSuggestion({ index: index, item: item, model: completionModel }, 4 /* KeepAlternativeSuggestions */ | 1 /* NoBeforeUndoStop */ | 2 /* NoAfterUndoStop */);\r\n            }, undefined, listener);\r\n        });\r\n        this.model.trigger({ auto: false, shy: true });\r\n        this.editor.revealLine(positionNow.lineNumber, 0 /* Smooth */);\r\n        this.editor.focus();\r\n    };\r\n    SuggestController.prototype.acceptSelectedSuggestion = function (keepAlternativeSuggestions, alternativeOverwriteConfig) {\r\n        var item = this.widget.getValue().getFocusedItem();\r\n        var flags = 0;\r\n        if (keepAlternativeSuggestions) {\r\n            flags |= 4 /* KeepAlternativeSuggestions */;\r\n        }\r\n        if (alternativeOverwriteConfig) {\r\n            flags |= 8 /* AlternativeOverwriteConfig */;\r\n        }\r\n        this._insertSuggestion(item, flags);\r\n    };\r\n    SuggestController.prototype.acceptNextSuggestion = function () {\r\n        this._alternatives.getValue().next();\r\n    };\r\n    SuggestController.prototype.acceptPrevSuggestion = function () {\r\n        this._alternatives.getValue().prev();\r\n    };\r\n    SuggestController.prototype.cancelSuggestWidget = function () {\r\n        this.model.cancel();\r\n        this.model.clear();\r\n        this.widget.getValue().hideWidget();\r\n    };\r\n    SuggestController.prototype.selectNextSuggestion = function () {\r\n        this.widget.getValue().selectNext();\r\n    };\r\n    SuggestController.prototype.selectNextPageSuggestion = function () {\r\n        this.widget.getValue().selectNextPage();\r\n    };\r\n    SuggestController.prototype.selectLastSuggestion = function () {\r\n        this.widget.getValue().selectLast();\r\n    };\r\n    SuggestController.prototype.selectPrevSuggestion = function () {\r\n        this.widget.getValue().selectPrevious();\r\n    };\r\n    SuggestController.prototype.selectPrevPageSuggestion = function () {\r\n        this.widget.getValue().selectPreviousPage();\r\n    };\r\n    SuggestController.prototype.selectFirstSuggestion = function () {\r\n        this.widget.getValue().selectFirst();\r\n    };\r\n    SuggestController.prototype.toggleSuggestionDetails = function () {\r\n        this.widget.getValue().toggleDetails();\r\n    };\r\n    SuggestController.prototype.toggleExplainMode = function () {\r\n        this.widget.getValue().toggleExplainMode();\r\n    };\r\n    SuggestController.prototype.toggleSuggestionFocus = function () {\r\n        this.widget.getValue().toggleDetailsFocus();\r\n    };\r\n    SuggestController.ID = 'editor.contrib.suggestController';\r\n    SuggestController = __decorate([\r\n        __param(1, IEditorWorkerService),\r\n        __param(2, ISuggestMemoryService),\r\n        __param(3, ICommandService),\r\n        __param(4, IContextKeyService),\r\n        __param(5, IInstantiationService)\r\n    ], SuggestController);\r\n    return SuggestController;\r\n}());\r\nexport { SuggestController };\r\nvar TriggerSuggestAction = /** @class */ (function (_super) {\r\n    __extends(TriggerSuggestAction, _super);\r\n    function TriggerSuggestAction() {\r\n        return _super.call(this, {\r\n            id: TriggerSuggestAction.id,\r\n            label: nls.localize('suggest.trigger.label', \"Trigger Suggest\"),\r\n            alias: 'Trigger Suggest',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCompletionItemProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 10 /* Space */,\r\n                mac: { primary: 256 /* WinCtrl */ | 10 /* Space */, secondary: [512 /* Alt */ | 9 /* Escape */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TriggerSuggestAction.prototype.run = function (accessor, editor) {\r\n        var controller = SuggestController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        controller.triggerSuggest();\r\n    };\r\n    TriggerSuggestAction.id = 'editor.action.triggerSuggest';\r\n    return TriggerSuggestAction;\r\n}(EditorAction));\r\nexport { TriggerSuggestAction };\r\nregisterEditorContribution(SuggestController.ID, SuggestController);\r\nregisterEditorAction(TriggerSuggestAction);\r\nvar weight = 100 /* EditorContrib */ + 90;\r\nvar SuggestCommand = EditorCommand.bindToContribution(SuggestController.get);\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'acceptSelectedSuggestion',\r\n    precondition: SuggestContext.Visible,\r\n    handler: function (x, args) {\r\n        var alternative = typeof args === 'object' && typeof args.alternative === 'boolean'\r\n            ? args.alternative\r\n            : false;\r\n        x.acceptSelectedSuggestion(true, alternative);\r\n    }\r\n}));\r\n// normal tab\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'acceptSelectedSuggestion',\r\n    when: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\r\n    primary: 2 /* Tab */,\r\n    weight: weight\r\n});\r\n// accept on enter has special rules\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'acceptSelectedSuggestion',\r\n    when: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.AcceptSuggestionsOnEnter, SuggestContext.MakesTextEdit),\r\n    primary: 3 /* Enter */,\r\n    weight: weight\r\n});\r\n// shift+enter and shift+tab use the alternative-flag so that the suggest controller\r\n// is doing the opposite of the editor.suggest.overwriteOnAccept-configuration\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'acceptSelectedSuggestion',\r\n    when: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\r\n    primary: 1024 /* Shift */ | 2 /* Tab */,\r\n    secondary: [1024 /* Shift */ | 3 /* Enter */],\r\n    args: { alternative: true },\r\n    weight: weight\r\n});\r\n// continue to support the old command\r\nCommandsRegistry.registerCommandAlias('acceptSelectedSuggestionOnEnter', 'acceptSelectedSuggestion');\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'hideSuggestWidget',\r\n    precondition: SuggestContext.Visible,\r\n    handler: function (x) { return x.cancelSuggestWidget(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectNextSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectNextSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 18 /* DownArrow */,\r\n        secondary: [2048 /* CtrlCmd */ | 18 /* DownArrow */],\r\n        mac: { primary: 18 /* DownArrow */, secondary: [2048 /* CtrlCmd */ | 18 /* DownArrow */, 256 /* WinCtrl */ | 44 /* KEY_N */] }\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectNextPageSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectNextPageSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 12 /* PageDown */,\r\n        secondary: [2048 /* CtrlCmd */ | 12 /* PageDown */]\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectLastSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectLastSuggestion(); }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectPrevSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectPrevSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 16 /* UpArrow */,\r\n        secondary: [2048 /* CtrlCmd */ | 16 /* UpArrow */],\r\n        mac: { primary: 16 /* UpArrow */, secondary: [2048 /* CtrlCmd */ | 16 /* UpArrow */, 256 /* WinCtrl */ | 46 /* KEY_P */] }\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectPrevPageSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectPrevPageSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 11 /* PageUp */,\r\n        secondary: [2048 /* CtrlCmd */ | 11 /* PageUp */]\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectFirstSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectFirstSuggestion(); }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'toggleSuggestionDetails',\r\n    precondition: SuggestContext.Visible,\r\n    handler: function (x) { return x.toggleSuggestionDetails(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2048 /* CtrlCmd */ | 10 /* Space */,\r\n        mac: { primary: 256 /* WinCtrl */ | 10 /* Space */ }\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'toggleExplainMode',\r\n    precondition: SuggestContext.Visible,\r\n    handler: function (x) { return x.toggleExplainMode(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */,\r\n        primary: 2048 /* CtrlCmd */ | 85 /* US_SLASH */,\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'toggleSuggestionFocus',\r\n    precondition: SuggestContext.Visible,\r\n    handler: function (x) { return x.toggleSuggestionFocus(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 10 /* Space */,\r\n        mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 10 /* Space */ }\r\n    }\r\n}));\r\n//#region tab completions\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'insertBestCompletion',\r\n    precondition: ContextKeyExpr.and(ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), WordContextKey.AtEnd, SuggestContext.Visible.toNegated(), SuggestAlternatives.OtherSuggestions.toNegated(), SnippetController2.InSnippetMode.toNegated()),\r\n    handler: function (x, arg) {\r\n        x.triggerSuggestAndAcceptBest(isObject(arg) ? __assign({ fallback: 'tab' }, arg) : { fallback: 'tab' });\r\n    },\r\n    kbOpts: {\r\n        weight: weight,\r\n        primary: 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'insertNextSuggestion',\r\n    precondition: ContextKeyExpr.and(ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\r\n    handler: function (x) { return x.acceptNextSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'insertPrevSuggestion',\r\n    precondition: ContextKeyExpr.and(ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\r\n    handler: function (x) { return x.acceptPrevSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 1024 /* Shift */ | 2 /* Tab */\r\n    }\r\n}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { StopWatch } from '../../../base/common/stopwatch.js';\r\nvar ForceRetokenizeAction = /** @class */ (function (_super) {\r\n    __extends(ForceRetokenizeAction, _super);\r\n    function ForceRetokenizeAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.forceRetokenize',\r\n            label: nls.localize('forceRetokenize', \"Developer: Force Retokenize\"),\r\n            alias: 'Developer: Force Retokenize',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    ForceRetokenizeAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        model.resetTokenization();\r\n        var sw = new StopWatch(true);\r\n        model.forceTokenization(model.getLineCount());\r\n        sw.stop();\r\n        console.log(\"tokenization took \" + sw.elapsed());\r\n    };\r\n    return ForceRetokenizeAction;\r\n}(EditorAction));\r\nregisterEditorAction(ForceRetokenizeAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { TabFocus } from '../../common/config/commonEditorConfig.js';\r\nvar ToggleTabFocusModeAction = /** @class */ (function (_super) {\r\n    __extends(ToggleTabFocusModeAction, _super);\r\n    function ToggleTabFocusModeAction() {\r\n        return _super.call(this, {\r\n            id: ToggleTabFocusModeAction.ID,\r\n            label: nls.localize({ key: 'toggle.tabMovesFocus', comment: ['Turn on/off use of tab key for moving focus around VS Code'] }, \"Toggle Tab Key Moves Focus\"),\r\n            alias: 'Toggle Tab Key Moves Focus',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 2048 /* CtrlCmd */ | 43 /* KEY_M */,\r\n                mac: { primary: 256 /* WinCtrl */ | 1024 /* Shift */ | 43 /* KEY_M */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ToggleTabFocusModeAction.prototype.run = function (accessor, editor) {\r\n        var oldValue = TabFocus.getTabFocusMode();\r\n        var newValue = !oldValue;\r\n        TabFocus.setTabFocusMode(newValue);\r\n        if (newValue) {\r\n            alert(nls.localize('toggle.tabMovesFocus.on', \"Pressing Tab will now move focus to the next focusable element\"));\r\n        }\r\n        else {\r\n            alert(nls.localize('toggle.tabMovesFocus.off', \"Pressing Tab will now insert the tab character\"));\r\n        }\r\n    };\r\n    ToggleTabFocusModeAction.ID = 'editor.action.toggleTabFocusMode';\r\n    return ToggleTabFocusModeAction;\r\n}(EditorAction));\r\nexport { ToggleTabFocusModeAction };\r\nregisterEditorAction(ToggleTabFocusModeAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as arrays from '../../../base/common/arrays.js';\r\nimport { createCancelablePromise, first, timeout } from '../../../base/common/async.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerDefaultLanguageCommand, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { DocumentHighlightKind, DocumentHighlightProviderRegistry } from '../../common/modes.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { activeContrastBorder, editorSelectionHighlight, editorSelectionHighlightBorder, overviewRulerSelectionHighlightForeground, registerColor } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant, themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nvar editorWordHighlight = registerColor('editor.wordHighlightBackground', { dark: '#575757B8', light: '#57575740', hc: null }, nls.localize('wordHighlight', 'Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nvar editorWordHighlightStrong = registerColor('editor.wordHighlightStrongBackground', { dark: '#004972B8', light: '#0e639c40', hc: null }, nls.localize('wordHighlightStrong', 'Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nvar editorWordHighlightBorder = registerColor('editor.wordHighlightBorder', { light: null, dark: null, hc: activeContrastBorder }, nls.localize('wordHighlightBorder', 'Border color of a symbol during read-access, like reading a variable.'));\r\nvar editorWordHighlightStrongBorder = registerColor('editor.wordHighlightStrongBorder', { light: null, dark: null, hc: activeContrastBorder }, nls.localize('wordHighlightStrongBorder', 'Border color of a symbol during write-access, like writing to a variable.'));\r\nvar overviewRulerWordHighlightForeground = registerColor('editorOverviewRuler.wordHighlightForeground', { dark: '#A0A0A0CC', light: '#A0A0A0CC', hc: '#A0A0A0CC' }, nls.localize('overviewRulerWordHighlightForeground', 'Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nvar overviewRulerWordHighlightStrongForeground = registerColor('editorOverviewRuler.wordHighlightStrongForeground', { dark: '#C0A0C0CC', light: '#C0A0C0CC', hc: '#C0A0C0CC' }, nls.localize('overviewRulerWordHighlightStrongForeground', 'Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nvar ctxHasWordHighlights = new RawContextKey('hasWordHighlights', false);\r\nexport function getOccurrencesAtPosition(model, position, token) {\r\n    var orderedByScore = DocumentHighlightProviderRegistry.ordered(model);\r\n    // in order of score ask the occurrences provider\r\n    // until someone response with a good result\r\n    // (good = none empty array)\r\n    return first(orderedByScore.map(function (provider) { return function () {\r\n        return Promise.resolve(provider.provideDocumentHighlights(model, position, token))\r\n            .then(undefined, onUnexpectedExternalError);\r\n    }; }), arrays.isNonEmptyArray);\r\n}\r\nvar OccurenceAtPositionRequest = /** @class */ (function () {\r\n    function OccurenceAtPositionRequest(model, selection, wordSeparators) {\r\n        var _this = this;\r\n        this._wordRange = this._getCurrentWordRange(model, selection);\r\n        this.result = createCancelablePromise(function (token) { return _this._compute(model, selection, wordSeparators, token); });\r\n    }\r\n    OccurenceAtPositionRequest.prototype._getCurrentWordRange = function (model, selection) {\r\n        var word = model.getWordAtPosition(selection.getPosition());\r\n        if (word) {\r\n            return new Range(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\r\n        }\r\n        return null;\r\n    };\r\n    OccurenceAtPositionRequest.prototype.isValid = function (model, selection, decorationIds) {\r\n        var lineNumber = selection.startLineNumber;\r\n        var startColumn = selection.startColumn;\r\n        var endColumn = selection.endColumn;\r\n        var currentWordRange = this._getCurrentWordRange(model, selection);\r\n        var requestIsValid = Boolean(this._wordRange && this._wordRange.equalsRange(currentWordRange));\r\n        // Even if we are on a different word, if that word is in the decorations ranges, the request is still valid\r\n        // (Same symbol)\r\n        for (var i = 0, len = decorationIds.length; !requestIsValid && i < len; i++) {\r\n            var range = model.getDecorationRange(decorationIds[i]);\r\n            if (range && range.startLineNumber === lineNumber) {\r\n                if (range.startColumn <= startColumn && range.endColumn >= endColumn) {\r\n                    requestIsValid = true;\r\n                }\r\n            }\r\n        }\r\n        return requestIsValid;\r\n    };\r\n    OccurenceAtPositionRequest.prototype.cancel = function () {\r\n        this.result.cancel();\r\n    };\r\n    return OccurenceAtPositionRequest;\r\n}());\r\nvar SemanticOccurenceAtPositionRequest = /** @class */ (function (_super) {\r\n    __extends(SemanticOccurenceAtPositionRequest, _super);\r\n    function SemanticOccurenceAtPositionRequest() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SemanticOccurenceAtPositionRequest.prototype._compute = function (model, selection, wordSeparators, token) {\r\n        return getOccurrencesAtPosition(model, selection.getPosition(), token).then(function (value) { return value || []; });\r\n    };\r\n    return SemanticOccurenceAtPositionRequest;\r\n}(OccurenceAtPositionRequest));\r\nvar TextualOccurenceAtPositionRequest = /** @class */ (function (_super) {\r\n    __extends(TextualOccurenceAtPositionRequest, _super);\r\n    function TextualOccurenceAtPositionRequest(model, selection, wordSeparators) {\r\n        var _this = _super.call(this, model, selection, wordSeparators) || this;\r\n        _this._selectionIsEmpty = selection.isEmpty();\r\n        return _this;\r\n    }\r\n    TextualOccurenceAtPositionRequest.prototype._compute = function (model, selection, wordSeparators, token) {\r\n        return timeout(250, token).then(function () {\r\n            if (!selection.isEmpty()) {\r\n                return [];\r\n            }\r\n            var word = model.getWordAtPosition(selection.getPosition());\r\n            if (!word) {\r\n                return [];\r\n            }\r\n            var matches = model.findMatches(word.word, true, false, true, wordSeparators, false);\r\n            return matches.map(function (m) {\r\n                return {\r\n                    range: m.range,\r\n                    kind: DocumentHighlightKind.Text\r\n                };\r\n            });\r\n        });\r\n    };\r\n    TextualOccurenceAtPositionRequest.prototype.isValid = function (model, selection, decorationIds) {\r\n        var currentSelectionIsEmpty = selection.isEmpty();\r\n        if (this._selectionIsEmpty !== currentSelectionIsEmpty) {\r\n            return false;\r\n        }\r\n        return _super.prototype.isValid.call(this, model, selection, decorationIds);\r\n    };\r\n    return TextualOccurenceAtPositionRequest;\r\n}(OccurenceAtPositionRequest));\r\nfunction computeOccurencesAtPosition(model, selection, wordSeparators) {\r\n    if (DocumentHighlightProviderRegistry.has(model)) {\r\n        return new SemanticOccurenceAtPositionRequest(model, selection, wordSeparators);\r\n    }\r\n    return new TextualOccurenceAtPositionRequest(model, selection, wordSeparators);\r\n}\r\nregisterDefaultLanguageCommand('_executeDocumentHighlights', function (model, position) { return getOccurrencesAtPosition(model, position, CancellationToken.None); });\r\nvar WordHighlighter = /** @class */ (function () {\r\n    function WordHighlighter(editor, contextKeyService) {\r\n        var _this = this;\r\n        this.toUnhook = new DisposableStore();\r\n        this.workerRequestTokenId = 0;\r\n        this.workerRequestCompleted = false;\r\n        this.workerRequestValue = [];\r\n        this.lastCursorPositionChangeTime = 0;\r\n        this.renderDecorationsTimer = -1;\r\n        this.editor = editor;\r\n        this._hasWordHighlights = ctxHasWordHighlights.bindTo(contextKeyService);\r\n        this._ignorePositionChangeEvent = false;\r\n        this.occurrencesHighlight = this.editor.getOption(59 /* occurrencesHighlight */);\r\n        this.model = this.editor.getModel();\r\n        this.toUnhook.add(editor.onDidChangeCursorPosition(function (e) {\r\n            if (_this._ignorePositionChangeEvent) {\r\n                // We are changing the position => ignore this event\r\n                return;\r\n            }\r\n            if (!_this.occurrencesHighlight) {\r\n                // Early exit if nothing needs to be done!\r\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n                return;\r\n            }\r\n            _this._onPositionChanged(e);\r\n        }));\r\n        this.toUnhook.add(editor.onDidChangeModelContent(function (e) {\r\n            _this._stopAll();\r\n        }));\r\n        this.toUnhook.add(editor.onDidChangeConfiguration(function (e) {\r\n            var newValue = _this.editor.getOption(59 /* occurrencesHighlight */);\r\n            if (_this.occurrencesHighlight !== newValue) {\r\n                _this.occurrencesHighlight = newValue;\r\n                _this._stopAll();\r\n            }\r\n        }));\r\n        this._decorationIds = [];\r\n        this.workerRequestTokenId = 0;\r\n        this.workerRequest = null;\r\n        this.workerRequestCompleted = false;\r\n        this.lastCursorPositionChangeTime = 0;\r\n        this.renderDecorationsTimer = -1;\r\n    }\r\n    WordHighlighter.prototype.hasDecorations = function () {\r\n        return (this._decorationIds.length > 0);\r\n    };\r\n    WordHighlighter.prototype.restore = function () {\r\n        if (!this.occurrencesHighlight) {\r\n            return;\r\n        }\r\n        this._run();\r\n    };\r\n    WordHighlighter.prototype._getSortedHighlights = function () {\r\n        var _this = this;\r\n        return arrays.coalesce(this._decorationIds\r\n            .map(function (id) { return _this.model.getDecorationRange(id); })\r\n            .sort(Range.compareRangesUsingStarts));\r\n    };\r\n    WordHighlighter.prototype.moveNext = function () {\r\n        var _this = this;\r\n        var highlights = this._getSortedHighlights();\r\n        var index = arrays.firstIndex(highlights, function (range) { return range.containsPosition(_this.editor.getPosition()); });\r\n        var newIndex = ((index + 1) % highlights.length);\r\n        var dest = highlights[newIndex];\r\n        try {\r\n            this._ignorePositionChangeEvent = true;\r\n            this.editor.setPosition(dest.getStartPosition());\r\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\r\n        }\r\n        finally {\r\n            this._ignorePositionChangeEvent = false;\r\n        }\r\n    };\r\n    WordHighlighter.prototype.moveBack = function () {\r\n        var _this = this;\r\n        var highlights = this._getSortedHighlights();\r\n        var index = arrays.firstIndex(highlights, function (range) { return range.containsPosition(_this.editor.getPosition()); });\r\n        var newIndex = ((index - 1 + highlights.length) % highlights.length);\r\n        var dest = highlights[newIndex];\r\n        try {\r\n            this._ignorePositionChangeEvent = true;\r\n            this.editor.setPosition(dest.getStartPosition());\r\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\r\n        }\r\n        finally {\r\n            this._ignorePositionChangeEvent = false;\r\n        }\r\n    };\r\n    WordHighlighter.prototype._removeDecorations = function () {\r\n        if (this._decorationIds.length > 0) {\r\n            // remove decorations\r\n            this._decorationIds = this.editor.deltaDecorations(this._decorationIds, []);\r\n            this._hasWordHighlights.set(false);\r\n        }\r\n    };\r\n    WordHighlighter.prototype._stopAll = function () {\r\n        // Remove any existing decorations\r\n        this._removeDecorations();\r\n        // Cancel any renderDecorationsTimer\r\n        if (this.renderDecorationsTimer !== -1) {\r\n            clearTimeout(this.renderDecorationsTimer);\r\n            this.renderDecorationsTimer = -1;\r\n        }\r\n        // Cancel any worker request\r\n        if (this.workerRequest !== null) {\r\n            this.workerRequest.cancel();\r\n            this.workerRequest = null;\r\n        }\r\n        // Invalidate any worker request callback\r\n        if (!this.workerRequestCompleted) {\r\n            this.workerRequestTokenId++;\r\n            this.workerRequestCompleted = true;\r\n        }\r\n    };\r\n    WordHighlighter.prototype._onPositionChanged = function (e) {\r\n        // disabled\r\n        if (!this.occurrencesHighlight) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        // ignore typing & other\r\n        if (e.reason !== 3 /* Explicit */) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        this._run();\r\n    };\r\n    WordHighlighter.prototype._run = function () {\r\n        var _this = this;\r\n        var editorSelection = this.editor.getSelection();\r\n        // ignore multiline selection\r\n        if (editorSelection.startLineNumber !== editorSelection.endLineNumber) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        var lineNumber = editorSelection.startLineNumber;\r\n        var startColumn = editorSelection.startColumn;\r\n        var endColumn = editorSelection.endColumn;\r\n        var word = this.model.getWordAtPosition({\r\n            lineNumber: lineNumber,\r\n            column: startColumn\r\n        });\r\n        // The selection must be inside a word or surround one word at most\r\n        if (!word || word.startColumn > startColumn || word.endColumn < endColumn) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        // All the effort below is trying to achieve this:\r\n        // - when cursor is moved to a word, trigger immediately a findOccurrences request\r\n        // - 250ms later after the last cursor move event, render the occurrences\r\n        // - no flickering!\r\n        var workerRequestIsValid = (this.workerRequest && this.workerRequest.isValid(this.model, editorSelection, this._decorationIds));\r\n        // There are 4 cases:\r\n        // a) old workerRequest is valid & completed, renderDecorationsTimer fired\r\n        // b) old workerRequest is valid & completed, renderDecorationsTimer not fired\r\n        // c) old workerRequest is valid, but not completed\r\n        // d) old workerRequest is not valid\r\n        // For a) no action is needed\r\n        // For c), member 'lastCursorPositionChangeTime' will be used when installing the timer so no action is needed\r\n        this.lastCursorPositionChangeTime = (new Date()).getTime();\r\n        if (workerRequestIsValid) {\r\n            if (this.workerRequestCompleted && this.renderDecorationsTimer !== -1) {\r\n                // case b)\r\n                // Delay the firing of renderDecorationsTimer by an extra 250 ms\r\n                clearTimeout(this.renderDecorationsTimer);\r\n                this.renderDecorationsTimer = -1;\r\n                this._beginRenderDecorations();\r\n            }\r\n        }\r\n        else {\r\n            // case d)\r\n            // Stop all previous actions and start fresh\r\n            this._stopAll();\r\n            var myRequestId_1 = ++this.workerRequestTokenId;\r\n            this.workerRequestCompleted = false;\r\n            this.workerRequest = computeOccurencesAtPosition(this.model, this.editor.getSelection(), this.editor.getOption(92 /* wordSeparators */));\r\n            this.workerRequest.result.then(function (data) {\r\n                if (myRequestId_1 === _this.workerRequestTokenId) {\r\n                    _this.workerRequestCompleted = true;\r\n                    _this.workerRequestValue = data || [];\r\n                    _this._beginRenderDecorations();\r\n                }\r\n            }, onUnexpectedError);\r\n        }\r\n    };\r\n    WordHighlighter.prototype._beginRenderDecorations = function () {\r\n        var _this = this;\r\n        var currentTime = (new Date()).getTime();\r\n        var minimumRenderTime = this.lastCursorPositionChangeTime + 250;\r\n        if (currentTime >= minimumRenderTime) {\r\n            // Synchronous\r\n            this.renderDecorationsTimer = -1;\r\n            this.renderDecorations();\r\n        }\r\n        else {\r\n            // Asynchronous\r\n            this.renderDecorationsTimer = setTimeout(function () {\r\n                _this.renderDecorations();\r\n            }, (minimumRenderTime - currentTime));\r\n        }\r\n    };\r\n    WordHighlighter.prototype.renderDecorations = function () {\r\n        this.renderDecorationsTimer = -1;\r\n        var decorations = [];\r\n        for (var i = 0, len = this.workerRequestValue.length; i < len; i++) {\r\n            var info = this.workerRequestValue[i];\r\n            decorations.push({\r\n                range: info.range,\r\n                options: WordHighlighter._getDecorationOptions(info.kind)\r\n            });\r\n        }\r\n        this._decorationIds = this.editor.deltaDecorations(this._decorationIds, decorations);\r\n        this._hasWordHighlights.set(this.hasDecorations());\r\n    };\r\n    WordHighlighter._getDecorationOptions = function (kind) {\r\n        if (kind === DocumentHighlightKind.Write) {\r\n            return this._WRITE_OPTIONS;\r\n        }\r\n        else if (kind === DocumentHighlightKind.Text) {\r\n            return this._TEXT_OPTIONS;\r\n        }\r\n        else {\r\n            return this._REGULAR_OPTIONS;\r\n        }\r\n    };\r\n    WordHighlighter.prototype.dispose = function () {\r\n        this._stopAll();\r\n        this.toUnhook.dispose();\r\n    };\r\n    WordHighlighter._WRITE_OPTIONS = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'wordHighlightStrong',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerWordHighlightStrongForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    WordHighlighter._TEXT_OPTIONS = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'selectionHighlight',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerSelectionHighlightForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    WordHighlighter._REGULAR_OPTIONS = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'wordHighlight',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerWordHighlightForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    return WordHighlighter;\r\n}());\r\nvar WordHighlighterContribution = /** @class */ (function (_super) {\r\n    __extends(WordHighlighterContribution, _super);\r\n    function WordHighlighterContribution(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.wordHighligher = null;\r\n        var createWordHighlighterIfPossible = function () {\r\n            if (editor.hasModel()) {\r\n                _this.wordHighligher = new WordHighlighter(editor, contextKeyService);\r\n            }\r\n        };\r\n        _this._register(editor.onDidChangeModel(function (e) {\r\n            if (_this.wordHighligher) {\r\n                _this.wordHighligher.dispose();\r\n                _this.wordHighligher = null;\r\n            }\r\n            createWordHighlighterIfPossible();\r\n        }));\r\n        createWordHighlighterIfPossible();\r\n        return _this;\r\n    }\r\n    WordHighlighterContribution.get = function (editor) {\r\n        return editor.getContribution(WordHighlighterContribution.ID);\r\n    };\r\n    WordHighlighterContribution.prototype.saveViewState = function () {\r\n        if (this.wordHighligher && this.wordHighligher.hasDecorations()) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    WordHighlighterContribution.prototype.moveNext = function () {\r\n        if (this.wordHighligher) {\r\n            this.wordHighligher.moveNext();\r\n        }\r\n    };\r\n    WordHighlighterContribution.prototype.moveBack = function () {\r\n        if (this.wordHighligher) {\r\n            this.wordHighligher.moveBack();\r\n        }\r\n    };\r\n    WordHighlighterContribution.prototype.restoreViewState = function (state) {\r\n        if (this.wordHighligher && state) {\r\n            this.wordHighligher.restore();\r\n        }\r\n    };\r\n    WordHighlighterContribution.prototype.dispose = function () {\r\n        if (this.wordHighligher) {\r\n            this.wordHighligher.dispose();\r\n            this.wordHighligher = null;\r\n        }\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    WordHighlighterContribution.ID = 'editor.contrib.wordHighlighter';\r\n    WordHighlighterContribution = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], WordHighlighterContribution);\r\n    return WordHighlighterContribution;\r\n}(Disposable));\r\nvar WordHighlightNavigationAction = /** @class */ (function (_super) {\r\n    __extends(WordHighlightNavigationAction, _super);\r\n    function WordHighlightNavigationAction(next, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._isNext = next;\r\n        return _this;\r\n    }\r\n    WordHighlightNavigationAction.prototype.run = function (accessor, editor) {\r\n        var controller = WordHighlighterContribution.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        if (this._isNext) {\r\n            controller.moveNext();\r\n        }\r\n        else {\r\n            controller.moveBack();\r\n        }\r\n    };\r\n    return WordHighlightNavigationAction;\r\n}(EditorAction));\r\nvar NextWordHighlightAction = /** @class */ (function (_super) {\r\n    __extends(NextWordHighlightAction, _super);\r\n    function NextWordHighlightAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.wordHighlight.next',\r\n            label: nls.localize('wordHighlight.next.label', \"Go to Next Symbol Highlight\"),\r\n            alias: 'Go to Next Symbol Highlight',\r\n            precondition: ctxHasWordHighlights,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 65 /* F7 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return NextWordHighlightAction;\r\n}(WordHighlightNavigationAction));\r\nvar PrevWordHighlightAction = /** @class */ (function (_super) {\r\n    __extends(PrevWordHighlightAction, _super);\r\n    function PrevWordHighlightAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.wordHighlight.prev',\r\n            label: nls.localize('wordHighlight.previous.label', \"Go to Previous Symbol Highlight\"),\r\n            alias: 'Go to Previous Symbol Highlight',\r\n            precondition: ctxHasWordHighlights,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 65 /* F7 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return PrevWordHighlightAction;\r\n}(WordHighlightNavigationAction));\r\nvar TriggerWordHighlightAction = /** @class */ (function (_super) {\r\n    __extends(TriggerWordHighlightAction, _super);\r\n    function TriggerWordHighlightAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.wordHighlight.trigger',\r\n            label: nls.localize('wordHighlight.trigger.label', \"Trigger Symbol Highlight\"),\r\n            alias: 'Trigger Symbol Highlight',\r\n            precondition: ctxHasWordHighlights.toNegated(),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 0,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TriggerWordHighlightAction.prototype.run = function (accessor, editor, args) {\r\n        var controller = WordHighlighterContribution.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        controller.restoreViewState(true);\r\n    };\r\n    return TriggerWordHighlightAction;\r\n}(EditorAction));\r\nregisterEditorContribution(WordHighlighterContribution.ID, WordHighlighterContribution);\r\nregisterEditorAction(NextWordHighlightAction);\r\nregisterEditorAction(PrevWordHighlightAction);\r\nregisterEditorAction(TriggerWordHighlightAction);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var selectionHighlight = theme.getColor(editorSelectionHighlight);\r\n    if (selectionHighlight) {\r\n        collector.addRule(\".monaco-editor .focused .selectionHighlight { background-color: \" + selectionHighlight + \"; }\");\r\n        collector.addRule(\".monaco-editor .selectionHighlight { background-color: \" + selectionHighlight.transparent(0.5) + \"; }\");\r\n    }\r\n    var wordHighlight = theme.getColor(editorWordHighlight);\r\n    if (wordHighlight) {\r\n        collector.addRule(\".monaco-editor .wordHighlight { background-color: \" + wordHighlight + \"; }\");\r\n    }\r\n    var wordHighlightStrong = theme.getColor(editorWordHighlightStrong);\r\n    if (wordHighlightStrong) {\r\n        collector.addRule(\".monaco-editor .wordHighlightStrong { background-color: \" + wordHighlightStrong + \"; }\");\r\n    }\r\n    var selectionHighlightBorder = theme.getColor(editorSelectionHighlightBorder);\r\n    if (selectionHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .selectionHighlight { border: 1px \" + (theme.type === 'hc' ? 'dotted' : 'solid') + \" \" + selectionHighlightBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n    var wordHighlightBorder = theme.getColor(editorWordHighlightBorder);\r\n    if (wordHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .wordHighlight { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + wordHighlightBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n    var wordHighlightStrongBorder = theme.getColor(editorWordHighlightStrongBorder);\r\n    if (wordHighlightStrongBorder) {\r\n        collector.addRule(\".monaco-editor .wordHighlightStrong { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + wordHighlightStrongBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { ReplaceCommand } from '../../common/commands/replaceCommand.js';\r\nimport { CursorState } from '../../common/controller/cursorCommon.js';\r\nimport { WordOperations } from '../../common/controller/cursorWordOperations.js';\r\nimport { getMapForWordSeparators } from '../../common/controller/wordCharacterClassifier.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { CONTEXT_ACCESSIBILITY_MODE_ENABLED } from '../../../platform/accessibility/common/accessibility.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { EditorOptions } from '../../common/config/editorOptions.js';\r\nvar MoveWordCommand = /** @class */ (function (_super) {\r\n    __extends(MoveWordCommand, _super);\r\n    function MoveWordCommand(opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._inSelectionMode = opts.inSelectionMode;\r\n        _this._wordNavigationType = opts.wordNavigationType;\r\n        return _this;\r\n    }\r\n    MoveWordCommand.prototype.runEditorCommand = function (accessor, editor, args) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var wordSeparators = getMapForWordSeparators(editor.getOption(92 /* wordSeparators */));\r\n        var model = editor.getModel();\r\n        var selections = editor.getSelections();\r\n        var result = selections.map(function (sel) {\r\n            var inPosition = new Position(sel.positionLineNumber, sel.positionColumn);\r\n            var outPosition = _this._move(wordSeparators, model, inPosition, _this._wordNavigationType);\r\n            return _this._moveTo(sel, outPosition, _this._inSelectionMode);\r\n        });\r\n        editor._getCursors().setStates('moveWordCommand', 0 /* NotSet */, result.map(function (r) { return CursorState.fromModelSelection(r); }));\r\n        if (result.length === 1) {\r\n            var pos = new Position(result[0].positionLineNumber, result[0].positionColumn);\r\n            editor.revealPosition(pos, 0 /* Smooth */);\r\n        }\r\n    };\r\n    MoveWordCommand.prototype._moveTo = function (from, to, inSelectionMode) {\r\n        if (inSelectionMode) {\r\n            // move just position\r\n            return new Selection(from.selectionStartLineNumber, from.selectionStartColumn, to.lineNumber, to.column);\r\n        }\r\n        else {\r\n            // move everything\r\n            return new Selection(to.lineNumber, to.column, to.lineNumber, to.column);\r\n        }\r\n    };\r\n    return MoveWordCommand;\r\n}(EditorCommand));\r\nexport { MoveWordCommand };\r\nvar WordLeftCommand = /** @class */ (function (_super) {\r\n    __extends(WordLeftCommand, _super);\r\n    function WordLeftCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WordLeftCommand.prototype._move = function (wordSeparators, model, position, wordNavigationType) {\r\n        return WordOperations.moveWordLeft(wordSeparators, model, position, wordNavigationType);\r\n    };\r\n    return WordLeftCommand;\r\n}(MoveWordCommand));\r\nexport { WordLeftCommand };\r\nvar WordRightCommand = /** @class */ (function (_super) {\r\n    __extends(WordRightCommand, _super);\r\n    function WordRightCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WordRightCommand.prototype._move = function (wordSeparators, model, position, wordNavigationType) {\r\n        return WordOperations.moveWordRight(wordSeparators, model, position, wordNavigationType);\r\n    };\r\n    return WordRightCommand;\r\n}(MoveWordCommand));\r\nexport { WordRightCommand };\r\nvar CursorWordStartLeft = /** @class */ (function (_super) {\r\n    __extends(CursorWordStartLeft, _super);\r\n    function CursorWordStartLeft() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartLeft',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 15 /* LeftArrow */,\r\n                mac: { primary: 512 /* Alt */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordStartLeft;\r\n}(WordLeftCommand));\r\nexport { CursorWordStartLeft };\r\nvar CursorWordEndLeft = /** @class */ (function (_super) {\r\n    __extends(CursorWordEndLeft, _super);\r\n    function CursorWordEndLeft() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndLeft',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordEndLeft;\r\n}(WordLeftCommand));\r\nexport { CursorWordEndLeft };\r\nvar CursorWordLeft = /** @class */ (function (_super) {\r\n    __extends(CursorWordLeft, _super);\r\n    function CursorWordLeft() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 1 /* WordStartFast */,\r\n            id: 'cursorWordLeft',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordLeft;\r\n}(WordLeftCommand));\r\nexport { CursorWordLeft };\r\nvar CursorWordStartLeftSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordStartLeftSelect, _super);\r\n    function CursorWordStartLeftSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartLeftSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 15 /* LeftArrow */,\r\n                mac: { primary: 512 /* Alt */ | 1024 /* Shift */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordStartLeftSelect;\r\n}(WordLeftCommand));\r\nexport { CursorWordStartLeftSelect };\r\nvar CursorWordEndLeftSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordEndLeftSelect, _super);\r\n    function CursorWordEndLeftSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndLeftSelect',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordEndLeftSelect;\r\n}(WordLeftCommand));\r\nexport { CursorWordEndLeftSelect };\r\nvar CursorWordLeftSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordLeftSelect, _super);\r\n    function CursorWordLeftSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 1 /* WordStartFast */,\r\n            id: 'cursorWordLeftSelect',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordLeftSelect;\r\n}(WordLeftCommand));\r\nexport { CursorWordLeftSelect };\r\nvar CursorWordAccessibilityLeft = /** @class */ (function (_super) {\r\n    __extends(CursorWordAccessibilityLeft, _super);\r\n    function CursorWordAccessibilityLeft() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityLeft',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, CONTEXT_ACCESSIBILITY_MODE_ENABLED),\r\n                primary: 2048 /* CtrlCmd */ | 15 /* LeftArrow */,\r\n                mac: { primary: 512 /* Alt */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */ + 1\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorWordAccessibilityLeft.prototype._move = function (_, model, position, wordNavigationType) {\r\n        return _super.prototype._move.call(this, getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    };\r\n    return CursorWordAccessibilityLeft;\r\n}(WordLeftCommand));\r\nexport { CursorWordAccessibilityLeft };\r\nvar CursorWordAccessibilityLeftSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordAccessibilityLeftSelect, _super);\r\n    function CursorWordAccessibilityLeftSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityLeftSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, CONTEXT_ACCESSIBILITY_MODE_ENABLED),\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 15 /* LeftArrow */,\r\n                mac: { primary: 512 /* Alt */ | 1024 /* Shift */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */ + 1\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorWordAccessibilityLeftSelect.prototype._move = function (_, model, position, wordNavigationType) {\r\n        return _super.prototype._move.call(this, getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    };\r\n    return CursorWordAccessibilityLeftSelect;\r\n}(WordLeftCommand));\r\nexport { CursorWordAccessibilityLeftSelect };\r\nvar CursorWordStartRight = /** @class */ (function (_super) {\r\n    __extends(CursorWordStartRight, _super);\r\n    function CursorWordStartRight() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartRight',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordStartRight;\r\n}(WordRightCommand));\r\nexport { CursorWordStartRight };\r\nvar CursorWordEndRight = /** @class */ (function (_super) {\r\n    __extends(CursorWordEndRight, _super);\r\n    function CursorWordEndRight() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndRight',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 17 /* RightArrow */,\r\n                mac: { primary: 512 /* Alt */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordEndRight;\r\n}(WordRightCommand));\r\nexport { CursorWordEndRight };\r\nvar CursorWordRight = /** @class */ (function (_super) {\r\n    __extends(CursorWordRight, _super);\r\n    function CursorWordRight() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordRight',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordRight;\r\n}(WordRightCommand));\r\nexport { CursorWordRight };\r\nvar CursorWordStartRightSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordStartRightSelect, _super);\r\n    function CursorWordStartRightSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartRightSelect',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordStartRightSelect;\r\n}(WordRightCommand));\r\nexport { CursorWordStartRightSelect };\r\nvar CursorWordEndRightSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordEndRightSelect, _super);\r\n    function CursorWordEndRightSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndRightSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 17 /* RightArrow */,\r\n                mac: { primary: 512 /* Alt */ | 1024 /* Shift */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordEndRightSelect;\r\n}(WordRightCommand));\r\nexport { CursorWordEndRightSelect };\r\nvar CursorWordRightSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordRightSelect, _super);\r\n    function CursorWordRightSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordRightSelect',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordRightSelect;\r\n}(WordRightCommand));\r\nexport { CursorWordRightSelect };\r\nvar CursorWordAccessibilityRight = /** @class */ (function (_super) {\r\n    __extends(CursorWordAccessibilityRight, _super);\r\n    function CursorWordAccessibilityRight() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityRight',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, CONTEXT_ACCESSIBILITY_MODE_ENABLED),\r\n                primary: 2048 /* CtrlCmd */ | 17 /* RightArrow */,\r\n                mac: { primary: 512 /* Alt */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */ + 1\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorWordAccessibilityRight.prototype._move = function (_, model, position, wordNavigationType) {\r\n        return _super.prototype._move.call(this, getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    };\r\n    return CursorWordAccessibilityRight;\r\n}(WordRightCommand));\r\nexport { CursorWordAccessibilityRight };\r\nvar CursorWordAccessibilityRightSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordAccessibilityRightSelect, _super);\r\n    function CursorWordAccessibilityRightSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityRightSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, CONTEXT_ACCESSIBILITY_MODE_ENABLED),\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 17 /* RightArrow */,\r\n                mac: { primary: 512 /* Alt */ | 1024 /* Shift */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */ + 1\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorWordAccessibilityRightSelect.prototype._move = function (_, model, position, wordNavigationType) {\r\n        return _super.prototype._move.call(this, getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    };\r\n    return CursorWordAccessibilityRightSelect;\r\n}(WordRightCommand));\r\nexport { CursorWordAccessibilityRightSelect };\r\nvar DeleteWordCommand = /** @class */ (function (_super) {\r\n    __extends(DeleteWordCommand, _super);\r\n    function DeleteWordCommand(opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._whitespaceHeuristics = opts.whitespaceHeuristics;\r\n        _this._wordNavigationType = opts.wordNavigationType;\r\n        return _this;\r\n    }\r\n    DeleteWordCommand.prototype.runEditorCommand = function (accessor, editor, args) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var wordSeparators = getMapForWordSeparators(editor.getOption(92 /* wordSeparators */));\r\n        var model = editor.getModel();\r\n        var selections = editor.getSelections();\r\n        var commands = selections.map(function (sel) {\r\n            var deleteRange = _this._delete(wordSeparators, model, sel, _this._whitespaceHeuristics, _this._wordNavigationType);\r\n            return new ReplaceCommand(deleteRange, '');\r\n        });\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return DeleteWordCommand;\r\n}(EditorCommand));\r\nexport { DeleteWordCommand };\r\nvar DeleteWordLeftCommand = /** @class */ (function (_super) {\r\n    __extends(DeleteWordLeftCommand, _super);\r\n    function DeleteWordLeftCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DeleteWordLeftCommand.prototype._delete = function (wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType) {\r\n        var r = WordOperations.deleteWordLeft(wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        return new Range(1, 1, 1, 1);\r\n    };\r\n    return DeleteWordLeftCommand;\r\n}(DeleteWordCommand));\r\nexport { DeleteWordLeftCommand };\r\nvar DeleteWordRightCommand = /** @class */ (function (_super) {\r\n    __extends(DeleteWordRightCommand, _super);\r\n    function DeleteWordRightCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DeleteWordRightCommand.prototype._delete = function (wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType) {\r\n        var r = WordOperations.deleteWordRight(wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        var lineCount = model.getLineCount();\r\n        var maxColumn = model.getLineMaxColumn(lineCount);\r\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\r\n    };\r\n    return DeleteWordRightCommand;\r\n}(DeleteWordCommand));\r\nexport { DeleteWordRightCommand };\r\nvar DeleteWordStartLeft = /** @class */ (function (_super) {\r\n    __extends(DeleteWordStartLeft, _super);\r\n    function DeleteWordStartLeft() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordStartLeft',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return DeleteWordStartLeft;\r\n}(DeleteWordLeftCommand));\r\nexport { DeleteWordStartLeft };\r\nvar DeleteWordEndLeft = /** @class */ (function (_super) {\r\n    __extends(DeleteWordEndLeft, _super);\r\n    function DeleteWordEndLeft() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordEndLeft',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return DeleteWordEndLeft;\r\n}(DeleteWordLeftCommand));\r\nexport { DeleteWordEndLeft };\r\nvar DeleteWordLeft = /** @class */ (function (_super) {\r\n    __extends(DeleteWordLeft, _super);\r\n    function DeleteWordLeft() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordLeft',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1 /* Backspace */,\r\n                mac: { primary: 512 /* Alt */ | 1 /* Backspace */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return DeleteWordLeft;\r\n}(DeleteWordLeftCommand));\r\nexport { DeleteWordLeft };\r\nvar DeleteWordStartRight = /** @class */ (function (_super) {\r\n    __extends(DeleteWordStartRight, _super);\r\n    function DeleteWordStartRight() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordStartRight',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return DeleteWordStartRight;\r\n}(DeleteWordRightCommand));\r\nexport { DeleteWordStartRight };\r\nvar DeleteWordEndRight = /** @class */ (function (_super) {\r\n    __extends(DeleteWordEndRight, _super);\r\n    function DeleteWordEndRight() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordEndRight',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return DeleteWordEndRight;\r\n}(DeleteWordRightCommand));\r\nexport { DeleteWordEndRight };\r\nvar DeleteWordRight = /** @class */ (function (_super) {\r\n    __extends(DeleteWordRight, _super);\r\n    function DeleteWordRight() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordRight',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 20 /* Delete */,\r\n                mac: { primary: 512 /* Alt */ | 20 /* Delete */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return DeleteWordRight;\r\n}(DeleteWordRightCommand));\r\nexport { DeleteWordRight };\r\nregisterEditorCommand(new CursorWordStartLeft());\r\nregisterEditorCommand(new CursorWordEndLeft());\r\nregisterEditorCommand(new CursorWordLeft());\r\nregisterEditorCommand(new CursorWordStartLeftSelect());\r\nregisterEditorCommand(new CursorWordEndLeftSelect());\r\nregisterEditorCommand(new CursorWordLeftSelect());\r\nregisterEditorCommand(new CursorWordStartRight());\r\nregisterEditorCommand(new CursorWordEndRight());\r\nregisterEditorCommand(new CursorWordRight());\r\nregisterEditorCommand(new CursorWordStartRightSelect());\r\nregisterEditorCommand(new CursorWordEndRightSelect());\r\nregisterEditorCommand(new CursorWordRightSelect());\r\nregisterEditorCommand(new CursorWordAccessibilityLeft());\r\nregisterEditorCommand(new CursorWordAccessibilityLeftSelect());\r\nregisterEditorCommand(new CursorWordAccessibilityRight());\r\nregisterEditorCommand(new CursorWordAccessibilityRightSelect());\r\nregisterEditorCommand(new DeleteWordStartLeft());\r\nregisterEditorCommand(new DeleteWordEndLeft());\r\nregisterEditorCommand(new DeleteWordLeft());\r\nregisterEditorCommand(new DeleteWordStartRight());\r\nregisterEditorCommand(new DeleteWordEndRight());\r\nregisterEditorCommand(new DeleteWordRight());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { WordPartOperations } from '../../common/controller/cursorWordOperations.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { DeleteWordCommand, MoveWordCommand } from '../wordOperations/wordOperations.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nvar DeleteWordPartLeft = /** @class */ (function (_super) {\r\n    __extends(DeleteWordPartLeft, _super);\r\n    function DeleteWordPartLeft() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordPartLeft',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 1 /* Backspace */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteWordPartLeft.prototype._delete = function (wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType) {\r\n        var r = WordPartOperations.deleteWordPartLeft(wordSeparators, model, selection, whitespaceHeuristics);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        return new Range(1, 1, 1, 1);\r\n    };\r\n    return DeleteWordPartLeft;\r\n}(DeleteWordCommand));\r\nexport { DeleteWordPartLeft };\r\nvar DeleteWordPartRight = /** @class */ (function (_super) {\r\n    __extends(DeleteWordPartRight, _super);\r\n    function DeleteWordPartRight() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordPartRight',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 20 /* Delete */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteWordPartRight.prototype._delete = function (wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType) {\r\n        var r = WordPartOperations.deleteWordPartRight(wordSeparators, model, selection, whitespaceHeuristics);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        var lineCount = model.getLineCount();\r\n        var maxColumn = model.getLineMaxColumn(lineCount);\r\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\r\n    };\r\n    return DeleteWordPartRight;\r\n}(DeleteWordCommand));\r\nexport { DeleteWordPartRight };\r\nvar WordPartLeftCommand = /** @class */ (function (_super) {\r\n    __extends(WordPartLeftCommand, _super);\r\n    function WordPartLeftCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WordPartLeftCommand.prototype._move = function (wordSeparators, model, position, wordNavigationType) {\r\n        return WordPartOperations.moveWordPartLeft(wordSeparators, model, position);\r\n    };\r\n    return WordPartLeftCommand;\r\n}(MoveWordCommand));\r\nexport { WordPartLeftCommand };\r\nvar CursorWordPartLeft = /** @class */ (function (_super) {\r\n    __extends(CursorWordPartLeft, _super);\r\n    function CursorWordPartLeft() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordPartLeft',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordPartLeft;\r\n}(WordPartLeftCommand));\r\nexport { CursorWordPartLeft };\r\n// Register previous id for compatibility purposes\r\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeft', 'cursorWordPartLeft');\r\nvar CursorWordPartLeftSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordPartLeftSelect, _super);\r\n    function CursorWordPartLeftSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordPartLeftSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 1024 /* Shift */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordPartLeftSelect;\r\n}(WordPartLeftCommand));\r\nexport { CursorWordPartLeftSelect };\r\n// Register previous id for compatibility purposes\r\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeftSelect', 'cursorWordPartLeftSelect');\r\nvar WordPartRightCommand = /** @class */ (function (_super) {\r\n    __extends(WordPartRightCommand, _super);\r\n    function WordPartRightCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WordPartRightCommand.prototype._move = function (wordSeparators, model, position, wordNavigationType) {\r\n        return WordPartOperations.moveWordPartRight(wordSeparators, model, position);\r\n    };\r\n    return WordPartRightCommand;\r\n}(MoveWordCommand));\r\nexport { WordPartRightCommand };\r\nvar CursorWordPartRight = /** @class */ (function (_super) {\r\n    __extends(CursorWordPartRight, _super);\r\n    function CursorWordPartRight() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordPartRight',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordPartRight;\r\n}(WordPartRightCommand));\r\nexport { CursorWordPartRight };\r\nvar CursorWordPartRightSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordPartRightSelect, _super);\r\n    function CursorWordPartRightSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordPartRightSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 1024 /* Shift */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordPartRightSelect;\r\n}(WordPartRightCommand));\r\nexport { CursorWordPartRightSelect };\r\nregisterEditorCommand(new DeleteWordPartLeft());\r\nregisterEditorCommand(new DeleteWordPartRight());\r\nregisterEditorCommand(new CursorWordPartLeft());\r\nregisterEditorCommand(new CursorWordPartLeftSelect());\r\nregisterEditorCommand(new CursorWordPartRight());\r\nregisterEditorCommand(new CursorWordPartRightSelect());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './accessibilityHelp.css';\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { renderFormattedText } from '../../../../base/browser/formattedTextRenderer.js';\r\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\r\nimport { Widget } from '../../../../base/browser/ui/widget.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { URI } from '../../../../base/common/uri.js';\r\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\r\nimport { ToggleTabFocusModeAction } from '../../../contrib/toggleTabFocusMode/toggleTabFocusMode.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\r\nimport { contrastBorder, editorWidgetBackground, widgetShadow, editorWidgetForeground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport { AccessibilityHelpNLS } from '../../../common/standaloneStrings.js';\r\nvar CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE = new RawContextKey('accessibilityHelpWidgetVisible', false);\r\nvar AccessibilityHelpController = /** @class */ (function (_super) {\r\n    __extends(AccessibilityHelpController, _super);\r\n    function AccessibilityHelpController(editor, instantiationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._widget = _this._register(instantiationService.createInstance(AccessibilityHelpWidget, _this._editor));\r\n        return _this;\r\n    }\r\n    AccessibilityHelpController.get = function (editor) {\r\n        return editor.getContribution(AccessibilityHelpController.ID);\r\n    };\r\n    AccessibilityHelpController.prototype.show = function () {\r\n        this._widget.show();\r\n    };\r\n    AccessibilityHelpController.prototype.hide = function () {\r\n        this._widget.hide();\r\n    };\r\n    AccessibilityHelpController.ID = 'editor.contrib.accessibilityHelpController';\r\n    AccessibilityHelpController = __decorate([\r\n        __param(1, IInstantiationService)\r\n    ], AccessibilityHelpController);\r\n    return AccessibilityHelpController;\r\n}(Disposable));\r\nfunction getSelectionLabel(selections, charactersSelected) {\r\n    if (!selections || selections.length === 0) {\r\n        return AccessibilityHelpNLS.noSelection;\r\n    }\r\n    if (selections.length === 1) {\r\n        if (charactersSelected) {\r\n            return strings.format(AccessibilityHelpNLS.singleSelectionRange, selections[0].positionLineNumber, selections[0].positionColumn, charactersSelected);\r\n        }\r\n        return strings.format(AccessibilityHelpNLS.singleSelection, selections[0].positionLineNumber, selections[0].positionColumn);\r\n    }\r\n    if (charactersSelected) {\r\n        return strings.format(AccessibilityHelpNLS.multiSelectionRange, selections.length, charactersSelected);\r\n    }\r\n    if (selections.length > 0) {\r\n        return strings.format(AccessibilityHelpNLS.multiSelection, selections.length);\r\n    }\r\n    return '';\r\n}\r\nvar AccessibilityHelpWidget = /** @class */ (function (_super) {\r\n    __extends(AccessibilityHelpWidget, _super);\r\n    function AccessibilityHelpWidget(editor, _contextKeyService, _keybindingService, _openerService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._contextKeyService = _contextKeyService;\r\n        _this._keybindingService = _keybindingService;\r\n        _this._openerService = _openerService;\r\n        _this._editor = editor;\r\n        _this._isVisibleKey = CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE.bindTo(_this._contextKeyService);\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        _this._domNode.setClassName('accessibilityHelpWidget');\r\n        _this._domNode.setDisplay('none');\r\n        _this._domNode.setAttribute('role', 'dialog');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._contentDomNode = createFastDomNode(document.createElement('div'));\r\n        _this._contentDomNode.setAttribute('role', 'document');\r\n        _this._domNode.appendChild(_this._contentDomNode);\r\n        _this._isVisible = false;\r\n        _this._register(_this._editor.onDidLayoutChange(function () {\r\n            if (_this._isVisible) {\r\n                _this._layout();\r\n            }\r\n        }));\r\n        // Intentionally not configurable!\r\n        _this._register(dom.addStandardDisposableListener(_this._contentDomNode.domNode, 'keydown', function (e) {\r\n            if (!_this._isVisible) {\r\n                return;\r\n            }\r\n            if (e.equals(2048 /* CtrlCmd */ | 35 /* KEY_E */)) {\r\n                alert(AccessibilityHelpNLS.emergencyConfOn);\r\n                _this._editor.updateOptions({\r\n                    accessibilitySupport: 'on'\r\n                });\r\n                dom.clearNode(_this._contentDomNode.domNode);\r\n                _this._buildContent();\r\n                _this._contentDomNode.domNode.focus();\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n            if (e.equals(2048 /* CtrlCmd */ | 38 /* KEY_H */)) {\r\n                alert(AccessibilityHelpNLS.openingDocs);\r\n                var url = _this._editor.getRawOptions().accessibilityHelpUrl;\r\n                if (typeof url === 'undefined') {\r\n                    url = 'https://go.microsoft.com/fwlink/?linkid=852450';\r\n                }\r\n                _this._openerService.open(URI.parse(url));\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n        }));\r\n        _this.onblur(_this._contentDomNode.domNode, function () {\r\n            _this.hide();\r\n        });\r\n        _this._editor.addOverlayWidget(_this);\r\n        return _this;\r\n    }\r\n    AccessibilityHelpWidget.prototype.dispose = function () {\r\n        this._editor.removeOverlayWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    AccessibilityHelpWidget.prototype.getId = function () {\r\n        return AccessibilityHelpWidget.ID;\r\n    };\r\n    AccessibilityHelpWidget.prototype.getDomNode = function () {\r\n        return this._domNode.domNode;\r\n    };\r\n    AccessibilityHelpWidget.prototype.getPosition = function () {\r\n        return {\r\n            preference: null\r\n        };\r\n    };\r\n    AccessibilityHelpWidget.prototype.show = function () {\r\n        if (this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = true;\r\n        this._isVisibleKey.set(true);\r\n        this._layout();\r\n        this._domNode.setDisplay('block');\r\n        this._domNode.setAttribute('aria-hidden', 'false');\r\n        this._contentDomNode.domNode.tabIndex = 0;\r\n        this._buildContent();\r\n        this._contentDomNode.domNode.focus();\r\n    };\r\n    AccessibilityHelpWidget.prototype._descriptionForCommand = function (commandId, msg, noKbMsg) {\r\n        var kb = this._keybindingService.lookupKeybinding(commandId);\r\n        if (kb) {\r\n            return strings.format(msg, kb.getAriaLabel());\r\n        }\r\n        return strings.format(noKbMsg, commandId);\r\n    };\r\n    AccessibilityHelpWidget.prototype._buildContent = function () {\r\n        var options = this._editor.getOptions();\r\n        var selections = this._editor.getSelections();\r\n        var charactersSelected = 0;\r\n        if (selections) {\r\n            var model_1 = this._editor.getModel();\r\n            if (model_1) {\r\n                selections.forEach(function (selection) {\r\n                    charactersSelected += model_1.getValueLengthInRange(selection);\r\n                });\r\n            }\r\n        }\r\n        var text = getSelectionLabel(selections, charactersSelected);\r\n        if (options.get(43 /* inDiffEditor */)) {\r\n            if (options.get(65 /* readOnly */)) {\r\n                text += AccessibilityHelpNLS.readonlyDiffEditor;\r\n            }\r\n            else {\r\n                text += AccessibilityHelpNLS.editableDiffEditor;\r\n            }\r\n        }\r\n        else {\r\n            if (options.get(65 /* readOnly */)) {\r\n                text += AccessibilityHelpNLS.readonlyEditor;\r\n            }\r\n            else {\r\n                text += AccessibilityHelpNLS.editableEditor;\r\n            }\r\n        }\r\n        var turnOnMessage = (platform.isMacintosh\r\n            ? AccessibilityHelpNLS.changeConfigToOnMac\r\n            : AccessibilityHelpNLS.changeConfigToOnWinLinux);\r\n        switch (options.get(2 /* accessibilitySupport */)) {\r\n            case 0 /* Unknown */:\r\n                text += '\\n\\n - ' + turnOnMessage;\r\n                break;\r\n            case 2 /* Enabled */:\r\n                text += '\\n\\n - ' + AccessibilityHelpNLS.auto_on;\r\n                break;\r\n            case 1 /* Disabled */:\r\n                text += '\\n\\n - ' + AccessibilityHelpNLS.auto_off;\r\n                text += ' ' + turnOnMessage;\r\n                break;\r\n        }\r\n        if (options.get(102 /* tabFocusMode */)) {\r\n            text += '\\n\\n - ' + this._descriptionForCommand(ToggleTabFocusModeAction.ID, AccessibilityHelpNLS.tabFocusModeOnMsg, AccessibilityHelpNLS.tabFocusModeOnMsgNoKb);\r\n        }\r\n        else {\r\n            text += '\\n\\n - ' + this._descriptionForCommand(ToggleTabFocusModeAction.ID, AccessibilityHelpNLS.tabFocusModeOffMsg, AccessibilityHelpNLS.tabFocusModeOffMsgNoKb);\r\n        }\r\n        var openDocMessage = (platform.isMacintosh\r\n            ? AccessibilityHelpNLS.openDocMac\r\n            : AccessibilityHelpNLS.openDocWinLinux);\r\n        text += '\\n\\n - ' + openDocMessage;\r\n        text += '\\n\\n' + AccessibilityHelpNLS.outroMsg;\r\n        this._contentDomNode.domNode.appendChild(renderFormattedText(text));\r\n        // Per https://www.w3.org/TR/wai-aria/roles#document, Authors SHOULD provide a title or label for documents\r\n        this._contentDomNode.domNode.setAttribute('aria-label', text);\r\n    };\r\n    AccessibilityHelpWidget.prototype.hide = function () {\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = false;\r\n        this._isVisibleKey.reset();\r\n        this._domNode.setDisplay('none');\r\n        this._domNode.setAttribute('aria-hidden', 'true');\r\n        this._contentDomNode.domNode.tabIndex = -1;\r\n        dom.clearNode(this._contentDomNode.domNode);\r\n        this._editor.focus();\r\n    };\r\n    AccessibilityHelpWidget.prototype._layout = function () {\r\n        var editorLayout = this._editor.getLayoutInfo();\r\n        var w = Math.max(5, Math.min(AccessibilityHelpWidget.WIDTH, editorLayout.width - 40));\r\n        var h = Math.max(5, Math.min(AccessibilityHelpWidget.HEIGHT, editorLayout.height - 40));\r\n        this._domNode.setWidth(w);\r\n        this._domNode.setHeight(h);\r\n        var top = Math.round((editorLayout.height - h) / 2);\r\n        this._domNode.setTop(top);\r\n        var left = Math.round((editorLayout.width - w) / 2);\r\n        this._domNode.setLeft(left);\r\n    };\r\n    AccessibilityHelpWidget.ID = 'editor.contrib.accessibilityHelpWidget';\r\n    AccessibilityHelpWidget.WIDTH = 500;\r\n    AccessibilityHelpWidget.HEIGHT = 300;\r\n    AccessibilityHelpWidget = __decorate([\r\n        __param(1, IContextKeyService),\r\n        __param(2, IKeybindingService),\r\n        __param(3, IOpenerService)\r\n    ], AccessibilityHelpWidget);\r\n    return AccessibilityHelpWidget;\r\n}(Widget));\r\nvar ShowAccessibilityHelpAction = /** @class */ (function (_super) {\r\n    __extends(ShowAccessibilityHelpAction, _super);\r\n    function ShowAccessibilityHelpAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.showAccessibilityHelp',\r\n            label: AccessibilityHelpNLS.showAccessibilityHelpAction,\r\n            alias: 'Show Accessibility Help',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: (browser.isIE ? 2048 /* CtrlCmd */ | 59 /* F1 */ : 512 /* Alt */ | 59 /* F1 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ShowAccessibilityHelpAction.prototype.run = function (accessor, editor) {\r\n        var controller = AccessibilityHelpController.get(editor);\r\n        if (controller) {\r\n            controller.show();\r\n        }\r\n    };\r\n    return ShowAccessibilityHelpAction;\r\n}(EditorAction));\r\nregisterEditorContribution(AccessibilityHelpController.ID, AccessibilityHelpController);\r\nregisterEditorAction(ShowAccessibilityHelpAction);\r\nvar AccessibilityHelpCommand = EditorCommand.bindToContribution(AccessibilityHelpController.get);\r\nregisterEditorCommand(new AccessibilityHelpCommand({\r\n    id: 'closeAccessibilityHelp',\r\n    precondition: CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.hide(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 100,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var widgetBackground = theme.getColor(editorWidgetBackground);\r\n    if (widgetBackground) {\r\n        collector.addRule(\".monaco-editor .accessibilityHelpWidget { background-color: \" + widgetBackground + \"; }\");\r\n    }\r\n    var widgetForeground = theme.getColor(editorWidgetForeground);\r\n    if (widgetForeground) {\r\n        collector.addRule(\".monaco-editor .accessibilityHelpWidget { color: \" + widgetForeground + \"; }\");\r\n    }\r\n    var widgetShadowColor = theme.getColor(widgetShadow);\r\n    if (widgetShadowColor) {\r\n        collector.addRule(\".monaco-editor .accessibilityHelpWidget { box-shadow: 0 2px 8px \" + widgetShadowColor + \"; }\");\r\n    }\r\n    var hcBorder = theme.getColor(contrastBorder);\r\n    if (hcBorder) {\r\n        collector.addRule(\".monaco-editor .accessibilityHelpWidget { border: 2px solid \" + hcBorder + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './iPadShowKeyboard.css';\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nvar IPadShowKeyboard = /** @class */ (function (_super) {\r\n    __extends(IPadShowKeyboard, _super);\r\n    function IPadShowKeyboard(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this.widget = null;\r\n        if (browser.isIPad) {\r\n            _this._register(editor.onDidChangeConfiguration(function () { return _this.update(); }));\r\n            _this.update();\r\n        }\r\n        return _this;\r\n    }\r\n    IPadShowKeyboard.prototype.update = function () {\r\n        var shouldHaveWidget = (!this.editor.getOption(65 /* readOnly */));\r\n        if (!this.widget && shouldHaveWidget) {\r\n            this.widget = new ShowKeyboardWidget(this.editor);\r\n        }\r\n        else if (this.widget && !shouldHaveWidget) {\r\n            this.widget.dispose();\r\n            this.widget = null;\r\n        }\r\n    };\r\n    IPadShowKeyboard.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        if (this.widget) {\r\n            this.widget.dispose();\r\n            this.widget = null;\r\n        }\r\n    };\r\n    IPadShowKeyboard.ID = 'editor.contrib.iPadShowKeyboard';\r\n    return IPadShowKeyboard;\r\n}(Disposable));\r\nexport { IPadShowKeyboard };\r\nvar ShowKeyboardWidget = /** @class */ (function (_super) {\r\n    __extends(ShowKeyboardWidget, _super);\r\n    function ShowKeyboardWidget(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this._domNode = document.createElement('textarea');\r\n        _this._domNode.className = 'iPadShowKeyboard';\r\n        _this._register(dom.addDisposableListener(_this._domNode, 'touchstart', function (e) {\r\n            _this.editor.focus();\r\n        }));\r\n        _this._register(dom.addDisposableListener(_this._domNode, 'focus', function (e) {\r\n            _this.editor.focus();\r\n        }));\r\n        _this.editor.addOverlayWidget(_this);\r\n        return _this;\r\n    }\r\n    ShowKeyboardWidget.prototype.dispose = function () {\r\n        this.editor.removeOverlayWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // ----- IOverlayWidget API\r\n    ShowKeyboardWidget.prototype.getId = function () {\r\n        return ShowKeyboardWidget.ID;\r\n    };\r\n    ShowKeyboardWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    ShowKeyboardWidget.prototype.getPosition = function () {\r\n        return {\r\n            preference: 1 /* BOTTOM_RIGHT_CORNER */\r\n        };\r\n    };\r\n    ShowKeyboardWidget.ID = 'editor.contrib.ShowKeyboardWidget';\r\n    return ShowKeyboardWidget;\r\n}(Disposable));\r\nregisterEditorContribution(IPadShowKeyboard.ID, IPadShowKeyboard);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './inspectTokens.css';\r\nimport { Color } from '../../../../base/common/color.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { escape } from '../../../../base/common/strings.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { TokenMetadata, TokenizationRegistry } from '../../../common/modes.js';\r\nimport { NULL_STATE, nullTokenize, nullTokenize2 } from '../../../common/modes/nullMode.js';\r\nimport { IModeService } from '../../../common/services/modeService.js';\r\nimport { IStandaloneThemeService } from '../../common/standaloneThemeService.js';\r\nimport { editorHoverBackground, editorHoverBorder, editorHoverForeground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { HIGH_CONTRAST, registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport { InspectTokensNLS } from '../../../common/standaloneStrings.js';\r\nvar InspectTokensController = /** @class */ (function (_super) {\r\n    __extends(InspectTokensController, _super);\r\n    function InspectTokensController(editor, standaloneColorService, modeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._modeService = modeService;\r\n        _this._widget = null;\r\n        _this._register(_this._editor.onDidChangeModel(function (e) { return _this.stop(); }));\r\n        _this._register(_this._editor.onDidChangeModelLanguage(function (e) { return _this.stop(); }));\r\n        _this._register(TokenizationRegistry.onDidChange(function (e) { return _this.stop(); }));\r\n        return _this;\r\n    }\r\n    InspectTokensController.get = function (editor) {\r\n        return editor.getContribution(InspectTokensController.ID);\r\n    };\r\n    InspectTokensController.prototype.dispose = function () {\r\n        this.stop();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    InspectTokensController.prototype.launch = function () {\r\n        if (this._widget) {\r\n            return;\r\n        }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        this._widget = new InspectTokensWidget(this._editor, this._modeService);\r\n    };\r\n    InspectTokensController.prototype.stop = function () {\r\n        if (this._widget) {\r\n            this._widget.dispose();\r\n            this._widget = null;\r\n        }\r\n    };\r\n    InspectTokensController.ID = 'editor.contrib.inspectTokens';\r\n    InspectTokensController = __decorate([\r\n        __param(1, IStandaloneThemeService),\r\n        __param(2, IModeService)\r\n    ], InspectTokensController);\r\n    return InspectTokensController;\r\n}(Disposable));\r\nvar InspectTokens = /** @class */ (function (_super) {\r\n    __extends(InspectTokens, _super);\r\n    function InspectTokens() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.inspectTokens',\r\n            label: InspectTokensNLS.inspectTokensAction,\r\n            alias: 'Developer: Inspect Tokens',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    InspectTokens.prototype.run = function (accessor, editor) {\r\n        var controller = InspectTokensController.get(editor);\r\n        if (controller) {\r\n            controller.launch();\r\n        }\r\n    };\r\n    return InspectTokens;\r\n}(EditorAction));\r\nfunction renderTokenText(tokenText) {\r\n    var result = '';\r\n    for (var charIndex = 0, len = tokenText.length; charIndex < len; charIndex++) {\r\n        var charCode = tokenText.charCodeAt(charIndex);\r\n        switch (charCode) {\r\n            case 9 /* Tab */:\r\n                result += '&rarr;';\r\n                break;\r\n            case 32 /* Space */:\r\n                result += '&middot;';\r\n                break;\r\n            case 60 /* LessThan */:\r\n                result += '&lt;';\r\n                break;\r\n            case 62 /* GreaterThan */:\r\n                result += '&gt;';\r\n                break;\r\n            case 38 /* Ampersand */:\r\n                result += '&amp;';\r\n                break;\r\n            default:\r\n                result += String.fromCharCode(charCode);\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction getSafeTokenizationSupport(languageIdentifier) {\r\n    var tokenizationSupport = TokenizationRegistry.get(languageIdentifier.language);\r\n    if (tokenizationSupport) {\r\n        return tokenizationSupport;\r\n    }\r\n    return {\r\n        getInitialState: function () { return NULL_STATE; },\r\n        tokenize: function (line, state, deltaOffset) { return nullTokenize(languageIdentifier.language, line, state, deltaOffset); },\r\n        tokenize2: function (line, state, deltaOffset) { return nullTokenize2(languageIdentifier.id, line, state, deltaOffset); }\r\n    };\r\n}\r\nvar InspectTokensWidget = /** @class */ (function (_super) {\r\n    __extends(InspectTokensWidget, _super);\r\n    function InspectTokensWidget(editor, modeService) {\r\n        var _this = _super.call(this) || this;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        _this.allowEditorOverflow = true;\r\n        _this._editor = editor;\r\n        _this._modeService = modeService;\r\n        _this._model = _this._editor.getModel();\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'tokens-inspect-widget';\r\n        _this._tokenizationSupport = getSafeTokenizationSupport(_this._model.getLanguageIdentifier());\r\n        _this._compute(_this._editor.getPosition());\r\n        _this._register(_this._editor.onDidChangeCursorPosition(function (e) { return _this._compute(_this._editor.getPosition()); }));\r\n        _this._editor.addContentWidget(_this);\r\n        return _this;\r\n    }\r\n    InspectTokensWidget.prototype.dispose = function () {\r\n        this._editor.removeContentWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    InspectTokensWidget.prototype.getId = function () {\r\n        return InspectTokensWidget._ID;\r\n    };\r\n    InspectTokensWidget.prototype._compute = function (position) {\r\n        var data = this._getTokensAtLine(position.lineNumber);\r\n        var token1Index = 0;\r\n        for (var i = data.tokens1.length - 1; i >= 0; i--) {\r\n            var t = data.tokens1[i];\r\n            if (position.column - 1 >= t.offset) {\r\n                token1Index = i;\r\n                break;\r\n            }\r\n        }\r\n        var token2Index = 0;\r\n        for (var i = (data.tokens2.length >>> 1); i >= 0; i--) {\r\n            if (position.column - 1 >= data.tokens2[(i << 1)]) {\r\n                token2Index = i;\r\n                break;\r\n            }\r\n        }\r\n        var result = '';\r\n        var lineContent = this._model.getLineContent(position.lineNumber);\r\n        var tokenText = '';\r\n        if (token1Index < data.tokens1.length) {\r\n            var tokenStartIndex = data.tokens1[token1Index].offset;\r\n            var tokenEndIndex = token1Index + 1 < data.tokens1.length ? data.tokens1[token1Index + 1].offset : lineContent.length;\r\n            tokenText = lineContent.substring(tokenStartIndex, tokenEndIndex);\r\n        }\r\n        result += \"<h2 class=\\\"tm-token\\\">\" + renderTokenText(tokenText) + \"<span class=\\\"tm-token-length\\\">(\" + tokenText.length + \" \" + (tokenText.length === 1 ? 'char' : 'chars') + \")</span></h2>\";\r\n        result += \"<hr class=\\\"tokens-inspect-separator\\\" style=\\\"clear:both\\\"/>\";\r\n        var metadata = this._decodeMetadata(data.tokens2[(token2Index << 1) + 1]);\r\n        result += \"<table class=\\\"tm-metadata-table\\\"><tbody>\";\r\n        result += \"<tr><td class=\\\"tm-metadata-key\\\">language</td><td class=\\\"tm-metadata-value\\\">\" + escape(metadata.languageIdentifier.language) + \"</td>\";\r\n        result += \"<tr><td class=\\\"tm-metadata-key\\\">token type</td><td class=\\\"tm-metadata-value\\\">\" + this._tokenTypeToString(metadata.tokenType) + \"</td>\";\r\n        result += \"<tr><td class=\\\"tm-metadata-key\\\">font style</td><td class=\\\"tm-metadata-value\\\">\" + this._fontStyleToString(metadata.fontStyle) + \"</td>\";\r\n        result += \"<tr><td class=\\\"tm-metadata-key\\\">foreground</td><td class=\\\"tm-metadata-value\\\">\" + Color.Format.CSS.formatHex(metadata.foreground) + \"</td>\";\r\n        result += \"<tr><td class=\\\"tm-metadata-key\\\">background</td><td class=\\\"tm-metadata-value\\\">\" + Color.Format.CSS.formatHex(metadata.background) + \"</td>\";\r\n        result += \"</tbody></table>\";\r\n        result += \"<hr class=\\\"tokens-inspect-separator\\\"/>\";\r\n        if (token1Index < data.tokens1.length) {\r\n            result += \"<span class=\\\"tm-token-type\\\">\" + escape(data.tokens1[token1Index].type) + \"</span>\";\r\n        }\r\n        this._domNode.innerHTML = result;\r\n        this._editor.layoutContentWidget(this);\r\n    };\r\n    InspectTokensWidget.prototype._decodeMetadata = function (metadata) {\r\n        var colorMap = TokenizationRegistry.getColorMap();\r\n        var languageId = TokenMetadata.getLanguageId(metadata);\r\n        var tokenType = TokenMetadata.getTokenType(metadata);\r\n        var fontStyle = TokenMetadata.getFontStyle(metadata);\r\n        var foreground = TokenMetadata.getForeground(metadata);\r\n        var background = TokenMetadata.getBackground(metadata);\r\n        return {\r\n            languageIdentifier: this._modeService.getLanguageIdentifier(languageId),\r\n            tokenType: tokenType,\r\n            fontStyle: fontStyle,\r\n            foreground: colorMap[foreground],\r\n            background: colorMap[background]\r\n        };\r\n    };\r\n    InspectTokensWidget.prototype._tokenTypeToString = function (tokenType) {\r\n        switch (tokenType) {\r\n            case 0 /* Other */: return 'Other';\r\n            case 1 /* Comment */: return 'Comment';\r\n            case 2 /* String */: return 'String';\r\n            case 4 /* RegEx */: return 'RegEx';\r\n        }\r\n        return '??';\r\n    };\r\n    InspectTokensWidget.prototype._fontStyleToString = function (fontStyle) {\r\n        var r = '';\r\n        if (fontStyle & 1 /* Italic */) {\r\n            r += 'italic ';\r\n        }\r\n        if (fontStyle & 2 /* Bold */) {\r\n            r += 'bold ';\r\n        }\r\n        if (fontStyle & 4 /* Underline */) {\r\n            r += 'underline ';\r\n        }\r\n        if (r.length === 0) {\r\n            r = '---';\r\n        }\r\n        return r;\r\n    };\r\n    InspectTokensWidget.prototype._getTokensAtLine = function (lineNumber) {\r\n        var stateBeforeLine = this._getStateBeforeLine(lineNumber);\r\n        var tokenizationResult1 = this._tokenizationSupport.tokenize(this._model.getLineContent(lineNumber), stateBeforeLine, 0);\r\n        var tokenizationResult2 = this._tokenizationSupport.tokenize2(this._model.getLineContent(lineNumber), stateBeforeLine, 0);\r\n        return {\r\n            startState: stateBeforeLine,\r\n            tokens1: tokenizationResult1.tokens,\r\n            tokens2: tokenizationResult2.tokens,\r\n            endState: tokenizationResult1.endState\r\n        };\r\n    };\r\n    InspectTokensWidget.prototype._getStateBeforeLine = function (lineNumber) {\r\n        var state = this._tokenizationSupport.getInitialState();\r\n        for (var i = 1; i < lineNumber; i++) {\r\n            var tokenizationResult = this._tokenizationSupport.tokenize(this._model.getLineContent(i), state, 0);\r\n            state = tokenizationResult.endState;\r\n        }\r\n        return state;\r\n    };\r\n    InspectTokensWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    InspectTokensWidget.prototype.getPosition = function () {\r\n        return {\r\n            position: this._editor.getPosition(),\r\n            preference: [2 /* BELOW */, 1 /* ABOVE */]\r\n        };\r\n    };\r\n    InspectTokensWidget._ID = 'editor.contrib.inspectTokensWidget';\r\n    return InspectTokensWidget;\r\n}(Disposable));\r\nregisterEditorContribution(InspectTokensController.ID, InspectTokensController);\r\nregisterEditorAction(InspectTokens);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(editorHoverBorder);\r\n    if (border) {\r\n        var borderWidth = theme.type === HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(\".monaco-editor .tokens-inspect-widget { border: \" + borderWidth + \"px solid \" + border + \"; }\");\r\n        collector.addRule(\".monaco-editor .tokens-inspect-widget .tokens-inspect-separator { background-color: \" + border + \"; }\");\r\n    }\r\n    var background = theme.getColor(editorHoverBackground);\r\n    if (background) {\r\n        collector.addRule(\".monaco-editor .tokens-inspect-widget { background-color: \" + background + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(editorHoverForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .tokens-inspect-widget { color: \" + foreground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './keybindingLabel.css';\r\nimport { equals } from '../../../common/objects.js';\r\nimport { UILabelProvider } from '../../../common/keybindingLabels.js';\r\nimport * as dom from '../../dom.js';\r\nimport { localize } from '../../../../nls.js';\r\nvar $ = dom.$;\r\nvar KeybindingLabel = /** @class */ (function () {\r\n    function KeybindingLabel(container, os, options) {\r\n        this.os = os;\r\n        this.options = options;\r\n        this.domNode = dom.append(container, $('.monaco-keybinding'));\r\n        this.didEverRender = false;\r\n        container.appendChild(this.domNode);\r\n    }\r\n    KeybindingLabel.prototype.set = function (keybinding, matches) {\r\n        if (this.didEverRender && this.keybinding === keybinding && KeybindingLabel.areSame(this.matches, matches)) {\r\n            return;\r\n        }\r\n        this.keybinding = keybinding;\r\n        this.matches = matches;\r\n        this.render();\r\n    };\r\n    KeybindingLabel.prototype.render = function () {\r\n        dom.clearNode(this.domNode);\r\n        if (this.keybinding) {\r\n            var _a = this.keybinding.getParts(), firstPart = _a[0], chordPart = _a[1];\r\n            if (firstPart) {\r\n                this.renderPart(this.domNode, firstPart, this.matches ? this.matches.firstPart : null);\r\n            }\r\n            if (chordPart) {\r\n                dom.append(this.domNode, $('span.monaco-keybinding-key-chord-separator', undefined, ' '));\r\n                this.renderPart(this.domNode, chordPart, this.matches ? this.matches.chordPart : null);\r\n            }\r\n            this.domNode.title = this.keybinding.getAriaLabel() || '';\r\n        }\r\n        else if (this.options && this.options.renderUnboundKeybindings) {\r\n            this.renderUnbound(this.domNode);\r\n        }\r\n        this.didEverRender = true;\r\n    };\r\n    KeybindingLabel.prototype.renderPart = function (parent, part, match) {\r\n        var _a, _b, _c, _d, _e;\r\n        var modifierLabels = UILabelProvider.modifierLabels[this.os];\r\n        if (part.ctrlKey) {\r\n            this.renderKey(parent, modifierLabels.ctrlKey, Boolean((_a = match) === null || _a === void 0 ? void 0 : _a.ctrlKey), modifierLabels.separator);\r\n        }\r\n        if (part.shiftKey) {\r\n            this.renderKey(parent, modifierLabels.shiftKey, Boolean((_b = match) === null || _b === void 0 ? void 0 : _b.shiftKey), modifierLabels.separator);\r\n        }\r\n        if (part.altKey) {\r\n            this.renderKey(parent, modifierLabels.altKey, Boolean((_c = match) === null || _c === void 0 ? void 0 : _c.altKey), modifierLabels.separator);\r\n        }\r\n        if (part.metaKey) {\r\n            this.renderKey(parent, modifierLabels.metaKey, Boolean((_d = match) === null || _d === void 0 ? void 0 : _d.metaKey), modifierLabels.separator);\r\n        }\r\n        var keyLabel = part.keyLabel;\r\n        if (keyLabel) {\r\n            this.renderKey(parent, keyLabel, Boolean((_e = match) === null || _e === void 0 ? void 0 : _e.keyCode), '');\r\n        }\r\n    };\r\n    KeybindingLabel.prototype.renderKey = function (parent, label, highlight, separator) {\r\n        dom.append(parent, $('span.monaco-keybinding-key' + (highlight ? '.highlight' : ''), undefined, label));\r\n        if (separator) {\r\n            dom.append(parent, $('span.monaco-keybinding-key-separator', undefined, separator));\r\n        }\r\n    };\r\n    KeybindingLabel.prototype.renderUnbound = function (parent) {\r\n        dom.append(parent, $('span.monaco-keybinding-key', undefined, localize('unbound', \"Unbound\")));\r\n    };\r\n    KeybindingLabel.areSame = function (a, b) {\r\n        if (a === b || (!a && !b)) {\r\n            return true;\r\n        }\r\n        return !!a && !!b && equals(a.firstPart, b.firstPart) && equals(a.chordPart, b.chordPart);\r\n    };\r\n    return KeybindingLabel;\r\n}());\r\nexport { KeybindingLabel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../../nls.js';\r\nimport * as types from '../../../common/types.js';\r\nimport { IconLabel } from '../../../browser/ui/iconLabel/iconLabel.js';\r\nimport { ActionBar } from '../../../browser/ui/actionbar/actionbar.js';\r\nimport { HighlightedLabel } from '../../../browser/ui/highlightedlabel/highlightedLabel.js';\r\nimport * as DOM from '../../../browser/dom.js';\r\nimport { KeybindingLabel } from '../../../browser/ui/keybindingLabel/keybindingLabel.js';\r\nimport { OS } from '../../../common/platform.js';\r\nimport { coalesce } from '../../../common/arrays.js';\r\nvar IDS = 0;\r\nvar QuickOpenEntry = /** @class */ (function () {\r\n    function QuickOpenEntry(highlights) {\r\n        if (highlights === void 0) { highlights = []; }\r\n        this.id = (IDS++).toString();\r\n        this.labelHighlights = highlights;\r\n        this.descriptionHighlights = [];\r\n    }\r\n    /**\r\n     * A unique identifier for the entry\r\n     */\r\n    QuickOpenEntry.prototype.getId = function () {\r\n        return this.id;\r\n    };\r\n    /**\r\n     * The label of the entry to identify it from others in the list\r\n     */\r\n    QuickOpenEntry.prototype.getLabel = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * The options for the label to use for this entry\r\n     */\r\n    QuickOpenEntry.prototype.getLabelOptions = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * The label of the entry to use when a screen reader wants to read about the entry\r\n     */\r\n    QuickOpenEntry.prototype.getAriaLabel = function () {\r\n        return coalesce([this.getLabel(), this.getDescription(), this.getDetail()])\r\n            .join(', ');\r\n    };\r\n    /**\r\n     * Detail information about the entry that is optional and can be shown below the label\r\n     */\r\n    QuickOpenEntry.prototype.getDetail = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * The icon of the entry to identify it from others in the list\r\n     */\r\n    QuickOpenEntry.prototype.getIcon = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * A secondary description that is optional and can be shown right to the label\r\n     */\r\n    QuickOpenEntry.prototype.getDescription = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * A tooltip to show when hovering over the entry.\r\n     */\r\n    QuickOpenEntry.prototype.getTooltip = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * A tooltip to show when hovering over the description portion of the entry.\r\n     */\r\n    QuickOpenEntry.prototype.getDescriptionTooltip = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * An optional keybinding to show for an entry.\r\n     */\r\n    QuickOpenEntry.prototype.getKeybinding = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * Allows to reuse the same model while filtering. Hidden entries will not show up in the viewer.\r\n     */\r\n    QuickOpenEntry.prototype.isHidden = function () {\r\n        return !!this.hidden;\r\n    };\r\n    /**\r\n     * Allows to set highlight ranges that should show up for the entry label and optionally description if set.\r\n     */\r\n    QuickOpenEntry.prototype.setHighlights = function (labelHighlights, descriptionHighlights, detailHighlights) {\r\n        this.labelHighlights = labelHighlights;\r\n        this.descriptionHighlights = descriptionHighlights;\r\n        this.detailHighlights = detailHighlights;\r\n    };\r\n    /**\r\n     * Allows to return highlight ranges that should show up for the entry label and description.\r\n     */\r\n    QuickOpenEntry.prototype.getHighlights = function () {\r\n        return [this.labelHighlights, this.descriptionHighlights, this.detailHighlights];\r\n    };\r\n    /**\r\n     * Called when the entry is selected for opening. Returns a boolean value indicating if an action was performed or not.\r\n     * The mode parameter gives an indication if the element is previewed (using arrow keys) or opened.\r\n     *\r\n     * The context parameter provides additional context information how the run was triggered.\r\n     */\r\n    QuickOpenEntry.prototype.run = function (mode, context) {\r\n        return false;\r\n    };\r\n    return QuickOpenEntry;\r\n}());\r\nexport { QuickOpenEntry };\r\nvar QuickOpenEntryGroup = /** @class */ (function (_super) {\r\n    __extends(QuickOpenEntryGroup, _super);\r\n    function QuickOpenEntryGroup(entry, groupLabel, withBorder) {\r\n        var _this = _super.call(this) || this;\r\n        _this.entry = entry;\r\n        _this.groupLabel = groupLabel;\r\n        _this.withBorder = withBorder;\r\n        return _this;\r\n    }\r\n    /**\r\n     * The label of the group or null if none.\r\n     */\r\n    QuickOpenEntryGroup.prototype.getGroupLabel = function () {\r\n        return this.groupLabel;\r\n    };\r\n    QuickOpenEntryGroup.prototype.setGroupLabel = function (groupLabel) {\r\n        this.groupLabel = groupLabel;\r\n    };\r\n    /**\r\n     * Whether to show a border on top of the group entry or not.\r\n     */\r\n    QuickOpenEntryGroup.prototype.showBorder = function () {\r\n        return !!this.withBorder;\r\n    };\r\n    QuickOpenEntryGroup.prototype.setShowBorder = function (showBorder) {\r\n        this.withBorder = showBorder;\r\n    };\r\n    QuickOpenEntryGroup.prototype.getLabel = function () {\r\n        return this.entry ? this.entry.getLabel() : _super.prototype.getLabel.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getLabelOptions = function () {\r\n        return this.entry ? this.entry.getLabelOptions() : _super.prototype.getLabelOptions.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getAriaLabel = function () {\r\n        return this.entry ? this.entry.getAriaLabel() : _super.prototype.getAriaLabel.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getDetail = function () {\r\n        return this.entry ? this.entry.getDetail() : _super.prototype.getDetail.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getIcon = function () {\r\n        return this.entry ? this.entry.getIcon() : _super.prototype.getIcon.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getDescription = function () {\r\n        return this.entry ? this.entry.getDescription() : _super.prototype.getDescription.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getHighlights = function () {\r\n        return this.entry ? this.entry.getHighlights() : _super.prototype.getHighlights.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.isHidden = function () {\r\n        return this.entry ? this.entry.isHidden() : _super.prototype.isHidden.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.setHighlights = function (labelHighlights, descriptionHighlights, detailHighlights) {\r\n        this.entry ? this.entry.setHighlights(labelHighlights, descriptionHighlights, detailHighlights) : _super.prototype.setHighlights.call(this, labelHighlights, descriptionHighlights, detailHighlights);\r\n    };\r\n    QuickOpenEntryGroup.prototype.run = function (mode, context) {\r\n        return this.entry ? this.entry.run(mode, context) : _super.prototype.run.call(this, mode, context);\r\n    };\r\n    return QuickOpenEntryGroup;\r\n}(QuickOpenEntry));\r\nexport { QuickOpenEntryGroup };\r\nvar NoActionProvider = /** @class */ (function () {\r\n    function NoActionProvider() {\r\n    }\r\n    NoActionProvider.prototype.hasActions = function (tree, element) {\r\n        return false;\r\n    };\r\n    NoActionProvider.prototype.getActions = function (tree, element) {\r\n        return null;\r\n    };\r\n    return NoActionProvider;\r\n}());\r\nvar templateEntry = 'quickOpenEntry';\r\nvar templateEntryGroup = 'quickOpenEntryGroup';\r\nvar Renderer = /** @class */ (function () {\r\n    function Renderer(actionProvider, actionRunner) {\r\n        if (actionProvider === void 0) { actionProvider = new NoActionProvider(); }\r\n        this.actionProvider = actionProvider;\r\n        this.actionRunner = actionRunner;\r\n    }\r\n    Renderer.prototype.getHeight = function (entry) {\r\n        if (entry.getDetail()) {\r\n            return 44;\r\n        }\r\n        return 22;\r\n    };\r\n    Renderer.prototype.getTemplateId = function (entry) {\r\n        if (entry instanceof QuickOpenEntryGroup) {\r\n            return templateEntryGroup;\r\n        }\r\n        return templateEntry;\r\n    };\r\n    Renderer.prototype.renderTemplate = function (templateId, container, styles) {\r\n        var entryContainer = document.createElement('div');\r\n        DOM.addClass(entryContainer, 'sub-content');\r\n        container.appendChild(entryContainer);\r\n        // Entry\r\n        var row1 = DOM.$('.quick-open-row');\r\n        var row2 = DOM.$('.quick-open-row');\r\n        var entry = DOM.$('.quick-open-entry', undefined, row1, row2);\r\n        entryContainer.appendChild(entry);\r\n        // Icon\r\n        var icon = document.createElement('span');\r\n        row1.appendChild(icon);\r\n        // Label\r\n        var label = new IconLabel(row1, { supportHighlights: true, supportDescriptionHighlights: true, supportCodicons: true });\r\n        // Keybinding\r\n        var keybindingContainer = document.createElement('span');\r\n        row1.appendChild(keybindingContainer);\r\n        DOM.addClass(keybindingContainer, 'quick-open-entry-keybinding');\r\n        var keybinding = new KeybindingLabel(keybindingContainer, OS);\r\n        // Detail\r\n        var detailContainer = document.createElement('div');\r\n        row2.appendChild(detailContainer);\r\n        DOM.addClass(detailContainer, 'quick-open-entry-meta');\r\n        var detail = new HighlightedLabel(detailContainer, true);\r\n        // Entry Group\r\n        var group;\r\n        if (templateId === templateEntryGroup) {\r\n            group = document.createElement('div');\r\n            DOM.addClass(group, 'results-group');\r\n            container.appendChild(group);\r\n        }\r\n        // Actions\r\n        DOM.addClass(container, 'actions');\r\n        var actionBarContainer = document.createElement('div');\r\n        DOM.addClass(actionBarContainer, 'primary-action-bar');\r\n        container.appendChild(actionBarContainer);\r\n        var actionBar = new ActionBar(actionBarContainer, {\r\n            actionRunner: this.actionRunner\r\n        });\r\n        return {\r\n            container: container,\r\n            entry: entry,\r\n            icon: icon,\r\n            label: label,\r\n            detail: detail,\r\n            keybinding: keybinding,\r\n            group: group,\r\n            actionBar: actionBar\r\n        };\r\n    };\r\n    Renderer.prototype.renderElement = function (entry, templateId, data, styles) {\r\n        // Action Bar\r\n        if (this.actionProvider.hasActions(null, entry)) {\r\n            DOM.addClass(data.container, 'has-actions');\r\n        }\r\n        else {\r\n            DOM.removeClass(data.container, 'has-actions');\r\n        }\r\n        data.actionBar.context = entry; // make sure the context is the current element\r\n        var actions = this.actionProvider.getActions(null, entry);\r\n        if (data.actionBar.isEmpty() && actions && actions.length > 0) {\r\n            data.actionBar.push(actions, { icon: true, label: false });\r\n        }\r\n        else if (!data.actionBar.isEmpty() && (!actions || actions.length === 0)) {\r\n            data.actionBar.clear();\r\n        }\r\n        // Entry group class\r\n        if (entry instanceof QuickOpenEntryGroup && entry.getGroupLabel()) {\r\n            DOM.addClass(data.container, 'has-group-label');\r\n        }\r\n        else {\r\n            DOM.removeClass(data.container, 'has-group-label');\r\n        }\r\n        // Entry group\r\n        if (entry instanceof QuickOpenEntryGroup) {\r\n            var group = entry;\r\n            var groupData = data;\r\n            // Border\r\n            if (group.showBorder()) {\r\n                DOM.addClass(groupData.container, 'results-group-separator');\r\n                if (styles.pickerGroupBorder) {\r\n                    groupData.container.style.borderTopColor = styles.pickerGroupBorder.toString();\r\n                }\r\n            }\r\n            else {\r\n                DOM.removeClass(groupData.container, 'results-group-separator');\r\n                groupData.container.style.borderTopColor = '';\r\n            }\r\n            // Group Label\r\n            var groupLabel = group.getGroupLabel() || '';\r\n            if (groupData.group) {\r\n                groupData.group.textContent = groupLabel;\r\n                if (styles.pickerGroupForeground) {\r\n                    groupData.group.style.color = styles.pickerGroupForeground.toString();\r\n                }\r\n            }\r\n        }\r\n        // Normal Entry\r\n        if (entry instanceof QuickOpenEntry) {\r\n            var _a = entry.getHighlights(), labelHighlights = _a[0], descriptionHighlights = _a[1], detailHighlights = _a[2];\r\n            // Icon\r\n            var iconClass = entry.getIcon() ? ('quick-open-entry-icon ' + entry.getIcon()) : '';\r\n            data.icon.className = iconClass;\r\n            // Label\r\n            var options = entry.getLabelOptions() || Object.create(null);\r\n            options.matches = labelHighlights || [];\r\n            options.title = entry.getTooltip();\r\n            options.descriptionTitle = entry.getDescriptionTooltip() || entry.getDescription(); // tooltip over description because it could overflow\r\n            options.descriptionMatches = descriptionHighlights || [];\r\n            data.label.setLabel(entry.getLabel() || '', entry.getDescription(), options);\r\n            // Meta\r\n            data.detail.set(entry.getDetail(), detailHighlights);\r\n            // Keybinding\r\n            data.keybinding.set(entry.getKeybinding());\r\n        }\r\n    };\r\n    Renderer.prototype.disposeTemplate = function (templateId, templateData) {\r\n        templateData.actionBar.dispose();\r\n        templateData.actionBar = null;\r\n        templateData.container = null;\r\n        templateData.entry = null;\r\n        templateData.keybinding = null;\r\n        templateData.detail = null;\r\n        templateData.group = null;\r\n        templateData.icon = null;\r\n        templateData.label.dispose();\r\n        templateData.label = null;\r\n    };\r\n    return Renderer;\r\n}());\r\nvar QuickOpenModel = /** @class */ (function () {\r\n    function QuickOpenModel(entries, actionProvider) {\r\n        if (entries === void 0) { entries = []; }\r\n        if (actionProvider === void 0) { actionProvider = new NoActionProvider(); }\r\n        this._entries = entries;\r\n        this._dataSource = this;\r\n        this._renderer = new Renderer(actionProvider);\r\n        this._filter = this;\r\n        this._runner = this;\r\n        this._accessibilityProvider = this;\r\n    }\r\n    Object.defineProperty(QuickOpenModel.prototype, \"entries\", {\r\n        get: function () { return this._entries; },\r\n        set: function (entries) {\r\n            this._entries = entries;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(QuickOpenModel.prototype, \"dataSource\", {\r\n        get: function () { return this._dataSource; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(QuickOpenModel.prototype, \"renderer\", {\r\n        get: function () { return this._renderer; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(QuickOpenModel.prototype, \"filter\", {\r\n        get: function () { return this._filter; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(QuickOpenModel.prototype, \"runner\", {\r\n        get: function () { return this._runner; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(QuickOpenModel.prototype, \"accessibilityProvider\", {\r\n        get: function () { return this._accessibilityProvider; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    QuickOpenModel.prototype.getId = function (entry) {\r\n        return entry.getId();\r\n    };\r\n    QuickOpenModel.prototype.getLabel = function (entry) {\r\n        return types.withUndefinedAsNull(entry.getLabel());\r\n    };\r\n    QuickOpenModel.prototype.getAriaLabel = function (entry) {\r\n        var ariaLabel = entry.getAriaLabel();\r\n        if (ariaLabel) {\r\n            return nls.localize('quickOpenAriaLabelEntry', \"{0}, picker\", entry.getAriaLabel());\r\n        }\r\n        return nls.localize('quickOpenAriaLabel', \"picker\");\r\n    };\r\n    QuickOpenModel.prototype.isVisible = function (entry) {\r\n        return !entry.isHidden();\r\n    };\r\n    QuickOpenModel.prototype.run = function (entry, mode, context) {\r\n        return entry.run(mode, context);\r\n    };\r\n    return QuickOpenModel;\r\n}());\r\nexport { QuickOpenModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isFunction } from '../../../common/types.js';\r\nvar DataSource = /** @class */ (function () {\r\n    function DataSource(arg) {\r\n        this.modelProvider = isFunction(arg.getModel) ? arg : { getModel: function () { return arg; } };\r\n    }\r\n    DataSource.prototype.getId = function (tree, element) {\r\n        if (!element) {\r\n            return null;\r\n        }\r\n        var model = this.modelProvider.getModel();\r\n        return model === element ? '__root__' : model.dataSource.getId(element);\r\n    };\r\n    DataSource.prototype.hasChildren = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        return !!(model && model === element && model.entries.length > 0);\r\n    };\r\n    DataSource.prototype.getChildren = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        return Promise.resolve(model === element ? model.entries : []);\r\n    };\r\n    DataSource.prototype.getParent = function (tree, element) {\r\n        return Promise.resolve(null);\r\n    };\r\n    return DataSource;\r\n}());\r\nexport { DataSource };\r\nvar AccessibilityProvider = /** @class */ (function () {\r\n    function AccessibilityProvider(modelProvider) {\r\n        this.modelProvider = modelProvider;\r\n    }\r\n    AccessibilityProvider.prototype.getAriaLabel = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        return model.accessibilityProvider ? model.accessibilityProvider.getAriaLabel(element) : null;\r\n    };\r\n    AccessibilityProvider.prototype.getPosInSet = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        var i = 0;\r\n        if (model.filter) {\r\n            for (var _i = 0, _a = model.entries; _i < _a.length; _i++) {\r\n                var entry = _a[_i];\r\n                if (model.filter.isVisible(entry)) {\r\n                    i++;\r\n                }\r\n                if (entry === element) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            i = model.entries.indexOf(element) + 1;\r\n        }\r\n        return String(i);\r\n    };\r\n    AccessibilityProvider.prototype.getSetSize = function () {\r\n        var model = this.modelProvider.getModel();\r\n        var n = 0;\r\n        if (model.filter) {\r\n            for (var _i = 0, _a = model.entries; _i < _a.length; _i++) {\r\n                var entry = _a[_i];\r\n                if (model.filter.isVisible(entry)) {\r\n                    n++;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            n = model.entries.length;\r\n        }\r\n        return String(n);\r\n    };\r\n    return AccessibilityProvider;\r\n}());\r\nexport { AccessibilityProvider };\r\nvar Filter = /** @class */ (function () {\r\n    function Filter(modelProvider) {\r\n        this.modelProvider = modelProvider;\r\n    }\r\n    Filter.prototype.isVisible = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        if (!model.filter) {\r\n            return true;\r\n        }\r\n        return model.filter.isVisible(element);\r\n    };\r\n    return Filter;\r\n}());\r\nexport { Filter };\r\nvar Renderer = /** @class */ (function () {\r\n    function Renderer(modelProvider, styles) {\r\n        this.modelProvider = modelProvider;\r\n        this.styles = styles;\r\n    }\r\n    Renderer.prototype.updateStyles = function (styles) {\r\n        this.styles = styles;\r\n    };\r\n    Renderer.prototype.getHeight = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        return model.renderer.getHeight(element);\r\n    };\r\n    Renderer.prototype.getTemplateId = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        return model.renderer.getTemplateId(element);\r\n    };\r\n    Renderer.prototype.renderTemplate = function (tree, templateId, container) {\r\n        var model = this.modelProvider.getModel();\r\n        return model.renderer.renderTemplate(templateId, container, this.styles);\r\n    };\r\n    Renderer.prototype.renderElement = function (tree, element, templateId, templateData) {\r\n        var model = this.modelProvider.getModel();\r\n        model.renderer.renderElement(element, templateId, templateData, this.styles);\r\n    };\r\n    Renderer.prototype.disposeTemplate = function (tree, templateId, templateData) {\r\n        var model = this.modelProvider.getModel();\r\n        model.renderer.disposeTemplate(templateId, templateData);\r\n    };\r\n    return Renderer;\r\n}());\r\nexport { Renderer };\r\n","import * as platform from '../../../common/platform.js';\r\nimport * as errors from '../../../common/errors.js';\r\nimport * as dom from '../../../browser/dom.js';\r\nimport { createKeybinding } from '../../../common/keyCodes.js';\r\nvar KeybindingDispatcher = /** @class */ (function () {\r\n    function KeybindingDispatcher() {\r\n        this._arr = [];\r\n    }\r\n    KeybindingDispatcher.prototype.set = function (keybinding, callback) {\r\n        this._arr.push({\r\n            keybinding: createKeybinding(keybinding, platform.OS),\r\n            callback: callback\r\n        });\r\n    };\r\n    KeybindingDispatcher.prototype.dispatch = function (keybinding) {\r\n        // Loop from the last to the first to handle overwrites\r\n        for (var i = this._arr.length - 1; i >= 0; i--) {\r\n            var item = this._arr[i];\r\n            if (keybinding.toChord().equals(item.keybinding)) {\r\n                return item.callback;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return KeybindingDispatcher;\r\n}());\r\nexport { KeybindingDispatcher };\r\nvar DefaultController = /** @class */ (function () {\r\n    function DefaultController(options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = { clickBehavior: 0 /* ON_MOUSE_DOWN */, keyboardSupport: true, openMode: 0 /* SINGLE_CLICK */ }; }\r\n        this.options = options;\r\n        this.downKeyBindingDispatcher = new KeybindingDispatcher();\r\n        this.upKeyBindingDispatcher = new KeybindingDispatcher();\r\n        if (typeof options.keyboardSupport !== 'boolean' || options.keyboardSupport) {\r\n            this.downKeyBindingDispatcher.set(16 /* UpArrow */, function (t, e) { return _this.onUp(t, e); });\r\n            this.downKeyBindingDispatcher.set(18 /* DownArrow */, function (t, e) { return _this.onDown(t, e); });\r\n            this.downKeyBindingDispatcher.set(15 /* LeftArrow */, function (t, e) { return _this.onLeft(t, e); });\r\n            this.downKeyBindingDispatcher.set(17 /* RightArrow */, function (t, e) { return _this.onRight(t, e); });\r\n            if (platform.isMacintosh) {\r\n                this.downKeyBindingDispatcher.set(2048 /* CtrlCmd */ | 16 /* UpArrow */, function (t, e) { return _this.onLeft(t, e); });\r\n                this.downKeyBindingDispatcher.set(256 /* WinCtrl */ | 44 /* KEY_N */, function (t, e) { return _this.onDown(t, e); });\r\n                this.downKeyBindingDispatcher.set(256 /* WinCtrl */ | 46 /* KEY_P */, function (t, e) { return _this.onUp(t, e); });\r\n            }\r\n            this.downKeyBindingDispatcher.set(11 /* PageUp */, function (t, e) { return _this.onPageUp(t, e); });\r\n            this.downKeyBindingDispatcher.set(12 /* PageDown */, function (t, e) { return _this.onPageDown(t, e); });\r\n            this.downKeyBindingDispatcher.set(14 /* Home */, function (t, e) { return _this.onHome(t, e); });\r\n            this.downKeyBindingDispatcher.set(13 /* End */, function (t, e) { return _this.onEnd(t, e); });\r\n            this.downKeyBindingDispatcher.set(10 /* Space */, function (t, e) { return _this.onSpace(t, e); });\r\n            this.downKeyBindingDispatcher.set(9 /* Escape */, function (t, e) { return _this.onEscape(t, e); });\r\n            this.upKeyBindingDispatcher.set(3 /* Enter */, this.onEnter.bind(this));\r\n            this.upKeyBindingDispatcher.set(2048 /* CtrlCmd */ | 3 /* Enter */, this.onEnter.bind(this));\r\n        }\r\n    }\r\n    DefaultController.prototype.onMouseDown = function (tree, element, event, origin) {\r\n        if (origin === void 0) { origin = 'mouse'; }\r\n        if (this.options.clickBehavior === 0 /* ON_MOUSE_DOWN */ && (event.leftButton || event.middleButton)) {\r\n            if (event.target) {\r\n                if (event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n                    return false; // Ignore event if target is a form input field (avoids browser specific issues)\r\n                }\r\n                if (dom.findParentWithClass(event.target, 'scrollbar', 'monaco-tree')) {\r\n                    return false;\r\n                }\r\n                if (dom.findParentWithClass(event.target, 'monaco-action-bar', 'row')) { // TODO@Joao not very nice way of checking for the action bar (implicit knowledge)\r\n                    return false; // Ignore event if target is over an action bar of the row\r\n                }\r\n            }\r\n            // Propagate to onLeftClick now\r\n            return this.onLeftClick(tree, element, event, origin);\r\n        }\r\n        return false;\r\n    };\r\n    DefaultController.prototype.onClick = function (tree, element, event) {\r\n        var isMac = platform.isMacintosh;\r\n        // A Ctrl click on the Mac is a context menu event\r\n        if (isMac && event.ctrlKey) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            return false;\r\n        }\r\n        if (event.target && event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n            return false; // Ignore event if target is a form input field (avoids browser specific issues)\r\n        }\r\n        if (this.options.clickBehavior === 0 /* ON_MOUSE_DOWN */ && (event.leftButton || event.middleButton)) {\r\n            return false; // Already handled by onMouseDown\r\n        }\r\n        return this.onLeftClick(tree, element, event);\r\n    };\r\n    DefaultController.prototype.onLeftClick = function (tree, element, eventish, origin) {\r\n        if (origin === void 0) { origin = 'mouse'; }\r\n        var event = eventish;\r\n        var payload = { origin: origin, originalEvent: eventish, didClickOnTwistie: this.isClickOnTwistie(event) };\r\n        if (tree.getInput() === element) {\r\n            tree.clearFocus(payload);\r\n            tree.clearSelection(payload);\r\n        }\r\n        else {\r\n            var isSingleMouseDown = eventish && event.browserEvent && event.browserEvent.type === 'mousedown' && event.browserEvent.detail === 1;\r\n            if (!isSingleMouseDown) {\r\n                eventish.preventDefault(); // we cannot preventDefault onMouseDown with single click because this would break DND otherwise\r\n            }\r\n            eventish.stopPropagation();\r\n            tree.domFocus();\r\n            tree.setSelection([element], payload);\r\n            tree.setFocus(element, payload);\r\n            if (this.shouldToggleExpansion(element, event, origin)) {\r\n                if (tree.isExpanded(element)) {\r\n                    tree.collapse(element).then(undefined, errors.onUnexpectedError);\r\n                }\r\n                else {\r\n                    tree.expand(element).then(undefined, errors.onUnexpectedError);\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.shouldToggleExpansion = function (element, event, origin) {\r\n        var isDoubleClick = (origin === 'mouse' && event.detail === 2);\r\n        return this.openOnSingleClick || isDoubleClick || this.isClickOnTwistie(event);\r\n    };\r\n    Object.defineProperty(DefaultController.prototype, \"openOnSingleClick\", {\r\n        get: function () {\r\n            return this.options.openMode === 0 /* SINGLE_CLICK */;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    DefaultController.prototype.isClickOnTwistie = function (event) {\r\n        var element = event.target;\r\n        if (!dom.hasClass(element, 'content')) {\r\n            return false;\r\n        }\r\n        var twistieStyle = window.getComputedStyle(element, ':before');\r\n        if (twistieStyle.backgroundImage === 'none' || twistieStyle.display === 'none') {\r\n            return false;\r\n        }\r\n        var twistieWidth = parseInt(twistieStyle.width) + parseInt(twistieStyle.paddingRight);\r\n        return event.browserEvent.offsetX <= twistieWidth;\r\n    };\r\n    DefaultController.prototype.onContextMenu = function (tree, element, event) {\r\n        if (event.target && event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n            return false; // allow context menu on input fields\r\n        }\r\n        // Prevent native context menu from showing up\r\n        if (event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        }\r\n        return false;\r\n    };\r\n    DefaultController.prototype.onTap = function (tree, element, event) {\r\n        var target = event.initialTarget;\r\n        if (target && target.tagName && target.tagName.toLowerCase() === 'input') {\r\n            return false; // Ignore event if target is a form input field (avoids browser specific issues)\r\n        }\r\n        return this.onLeftClick(tree, element, event, 'touch');\r\n    };\r\n    DefaultController.prototype.onKeyDown = function (tree, event) {\r\n        return this.onKey(this.downKeyBindingDispatcher, tree, event);\r\n    };\r\n    DefaultController.prototype.onKeyUp = function (tree, event) {\r\n        return this.onKey(this.upKeyBindingDispatcher, tree, event);\r\n    };\r\n    DefaultController.prototype.onKey = function (bindings, tree, event) {\r\n        var handler = bindings.dispatch(event.toKeybinding());\r\n        if (handler) {\r\n            // TODO: TS 3.1 upgrade. Why are we checking against void?\r\n            if (handler(tree, event)) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    DefaultController.prototype.onUp = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusPrevious(1, payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onPageUp = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusPreviousPage(payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onDown = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusNext(1, payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onPageDown = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusNextPage(payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onHome = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusFirst(payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onEnd = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusLast(payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onLeft = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            var focus_1 = tree.getFocus();\r\n            tree.collapse(focus_1).then(function (didCollapse) {\r\n                if (focus_1 && !didCollapse) {\r\n                    tree.focusParent(payload);\r\n                    return tree.reveal(tree.getFocus());\r\n                }\r\n                return undefined;\r\n            }).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onRight = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            var focus_2 = tree.getFocus();\r\n            tree.expand(focus_2).then(function (didExpand) {\r\n                if (focus_2 && !didExpand) {\r\n                    tree.focusFirstChild(payload);\r\n                    return tree.reveal(tree.getFocus());\r\n                }\r\n                return undefined;\r\n            }).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onEnter = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            return false;\r\n        }\r\n        var focus = tree.getFocus();\r\n        if (focus) {\r\n            tree.setSelection([focus], payload);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onSpace = function (tree, event) {\r\n        if (tree.getHighlight()) {\r\n            return false;\r\n        }\r\n        var focus = tree.getFocus();\r\n        if (focus) {\r\n            tree.toggleExpansion(focus);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onEscape = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n            return true;\r\n        }\r\n        if (tree.getSelection().length) {\r\n            tree.clearSelection(payload);\r\n            return true;\r\n        }\r\n        if (tree.getFocus()) {\r\n            tree.clearFocus(payload);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return DefaultController;\r\n}());\r\nexport { DefaultController };\r\nvar DefaultDragAndDrop = /** @class */ (function () {\r\n    function DefaultDragAndDrop() {\r\n    }\r\n    DefaultDragAndDrop.prototype.getDragURI = function (tree, element) {\r\n        return null;\r\n    };\r\n    DefaultDragAndDrop.prototype.onDragStart = function (tree, data, originalEvent) {\r\n        return;\r\n    };\r\n    DefaultDragAndDrop.prototype.onDragOver = function (tree, data, targetElement, originalEvent) {\r\n        return null;\r\n    };\r\n    DefaultDragAndDrop.prototype.drop = function (tree, data, targetElement, originalEvent) {\r\n        return;\r\n    };\r\n    return DefaultDragAndDrop;\r\n}());\r\nexport { DefaultDragAndDrop };\r\nvar DefaultFilter = /** @class */ (function () {\r\n    function DefaultFilter() {\r\n    }\r\n    DefaultFilter.prototype.isVisible = function (tree, element) {\r\n        return true;\r\n    };\r\n    return DefaultFilter;\r\n}());\r\nexport { DefaultFilter };\r\nvar DefaultAccessibilityProvider = /** @class */ (function () {\r\n    function DefaultAccessibilityProvider() {\r\n    }\r\n    DefaultAccessibilityProvider.prototype.getAriaLabel = function (tree, element) {\r\n        return null;\r\n    };\r\n    return DefaultAccessibilityProvider;\r\n}());\r\nexport { DefaultAccessibilityProvider };\r\nvar DefaultTreestyler = /** @class */ (function () {\r\n    function DefaultTreestyler(styleElement, selectorSuffix) {\r\n        this.styleElement = styleElement;\r\n        this.selectorSuffix = selectorSuffix;\r\n    }\r\n    DefaultTreestyler.prototype.style = function (styles) {\r\n        var suffix = this.selectorSuffix ? \".\" + this.selectorSuffix : '';\r\n        var content = [];\r\n        if (styles.listFocusBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) { background-color: \" + styles.listFocusBackground + \"; }\");\r\n        }\r\n        if (styles.listFocusForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) { color: \" + styles.listFocusForeground + \"; }\");\r\n        }\r\n        if (styles.listActiveSelectionBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { background-color: \" + styles.listActiveSelectionBackground + \"; }\");\r\n        }\r\n        if (styles.listActiveSelectionForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { color: \" + styles.listActiveSelectionForeground + \"; }\");\r\n        }\r\n        if (styles.listFocusAndSelectionBackground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree-drag-image,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused.selected:not(.highlighted) { background-color: \" + styles.listFocusAndSelectionBackground + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listFocusAndSelectionForeground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree-drag-image,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused.selected:not(.highlighted) { color: \" + styles.listFocusAndSelectionForeground + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listInactiveSelectionBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { background-color: \" + styles.listInactiveSelectionBackground + \"; }\");\r\n        }\r\n        if (styles.listInactiveSelectionForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { color: \" + styles.listInactiveSelectionForeground + \"; }\");\r\n        }\r\n        if (styles.listHoverBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused) { background-color: \" + styles.listHoverBackground + \"; }\");\r\n        }\r\n        if (styles.listHoverForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused) { color: \" + styles.listHoverForeground + \"; }\");\r\n        }\r\n        if (styles.listDropBackground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-wrapper.drop-target,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.drop-target { background-color: \" + styles.listDropBackground + \" !important; color: inherit !important; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listFocusOutline) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree-drag-image\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{ border: 1px solid \" + styles.listFocusOutline + \"; background: #000; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{ border: 1px solid transparent; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) \\t\\t\\t\\t\\t\\t{ border: 1px dotted \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) \\t\\t\\t\\t\\t\\t{ border: 1px solid \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted)  \\t\\t\\t\\t\\t\\t\\t{ border: 1px solid \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused)  \\t{ border: 1px dashed \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-wrapper.drop-target,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.drop-target\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{ border: 1px dashed \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        var newStyles = content.join('\\n');\r\n        if (newStyles !== this.styleElement.innerHTML) {\r\n            this.styleElement.innerHTML = newStyles;\r\n        }\r\n    };\r\n    return DefaultTreestyler;\r\n}());\r\nexport { DefaultTreestyler };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as Assert from '../../../common/assert.js';\r\nimport { onUnexpectedError } from '../../../common/errors.js';\r\nimport { combinedDisposable, Disposable } from '../../../common/lifecycle.js';\r\nimport { Event, Emitter, EventMultiplexer, Relay } from '../../../common/event.js';\r\nvar LockData = /** @class */ (function () {\r\n    function LockData(item) {\r\n        this._onDispose = new Emitter();\r\n        this.onDispose = this._onDispose.event;\r\n        this._item = item;\r\n    }\r\n    Object.defineProperty(LockData.prototype, \"item\", {\r\n        get: function () {\r\n            return this._item;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LockData.prototype.dispose = function () {\r\n        if (this._onDispose) {\r\n            this._onDispose.fire();\r\n            this._onDispose.dispose();\r\n            this._onDispose = undefined;\r\n        }\r\n    };\r\n    return LockData;\r\n}());\r\nexport { LockData };\r\nvar Lock = /** @class */ (function () {\r\n    function Lock() {\r\n        this.locks = Object.create({});\r\n    }\r\n    Lock.prototype.isLocked = function (item) {\r\n        return !!this.locks[item.id];\r\n    };\r\n    Lock.prototype.run = function (item, fn) {\r\n        var _this = this;\r\n        var lock = this.getLock(item);\r\n        if (lock) {\r\n            return new Promise(function (c, e) {\r\n                Event.once(lock.onDispose)(function () {\r\n                    return _this.run(item, fn).then(c, e);\r\n                });\r\n            });\r\n        }\r\n        var result;\r\n        return new Promise(function (c, e) {\r\n            if (item.isDisposed()) {\r\n                return e(new Error('Item is disposed.'));\r\n            }\r\n            var lock = _this.locks[item.id] = new LockData(item);\r\n            result = fn().then(function (r) {\r\n                delete _this.locks[item.id];\r\n                lock.dispose();\r\n                return r;\r\n            }).then(c, e);\r\n            return result;\r\n        });\r\n    };\r\n    Lock.prototype.getLock = function (item) {\r\n        var key;\r\n        for (key in this.locks) {\r\n            var lock = this.locks[key];\r\n            if (item.intersects(lock.item)) {\r\n                return lock;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return Lock;\r\n}());\r\nexport { Lock };\r\nvar ItemRegistry = /** @class */ (function () {\r\n    function ItemRegistry() {\r\n        this._isDisposed = false;\r\n        this._onDidRevealItem = new EventMultiplexer();\r\n        this.onDidRevealItem = this._onDidRevealItem.event;\r\n        this._onExpandItem = new EventMultiplexer();\r\n        this.onExpandItem = this._onExpandItem.event;\r\n        this._onDidExpandItem = new EventMultiplexer();\r\n        this.onDidExpandItem = this._onDidExpandItem.event;\r\n        this._onCollapseItem = new EventMultiplexer();\r\n        this.onCollapseItem = this._onCollapseItem.event;\r\n        this._onDidCollapseItem = new EventMultiplexer();\r\n        this.onDidCollapseItem = this._onDidCollapseItem.event;\r\n        this._onDidAddTraitItem = new EventMultiplexer();\r\n        this.onDidAddTraitItem = this._onDidAddTraitItem.event;\r\n        this._onDidRemoveTraitItem = new EventMultiplexer();\r\n        this.onDidRemoveTraitItem = this._onDidRemoveTraitItem.event;\r\n        this._onDidRefreshItem = new EventMultiplexer();\r\n        this.onDidRefreshItem = this._onDidRefreshItem.event;\r\n        this._onRefreshItemChildren = new EventMultiplexer();\r\n        this.onRefreshItemChildren = this._onRefreshItemChildren.event;\r\n        this._onDidRefreshItemChildren = new EventMultiplexer();\r\n        this.onDidRefreshItemChildren = this._onDidRefreshItemChildren.event;\r\n        this._onDidDisposeItem = new EventMultiplexer();\r\n        this.onDidDisposeItem = this._onDidDisposeItem.event;\r\n        this.items = {};\r\n    }\r\n    ItemRegistry.prototype.register = function (item) {\r\n        Assert.ok(!this.isRegistered(item.id), 'item already registered: ' + item.id);\r\n        var disposable = combinedDisposable(this._onDidRevealItem.add(item.onDidReveal), this._onExpandItem.add(item.onExpand), this._onDidExpandItem.add(item.onDidExpand), this._onCollapseItem.add(item.onCollapse), this._onDidCollapseItem.add(item.onDidCollapse), this._onDidAddTraitItem.add(item.onDidAddTrait), this._onDidRemoveTraitItem.add(item.onDidRemoveTrait), this._onDidRefreshItem.add(item.onDidRefresh), this._onRefreshItemChildren.add(item.onRefreshChildren), this._onDidRefreshItemChildren.add(item.onDidRefreshChildren), this._onDidDisposeItem.add(item.onDidDispose));\r\n        this.items[item.id] = { item: item, disposable: disposable };\r\n    };\r\n    ItemRegistry.prototype.deregister = function (item) {\r\n        Assert.ok(this.isRegistered(item.id), 'item not registered: ' + item.id);\r\n        this.items[item.id].disposable.dispose();\r\n        delete this.items[item.id];\r\n    };\r\n    ItemRegistry.prototype.isRegistered = function (id) {\r\n        return this.items.hasOwnProperty(id);\r\n    };\r\n    ItemRegistry.prototype.getItem = function (id) {\r\n        var result = this.items[id];\r\n        return result ? result.item : null;\r\n    };\r\n    ItemRegistry.prototype.dispose = function () {\r\n        this.items = {};\r\n        this._onDidRevealItem.dispose();\r\n        this._onExpandItem.dispose();\r\n        this._onDidExpandItem.dispose();\r\n        this._onCollapseItem.dispose();\r\n        this._onDidCollapseItem.dispose();\r\n        this._onDidAddTraitItem.dispose();\r\n        this._onDidRemoveTraitItem.dispose();\r\n        this._onDidRefreshItem.dispose();\r\n        this._onRefreshItemChildren.dispose();\r\n        this._onDidRefreshItemChildren.dispose();\r\n        this._isDisposed = true;\r\n    };\r\n    ItemRegistry.prototype.isDisposed = function () {\r\n        return this._isDisposed;\r\n    };\r\n    return ItemRegistry;\r\n}());\r\nexport { ItemRegistry };\r\nvar Item = /** @class */ (function () {\r\n    function Item(id, registry, context, lock, element) {\r\n        this._onDidCreate = new Emitter();\r\n        this._onDidReveal = new Emitter();\r\n        this.onDidReveal = this._onDidReveal.event;\r\n        this._onExpand = new Emitter();\r\n        this.onExpand = this._onExpand.event;\r\n        this._onDidExpand = new Emitter();\r\n        this.onDidExpand = this._onDidExpand.event;\r\n        this._onCollapse = new Emitter();\r\n        this.onCollapse = this._onCollapse.event;\r\n        this._onDidCollapse = new Emitter();\r\n        this.onDidCollapse = this._onDidCollapse.event;\r\n        this._onDidAddTrait = new Emitter();\r\n        this.onDidAddTrait = this._onDidAddTrait.event;\r\n        this._onDidRemoveTrait = new Emitter();\r\n        this.onDidRemoveTrait = this._onDidRemoveTrait.event;\r\n        this._onDidRefresh = new Emitter();\r\n        this.onDidRefresh = this._onDidRefresh.event;\r\n        this._onRefreshChildren = new Emitter();\r\n        this.onRefreshChildren = this._onRefreshChildren.event;\r\n        this._onDidRefreshChildren = new Emitter();\r\n        this.onDidRefreshChildren = this._onDidRefreshChildren.event;\r\n        this._onDidDispose = new Emitter();\r\n        this.onDidDispose = this._onDidDispose.event;\r\n        this.registry = registry;\r\n        this.context = context;\r\n        this.lock = lock;\r\n        this.element = element;\r\n        this.id = id;\r\n        this.registry.register(this);\r\n        this.doesHaveChildren = this.context.dataSource.hasChildren(this.context.tree, this.element);\r\n        this.needsChildrenRefresh = true;\r\n        this.parent = null;\r\n        this.previous = null;\r\n        this.next = null;\r\n        this.firstChild = null;\r\n        this.lastChild = null;\r\n        this.traits = {};\r\n        this.depth = 0;\r\n        this.expanded = !!(this.context.dataSource.shouldAutoexpand && this.context.dataSource.shouldAutoexpand(this.context.tree, element));\r\n        this._onDidCreate.fire(this);\r\n        this.visible = this._isVisible();\r\n        this.height = this._getHeight();\r\n        this._isDisposed = false;\r\n    }\r\n    Item.prototype.getElement = function () {\r\n        return this.element;\r\n    };\r\n    Item.prototype.hasChildren = function () {\r\n        return this.doesHaveChildren;\r\n    };\r\n    Item.prototype.getDepth = function () {\r\n        return this.depth;\r\n    };\r\n    Item.prototype.isVisible = function () {\r\n        return this.visible;\r\n    };\r\n    Item.prototype.setVisible = function (value) {\r\n        this.visible = value;\r\n    };\r\n    Item.prototype.isExpanded = function () {\r\n        return this.expanded;\r\n    };\r\n    /* protected */ Item.prototype._setExpanded = function (value) {\r\n        this.expanded = value;\r\n    };\r\n    Item.prototype.reveal = function (relativeTop) {\r\n        if (relativeTop === void 0) { relativeTop = null; }\r\n        var eventData = { item: this, relativeTop: relativeTop };\r\n        this._onDidReveal.fire(eventData);\r\n    };\r\n    Item.prototype.expand = function () {\r\n        var _this = this;\r\n        if (this.isExpanded() || !this.doesHaveChildren || this.lock.isLocked(this)) {\r\n            return Promise.resolve(false);\r\n        }\r\n        var result = this.lock.run(this, function () {\r\n            if (_this.isExpanded() || !_this.doesHaveChildren) {\r\n                return Promise.resolve(false);\r\n            }\r\n            var eventData = { item: _this };\r\n            var result;\r\n            _this._onExpand.fire(eventData);\r\n            if (_this.needsChildrenRefresh) {\r\n                result = _this.refreshChildren(false, true, true);\r\n            }\r\n            else {\r\n                result = Promise.resolve(null);\r\n            }\r\n            return result.then(function () {\r\n                _this._setExpanded(true);\r\n                _this._onDidExpand.fire(eventData);\r\n                return true;\r\n            });\r\n        });\r\n        return result.then(function (r) {\r\n            if (_this.isDisposed()) {\r\n                return false;\r\n            }\r\n            // Auto expand single child folders\r\n            if (_this.context.options.autoExpandSingleChildren && r && _this.firstChild !== null && _this.firstChild === _this.lastChild && _this.firstChild.isVisible()) {\r\n                return _this.firstChild.expand().then(function () { return true; });\r\n            }\r\n            return r;\r\n        });\r\n    };\r\n    Item.prototype.collapse = function (recursive) {\r\n        var _this = this;\r\n        if (recursive === void 0) { recursive = false; }\r\n        if (recursive) {\r\n            var collapseChildrenPromise_1 = Promise.resolve(null);\r\n            this.forEachChild(function (child) {\r\n                collapseChildrenPromise_1 = collapseChildrenPromise_1.then(function () { return child.collapse(true); });\r\n            });\r\n            return collapseChildrenPromise_1.then(function () {\r\n                return _this.collapse(false);\r\n            });\r\n        }\r\n        else {\r\n            if (!this.isExpanded() || this.lock.isLocked(this)) {\r\n                return Promise.resolve(false);\r\n            }\r\n            return this.lock.run(this, function () {\r\n                var eventData = { item: _this };\r\n                _this._onCollapse.fire(eventData);\r\n                _this._setExpanded(false);\r\n                _this._onDidCollapse.fire(eventData);\r\n                return Promise.resolve(true);\r\n            });\r\n        }\r\n    };\r\n    Item.prototype.addTrait = function (trait) {\r\n        var eventData = { item: this, trait: trait };\r\n        this.traits[trait] = true;\r\n        this._onDidAddTrait.fire(eventData);\r\n    };\r\n    Item.prototype.removeTrait = function (trait) {\r\n        var eventData = { item: this, trait: trait };\r\n        delete this.traits[trait];\r\n        this._onDidRemoveTrait.fire(eventData);\r\n    };\r\n    Item.prototype.hasTrait = function (trait) {\r\n        return this.traits[trait] || false;\r\n    };\r\n    Item.prototype.getAllTraits = function () {\r\n        var result = [];\r\n        var trait;\r\n        for (trait in this.traits) {\r\n            if (this.traits.hasOwnProperty(trait) && this.traits[trait]) {\r\n                result.push(trait);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    Item.prototype.getHeight = function () {\r\n        return this.height;\r\n    };\r\n    Item.prototype.refreshChildren = function (recursive, safe, force) {\r\n        var _this = this;\r\n        if (safe === void 0) { safe = false; }\r\n        if (force === void 0) { force = false; }\r\n        if (!force && !this.isExpanded()) {\r\n            var setNeedsChildrenRefresh_1 = function (item) {\r\n                item.needsChildrenRefresh = true;\r\n                item.forEachChild(setNeedsChildrenRefresh_1);\r\n            };\r\n            setNeedsChildrenRefresh_1(this);\r\n            return Promise.resolve(this);\r\n        }\r\n        this.needsChildrenRefresh = false;\r\n        var doRefresh = function () {\r\n            var eventData = { item: _this, isNested: safe };\r\n            _this._onRefreshChildren.fire(eventData);\r\n            var childrenPromise;\r\n            if (_this.doesHaveChildren) {\r\n                childrenPromise = _this.context.dataSource.getChildren(_this.context.tree, _this.element);\r\n            }\r\n            else {\r\n                childrenPromise = Promise.resolve([]);\r\n            }\r\n            var result = childrenPromise.then(function (elements) {\r\n                if (_this.isDisposed() || _this.registry.isDisposed()) {\r\n                    return Promise.resolve(null);\r\n                }\r\n                if (!Array.isArray(elements)) {\r\n                    return Promise.reject(new Error('Please return an array of children.'));\r\n                }\r\n                elements = !elements ? [] : elements.slice(0);\r\n                elements = _this.sort(elements);\r\n                var staleItems = {};\r\n                while (_this.firstChild !== null) {\r\n                    staleItems[_this.firstChild.id] = _this.firstChild;\r\n                    _this.removeChild(_this.firstChild);\r\n                }\r\n                for (var i = 0, len = elements.length; i < len; i++) {\r\n                    var element = elements[i];\r\n                    var id = _this.context.dataSource.getId(_this.context.tree, element);\r\n                    var item = staleItems[id] || new Item(id, _this.registry, _this.context, _this.lock, element);\r\n                    item.element = element;\r\n                    if (recursive) {\r\n                        item.needsChildrenRefresh = recursive;\r\n                    }\r\n                    delete staleItems[id];\r\n                    _this.addChild(item);\r\n                }\r\n                for (var staleItemId in staleItems) {\r\n                    if (staleItems.hasOwnProperty(staleItemId)) {\r\n                        staleItems[staleItemId].dispose();\r\n                    }\r\n                }\r\n                if (recursive) {\r\n                    return Promise.all(_this.mapEachChild(function (child) {\r\n                        return child.doRefresh(recursive, true);\r\n                    }));\r\n                }\r\n                else {\r\n                    return Promise.all(_this.mapEachChild(function (child) {\r\n                        if (child.isExpanded() && child.needsChildrenRefresh) {\r\n                            return child.doRefresh(recursive, true);\r\n                        }\r\n                        else {\r\n                            child.updateVisibility();\r\n                            return Promise.resolve(null);\r\n                        }\r\n                    }));\r\n                }\r\n            });\r\n            return result\r\n                .then(undefined, onUnexpectedError)\r\n                .then(function () { return _this._onDidRefreshChildren.fire(eventData); });\r\n        };\r\n        return safe ? doRefresh() : this.lock.run(this, doRefresh);\r\n    };\r\n    Item.prototype.doRefresh = function (recursive, safe) {\r\n        if (safe === void 0) { safe = false; }\r\n        this.doesHaveChildren = this.context.dataSource.hasChildren(this.context.tree, this.element);\r\n        this.height = this._getHeight();\r\n        this.updateVisibility();\r\n        this._onDidRefresh.fire(this);\r\n        return this.refreshChildren(recursive, safe);\r\n    };\r\n    Item.prototype.updateVisibility = function () {\r\n        this.setVisible(this._isVisible());\r\n    };\r\n    Item.prototype.refresh = function (recursive) {\r\n        return this.doRefresh(recursive);\r\n    };\r\n    Item.prototype.getNavigator = function () {\r\n        return new TreeNavigator(this);\r\n    };\r\n    Item.prototype.intersects = function (other) {\r\n        return this.isAncestorOf(other) || other.isAncestorOf(this);\r\n    };\r\n    Item.prototype.isAncestorOf = function (startItem) {\r\n        var item = startItem;\r\n        while (item) {\r\n            if (item.id === this.id) {\r\n                return true;\r\n            }\r\n            item = item.parent;\r\n        }\r\n        return false;\r\n    };\r\n    Item.prototype.addChild = function (item, afterItem) {\r\n        if (afterItem === void 0) { afterItem = this.lastChild; }\r\n        var isEmpty = this.firstChild === null;\r\n        var atHead = afterItem === null;\r\n        var atTail = afterItem === this.lastChild;\r\n        if (isEmpty) {\r\n            this.firstChild = this.lastChild = item;\r\n            item.next = item.previous = null;\r\n        }\r\n        else if (atHead) {\r\n            if (!this.firstChild) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            this.firstChild.previous = item;\r\n            item.next = this.firstChild;\r\n            item.previous = null;\r\n            this.firstChild = item;\r\n        }\r\n        else if (atTail) {\r\n            if (!this.lastChild) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            this.lastChild.next = item;\r\n            item.next = null;\r\n            item.previous = this.lastChild;\r\n            this.lastChild = item;\r\n        }\r\n        else {\r\n            item.previous = afterItem;\r\n            if (!afterItem) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            item.next = afterItem.next;\r\n            if (!afterItem.next) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            afterItem.next.previous = item;\r\n            afterItem.next = item;\r\n        }\r\n        item.parent = this;\r\n        item.depth = this.depth + 1;\r\n    };\r\n    Item.prototype.removeChild = function (item) {\r\n        var isFirstChild = this.firstChild === item;\r\n        var isLastChild = this.lastChild === item;\r\n        if (isFirstChild && isLastChild) {\r\n            this.firstChild = this.lastChild = null;\r\n        }\r\n        else if (isFirstChild) {\r\n            if (!item.next) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            item.next.previous = null;\r\n            this.firstChild = item.next;\r\n        }\r\n        else if (isLastChild) {\r\n            if (!item.previous) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            item.previous.next = null;\r\n            this.lastChild = item.previous;\r\n        }\r\n        else {\r\n            if (!item.next) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            item.next.previous = item.previous;\r\n            if (!item.previous) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            item.previous.next = item.next;\r\n        }\r\n        item.parent = null;\r\n        item.depth = NaN;\r\n    };\r\n    Item.prototype.forEachChild = function (fn) {\r\n        var child = this.firstChild;\r\n        var next;\r\n        while (child) {\r\n            next = child.next;\r\n            fn(child);\r\n            child = next;\r\n        }\r\n    };\r\n    Item.prototype.mapEachChild = function (fn) {\r\n        var result = [];\r\n        this.forEachChild(function (child) {\r\n            result.push(fn(child));\r\n        });\r\n        return result;\r\n    };\r\n    Item.prototype.sort = function (elements) {\r\n        var _this = this;\r\n        var sorter = this.context.sorter;\r\n        if (sorter) {\r\n            return elements.sort(function (element, otherElement) {\r\n                return sorter.compare(_this.context.tree, element, otherElement);\r\n            });\r\n        }\r\n        return elements;\r\n    };\r\n    /* protected */ Item.prototype._getHeight = function () {\r\n        if (!this.context.renderer) {\r\n            return 0;\r\n        }\r\n        return this.context.renderer.getHeight(this.context.tree, this.element);\r\n    };\r\n    /* protected */ Item.prototype._isVisible = function () {\r\n        if (!this.context.filter) {\r\n            return false;\r\n        }\r\n        return this.context.filter.isVisible(this.context.tree, this.element);\r\n    };\r\n    Item.prototype.isDisposed = function () {\r\n        return this._isDisposed;\r\n    };\r\n    Item.prototype.dispose = function () {\r\n        this.forEachChild(function (child) { return child.dispose(); });\r\n        this.parent = null;\r\n        this.previous = null;\r\n        this.next = null;\r\n        this.firstChild = null;\r\n        this.lastChild = null;\r\n        this._onDidDispose.fire(this);\r\n        this.registry.deregister(this);\r\n        this._onDidCreate.dispose();\r\n        this._onDidReveal.dispose();\r\n        this._onExpand.dispose();\r\n        this._onDidExpand.dispose();\r\n        this._onCollapse.dispose();\r\n        this._onDidCollapse.dispose();\r\n        this._onDidAddTrait.dispose();\r\n        this._onDidRemoveTrait.dispose();\r\n        this._onDidRefresh.dispose();\r\n        this._onRefreshChildren.dispose();\r\n        this._onDidRefreshChildren.dispose();\r\n        this._onDidDispose.dispose();\r\n        this._isDisposed = true;\r\n    };\r\n    return Item;\r\n}());\r\nexport { Item };\r\nvar RootItem = /** @class */ (function (_super) {\r\n    __extends(RootItem, _super);\r\n    function RootItem(id, registry, context, lock, element) {\r\n        return _super.call(this, id, registry, context, lock, element) || this;\r\n    }\r\n    RootItem.prototype.isVisible = function () {\r\n        return false;\r\n    };\r\n    RootItem.prototype.setVisible = function (value) {\r\n        // no-op\r\n    };\r\n    RootItem.prototype.isExpanded = function () {\r\n        return true;\r\n    };\r\n    /* protected */ RootItem.prototype._setExpanded = function (value) {\r\n        // no-op\r\n    };\r\n    /* protected */ RootItem.prototype._getHeight = function () {\r\n        return 0;\r\n    };\r\n    /* protected */ RootItem.prototype._isVisible = function () {\r\n        return false;\r\n    };\r\n    return RootItem;\r\n}(Item));\r\nvar TreeNavigator = /** @class */ (function () {\r\n    function TreeNavigator(item, subTreeOnly) {\r\n        if (subTreeOnly === void 0) { subTreeOnly = true; }\r\n        this.item = item;\r\n        this.start = subTreeOnly ? item : null;\r\n    }\r\n    TreeNavigator.lastDescendantOf = function (item) {\r\n        if (!item) {\r\n            return null;\r\n        }\r\n        if (item instanceof RootItem) {\r\n            return TreeNavigator.lastDescendantOf(item.lastChild);\r\n        }\r\n        if (!item.isVisible()) {\r\n            return TreeNavigator.lastDescendantOf(item.previous);\r\n        }\r\n        if (!item.isExpanded() || item.lastChild === null) {\r\n            return item;\r\n        }\r\n        return TreeNavigator.lastDescendantOf(item.lastChild);\r\n    };\r\n    TreeNavigator.prototype.current = function () {\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.next = function () {\r\n        if (this.item) {\r\n            do {\r\n                if ((this.item instanceof RootItem || (this.item.isVisible() && this.item.isExpanded())) && this.item.firstChild) {\r\n                    this.item = this.item.firstChild;\r\n                }\r\n                else if (this.item === this.start) {\r\n                    this.item = null;\r\n                }\r\n                else {\r\n                    // select next brother, next uncle, next great-uncle, etc...\r\n                    while (this.item && this.item !== this.start && !this.item.next) {\r\n                        this.item = this.item.parent;\r\n                    }\r\n                    if (this.item === this.start) {\r\n                        this.item = null;\r\n                    }\r\n                    this.item = !this.item ? null : this.item.next;\r\n                }\r\n            } while (this.item && !this.item.isVisible());\r\n        }\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.previous = function () {\r\n        if (this.item) {\r\n            do {\r\n                var previous = TreeNavigator.lastDescendantOf(this.item.previous);\r\n                if (previous) {\r\n                    this.item = previous;\r\n                }\r\n                else if (this.item.parent && this.item.parent !== this.start && this.item.parent.isVisible()) {\r\n                    this.item = this.item.parent;\r\n                }\r\n                else {\r\n                    this.item = null;\r\n                }\r\n            } while (this.item && !this.item.isVisible());\r\n        }\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.parent = function () {\r\n        if (this.item) {\r\n            var parent_1 = this.item.parent;\r\n            if (parent_1 && parent_1 !== this.start && parent_1.isVisible()) {\r\n                this.item = parent_1;\r\n            }\r\n            else {\r\n                this.item = null;\r\n            }\r\n        }\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.first = function () {\r\n        this.item = this.start;\r\n        this.next();\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.last = function () {\r\n        return TreeNavigator.lastDescendantOf(this.start);\r\n    };\r\n    return TreeNavigator;\r\n}());\r\nexport { TreeNavigator };\r\nvar TreeModel = /** @class */ (function () {\r\n    function TreeModel(context) {\r\n        this.registry = new ItemRegistry();\r\n        this.registryDisposable = Disposable.None;\r\n        this._onSetInput = new Emitter();\r\n        this.onSetInput = this._onSetInput.event;\r\n        this._onDidSetInput = new Emitter();\r\n        this.onDidSetInput = this._onDidSetInput.event;\r\n        this._onRefresh = new Emitter();\r\n        this.onRefresh = this._onRefresh.event;\r\n        this._onDidRefresh = new Emitter();\r\n        this.onDidRefresh = this._onDidRefresh.event;\r\n        this._onDidHighlight = new Emitter();\r\n        this.onDidHighlight = this._onDidHighlight.event;\r\n        this._onDidSelect = new Emitter();\r\n        this.onDidSelect = this._onDidSelect.event;\r\n        this._onDidFocus = new Emitter();\r\n        this.onDidFocus = this._onDidFocus.event;\r\n        this._onDidRevealItem = new Relay();\r\n        this.onDidRevealItem = this._onDidRevealItem.event;\r\n        this._onExpandItem = new Relay();\r\n        this.onExpandItem = this._onExpandItem.event;\r\n        this._onDidExpandItem = new Relay();\r\n        this.onDidExpandItem = this._onDidExpandItem.event;\r\n        this._onCollapseItem = new Relay();\r\n        this.onCollapseItem = this._onCollapseItem.event;\r\n        this._onDidCollapseItem = new Relay();\r\n        this.onDidCollapseItem = this._onDidCollapseItem.event;\r\n        this._onDidAddTraitItem = new Relay();\r\n        this.onDidAddTraitItem = this._onDidAddTraitItem.event;\r\n        this._onDidRemoveTraitItem = new Relay();\r\n        this.onDidRemoveTraitItem = this._onDidRemoveTraitItem.event;\r\n        this._onDidRefreshItem = new Relay();\r\n        this.onDidRefreshItem = this._onDidRefreshItem.event;\r\n        this._onRefreshItemChildren = new Relay();\r\n        this.onRefreshItemChildren = this._onRefreshItemChildren.event;\r\n        this._onDidRefreshItemChildren = new Relay();\r\n        this.onDidRefreshItemChildren = this._onDidRefreshItemChildren.event;\r\n        this._onDidDisposeItem = new Relay();\r\n        this.context = context;\r\n        this.input = null;\r\n        this.traitsToItems = {};\r\n    }\r\n    TreeModel.prototype.setInput = function (element) {\r\n        var _this = this;\r\n        var eventData = { item: this.input };\r\n        this._onSetInput.fire(eventData);\r\n        this.setSelection([]);\r\n        this.setFocus();\r\n        this.setHighlight();\r\n        this.lock = new Lock();\r\n        if (this.input) {\r\n            this.input.dispose();\r\n        }\r\n        if (this.registry) {\r\n            this.registry.dispose();\r\n            this.registryDisposable.dispose();\r\n        }\r\n        this.registry = new ItemRegistry();\r\n        this._onDidRevealItem.input = this.registry.onDidRevealItem;\r\n        this._onExpandItem.input = this.registry.onExpandItem;\r\n        this._onDidExpandItem.input = this.registry.onDidExpandItem;\r\n        this._onCollapseItem.input = this.registry.onCollapseItem;\r\n        this._onDidCollapseItem.input = this.registry.onDidCollapseItem;\r\n        this._onDidAddTraitItem.input = this.registry.onDidAddTraitItem;\r\n        this._onDidRemoveTraitItem.input = this.registry.onDidRemoveTraitItem;\r\n        this._onDidRefreshItem.input = this.registry.onDidRefreshItem;\r\n        this._onRefreshItemChildren.input = this.registry.onRefreshItemChildren;\r\n        this._onDidRefreshItemChildren.input = this.registry.onDidRefreshItemChildren;\r\n        this._onDidDisposeItem.input = this.registry.onDidDisposeItem;\r\n        this.registryDisposable = this.registry\r\n            .onDidDisposeItem(function (item) { return item.getAllTraits().forEach(function (trait) { return delete _this.traitsToItems[trait][item.id]; }); });\r\n        var id = this.context.dataSource.getId(this.context.tree, element);\r\n        this.input = new RootItem(id, this.registry, this.context, this.lock, element);\r\n        eventData = { item: this.input };\r\n        this._onDidSetInput.fire(eventData);\r\n        return this.refresh(this.input);\r\n    };\r\n    TreeModel.prototype.getInput = function () {\r\n        return this.input ? this.input.getElement() : null;\r\n    };\r\n    TreeModel.prototype.refresh = function (element, recursive) {\r\n        var _this = this;\r\n        if (element === void 0) { element = null; }\r\n        if (recursive === void 0) { recursive = true; }\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return Promise.resolve(null);\r\n        }\r\n        var eventData = { item: item, recursive: recursive };\r\n        this._onRefresh.fire(eventData);\r\n        return item.refresh(recursive).then(function () {\r\n            _this._onDidRefresh.fire(eventData);\r\n        });\r\n    };\r\n    TreeModel.prototype.expand = function (element) {\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return Promise.resolve(false);\r\n        }\r\n        return item.expand();\r\n    };\r\n    TreeModel.prototype.collapse = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return Promise.resolve(false);\r\n        }\r\n        return item.collapse(recursive);\r\n    };\r\n    TreeModel.prototype.toggleExpansion = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        return this.isExpanded(element) ? this.collapse(element, recursive) : this.expand(element);\r\n    };\r\n    TreeModel.prototype.isExpanded = function (element) {\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return false;\r\n        }\r\n        return item.isExpanded();\r\n    };\r\n    TreeModel.prototype.reveal = function (element, relativeTop) {\r\n        var _this = this;\r\n        if (relativeTop === void 0) { relativeTop = null; }\r\n        return this.resolveUnknownParentChain(element).then(function (chain) {\r\n            var result = Promise.resolve(null);\r\n            chain.forEach(function (e) {\r\n                result = result.then(function () { return _this.expand(e); });\r\n            });\r\n            return result;\r\n        }).then(function () {\r\n            var item = _this.getItem(element);\r\n            if (item) {\r\n                return item.reveal(relativeTop);\r\n            }\r\n        });\r\n    };\r\n    TreeModel.prototype.resolveUnknownParentChain = function (element) {\r\n        var _this = this;\r\n        return this.context.dataSource.getParent(this.context.tree, element).then(function (parent) {\r\n            if (!parent) {\r\n                return Promise.resolve([]);\r\n            }\r\n            return _this.resolveUnknownParentChain(parent).then(function (result) {\r\n                result.push(parent);\r\n                return result;\r\n            });\r\n        });\r\n    };\r\n    TreeModel.prototype.setHighlight = function (element, eventPayload) {\r\n        this.setTraits('highlighted', element ? [element] : []);\r\n        var eventData = { highlight: this.getHighlight(), payload: eventPayload };\r\n        this._onDidHighlight.fire(eventData);\r\n    };\r\n    TreeModel.prototype.getHighlight = function (includeHidden) {\r\n        if (includeHidden === void 0) { includeHidden = false; }\r\n        var result = this.getElementsWithTrait('highlighted', includeHidden);\r\n        return result.length === 0 ? null : result[0];\r\n    };\r\n    TreeModel.prototype.setSelection = function (elements, eventPayload) {\r\n        this.setTraits('selected', elements);\r\n        var eventData = { selection: this.getSelection(), payload: eventPayload };\r\n        this._onDidSelect.fire(eventData);\r\n    };\r\n    TreeModel.prototype.getSelection = function (includeHidden) {\r\n        if (includeHidden === void 0) { includeHidden = false; }\r\n        return this.getElementsWithTrait('selected', includeHidden);\r\n    };\r\n    TreeModel.prototype.setFocus = function (element, eventPayload) {\r\n        this.setTraits('focused', element ? [element] : []);\r\n        var eventData = { focus: this.getFocus(), payload: eventPayload };\r\n        this._onDidFocus.fire(eventData);\r\n    };\r\n    TreeModel.prototype.getFocus = function (includeHidden) {\r\n        if (includeHidden === void 0) { includeHidden = false; }\r\n        var result = this.getElementsWithTrait('focused', includeHidden);\r\n        return result.length === 0 ? null : result[0];\r\n    };\r\n    TreeModel.prototype.focusNext = function (count, eventPayload) {\r\n        if (count === void 0) { count = 1; }\r\n        var item = this.getFocus() || this.input;\r\n        var nextItem;\r\n        var nav = this.getNavigator(item, false);\r\n        for (var i = 0; i < count; i++) {\r\n            nextItem = nav.next();\r\n            if (!nextItem) {\r\n                break;\r\n            }\r\n            item = nextItem;\r\n        }\r\n        this.setFocus(item, eventPayload);\r\n    };\r\n    TreeModel.prototype.focusPrevious = function (count, eventPayload) {\r\n        if (count === void 0) { count = 1; }\r\n        var item = this.getFocus() || this.input;\r\n        var previousItem;\r\n        var nav = this.getNavigator(item, false);\r\n        for (var i = 0; i < count; i++) {\r\n            previousItem = nav.previous();\r\n            if (!previousItem) {\r\n                break;\r\n            }\r\n            item = previousItem;\r\n        }\r\n        this.setFocus(item, eventPayload);\r\n    };\r\n    TreeModel.prototype.focusParent = function (eventPayload) {\r\n        var item = this.getFocus() || this.input;\r\n        var nav = this.getNavigator(item, false);\r\n        var parent = nav.parent();\r\n        if (parent) {\r\n            this.setFocus(parent, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.focusFirstChild = function (eventPayload) {\r\n        var item = this.getItem(this.getFocus() || this.input);\r\n        var nav = this.getNavigator(item, false);\r\n        var next = nav.next();\r\n        var parent = nav.parent();\r\n        if (parent === item) {\r\n            this.setFocus(next, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.focusFirst = function (eventPayload, from) {\r\n        this.focusNth(0, eventPayload, from);\r\n    };\r\n    TreeModel.prototype.focusNth = function (index, eventPayload, from) {\r\n        var navItem = this.getParent(from);\r\n        var nav = this.getNavigator(navItem);\r\n        var item = nav.first();\r\n        for (var i = 0; i < index; i++) {\r\n            item = nav.next();\r\n        }\r\n        if (item) {\r\n            this.setFocus(item, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.focusLast = function (eventPayload, from) {\r\n        var navItem = this.getParent(from);\r\n        var item;\r\n        if (from && navItem) {\r\n            item = navItem.lastChild;\r\n        }\r\n        else {\r\n            var nav = this.getNavigator(navItem);\r\n            item = nav.last();\r\n        }\r\n        if (item) {\r\n            this.setFocus(item, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.getParent = function (from) {\r\n        if (from) {\r\n            var fromItem = this.getItem(from);\r\n            if (fromItem && fromItem.parent) {\r\n                return fromItem.parent;\r\n            }\r\n        }\r\n        return this.getItem(this.input);\r\n    };\r\n    TreeModel.prototype.getNavigator = function (element, subTreeOnly) {\r\n        if (element === void 0) { element = null; }\r\n        if (subTreeOnly === void 0) { subTreeOnly = true; }\r\n        return new TreeNavigator(this.getItem(element), subTreeOnly);\r\n    };\r\n    TreeModel.prototype.getItem = function (element) {\r\n        if (element === void 0) { element = null; }\r\n        if (element === null) {\r\n            return this.input;\r\n        }\r\n        else if (element instanceof Item) {\r\n            return element;\r\n        }\r\n        else if (typeof element === 'string') {\r\n            return this.registry.getItem(element);\r\n        }\r\n        else {\r\n            return this.registry.getItem(this.context.dataSource.getId(this.context.tree, element));\r\n        }\r\n    };\r\n    TreeModel.prototype.removeTraits = function (trait, elements) {\r\n        var items = this.traitsToItems[trait] || {};\r\n        var item;\r\n        var id;\r\n        if (elements.length === 0) {\r\n            for (id in items) {\r\n                if (items.hasOwnProperty(id)) {\r\n                    item = items[id];\r\n                    item.removeTrait(trait);\r\n                }\r\n            }\r\n            delete this.traitsToItems[trait];\r\n        }\r\n        else {\r\n            for (var i = 0, len = elements.length; i < len; i++) {\r\n                item = this.getItem(elements[i]);\r\n                if (item) {\r\n                    item.removeTrait(trait);\r\n                    delete items[item.id];\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TreeModel.prototype.setTraits = function (trait, elements) {\r\n        if (elements.length === 0) {\r\n            this.removeTraits(trait, elements);\r\n        }\r\n        else {\r\n            var items = {};\r\n            var item = void 0;\r\n            for (var i = 0, len = elements.length; i < len; i++) {\r\n                item = this.getItem(elements[i]);\r\n                if (item) {\r\n                    items[item.id] = item;\r\n                }\r\n            }\r\n            var traitItems = this.traitsToItems[trait] || {};\r\n            var itemsToRemoveTrait = [];\r\n            var id = void 0;\r\n            for (id in traitItems) {\r\n                if (traitItems.hasOwnProperty(id)) {\r\n                    if (items.hasOwnProperty(id)) {\r\n                        delete items[id];\r\n                    }\r\n                    else {\r\n                        itemsToRemoveTrait.push(traitItems[id]);\r\n                    }\r\n                }\r\n            }\r\n            for (var i = 0, len = itemsToRemoveTrait.length; i < len; i++) {\r\n                item = itemsToRemoveTrait[i];\r\n                item.removeTrait(trait);\r\n                delete traitItems[item.id];\r\n            }\r\n            for (id in items) {\r\n                if (items.hasOwnProperty(id)) {\r\n                    item = items[id];\r\n                    item.addTrait(trait);\r\n                    traitItems[id] = item;\r\n                }\r\n            }\r\n            this.traitsToItems[trait] = traitItems;\r\n        }\r\n    };\r\n    TreeModel.prototype.getElementsWithTrait = function (trait, includeHidden) {\r\n        var elements = [];\r\n        var items = this.traitsToItems[trait] || {};\r\n        var id;\r\n        for (id in items) {\r\n            if (items.hasOwnProperty(id) && (items[id].isVisible() || includeHidden)) {\r\n                elements.push(items[id].getElement());\r\n            }\r\n        }\r\n        return elements;\r\n    };\r\n    TreeModel.prototype.dispose = function () {\r\n        this.registry.dispose();\r\n        this._onSetInput.dispose();\r\n        this._onDidSetInput.dispose();\r\n        this._onRefresh.dispose();\r\n        this._onDidRefresh.dispose();\r\n        this._onDidHighlight.dispose();\r\n        this._onDidSelect.dispose();\r\n        this._onDidFocus.dispose();\r\n        this._onDidRevealItem.dispose();\r\n        this._onExpandItem.dispose();\r\n        this._onDidExpandItem.dispose();\r\n        this._onCollapseItem.dispose();\r\n        this._onDidCollapseItem.dispose();\r\n        this._onDidAddTraitItem.dispose();\r\n        this._onDidRemoveTraitItem.dispose();\r\n        this._onDidRefreshItem.dispose();\r\n        this._onRefreshItemChildren.dispose();\r\n        this._onDidRefreshItemChildren.dispose();\r\n        this._onDidDisposeItem.dispose();\r\n    };\r\n    return TreeModel;\r\n}());\r\nexport { TreeModel };\r\n","var ElementsDragAndDropData = /** @class */ (function () {\r\n    function ElementsDragAndDropData(elements) {\r\n        this.elements = elements;\r\n    }\r\n    ElementsDragAndDropData.prototype.update = function (dataTransfer) {\r\n        // no-op\r\n    };\r\n    ElementsDragAndDropData.prototype.getData = function () {\r\n        return this.elements;\r\n    };\r\n    return ElementsDragAndDropData;\r\n}());\r\nexport { ElementsDragAndDropData };\r\nvar ExternalElementsDragAndDropData = /** @class */ (function () {\r\n    function ExternalElementsDragAndDropData(elements) {\r\n        this.elements = elements;\r\n    }\r\n    ExternalElementsDragAndDropData.prototype.update = function (dataTransfer) {\r\n        // no-op\r\n    };\r\n    ExternalElementsDragAndDropData.prototype.getData = function () {\r\n        return this.elements;\r\n    };\r\n    return ExternalElementsDragAndDropData;\r\n}());\r\nexport { ExternalElementsDragAndDropData };\r\nvar DesktopDragAndDropData = /** @class */ (function () {\r\n    function DesktopDragAndDropData() {\r\n        this.types = [];\r\n        this.files = [];\r\n    }\r\n    DesktopDragAndDropData.prototype.update = function (dataTransfer) {\r\n        if (dataTransfer.types) {\r\n            this.types = [];\r\n            Array.prototype.push.apply(this.types, dataTransfer.types);\r\n        }\r\n        if (dataTransfer.files) {\r\n            this.files = [];\r\n            Array.prototype.push.apply(this.files, dataTransfer.files);\r\n            this.files = this.files.filter(function (f) { return f.size || f.type; });\r\n        }\r\n    };\r\n    DesktopDragAndDropData.prototype.getData = function () {\r\n        return {\r\n            types: this.types,\r\n            files: this.files\r\n        };\r\n    };\r\n    return DesktopDragAndDropData;\r\n}());\r\nexport { DesktopDragAndDropData };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { ArrayIterator } from '../../../common/iterator.js';\r\nvar HeightMap = /** @class */ (function () {\r\n    function HeightMap() {\r\n        this.heightMap = [];\r\n        this.indexes = {};\r\n    }\r\n    HeightMap.prototype.getContentHeight = function () {\r\n        var last = this.heightMap[this.heightMap.length - 1];\r\n        return !last ? 0 : last.top + last.height;\r\n    };\r\n    HeightMap.prototype.onInsertItems = function (iterator, afterItemId) {\r\n        if (afterItemId === void 0) { afterItemId = null; }\r\n        var item = null;\r\n        var viewItem;\r\n        var i, j;\r\n        var totalSize;\r\n        var sizeDiff = 0;\r\n        if (afterItemId === null) {\r\n            i = 0;\r\n            totalSize = 0;\r\n        }\r\n        else {\r\n            i = this.indexes[afterItemId] + 1;\r\n            viewItem = this.heightMap[i - 1];\r\n            if (!viewItem) {\r\n                console.error('view item doesnt exist');\r\n                return undefined;\r\n            }\r\n            totalSize = viewItem.top + viewItem.height;\r\n        }\r\n        var boundSplice = this.heightMap.splice.bind(this.heightMap, i, 0);\r\n        var itemsToInsert = [];\r\n        while (item = iterator.next()) {\r\n            viewItem = this.createViewItem(item);\r\n            viewItem.top = totalSize + sizeDiff;\r\n            this.indexes[item.id] = i++;\r\n            itemsToInsert.push(viewItem);\r\n            sizeDiff += viewItem.height;\r\n        }\r\n        boundSplice.apply(this.heightMap, itemsToInsert);\r\n        for (j = i; j < this.heightMap.length; j++) {\r\n            viewItem = this.heightMap[j];\r\n            viewItem.top += sizeDiff;\r\n            this.indexes[viewItem.model.id] = j;\r\n        }\r\n        for (j = itemsToInsert.length - 1; j >= 0; j--) {\r\n            this.onInsertItem(itemsToInsert[j]);\r\n        }\r\n        for (j = this.heightMap.length - 1; j >= i; j--) {\r\n            this.onRefreshItem(this.heightMap[j]);\r\n        }\r\n        return sizeDiff;\r\n    };\r\n    HeightMap.prototype.onInsertItem = function (item) {\r\n        // noop\r\n    };\r\n    // Contiguous items\r\n    HeightMap.prototype.onRemoveItems = function (iterator) {\r\n        var itemId = null;\r\n        var viewItem;\r\n        var startIndex = null;\r\n        var i = 0;\r\n        var sizeDiff = 0;\r\n        while (itemId = iterator.next()) {\r\n            i = this.indexes[itemId];\r\n            viewItem = this.heightMap[i];\r\n            if (!viewItem) {\r\n                console.error('view item doesnt exist');\r\n                return;\r\n            }\r\n            sizeDiff -= viewItem.height;\r\n            delete this.indexes[itemId];\r\n            this.onRemoveItem(viewItem);\r\n            if (startIndex === null) {\r\n                startIndex = i;\r\n            }\r\n        }\r\n        if (sizeDiff === 0 || startIndex === null) {\r\n            return;\r\n        }\r\n        this.heightMap.splice(startIndex, i - startIndex + 1);\r\n        for (i = startIndex; i < this.heightMap.length; i++) {\r\n            viewItem = this.heightMap[i];\r\n            viewItem.top += sizeDiff;\r\n            this.indexes[viewItem.model.id] = i;\r\n            this.onRefreshItem(viewItem);\r\n        }\r\n    };\r\n    HeightMap.prototype.onRemoveItem = function (item) {\r\n        // noop\r\n    };\r\n    HeightMap.prototype.onRefreshItemSet = function (items) {\r\n        var _this = this;\r\n        var sortedItems = items.sort(function (a, b) { return _this.indexes[a.id] - _this.indexes[b.id]; });\r\n        this.onRefreshItems(new ArrayIterator(sortedItems));\r\n    };\r\n    // Ordered, but not necessarily contiguous items\r\n    HeightMap.prototype.onRefreshItems = function (iterator) {\r\n        var item = null;\r\n        var viewItem;\r\n        var newHeight;\r\n        var i, j = null;\r\n        var cummDiff = 0;\r\n        while (item = iterator.next()) {\r\n            i = this.indexes[item.id];\r\n            for (; cummDiff !== 0 && j !== null && j < i; j++) {\r\n                viewItem = this.heightMap[j];\r\n                viewItem.top += cummDiff;\r\n                this.onRefreshItem(viewItem);\r\n            }\r\n            viewItem = this.heightMap[i];\r\n            newHeight = item.getHeight();\r\n            viewItem.top += cummDiff;\r\n            cummDiff += newHeight - viewItem.height;\r\n            viewItem.height = newHeight;\r\n            this.onRefreshItem(viewItem, true);\r\n            j = i + 1;\r\n        }\r\n        if (cummDiff !== 0 && j !== null) {\r\n            for (; j < this.heightMap.length; j++) {\r\n                viewItem = this.heightMap[j];\r\n                viewItem.top += cummDiff;\r\n                this.onRefreshItem(viewItem);\r\n            }\r\n        }\r\n    };\r\n    HeightMap.prototype.onRefreshItem = function (item, needsRender) {\r\n        if (needsRender === void 0) { needsRender = false; }\r\n        // noop\r\n    };\r\n    HeightMap.prototype.indexAt = function (position) {\r\n        var left = 0;\r\n        var right = this.heightMap.length;\r\n        var center;\r\n        var item;\r\n        // Binary search\r\n        while (left < right) {\r\n            center = Math.floor((left + right) / 2);\r\n            item = this.heightMap[center];\r\n            if (position < item.top) {\r\n                right = center;\r\n            }\r\n            else if (position >= item.top + item.height) {\r\n                if (left === center) {\r\n                    break;\r\n                }\r\n                left = center;\r\n            }\r\n            else {\r\n                return center;\r\n            }\r\n        }\r\n        return this.heightMap.length;\r\n    };\r\n    HeightMap.prototype.indexAfter = function (position) {\r\n        return Math.min(this.indexAt(position) + 1, this.heightMap.length);\r\n    };\r\n    HeightMap.prototype.itemAtIndex = function (index) {\r\n        return this.heightMap[index];\r\n    };\r\n    HeightMap.prototype.itemAfter = function (item) {\r\n        return this.heightMap[this.indexes[item.model.id] + 1] || null;\r\n    };\r\n    HeightMap.prototype.createViewItem = function (item) {\r\n        throw new Error('not implemented');\r\n    };\r\n    HeightMap.prototype.dispose = function () {\r\n        this.heightMap = [];\r\n        this.indexes = {};\r\n    };\r\n    return HeightMap;\r\n}());\r\nexport { HeightMap };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar ContextMenuEvent = /** @class */ (function () {\r\n    function ContextMenuEvent(posx, posy, target) {\r\n        this._posx = posx;\r\n        this._posy = posy;\r\n        this._target = target;\r\n    }\r\n    ContextMenuEvent.prototype.preventDefault = function () {\r\n        // no-op\r\n    };\r\n    ContextMenuEvent.prototype.stopPropagation = function () {\r\n        // no-op\r\n    };\r\n    Object.defineProperty(ContextMenuEvent.prototype, \"target\", {\r\n        get: function () {\r\n            return this._target;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return ContextMenuEvent;\r\n}());\r\nexport { ContextMenuEvent };\r\nvar MouseContextMenuEvent = /** @class */ (function (_super) {\r\n    __extends(MouseContextMenuEvent, _super);\r\n    function MouseContextMenuEvent(originalEvent) {\r\n        var _this = _super.call(this, originalEvent.posx, originalEvent.posy, originalEvent.target) || this;\r\n        _this.originalEvent = originalEvent;\r\n        return _this;\r\n    }\r\n    MouseContextMenuEvent.prototype.preventDefault = function () {\r\n        this.originalEvent.preventDefault();\r\n    };\r\n    MouseContextMenuEvent.prototype.stopPropagation = function () {\r\n        this.originalEvent.stopPropagation();\r\n    };\r\n    return MouseContextMenuEvent;\r\n}(ContextMenuEvent));\r\nexport { MouseContextMenuEvent };\r\nvar KeyboardContextMenuEvent = /** @class */ (function (_super) {\r\n    __extends(KeyboardContextMenuEvent, _super);\r\n    function KeyboardContextMenuEvent(posx, posy, originalEvent) {\r\n        var _this = _super.call(this, posx, posy, originalEvent.target) || this;\r\n        _this.originalEvent = originalEvent;\r\n        return _this;\r\n    }\r\n    KeyboardContextMenuEvent.prototype.preventDefault = function () {\r\n        this.originalEvent.preventDefault();\r\n    };\r\n    KeyboardContextMenuEvent.prototype.stopPropagation = function () {\r\n        this.originalEvent.stopPropagation();\r\n    };\r\n    return KeyboardContextMenuEvent;\r\n}(ContextMenuEvent));\r\nexport { KeyboardContextMenuEvent };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as Platform from '../../../common/platform.js';\r\nimport * as Browser from '../../../browser/browser.js';\r\nimport * as Lifecycle from '../../../common/lifecycle.js';\r\nimport * as DOM from '../../../browser/dom.js';\r\nimport * as Diff from '../../../common/diff/diff.js';\r\nimport * as Touch from '../../../browser/touch.js';\r\nimport * as strings from '../../../common/strings.js';\r\nimport * as Mouse from '../../../browser/mouseEvent.js';\r\nimport * as Keyboard from '../../../browser/keyboardEvent.js';\r\nimport * as dnd from './treeDnd.js';\r\nimport { ArrayIterator, MappedIterator } from '../../../common/iterator.js';\r\nimport { ScrollableElement } from '../../../browser/ui/scrollbar/scrollableElement.js';\r\nimport { HeightMap } from './treeViewModel.js';\r\nimport * as _ from './tree.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { DataTransfers, StaticDND } from '../../../browser/dnd.js';\r\nimport { DefaultTreestyler } from './treeDefaults.js';\r\nimport { Delayer, timeout } from '../../../common/async.js';\r\nfunction removeFromParent(element) {\r\n    try {\r\n        element.parentElement.removeChild(element);\r\n    }\r\n    catch (e) {\r\n        // this will throw if this happens due to a blur event, nasty business\r\n    }\r\n}\r\nvar RowCache = /** @class */ (function () {\r\n    function RowCache(context) {\r\n        this.context = context;\r\n        this._cache = { '': [] };\r\n    }\r\n    RowCache.prototype.alloc = function (templateId) {\r\n        var result = this.cache(templateId).pop();\r\n        if (!result) {\r\n            var content = document.createElement('div');\r\n            content.className = 'content';\r\n            var row = document.createElement('div');\r\n            row.appendChild(content);\r\n            var templateData = null;\r\n            try {\r\n                templateData = this.context.renderer.renderTemplate(this.context.tree, templateId, content);\r\n            }\r\n            catch (err) {\r\n                console.error('Tree usage error: exception while rendering template');\r\n                console.error(err);\r\n            }\r\n            result = {\r\n                element: row,\r\n                templateId: templateId,\r\n                templateData: templateData\r\n            };\r\n        }\r\n        return result;\r\n    };\r\n    RowCache.prototype.release = function (templateId, row) {\r\n        removeFromParent(row.element);\r\n        this.cache(templateId).push(row);\r\n    };\r\n    RowCache.prototype.cache = function (templateId) {\r\n        return this._cache[templateId] || (this._cache[templateId] = []);\r\n    };\r\n    RowCache.prototype.garbageCollect = function () {\r\n        var _this = this;\r\n        if (this._cache) {\r\n            Object.keys(this._cache).forEach(function (templateId) {\r\n                _this._cache[templateId].forEach(function (cachedRow) {\r\n                    _this.context.renderer.disposeTemplate(_this.context.tree, templateId, cachedRow.templateData);\r\n                    cachedRow.element = null;\r\n                    cachedRow.templateData = null;\r\n                });\r\n                delete _this._cache[templateId];\r\n            });\r\n        }\r\n    };\r\n    RowCache.prototype.dispose = function () {\r\n        this.garbageCollect();\r\n        this._cache = null;\r\n    };\r\n    return RowCache;\r\n}());\r\nexport { RowCache };\r\nvar ViewItem = /** @class */ (function () {\r\n    function ViewItem(context, model) {\r\n        var _this = this;\r\n        this.width = 0;\r\n        this.needsRender = false;\r\n        this.uri = null;\r\n        this.unbindDragStart = Lifecycle.Disposable.None;\r\n        this._draggable = false;\r\n        this.context = context;\r\n        this.model = model;\r\n        this.id = this.model.id;\r\n        this.row = null;\r\n        this.top = 0;\r\n        this.height = model.getHeight();\r\n        this._styles = {};\r\n        model.getAllTraits().forEach(function (t) { return _this._styles[t] = true; });\r\n        if (model.isExpanded()) {\r\n            this.addClass('expanded');\r\n        }\r\n    }\r\n    Object.defineProperty(ViewItem.prototype, \"expanded\", {\r\n        set: function (value) {\r\n            value ? this.addClass('expanded') : this.removeClass('expanded');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"loading\", {\r\n        set: function (value) {\r\n            value ? this.addClass('codicon-loading') : this.removeClass('codicon-loading');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"draggable\", {\r\n        get: function () {\r\n            return this._draggable;\r\n        },\r\n        set: function (value) {\r\n            this._draggable = value;\r\n            this.render(true);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"dropTarget\", {\r\n        set: function (value) {\r\n            value ? this.addClass('drop-target') : this.removeClass('drop-target');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"element\", {\r\n        get: function () {\r\n            return (this.row && this.row.element);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"templateId\", {\r\n        get: function () {\r\n            return this._templateId || (this._templateId = (this.context.renderer.getTemplateId && this.context.renderer.getTemplateId(this.context.tree, this.model.getElement())));\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ViewItem.prototype.addClass = function (name) {\r\n        this._styles[name] = true;\r\n        this.render(true);\r\n    };\r\n    ViewItem.prototype.removeClass = function (name) {\r\n        delete this._styles[name]; // is this slow?\r\n        this.render(true);\r\n    };\r\n    ViewItem.prototype.render = function (skipUserRender) {\r\n        var _this = this;\r\n        if (skipUserRender === void 0) { skipUserRender = false; }\r\n        if (!this.model || !this.element) {\r\n            return;\r\n        }\r\n        var classes = ['monaco-tree-row'];\r\n        classes.push.apply(classes, Object.keys(this._styles));\r\n        if (this.model.hasChildren()) {\r\n            classes.push('has-children');\r\n        }\r\n        this.element.className = classes.join(' ');\r\n        this.element.draggable = this.draggable;\r\n        this.element.style.height = this.height + 'px';\r\n        // ARIA\r\n        this.element.setAttribute('role', 'treeitem');\r\n        var accessibility = this.context.accessibilityProvider;\r\n        var ariaLabel = accessibility.getAriaLabel(this.context.tree, this.model.getElement());\r\n        if (ariaLabel) {\r\n            this.element.setAttribute('aria-label', ariaLabel);\r\n        }\r\n        if (accessibility.getPosInSet && accessibility.getSetSize) {\r\n            this.element.setAttribute('aria-setsize', accessibility.getSetSize());\r\n            this.element.setAttribute('aria-posinset', accessibility.getPosInSet(this.context.tree, this.model.getElement()));\r\n        }\r\n        if (this.model.hasTrait('focused')) {\r\n            var base64Id = strings.safeBtoa(this.model.id);\r\n            this.element.setAttribute('aria-selected', 'true');\r\n            this.element.setAttribute('id', base64Id);\r\n        }\r\n        else {\r\n            this.element.setAttribute('aria-selected', 'false');\r\n            this.element.removeAttribute('id');\r\n        }\r\n        if (this.model.hasChildren()) {\r\n            this.element.setAttribute('aria-expanded', String(!!this._styles['expanded']));\r\n        }\r\n        else {\r\n            this.element.removeAttribute('aria-expanded');\r\n        }\r\n        this.element.setAttribute('aria-level', String(this.model.getDepth()));\r\n        if (this.context.options.paddingOnRow) {\r\n            this.element.style.paddingLeft = this.context.options.twistiePixels + ((this.model.getDepth() - 1) * this.context.options.indentPixels) + 'px';\r\n        }\r\n        else {\r\n            this.element.style.paddingLeft = ((this.model.getDepth() - 1) * this.context.options.indentPixels) + 'px';\r\n            this.row.element.firstElementChild.style.paddingLeft = this.context.options.twistiePixels + 'px';\r\n        }\r\n        var uri = this.context.dnd.getDragURI(this.context.tree, this.model.getElement());\r\n        if (uri !== this.uri) {\r\n            if (this.unbindDragStart) {\r\n                this.unbindDragStart.dispose();\r\n            }\r\n            if (uri) {\r\n                this.uri = uri;\r\n                this.draggable = true;\r\n                this.unbindDragStart = DOM.addDisposableListener(this.element, 'dragstart', function (e) {\r\n                    _this.onDragStart(e);\r\n                });\r\n            }\r\n            else {\r\n                this.uri = null;\r\n            }\r\n        }\r\n        if (!skipUserRender && this.element) {\r\n            var paddingLeft = 0;\r\n            if (this.context.horizontalScrolling) {\r\n                var style = window.getComputedStyle(this.element);\r\n                paddingLeft = parseFloat(style.paddingLeft);\r\n            }\r\n            if (this.context.horizontalScrolling) {\r\n                this.element.style.width = Browser.isFirefox ? '-moz-fit-content' : 'fit-content';\r\n            }\r\n            try {\r\n                this.context.renderer.renderElement(this.context.tree, this.model.getElement(), this.templateId, this.row.templateData);\r\n            }\r\n            catch (err) {\r\n                console.error('Tree usage error: exception while rendering element');\r\n                console.error(err);\r\n            }\r\n            if (this.context.horizontalScrolling) {\r\n                this.width = DOM.getContentWidth(this.element) + paddingLeft;\r\n                this.element.style.width = '';\r\n            }\r\n        }\r\n    };\r\n    ViewItem.prototype.insertInDOM = function (container, afterElement) {\r\n        if (!this.row) {\r\n            this.row = this.context.cache.alloc(this.templateId);\r\n            // used in reverse lookup from HTMLElement to Item\r\n            this.element[TreeView.BINDING] = this;\r\n        }\r\n        if (this.element.parentElement) {\r\n            return;\r\n        }\r\n        if (afterElement === null) {\r\n            container.appendChild(this.element);\r\n        }\r\n        else {\r\n            try {\r\n                container.insertBefore(this.element, afterElement);\r\n            }\r\n            catch (e) {\r\n                console.warn('Failed to locate previous tree element');\r\n                container.appendChild(this.element);\r\n            }\r\n        }\r\n        this.render();\r\n    };\r\n    ViewItem.prototype.removeFromDOM = function () {\r\n        if (!this.row) {\r\n            return;\r\n        }\r\n        this.unbindDragStart.dispose();\r\n        this.uri = null;\r\n        this.element[TreeView.BINDING] = null;\r\n        this.context.cache.release(this.templateId, this.row);\r\n        this.row = null;\r\n    };\r\n    ViewItem.prototype.dispose = function () {\r\n        this.row = null;\r\n    };\r\n    return ViewItem;\r\n}());\r\nexport { ViewItem };\r\nvar RootViewItem = /** @class */ (function (_super) {\r\n    __extends(RootViewItem, _super);\r\n    function RootViewItem(context, model, wrapper) {\r\n        var _this = _super.call(this, context, model) || this;\r\n        _this.row = {\r\n            element: wrapper,\r\n            templateData: null,\r\n            templateId: null\r\n        };\r\n        return _this;\r\n    }\r\n    RootViewItem.prototype.render = function () {\r\n        if (!this.model || !this.element) {\r\n            return;\r\n        }\r\n        var classes = ['monaco-tree-wrapper'];\r\n        classes.push.apply(classes, Object.keys(this._styles));\r\n        if (this.model.hasChildren()) {\r\n            classes.push('has-children');\r\n        }\r\n        this.element.className = classes.join(' ');\r\n    };\r\n    RootViewItem.prototype.insertInDOM = function (container, afterElement) {\r\n        // noop\r\n    };\r\n    RootViewItem.prototype.removeFromDOM = function () {\r\n        // noop\r\n    };\r\n    return RootViewItem;\r\n}(ViewItem));\r\nfunction reactionEquals(one, other) {\r\n    if (!one && !other) {\r\n        return true;\r\n    }\r\n    else if (!one || !other) {\r\n        return false;\r\n    }\r\n    else if (one.accept !== other.accept) {\r\n        return false;\r\n    }\r\n    else if (one.bubble !== other.bubble) {\r\n        return false;\r\n    }\r\n    else if (one.effect !== other.effect) {\r\n        return false;\r\n    }\r\n    else {\r\n        return true;\r\n    }\r\n}\r\nvar TreeView = /** @class */ (function (_super) {\r\n    __extends(TreeView, _super);\r\n    function TreeView(context, container) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = null;\r\n        _this.lastPointerType = '';\r\n        _this.lastClickTimeStamp = 0;\r\n        _this.contentWidthUpdateDelayer = new Delayer(50);\r\n        _this.isRefreshing = false;\r\n        _this.refreshingPreviousChildrenIds = {};\r\n        _this.currentDragAndDropData = null;\r\n        _this.currentDropTarget = null;\r\n        _this.currentDropTargets = null;\r\n        _this.currentDropDisposable = Lifecycle.Disposable.None;\r\n        _this.gestureDisposable = Lifecycle.Disposable.None;\r\n        _this.dragAndDropScrollInterval = null;\r\n        _this.dragAndDropScrollTimeout = null;\r\n        _this.dragAndDropMouseY = null;\r\n        _this.highlightedItemWasDraggable = false;\r\n        _this.onHiddenScrollTop = null;\r\n        _this._onDOMFocus = new Emitter();\r\n        _this.onDOMFocus = _this._onDOMFocus.event;\r\n        _this._onDOMBlur = new Emitter();\r\n        _this._onDidScroll = new Emitter();\r\n        TreeView.counter++;\r\n        _this.instance = TreeView.counter;\r\n        var horizontalScrollMode = typeof context.options.horizontalScrollMode === 'undefined' ? 2 /* Hidden */ : context.options.horizontalScrollMode;\r\n        _this.horizontalScrolling = horizontalScrollMode !== 2 /* Hidden */;\r\n        _this.context = {\r\n            dataSource: context.dataSource,\r\n            renderer: context.renderer,\r\n            controller: context.controller,\r\n            dnd: context.dnd,\r\n            filter: context.filter,\r\n            sorter: context.sorter,\r\n            tree: context.tree,\r\n            accessibilityProvider: context.accessibilityProvider,\r\n            options: context.options,\r\n            cache: new RowCache(context),\r\n            horizontalScrolling: _this.horizontalScrolling\r\n        };\r\n        _this.modelListeners = [];\r\n        _this.viewListeners = [];\r\n        _this.items = {};\r\n        _this.domNode = document.createElement('div');\r\n        _this.domNode.className = \"monaco-tree no-focused-item monaco-tree-instance-\" + _this.instance;\r\n        // to allow direct tabbing into the tree instead of first focusing the tree\r\n        _this.domNode.tabIndex = context.options.preventRootFocus ? -1 : 0;\r\n        _this.styleElement = DOM.createStyleSheet(_this.domNode);\r\n        _this.treeStyler = context.styler || new DefaultTreestyler(_this.styleElement, \"monaco-tree-instance-\" + _this.instance);\r\n        // ARIA\r\n        _this.domNode.setAttribute('role', 'tree');\r\n        if (_this.context.options.ariaLabel) {\r\n            _this.domNode.setAttribute('aria-label', _this.context.options.ariaLabel);\r\n        }\r\n        if (_this.context.options.alwaysFocused) {\r\n            DOM.addClass(_this.domNode, 'focused');\r\n        }\r\n        if (!_this.context.options.paddingOnRow) {\r\n            DOM.addClass(_this.domNode, 'no-row-padding');\r\n        }\r\n        _this.wrapper = document.createElement('div');\r\n        _this.wrapper.className = 'monaco-tree-wrapper';\r\n        _this.scrollableElement = new ScrollableElement(_this.wrapper, {\r\n            alwaysConsumeMouseWheel: true,\r\n            horizontal: horizontalScrollMode,\r\n            vertical: (typeof context.options.verticalScrollMode !== 'undefined' ? context.options.verticalScrollMode : 1 /* Auto */),\r\n            useShadows: context.options.useShadows\r\n        });\r\n        _this.scrollableElement.onScroll(function (e) {\r\n            _this.render(e.scrollTop, e.height, e.scrollLeft, e.width, e.scrollWidth);\r\n            _this._onDidScroll.fire();\r\n        });\r\n        if (Browser.isIE) {\r\n            _this.wrapper.style.msTouchAction = 'none';\r\n            _this.wrapper.style.msContentZooming = 'none';\r\n        }\r\n        else {\r\n            _this.gestureDisposable = Touch.Gesture.addTarget(_this.wrapper);\r\n        }\r\n        _this.rowsContainer = document.createElement('div');\r\n        _this.rowsContainer.className = 'monaco-tree-rows';\r\n        if (context.options.showTwistie) {\r\n            _this.rowsContainer.className += ' show-twisties';\r\n        }\r\n        var focusTracker = DOM.trackFocus(_this.domNode);\r\n        _this.viewListeners.push(focusTracker.onDidFocus(function () { return _this.onFocus(); }));\r\n        _this.viewListeners.push(focusTracker.onDidBlur(function () { return _this.onBlur(); }));\r\n        _this.viewListeners.push(focusTracker);\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'keydown', function (e) { return _this.onKeyDown(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'keyup', function (e) { return _this.onKeyUp(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'mousedown', function (e) { return _this.onMouseDown(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'mouseup', function (e) { return _this.onMouseUp(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'auxclick', function (e) {\r\n            if (e && e.button === 1) {\r\n                _this.onMouseMiddleClick(e);\r\n            }\r\n        }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'click', function (e) { return _this.onClick(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'contextmenu', function (e) { return _this.onContextMenu(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, Touch.EventType.Tap, function (e) { return _this.onTap(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, Touch.EventType.Change, function (e) { return _this.onTouchChange(e); }));\r\n        if (Browser.isIE) {\r\n            _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'MSPointerDown', function (e) { return _this.onMsPointerDown(e); }));\r\n            _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'MSGestureTap', function (e) { return _this.onMsGestureTap(e); }));\r\n            // these events come too fast, we throttle them\r\n            _this.viewListeners.push(DOM.addDisposableThrottledListener(_this.wrapper, 'MSGestureChange', function (e) { return _this.onThrottledMsGestureChange(e); }, function (lastEvent, event) {\r\n                event.stopPropagation();\r\n                event.preventDefault();\r\n                var result = { translationY: event.translationY, translationX: event.translationX };\r\n                if (lastEvent) {\r\n                    result.translationY += lastEvent.translationY;\r\n                    result.translationX += lastEvent.translationX;\r\n                }\r\n                return result;\r\n            }));\r\n        }\r\n        _this.viewListeners.push(DOM.addDisposableListener(window, 'dragover', function (e) { return _this.onDragOver(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'drop', function (e) { return _this.onDrop(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(window, 'dragend', function (e) { return _this.onDragEnd(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(window, 'dragleave', function (e) { return _this.onDragOver(e); }));\r\n        _this.wrapper.appendChild(_this.rowsContainer);\r\n        _this.domNode.appendChild(_this.scrollableElement.getDomNode());\r\n        container.appendChild(_this.domNode);\r\n        _this.lastRenderTop = 0;\r\n        _this.lastRenderHeight = 0;\r\n        _this.didJustPressContextMenuKey = false;\r\n        _this.currentDropTarget = null;\r\n        _this.currentDropTargets = [];\r\n        _this.shouldInvalidateDropReaction = false;\r\n        _this.dragAndDropScrollInterval = null;\r\n        _this.dragAndDropScrollTimeout = null;\r\n        _this.onRowsChanged();\r\n        _this.layout();\r\n        _this.setupMSGesture();\r\n        _this.applyStyles(context.options);\r\n        return _this;\r\n    }\r\n    TreeView.prototype.applyStyles = function (styles) {\r\n        this.treeStyler.style(styles);\r\n    };\r\n    TreeView.prototype.createViewItem = function (item) {\r\n        return new ViewItem(this.context, item);\r\n    };\r\n    TreeView.prototype.getHTMLElement = function () {\r\n        return this.domNode;\r\n    };\r\n    TreeView.prototype.focus = function () {\r\n        this.domNode.focus();\r\n    };\r\n    TreeView.prototype.isFocused = function () {\r\n        return document.activeElement === this.domNode;\r\n    };\r\n    TreeView.prototype.blur = function () {\r\n        this.domNode.blur();\r\n    };\r\n    TreeView.prototype.setupMSGesture = function () {\r\n        var _this = this;\r\n        if (window.MSGesture) {\r\n            this.msGesture = new MSGesture();\r\n            setTimeout(function () { return _this.msGesture.target = _this.wrapper; }, 100); // TODO@joh, TODO@IETeam\r\n        }\r\n    };\r\n    TreeView.prototype.isTreeVisible = function () {\r\n        return this.onHiddenScrollTop === null;\r\n    };\r\n    TreeView.prototype.layout = function (height, width) {\r\n        if (!this.isTreeVisible()) {\r\n            return;\r\n        }\r\n        this.viewHeight = height || DOM.getContentHeight(this.wrapper); // render\r\n        this.scrollHeight = this.getContentHeight();\r\n        if (this.horizontalScrolling) {\r\n            this.viewWidth = width || DOM.getContentWidth(this.wrapper);\r\n        }\r\n    };\r\n    TreeView.prototype.render = function (scrollTop, viewHeight, scrollLeft, viewWidth, scrollWidth) {\r\n        var i;\r\n        var stop;\r\n        var renderTop = scrollTop;\r\n        var renderBottom = scrollTop + viewHeight;\r\n        var thisRenderBottom = this.lastRenderTop + this.lastRenderHeight;\r\n        // when view scrolls down, start rendering from the renderBottom\r\n        for (i = this.indexAfter(renderBottom) - 1, stop = this.indexAt(Math.max(thisRenderBottom, renderTop)); i >= stop; i--) {\r\n            this.insertItemInDOM(this.itemAtIndex(i));\r\n        }\r\n        // when view scrolls up, start rendering from either this.renderTop or renderBottom\r\n        for (i = Math.min(this.indexAt(this.lastRenderTop), this.indexAfter(renderBottom)) - 1, stop = this.indexAt(renderTop); i >= stop; i--) {\r\n            this.insertItemInDOM(this.itemAtIndex(i));\r\n        }\r\n        // when view scrolls down, start unrendering from renderTop\r\n        for (i = this.indexAt(this.lastRenderTop), stop = Math.min(this.indexAt(renderTop), this.indexAfter(thisRenderBottom)); i < stop; i++) {\r\n            this.removeItemFromDOM(this.itemAtIndex(i));\r\n        }\r\n        // when view scrolls up, start unrendering from either renderBottom this.renderTop\r\n        for (i = Math.max(this.indexAfter(renderBottom), this.indexAt(this.lastRenderTop)), stop = this.indexAfter(thisRenderBottom); i < stop; i++) {\r\n            this.removeItemFromDOM(this.itemAtIndex(i));\r\n        }\r\n        var topItem = this.itemAtIndex(this.indexAt(renderTop));\r\n        if (topItem) {\r\n            this.rowsContainer.style.top = (topItem.top - renderTop) + 'px';\r\n        }\r\n        if (this.horizontalScrolling) {\r\n            this.rowsContainer.style.left = -scrollLeft + 'px';\r\n            this.rowsContainer.style.width = Math.max(scrollWidth, viewWidth) + \"px\";\r\n        }\r\n        this.lastRenderTop = renderTop;\r\n        this.lastRenderHeight = renderBottom - renderTop;\r\n    };\r\n    TreeView.prototype.setModel = function (newModel) {\r\n        this.releaseModel();\r\n        this.model = newModel;\r\n        this.model.onRefresh(this.onRefreshing, this, this.modelListeners);\r\n        this.model.onDidRefresh(this.onRefreshed, this, this.modelListeners);\r\n        this.model.onSetInput(this.onClearingInput, this, this.modelListeners);\r\n        this.model.onDidSetInput(this.onSetInput, this, this.modelListeners);\r\n        this.model.onDidFocus(this.onModelFocusChange, this, this.modelListeners);\r\n        this.model.onRefreshItemChildren(this.onItemChildrenRefreshing, this, this.modelListeners);\r\n        this.model.onDidRefreshItemChildren(this.onItemChildrenRefreshed, this, this.modelListeners);\r\n        this.model.onDidRefreshItem(this.onItemRefresh, this, this.modelListeners);\r\n        this.model.onExpandItem(this.onItemExpanding, this, this.modelListeners);\r\n        this.model.onDidExpandItem(this.onItemExpanded, this, this.modelListeners);\r\n        this.model.onCollapseItem(this.onItemCollapsing, this, this.modelListeners);\r\n        this.model.onDidRevealItem(this.onItemReveal, this, this.modelListeners);\r\n        this.model.onDidAddTraitItem(this.onItemAddTrait, this, this.modelListeners);\r\n        this.model.onDidRemoveTraitItem(this.onItemRemoveTrait, this, this.modelListeners);\r\n    };\r\n    TreeView.prototype.onRefreshing = function () {\r\n        this.isRefreshing = true;\r\n    };\r\n    TreeView.prototype.onRefreshed = function () {\r\n        this.isRefreshing = false;\r\n        this.onRowsChanged();\r\n    };\r\n    TreeView.prototype.onRowsChanged = function (scrollTop) {\r\n        if (scrollTop === void 0) { scrollTop = this.scrollTop; }\r\n        if (this.isRefreshing) {\r\n            return;\r\n        }\r\n        this.scrollTop = scrollTop;\r\n        this.updateScrollWidth();\r\n    };\r\n    TreeView.prototype.updateScrollWidth = function () {\r\n        var _this = this;\r\n        if (!this.horizontalScrolling) {\r\n            return;\r\n        }\r\n        this.contentWidthUpdateDelayer.trigger(function () {\r\n            var keys = Object.keys(_this.items);\r\n            var scrollWidth = 0;\r\n            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n                var key = keys_1[_i];\r\n                scrollWidth = Math.max(scrollWidth, _this.items[key].width);\r\n            }\r\n            _this.scrollWidth = scrollWidth + 10 /* scrollbar */;\r\n        });\r\n    };\r\n    TreeView.prototype.focusNextPage = function (eventPayload) {\r\n        var _this = this;\r\n        var lastPageIndex = this.indexAt(this.scrollTop + this.viewHeight);\r\n        lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\r\n        var lastPageElement = this.itemAtIndex(lastPageIndex).model.getElement();\r\n        var currentlyFocusedElement = this.model.getFocus();\r\n        if (currentlyFocusedElement !== lastPageElement) {\r\n            this.model.setFocus(lastPageElement, eventPayload);\r\n        }\r\n        else {\r\n            var previousScrollTop = this.scrollTop;\r\n            this.scrollTop += this.viewHeight;\r\n            if (this.scrollTop !== previousScrollTop) {\r\n                // Let the scroll event listener run\r\n                setTimeout(function () {\r\n                    _this.focusNextPage(eventPayload);\r\n                }, 0);\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.focusPreviousPage = function (eventPayload) {\r\n        var _this = this;\r\n        var firstPageIndex;\r\n        if (this.scrollTop === 0) {\r\n            firstPageIndex = this.indexAt(this.scrollTop);\r\n        }\r\n        else {\r\n            firstPageIndex = this.indexAfter(this.scrollTop - 1);\r\n        }\r\n        var firstPageElement = this.itemAtIndex(firstPageIndex).model.getElement();\r\n        var currentlyFocusedElement = this.model.getFocus();\r\n        if (currentlyFocusedElement !== firstPageElement) {\r\n            this.model.setFocus(firstPageElement, eventPayload);\r\n        }\r\n        else {\r\n            var previousScrollTop = this.scrollTop;\r\n            this.scrollTop -= this.viewHeight;\r\n            if (this.scrollTop !== previousScrollTop) {\r\n                // Let the scroll event listener run\r\n                setTimeout(function () {\r\n                    _this.focusPreviousPage(eventPayload);\r\n                }, 0);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(TreeView.prototype, \"viewHeight\", {\r\n        get: function () {\r\n            var scrollDimensions = this.scrollableElement.getScrollDimensions();\r\n            return scrollDimensions.height;\r\n        },\r\n        set: function (height) {\r\n            this.scrollableElement.setScrollDimensions({ height: height });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"scrollHeight\", {\r\n        set: function (scrollHeight) {\r\n            scrollHeight = scrollHeight + (this.horizontalScrolling ? 10 : 0);\r\n            this.scrollableElement.setScrollDimensions({ scrollHeight: scrollHeight });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"viewWidth\", {\r\n        get: function () {\r\n            var scrollDimensions = this.scrollableElement.getScrollDimensions();\r\n            return scrollDimensions.width;\r\n        },\r\n        set: function (viewWidth) {\r\n            this.scrollableElement.setScrollDimensions({ width: viewWidth });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"scrollWidth\", {\r\n        set: function (scrollWidth) {\r\n            this.scrollableElement.setScrollDimensions({ scrollWidth: scrollWidth });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"scrollTop\", {\r\n        get: function () {\r\n            var scrollPosition = this.scrollableElement.getScrollPosition();\r\n            return scrollPosition.scrollTop;\r\n        },\r\n        set: function (scrollTop) {\r\n            var scrollHeight = this.getContentHeight() + (this.horizontalScrolling ? 10 : 0);\r\n            this.scrollableElement.setScrollDimensions({ scrollHeight: scrollHeight });\r\n            this.scrollableElement.setScrollPosition({ scrollTop: scrollTop });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // Events\r\n    TreeView.prototype.onClearingInput = function (e) {\r\n        var item = e.item;\r\n        if (item) {\r\n            this.onRemoveItems(new MappedIterator(item.getNavigator(), function (item) { return item && item.id; }));\r\n            this.onRowsChanged();\r\n        }\r\n    };\r\n    TreeView.prototype.onSetInput = function (e) {\r\n        this.context.cache.garbageCollect();\r\n        this.inputItem = new RootViewItem(this.context, e.item, this.wrapper);\r\n    };\r\n    TreeView.prototype.onItemChildrenRefreshing = function (e) {\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem && this.context.options.showLoading) {\r\n            viewItem.loadingTimer = setTimeout(function () {\r\n                viewItem.loadingTimer = 0;\r\n                viewItem.loading = true;\r\n            }, TreeView.LOADING_DECORATION_DELAY);\r\n        }\r\n        if (!e.isNested) {\r\n            var childrenIds = [];\r\n            var navigator_1 = item.getNavigator();\r\n            var childItem = void 0;\r\n            while (childItem = navigator_1.next()) {\r\n                childrenIds.push(childItem.id);\r\n            }\r\n            this.refreshingPreviousChildrenIds[item.id] = childrenIds;\r\n        }\r\n    };\r\n    TreeView.prototype.onItemChildrenRefreshed = function (e) {\r\n        var _this = this;\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            if (viewItem.loadingTimer) {\r\n                clearTimeout(viewItem.loadingTimer);\r\n                viewItem.loadingTimer = 0;\r\n            }\r\n            viewItem.loading = false;\r\n        }\r\n        if (!e.isNested) {\r\n            var previousChildrenIds_1 = this.refreshingPreviousChildrenIds[item.id];\r\n            var afterModelItems_1 = [];\r\n            var navigator_2 = item.getNavigator();\r\n            var childItem = void 0;\r\n            while (childItem = navigator_2.next()) {\r\n                afterModelItems_1.push(childItem);\r\n            }\r\n            var skipDiff = Math.abs(previousChildrenIds_1.length - afterModelItems_1.length) > 1000;\r\n            var diff = [];\r\n            var doToInsertItemsAlreadyExist = false;\r\n            if (!skipDiff) {\r\n                var lcs = new Diff.LcsDiff({\r\n                    getElements: function () { return previousChildrenIds_1; }\r\n                }, {\r\n                    getElements: function () { return afterModelItems_1.map(function (item) { return item.id; }); }\r\n                }, null);\r\n                diff = lcs.ComputeDiff(false).changes;\r\n                // this means that the result of the diff algorithm would result\r\n                // in inserting items that were already registered. this can only\r\n                // happen if the data provider returns bad ids OR if the sorting\r\n                // of the elements has changed\r\n                doToInsertItemsAlreadyExist = diff.some(function (d) {\r\n                    if (d.modifiedLength > 0) {\r\n                        for (var i = d.modifiedStart, len = d.modifiedStart + d.modifiedLength; i < len; i++) {\r\n                            if (_this.items.hasOwnProperty(afterModelItems_1[i].id)) {\r\n                                return true;\r\n                            }\r\n                        }\r\n                    }\r\n                    return false;\r\n                });\r\n            }\r\n            // 50 is an optimization number, at some point we're better off\r\n            // just replacing everything\r\n            if (!skipDiff && !doToInsertItemsAlreadyExist && diff.length < 50) {\r\n                for (var _i = 0, diff_1 = diff; _i < diff_1.length; _i++) {\r\n                    var diffChange = diff_1[_i];\r\n                    if (diffChange.originalLength > 0) {\r\n                        this.onRemoveItems(new ArrayIterator(previousChildrenIds_1, diffChange.originalStart, diffChange.originalStart + diffChange.originalLength));\r\n                    }\r\n                    if (diffChange.modifiedLength > 0) {\r\n                        var beforeItem = afterModelItems_1[diffChange.modifiedStart - 1] || item;\r\n                        beforeItem = beforeItem.getDepth() > 0 ? beforeItem : null;\r\n                        this.onInsertItems(new ArrayIterator(afterModelItems_1, diffChange.modifiedStart, diffChange.modifiedStart + diffChange.modifiedLength), beforeItem ? beforeItem.id : null);\r\n                    }\r\n                }\r\n            }\r\n            else if (skipDiff || diff.length) {\r\n                this.onRemoveItems(new ArrayIterator(previousChildrenIds_1));\r\n                this.onInsertItems(new ArrayIterator(afterModelItems_1), item.getDepth() > 0 ? item.id : null);\r\n            }\r\n            if (skipDiff || diff.length) {\r\n                this.onRowsChanged();\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.onItemRefresh = function (item) {\r\n        this.onItemsRefresh([item]);\r\n    };\r\n    TreeView.prototype.onItemsRefresh = function (items) {\r\n        var _this = this;\r\n        this.onRefreshItemSet(items.filter(function (item) { return _this.items.hasOwnProperty(item.id); }));\r\n        this.onRowsChanged();\r\n    };\r\n    TreeView.prototype.onItemExpanding = function (e) {\r\n        var viewItem = this.items[e.item.id];\r\n        if (viewItem) {\r\n            viewItem.expanded = true;\r\n        }\r\n    };\r\n    TreeView.prototype.onItemExpanded = function (e) {\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.expanded = true;\r\n            var height = this.onInsertItems(item.getNavigator(), item.id) || 0;\r\n            var scrollTop = this.scrollTop;\r\n            if (viewItem.top + viewItem.height <= this.scrollTop) {\r\n                scrollTop += height;\r\n            }\r\n            this.onRowsChanged(scrollTop);\r\n        }\r\n    };\r\n    TreeView.prototype.onItemCollapsing = function (e) {\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.expanded = false;\r\n            this.onRemoveItems(new MappedIterator(item.getNavigator(), function (item) { return item && item.id; }));\r\n            this.onRowsChanged();\r\n        }\r\n    };\r\n    TreeView.prototype.onItemReveal = function (e) {\r\n        var item = e.item;\r\n        var relativeTop = e.relativeTop;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            if (relativeTop !== null) {\r\n                relativeTop = relativeTop < 0 ? 0 : relativeTop;\r\n                relativeTop = relativeTop > 1 ? 1 : relativeTop;\r\n                // y = mx + b\r\n                var m = viewItem.height - this.viewHeight;\r\n                this.scrollTop = m * relativeTop + viewItem.top;\r\n            }\r\n            else {\r\n                var viewItemBottom = viewItem.top + viewItem.height;\r\n                var wrapperBottom = this.scrollTop + this.viewHeight;\r\n                if (viewItem.top < this.scrollTop) {\r\n                    this.scrollTop = viewItem.top;\r\n                }\r\n                else if (viewItemBottom >= wrapperBottom) {\r\n                    this.scrollTop = viewItemBottom - this.viewHeight;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.onItemAddTrait = function (e) {\r\n        var item = e.item;\r\n        var trait = e.trait;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.addClass(trait);\r\n        }\r\n        if (trait === 'highlighted') {\r\n            DOM.addClass(this.domNode, trait);\r\n            // Ugly Firefox fix: input fields can't be selected if parent nodes are draggable\r\n            if (viewItem) {\r\n                this.highlightedItemWasDraggable = !!viewItem.draggable;\r\n                if (viewItem.draggable) {\r\n                    viewItem.draggable = false;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.onItemRemoveTrait = function (e) {\r\n        var item = e.item;\r\n        var trait = e.trait;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.removeClass(trait);\r\n        }\r\n        if (trait === 'highlighted') {\r\n            DOM.removeClass(this.domNode, trait);\r\n            // Ugly Firefox fix: input fields can't be selected if parent nodes are draggable\r\n            if (this.highlightedItemWasDraggable) {\r\n                viewItem.draggable = true;\r\n            }\r\n            this.highlightedItemWasDraggable = false;\r\n        }\r\n    };\r\n    TreeView.prototype.onModelFocusChange = function () {\r\n        var focus = this.model && this.model.getFocus();\r\n        DOM.toggleClass(this.domNode, 'no-focused-item', !focus);\r\n        // ARIA\r\n        if (focus) {\r\n            this.domNode.setAttribute('aria-activedescendant', strings.safeBtoa(this.context.dataSource.getId(this.context.tree, focus)));\r\n        }\r\n        else {\r\n            this.domNode.removeAttribute('aria-activedescendant');\r\n        }\r\n    };\r\n    // HeightMap \"events\"\r\n    TreeView.prototype.onInsertItem = function (item) {\r\n        var _this = this;\r\n        item.onDragStart = function (e) { _this.onDragStart(item, e); };\r\n        item.needsRender = true;\r\n        this.refreshViewItem(item);\r\n        this.items[item.id] = item;\r\n    };\r\n    TreeView.prototype.onRefreshItem = function (item, needsRender) {\r\n        if (needsRender === void 0) { needsRender = false; }\r\n        item.needsRender = item.needsRender || needsRender;\r\n        this.refreshViewItem(item);\r\n    };\r\n    TreeView.prototype.onRemoveItem = function (item) {\r\n        this.removeItemFromDOM(item);\r\n        item.dispose();\r\n        delete this.items[item.id];\r\n    };\r\n    // ViewItem refresh\r\n    TreeView.prototype.refreshViewItem = function (item) {\r\n        item.render();\r\n        if (this.shouldBeRendered(item)) {\r\n            this.insertItemInDOM(item);\r\n        }\r\n        else {\r\n            this.removeItemFromDOM(item);\r\n        }\r\n    };\r\n    // DOM Events\r\n    TreeView.prototype.onClick = function (e) {\r\n        if (this.lastPointerType && this.lastPointerType !== 'mouse') {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        if (Browser.isIE && Date.now() - this.lastClickTimeStamp < 300) {\r\n            // IE10+ doesn't set the detail property correctly. While IE10 simply\r\n            // counts the number of clicks, IE11 reports always 1. To align with\r\n            // other browser, we set the value to 2 if clicks events come in a 300ms\r\n            // sequence.\r\n            event.detail = 2;\r\n        }\r\n        this.lastClickTimeStamp = Date.now();\r\n        this.context.controller.onClick(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onMouseMiddleClick = function (e) {\r\n        if (!this.context.controller.onMouseMiddleClick) {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onMouseMiddleClick(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onMouseDown = function (e) {\r\n        this.didJustPressContextMenuKey = false;\r\n        if (!this.context.controller.onMouseDown) {\r\n            return;\r\n        }\r\n        if (this.lastPointerType && this.lastPointerType !== 'mouse') {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        if (event.ctrlKey && Platform.isNative && Platform.isMacintosh) {\r\n            return;\r\n        }\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onMouseDown(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onMouseUp = function (e) {\r\n        if (!this.context.controller.onMouseUp) {\r\n            return;\r\n        }\r\n        if (this.lastPointerType && this.lastPointerType !== 'mouse') {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        if (event.ctrlKey && Platform.isNative && Platform.isMacintosh) {\r\n            return;\r\n        }\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onMouseUp(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onTap = function (e) {\r\n        var item = this.getItemAround(e.initialTarget);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onTap(this.context.tree, item.model.getElement(), e);\r\n    };\r\n    TreeView.prototype.onTouchChange = function (event) {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        this.scrollTop -= event.translationY;\r\n    };\r\n    TreeView.prototype.onContextMenu = function (event) {\r\n        var resultEvent;\r\n        var element;\r\n        if (event instanceof KeyboardEvent || this.didJustPressContextMenuKey) {\r\n            this.didJustPressContextMenuKey = false;\r\n            var keyboardEvent = new Keyboard.StandardKeyboardEvent(event);\r\n            element = this.model.getFocus();\r\n            var position = void 0;\r\n            if (!element) {\r\n                element = this.model.getInput();\r\n                position = DOM.getDomNodePagePosition(this.inputItem.element);\r\n            }\r\n            else {\r\n                var id = this.context.dataSource.getId(this.context.tree, element);\r\n                var viewItem = this.items[id];\r\n                position = DOM.getDomNodePagePosition(viewItem.element);\r\n            }\r\n            resultEvent = new _.KeyboardContextMenuEvent(position.left + position.width, position.top, keyboardEvent);\r\n        }\r\n        else {\r\n            var mouseEvent = new Mouse.StandardMouseEvent(event);\r\n            var item = this.getItemAround(mouseEvent.target);\r\n            if (!item) {\r\n                return;\r\n            }\r\n            element = item.model.getElement();\r\n            resultEvent = new _.MouseContextMenuEvent(mouseEvent);\r\n        }\r\n        this.context.controller.onContextMenu(this.context.tree, element, resultEvent);\r\n    };\r\n    TreeView.prototype.onKeyDown = function (e) {\r\n        var event = new Keyboard.StandardKeyboardEvent(e);\r\n        this.didJustPressContextMenuKey = event.keyCode === 58 /* ContextMenu */ || (event.shiftKey && event.keyCode === 68 /* F10 */);\r\n        if (event.target && event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n            return; // Ignore event if target is a form input field (avoids browser specific issues)\r\n        }\r\n        if (this.didJustPressContextMenuKey) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        }\r\n        this.context.controller.onKeyDown(this.context.tree, event);\r\n    };\r\n    TreeView.prototype.onKeyUp = function (e) {\r\n        if (this.didJustPressContextMenuKey) {\r\n            this.onContextMenu(e);\r\n        }\r\n        this.didJustPressContextMenuKey = false;\r\n        this.context.controller.onKeyUp(this.context.tree, new Keyboard.StandardKeyboardEvent(e));\r\n    };\r\n    TreeView.prototype.onDragStart = function (item, e) {\r\n        if (this.model.getHighlight()) {\r\n            return;\r\n        }\r\n        var element = item.model.getElement();\r\n        var selection = this.model.getSelection();\r\n        var elements;\r\n        if (selection.indexOf(element) > -1) {\r\n            elements = selection;\r\n        }\r\n        else {\r\n            elements = [element];\r\n        }\r\n        e.dataTransfer.effectAllowed = 'copyMove';\r\n        e.dataTransfer.setData(DataTransfers.RESOURCES, JSON.stringify([item.uri]));\r\n        if (e.dataTransfer.setDragImage) {\r\n            var label = void 0;\r\n            if (this.context.dnd.getDragLabel) {\r\n                label = this.context.dnd.getDragLabel(this.context.tree, elements);\r\n            }\r\n            else {\r\n                label = String(elements.length);\r\n            }\r\n            var dragImage_1 = document.createElement('div');\r\n            dragImage_1.className = 'monaco-tree-drag-image';\r\n            dragImage_1.textContent = label;\r\n            document.body.appendChild(dragImage_1);\r\n            e.dataTransfer.setDragImage(dragImage_1, -10, -10);\r\n            setTimeout(function () { return document.body.removeChild(dragImage_1); }, 0);\r\n        }\r\n        this.currentDragAndDropData = new dnd.ElementsDragAndDropData(elements);\r\n        StaticDND.CurrentDragAndDropData = new dnd.ExternalElementsDragAndDropData(elements);\r\n        this.context.dnd.onDragStart(this.context.tree, this.currentDragAndDropData, new Mouse.DragMouseEvent(e));\r\n    };\r\n    TreeView.prototype.setupDragAndDropScrollInterval = function () {\r\n        var _this = this;\r\n        var viewTop = DOM.getTopLeftOffset(this.wrapper).top;\r\n        if (!this.dragAndDropScrollInterval) {\r\n            this.dragAndDropScrollInterval = window.setInterval(function () {\r\n                if (_this.dragAndDropMouseY === null) {\r\n                    return;\r\n                }\r\n                var diff = _this.dragAndDropMouseY - viewTop;\r\n                var scrollDiff = 0;\r\n                var upperLimit = _this.viewHeight - 35;\r\n                if (diff < 35) {\r\n                    scrollDiff = Math.max(-14, 0.2 * (diff - 35));\r\n                }\r\n                else if (diff > upperLimit) {\r\n                    scrollDiff = Math.min(14, 0.2 * (diff - upperLimit));\r\n                }\r\n                _this.scrollTop += scrollDiff;\r\n            }, 10);\r\n            this.cancelDragAndDropScrollTimeout();\r\n            this.dragAndDropScrollTimeout = window.setTimeout(function () {\r\n                _this.cancelDragAndDropScrollInterval();\r\n                _this.dragAndDropScrollTimeout = null;\r\n            }, 1000);\r\n        }\r\n    };\r\n    TreeView.prototype.cancelDragAndDropScrollInterval = function () {\r\n        if (this.dragAndDropScrollInterval) {\r\n            window.clearInterval(this.dragAndDropScrollInterval);\r\n            this.dragAndDropScrollInterval = null;\r\n        }\r\n        this.cancelDragAndDropScrollTimeout();\r\n    };\r\n    TreeView.prototype.cancelDragAndDropScrollTimeout = function () {\r\n        if (this.dragAndDropScrollTimeout) {\r\n            window.clearTimeout(this.dragAndDropScrollTimeout);\r\n            this.dragAndDropScrollTimeout = null;\r\n        }\r\n    };\r\n    TreeView.prototype.onDragOver = function (e) {\r\n        var _this = this;\r\n        e.preventDefault(); // needed so that the drop event fires (https://stackoverflow.com/questions/21339924/drop-event-not-firing-in-chrome)\r\n        var event = new Mouse.DragMouseEvent(e);\r\n        var viewItem = this.getItemAround(event.target);\r\n        if (!viewItem || (event.posx === 0 && event.posy === 0 && event.browserEvent.type === DOM.EventType.DRAG_LEAVE)) {\r\n            // dragging outside of tree\r\n            if (this.currentDropTarget) {\r\n                // clear previously hovered element feedback\r\n                this.currentDropTargets.forEach(function (i) { return i.dropTarget = false; });\r\n                this.currentDropTargets = [];\r\n                this.currentDropDisposable.dispose();\r\n            }\r\n            this.cancelDragAndDropScrollInterval();\r\n            this.currentDropTarget = null;\r\n            this.currentDropElement = null;\r\n            this.dragAndDropMouseY = null;\r\n            return false;\r\n        }\r\n        // dragging inside the tree\r\n        this.setupDragAndDropScrollInterval();\r\n        this.dragAndDropMouseY = event.posy;\r\n        if (!this.currentDragAndDropData) {\r\n            // just started dragging\r\n            if (StaticDND.CurrentDragAndDropData) {\r\n                this.currentDragAndDropData = StaticDND.CurrentDragAndDropData;\r\n            }\r\n            else {\r\n                if (!event.dataTransfer.types) {\r\n                    return false;\r\n                }\r\n                this.currentDragAndDropData = new dnd.DesktopDragAndDropData();\r\n            }\r\n        }\r\n        this.currentDragAndDropData.update(event.browserEvent.dataTransfer);\r\n        var element;\r\n        var item = viewItem.model;\r\n        var reaction;\r\n        // check the bubble up behavior\r\n        do {\r\n            element = item ? item.getElement() : this.model.getInput();\r\n            reaction = this.context.dnd.onDragOver(this.context.tree, this.currentDragAndDropData, element, event);\r\n            if (!reaction || reaction.bubble !== 1 /* BUBBLE_UP */) {\r\n                break;\r\n            }\r\n            item = item && item.parent;\r\n        } while (item);\r\n        if (!item) {\r\n            this.currentDropElement = null;\r\n            return false;\r\n        }\r\n        var canDrop = reaction && reaction.accept;\r\n        if (canDrop) {\r\n            this.currentDropElement = item.getElement();\r\n            event.preventDefault();\r\n            event.dataTransfer.dropEffect = reaction.effect === 0 /* COPY */ ? 'copy' : 'move';\r\n        }\r\n        else {\r\n            this.currentDropElement = null;\r\n        }\r\n        // item is the model item where drop() should be called\r\n        // can be null\r\n        var currentDropTarget = item.id === this.inputItem.id ? this.inputItem : this.items[item.id];\r\n        if (this.shouldInvalidateDropReaction || this.currentDropTarget !== currentDropTarget || !reactionEquals(this.currentDropElementReaction, reaction)) {\r\n            this.shouldInvalidateDropReaction = false;\r\n            if (this.currentDropTarget) {\r\n                this.currentDropTargets.forEach(function (i) { return i.dropTarget = false; });\r\n                this.currentDropTargets = [];\r\n                this.currentDropDisposable.dispose();\r\n            }\r\n            this.currentDropTarget = currentDropTarget;\r\n            this.currentDropElementReaction = reaction;\r\n            if (canDrop) {\r\n                // setup hover feedback for drop target\r\n                if (this.currentDropTarget) {\r\n                    this.currentDropTarget.dropTarget = true;\r\n                    this.currentDropTargets.push(this.currentDropTarget);\r\n                }\r\n                if (reaction.bubble === 0 /* BUBBLE_DOWN */) {\r\n                    var nav = item.getNavigator();\r\n                    var child = void 0;\r\n                    while (child = nav.next()) {\r\n                        viewItem = this.items[child.id];\r\n                        if (viewItem) {\r\n                            viewItem.dropTarget = true;\r\n                            this.currentDropTargets.push(viewItem);\r\n                        }\r\n                    }\r\n                }\r\n                if (reaction.autoExpand) {\r\n                    var timeoutPromise_1 = timeout(500);\r\n                    this.currentDropDisposable = Lifecycle.toDisposable(function () { return timeoutPromise_1.cancel(); });\r\n                    timeoutPromise_1\r\n                        .then(function () { return _this.context.tree.expand(_this.currentDropElement); })\r\n                        .then(function () { return _this.shouldInvalidateDropReaction = true; });\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    TreeView.prototype.onDrop = function (e) {\r\n        if (this.currentDropElement) {\r\n            var event_1 = new Mouse.DragMouseEvent(e);\r\n            event_1.preventDefault();\r\n            this.currentDragAndDropData.update(event_1.browserEvent.dataTransfer);\r\n            this.context.dnd.drop(this.context.tree, this.currentDragAndDropData, this.currentDropElement, event_1);\r\n            this.onDragEnd(e);\r\n        }\r\n        this.cancelDragAndDropScrollInterval();\r\n    };\r\n    TreeView.prototype.onDragEnd = function (e) {\r\n        if (this.currentDropTarget) {\r\n            this.currentDropTargets.forEach(function (i) { return i.dropTarget = false; });\r\n            this.currentDropTargets = [];\r\n        }\r\n        this.currentDropDisposable.dispose();\r\n        this.cancelDragAndDropScrollInterval();\r\n        this.currentDragAndDropData = null;\r\n        StaticDND.CurrentDragAndDropData = undefined;\r\n        this.currentDropElement = null;\r\n        this.currentDropTarget = null;\r\n        this.dragAndDropMouseY = null;\r\n    };\r\n    TreeView.prototype.onFocus = function () {\r\n        if (!this.context.options.alwaysFocused) {\r\n            DOM.addClass(this.domNode, 'focused');\r\n        }\r\n        this._onDOMFocus.fire();\r\n    };\r\n    TreeView.prototype.onBlur = function () {\r\n        if (!this.context.options.alwaysFocused) {\r\n            DOM.removeClass(this.domNode, 'focused');\r\n        }\r\n        this.domNode.removeAttribute('aria-activedescendant'); // ARIA\r\n        this._onDOMBlur.fire();\r\n    };\r\n    // MS specific DOM Events\r\n    TreeView.prototype.onMsPointerDown = function (event) {\r\n        if (!this.msGesture) {\r\n            return;\r\n        }\r\n        // Circumvent IE11 breaking change in e.pointerType & TypeScript's stale definitions\r\n        var pointerType = event.pointerType;\r\n        if (pointerType === (event.MSPOINTER_TYPE_MOUSE || 'mouse')) {\r\n            this.lastPointerType = 'mouse';\r\n            return;\r\n        }\r\n        else if (pointerType === (event.MSPOINTER_TYPE_TOUCH || 'touch')) {\r\n            this.lastPointerType = 'touch';\r\n        }\r\n        else {\r\n            return;\r\n        }\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        this.msGesture.addPointer(event.pointerId);\r\n    };\r\n    TreeView.prototype.onThrottledMsGestureChange = function (event) {\r\n        this.scrollTop -= event.translationY;\r\n    };\r\n    TreeView.prototype.onMsGestureTap = function (event) {\r\n        event.initialTarget = document.elementFromPoint(event.clientX, event.clientY);\r\n        this.onTap(event);\r\n    };\r\n    // DOM changes\r\n    TreeView.prototype.insertItemInDOM = function (item) {\r\n        var elementAfter = null;\r\n        var itemAfter = this.itemAfter(item);\r\n        if (itemAfter && itemAfter.element) {\r\n            elementAfter = itemAfter.element;\r\n        }\r\n        item.insertInDOM(this.rowsContainer, elementAfter);\r\n    };\r\n    TreeView.prototype.removeItemFromDOM = function (item) {\r\n        if (!item) {\r\n            return;\r\n        }\r\n        item.removeFromDOM();\r\n    };\r\n    // Helpers\r\n    TreeView.prototype.shouldBeRendered = function (item) {\r\n        return item.top < this.lastRenderTop + this.lastRenderHeight && item.top + item.height > this.lastRenderTop;\r\n    };\r\n    TreeView.prototype.getItemAround = function (element) {\r\n        var candidate = this.inputItem;\r\n        var el = element;\r\n        do {\r\n            if (el[TreeView.BINDING]) {\r\n                candidate = el[TreeView.BINDING];\r\n            }\r\n            if (el === this.wrapper || el === this.domNode) {\r\n                return candidate;\r\n            }\r\n            if (el === this.scrollableElement.getDomNode() || el === document.body) {\r\n                return undefined;\r\n            }\r\n        } while (el = el.parentElement);\r\n        return undefined;\r\n    };\r\n    // Cleanup\r\n    TreeView.prototype.releaseModel = function () {\r\n        if (this.model) {\r\n            this.modelListeners = Lifecycle.dispose(this.modelListeners);\r\n            this.model = null;\r\n        }\r\n    };\r\n    TreeView.prototype.dispose = function () {\r\n        var _this = this;\r\n        // TODO@joao: improve\r\n        this.scrollableElement.dispose();\r\n        this.releaseModel();\r\n        this.viewListeners = Lifecycle.dispose(this.viewListeners);\r\n        this._onDOMFocus.dispose();\r\n        this._onDOMBlur.dispose();\r\n        if (this.domNode.parentNode) {\r\n            this.domNode.parentNode.removeChild(this.domNode);\r\n        }\r\n        if (this.items) {\r\n            Object.keys(this.items).forEach(function (key) { return _this.items[key].removeFromDOM(); });\r\n        }\r\n        if (this.context.cache) {\r\n            this.context.cache.dispose();\r\n        }\r\n        this.gestureDisposable.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    TreeView.BINDING = 'monaco-tree-row';\r\n    TreeView.LOADING_DECORATION_DELAY = 800;\r\n    TreeView.counter = 0;\r\n    return TreeView;\r\n}(HeightMap));\r\nexport { TreeView };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './tree.css';\r\nimport * as TreeDefaults from './treeDefaults.js';\r\nimport * as Model from './treeModel.js';\r\nimport * as View from './treeView.js';\r\nimport { Emitter, Relay } from '../../../common/event.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nvar TreeContext = /** @class */ (function () {\r\n    function TreeContext(tree, configuration, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.tree = tree;\r\n        this.configuration = configuration;\r\n        this.options = options;\r\n        if (!configuration.dataSource) {\r\n            throw new Error('You must provide a Data Source to the tree.');\r\n        }\r\n        this.dataSource = configuration.dataSource;\r\n        this.renderer = configuration.renderer;\r\n        this.controller = configuration.controller || new TreeDefaults.DefaultController({ clickBehavior: 1 /* ON_MOUSE_UP */, keyboardSupport: typeof options.keyboardSupport !== 'boolean' || options.keyboardSupport });\r\n        this.dnd = configuration.dnd || new TreeDefaults.DefaultDragAndDrop();\r\n        this.filter = configuration.filter || new TreeDefaults.DefaultFilter();\r\n        this.sorter = configuration.sorter;\r\n        this.accessibilityProvider = configuration.accessibilityProvider || new TreeDefaults.DefaultAccessibilityProvider();\r\n        this.styler = configuration.styler;\r\n    }\r\n    return TreeContext;\r\n}());\r\nexport { TreeContext };\r\nvar defaultStyles = {\r\n    listFocusBackground: Color.fromHex('#073655'),\r\n    listActiveSelectionBackground: Color.fromHex('#0E639C'),\r\n    listActiveSelectionForeground: Color.fromHex('#FFFFFF'),\r\n    listFocusAndSelectionBackground: Color.fromHex('#094771'),\r\n    listFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\r\n    listInactiveSelectionBackground: Color.fromHex('#3F3F46'),\r\n    listHoverBackground: Color.fromHex('#2A2D2E'),\r\n    listDropBackground: Color.fromHex('#383B3D')\r\n};\r\nvar Tree = /** @class */ (function () {\r\n    function Tree(container, configuration, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this._onDidChangeFocus = new Relay();\r\n        this.onDidChangeFocus = this._onDidChangeFocus.event;\r\n        this._onDidChangeSelection = new Relay();\r\n        this.onDidChangeSelection = this._onDidChangeSelection.event;\r\n        this._onHighlightChange = new Relay();\r\n        this._onDidExpandItem = new Relay();\r\n        this._onDidCollapseItem = new Relay();\r\n        this._onDispose = new Emitter();\r\n        this.onDidDispose = this._onDispose.event;\r\n        this.container = container;\r\n        mixin(options, defaultStyles, false);\r\n        options.twistiePixels = typeof options.twistiePixels === 'number' ? options.twistiePixels : 32;\r\n        options.showTwistie = options.showTwistie === false ? false : true;\r\n        options.indentPixels = typeof options.indentPixels === 'number' ? options.indentPixels : 12;\r\n        options.alwaysFocused = options.alwaysFocused === true ? true : false;\r\n        options.useShadows = options.useShadows === false ? false : true;\r\n        options.paddingOnRow = options.paddingOnRow === false ? false : true;\r\n        options.showLoading = options.showLoading === false ? false : true;\r\n        this.context = new TreeContext(this, configuration, options);\r\n        this.model = new Model.TreeModel(this.context);\r\n        this.view = new View.TreeView(this.context, this.container);\r\n        this.view.setModel(this.model);\r\n        this._onDidChangeFocus.input = this.model.onDidFocus;\r\n        this._onDidChangeSelection.input = this.model.onDidSelect;\r\n        this._onHighlightChange.input = this.model.onDidHighlight;\r\n        this._onDidExpandItem.input = this.model.onDidExpandItem;\r\n        this._onDidCollapseItem.input = this.model.onDidCollapseItem;\r\n    }\r\n    Tree.prototype.style = function (styles) {\r\n        this.view.applyStyles(styles);\r\n    };\r\n    Object.defineProperty(Tree.prototype, \"onDidFocus\", {\r\n        get: function () {\r\n            return this.view.onDOMFocus;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Tree.prototype.getHTMLElement = function () {\r\n        return this.view.getHTMLElement();\r\n    };\r\n    Tree.prototype.layout = function (height, width) {\r\n        this.view.layout(height, width);\r\n    };\r\n    Tree.prototype.domFocus = function () {\r\n        this.view.focus();\r\n    };\r\n    Tree.prototype.isDOMFocused = function () {\r\n        return this.view.isFocused();\r\n    };\r\n    Tree.prototype.domBlur = function () {\r\n        this.view.blur();\r\n    };\r\n    Tree.prototype.setInput = function (element) {\r\n        return this.model.setInput(element);\r\n    };\r\n    Tree.prototype.getInput = function () {\r\n        return this.model.getInput();\r\n    };\r\n    Tree.prototype.expand = function (element) {\r\n        return this.model.expand(element);\r\n    };\r\n    Tree.prototype.collapse = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        return this.model.collapse(element, recursive);\r\n    };\r\n    Tree.prototype.toggleExpansion = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        return this.model.toggleExpansion(element, recursive);\r\n    };\r\n    Tree.prototype.isExpanded = function (element) {\r\n        return this.model.isExpanded(element);\r\n    };\r\n    Tree.prototype.reveal = function (element, relativeTop) {\r\n        if (relativeTop === void 0) { relativeTop = null; }\r\n        return this.model.reveal(element, relativeTop);\r\n    };\r\n    Tree.prototype.getHighlight = function () {\r\n        return this.model.getHighlight();\r\n    };\r\n    Tree.prototype.clearHighlight = function (eventPayload) {\r\n        this.model.setHighlight(null, eventPayload);\r\n    };\r\n    Tree.prototype.setSelection = function (elements, eventPayload) {\r\n        this.model.setSelection(elements, eventPayload);\r\n    };\r\n    Tree.prototype.getSelection = function () {\r\n        return this.model.getSelection();\r\n    };\r\n    Tree.prototype.clearSelection = function (eventPayload) {\r\n        this.model.setSelection([], eventPayload);\r\n    };\r\n    Tree.prototype.setFocus = function (element, eventPayload) {\r\n        this.model.setFocus(element, eventPayload);\r\n    };\r\n    Tree.prototype.getFocus = function () {\r\n        return this.model.getFocus();\r\n    };\r\n    Tree.prototype.focusNext = function (count, eventPayload) {\r\n        this.model.focusNext(count, eventPayload);\r\n    };\r\n    Tree.prototype.focusPrevious = function (count, eventPayload) {\r\n        this.model.focusPrevious(count, eventPayload);\r\n    };\r\n    Tree.prototype.focusParent = function (eventPayload) {\r\n        this.model.focusParent(eventPayload);\r\n    };\r\n    Tree.prototype.focusFirstChild = function (eventPayload) {\r\n        this.model.focusFirstChild(eventPayload);\r\n    };\r\n    Tree.prototype.focusFirst = function (eventPayload, from) {\r\n        this.model.focusFirst(eventPayload, from);\r\n    };\r\n    Tree.prototype.focusNth = function (index, eventPayload) {\r\n        this.model.focusNth(index, eventPayload);\r\n    };\r\n    Tree.prototype.focusLast = function (eventPayload, from) {\r\n        this.model.focusLast(eventPayload, from);\r\n    };\r\n    Tree.prototype.focusNextPage = function (eventPayload) {\r\n        this.view.focusNextPage(eventPayload);\r\n    };\r\n    Tree.prototype.focusPreviousPage = function (eventPayload) {\r\n        this.view.focusPreviousPage(eventPayload);\r\n    };\r\n    Tree.prototype.clearFocus = function (eventPayload) {\r\n        this.model.setFocus(null, eventPayload);\r\n    };\r\n    Tree.prototype.dispose = function () {\r\n        this._onDispose.fire();\r\n        this.model.dispose();\r\n        this.view.dispose();\r\n        this._onDidChangeFocus.dispose();\r\n        this._onDidChangeSelection.dispose();\r\n        this._onHighlightChange.dispose();\r\n        this._onDidExpandItem.dispose();\r\n        this._onDidCollapseItem.dispose();\r\n        this._onDispose.dispose();\r\n    };\r\n    return Tree;\r\n}());\r\nexport { Tree };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './progressbar.css';\r\nimport { Disposable } from '../../../common/lifecycle.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nimport { removeClasses, addClass, hasClass, hide, show } from '../../dom.js';\r\nimport { RunOnceScheduler } from '../../../common/async.js';\r\nvar css_done = 'done';\r\nvar css_active = 'active';\r\nvar css_infinite = 'infinite';\r\nvar css_discrete = 'discrete';\r\nvar css_progress_container = 'monaco-progress-container';\r\nvar css_progress_bit = 'progress-bit';\r\nvar defaultOpts = {\r\n    progressBarBackground: Color.fromHex('#0E70C0')\r\n};\r\n/**\r\n * A progress bar with support for infinite or discrete progress.\r\n */\r\nvar ProgressBar = /** @class */ (function (_super) {\r\n    __extends(ProgressBar, _super);\r\n    function ProgressBar(container, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this.options = options || Object.create(null);\r\n        mixin(_this.options, defaultOpts, false);\r\n        _this.workedVal = 0;\r\n        _this.progressBarBackground = _this.options.progressBarBackground;\r\n        _this._register(_this.showDelayedScheduler = new RunOnceScheduler(function () { return show(_this.element); }, 0));\r\n        _this.create(container);\r\n        return _this;\r\n    }\r\n    ProgressBar.prototype.create = function (container) {\r\n        this.element = document.createElement('div');\r\n        addClass(this.element, css_progress_container);\r\n        container.appendChild(this.element);\r\n        this.bit = document.createElement('div');\r\n        addClass(this.bit, css_progress_bit);\r\n        this.element.appendChild(this.bit);\r\n        this.applyStyles();\r\n    };\r\n    ProgressBar.prototype.off = function () {\r\n        this.bit.style.width = 'inherit';\r\n        this.bit.style.opacity = '1';\r\n        removeClasses(this.element, css_active, css_infinite, css_discrete);\r\n        this.workedVal = 0;\r\n        this.totalWork = undefined;\r\n    };\r\n    /**\r\n     * Stops the progressbar from showing any progress instantly without fading out.\r\n     */\r\n    ProgressBar.prototype.stop = function () {\r\n        return this.doDone(false);\r\n    };\r\n    ProgressBar.prototype.doDone = function (delayed) {\r\n        var _this = this;\r\n        addClass(this.element, css_done);\r\n        // let it grow to 100% width and hide afterwards\r\n        if (!hasClass(this.element, css_infinite)) {\r\n            this.bit.style.width = 'inherit';\r\n            if (delayed) {\r\n                setTimeout(function () { return _this.off(); }, 200);\r\n            }\r\n            else {\r\n                this.off();\r\n            }\r\n        }\r\n        // let it fade out and hide afterwards\r\n        else {\r\n            this.bit.style.opacity = '0';\r\n            if (delayed) {\r\n                setTimeout(function () { return _this.off(); }, 200);\r\n            }\r\n            else {\r\n                this.off();\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    ProgressBar.prototype.hide = function () {\r\n        hide(this.element);\r\n        this.showDelayedScheduler.cancel();\r\n    };\r\n    ProgressBar.prototype.style = function (styles) {\r\n        this.progressBarBackground = styles.progressBarBackground;\r\n        this.applyStyles();\r\n    };\r\n    ProgressBar.prototype.applyStyles = function () {\r\n        if (this.bit) {\r\n            var background = this.progressBarBackground ? this.progressBarBackground.toString() : '';\r\n            this.bit.style.backgroundColor = background;\r\n        }\r\n    };\r\n    return ProgressBar;\r\n}(Disposable));\r\nexport { ProgressBar };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './quickopen.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as platform from '../../../common/platform.js';\r\nimport * as types from '../../../common/types.js';\r\nimport { Filter, Renderer, DataSource, AccessibilityProvider } from './quickOpenViewer.js';\r\nimport { InputBox } from '../../../browser/ui/inputbox/inputBox.js';\r\nimport { Tree } from '../../tree/browser/treeImpl.js';\r\nimport { ProgressBar } from '../../../browser/ui/progressbar/progressbar.js';\r\nimport { StandardKeyboardEvent } from '../../../browser/keyboardEvent.js';\r\nimport { DefaultController } from '../../tree/browser/treeDefaults.js';\r\nimport * as DOM from '../../../browser/dom.js';\r\nimport { Disposable } from '../../../common/lifecycle.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nimport { StandardMouseEvent } from '../../../browser/mouseEvent.js';\r\nvar QuickOpenController = /** @class */ (function (_super) {\r\n    __extends(QuickOpenController, _super);\r\n    function QuickOpenController() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    QuickOpenController.prototype.onContextMenu = function (tree, element, event) {\r\n        if (platform.isMacintosh) {\r\n            return this.onLeftClick(tree, element, event); // https://github.com/Microsoft/vscode/issues/1011\r\n        }\r\n        return _super.prototype.onContextMenu.call(this, tree, element, event);\r\n    };\r\n    return QuickOpenController;\r\n}(DefaultController));\r\nexport { QuickOpenController };\r\nvar defaultStyles = {\r\n    background: Color.fromHex('#1E1E1E'),\r\n    foreground: Color.fromHex('#CCCCCC'),\r\n    pickerGroupForeground: Color.fromHex('#0097FB'),\r\n    pickerGroupBorder: Color.fromHex('#3F3F46'),\r\n    widgetShadow: Color.fromHex('#000000'),\r\n    progressBarBackground: Color.fromHex('#0E70C0')\r\n};\r\nvar DEFAULT_INPUT_ARIA_LABEL = nls.localize('quickOpenAriaLabel', \"Quick picker. Type to narrow down results.\");\r\nvar QuickOpenWidget = /** @class */ (function (_super) {\r\n    __extends(QuickOpenWidget, _super);\r\n    function QuickOpenWidget(container, callbacks, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this.isDisposed = false;\r\n        _this.container = container;\r\n        _this.callbacks = callbacks;\r\n        _this.options = options;\r\n        _this.styles = options || Object.create(null);\r\n        mixin(_this.styles, defaultStyles, false);\r\n        _this.model = null;\r\n        return _this;\r\n    }\r\n    QuickOpenWidget.prototype.getModel = function () {\r\n        return this.model;\r\n    };\r\n    QuickOpenWidget.prototype.create = function () {\r\n        var _this = this;\r\n        // Container\r\n        this.element = document.createElement('div');\r\n        DOM.addClass(this.element, 'monaco-quick-open-widget');\r\n        this.container.appendChild(this.element);\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.CONTEXT_MENU, function (e) { return DOM.EventHelper.stop(e, true); })); // Do this to fix an issue on Mac where the menu goes into the way\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.FOCUS, function (e) { return _this.gainingFocus(); }, true));\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.BLUR, function (e) { return _this.loosingFocus(e); }, true));\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.KEY_DOWN, function (e) {\r\n            var keyboardEvent = new StandardKeyboardEvent(e);\r\n            if (keyboardEvent.keyCode === 9 /* Escape */) {\r\n                DOM.EventHelper.stop(e, true);\r\n                _this.hide(2 /* CANCELED */);\r\n            }\r\n            else if (keyboardEvent.keyCode === 2 /* Tab */ && !keyboardEvent.altKey && !keyboardEvent.ctrlKey && !keyboardEvent.metaKey) {\r\n                var stops = e.currentTarget.querySelectorAll('input, .monaco-tree, .monaco-tree-row.focused .action-label.icon');\r\n                if (keyboardEvent.shiftKey && keyboardEvent.target === stops[0]) {\r\n                    DOM.EventHelper.stop(e, true);\r\n                    stops[stops.length - 1].focus();\r\n                }\r\n                else if (!keyboardEvent.shiftKey && keyboardEvent.target === stops[stops.length - 1]) {\r\n                    DOM.EventHelper.stop(e, true);\r\n                    stops[0].focus();\r\n                }\r\n            }\r\n        }));\r\n        // Progress Bar\r\n        this.progressBar = this._register(new ProgressBar(this.element, { progressBarBackground: this.styles.progressBarBackground }));\r\n        this.progressBar.hide();\r\n        // Input Field\r\n        this.inputContainer = document.createElement('div');\r\n        DOM.addClass(this.inputContainer, 'quick-open-input');\r\n        this.element.appendChild(this.inputContainer);\r\n        this.inputBox = this._register(new InputBox(this.inputContainer, undefined, {\r\n            placeholder: this.options.inputPlaceHolder || '',\r\n            ariaLabel: DEFAULT_INPUT_ARIA_LABEL,\r\n            inputBackground: this.styles.inputBackground,\r\n            inputForeground: this.styles.inputForeground,\r\n            inputBorder: this.styles.inputBorder,\r\n            inputValidationInfoBackground: this.styles.inputValidationInfoBackground,\r\n            inputValidationInfoForeground: this.styles.inputValidationInfoForeground,\r\n            inputValidationInfoBorder: this.styles.inputValidationInfoBorder,\r\n            inputValidationWarningBackground: this.styles.inputValidationWarningBackground,\r\n            inputValidationWarningForeground: this.styles.inputValidationWarningForeground,\r\n            inputValidationWarningBorder: this.styles.inputValidationWarningBorder,\r\n            inputValidationErrorBackground: this.styles.inputValidationErrorBackground,\r\n            inputValidationErrorForeground: this.styles.inputValidationErrorForeground,\r\n            inputValidationErrorBorder: this.styles.inputValidationErrorBorder\r\n        }));\r\n        this.inputElement = this.inputBox.inputElement;\r\n        this.inputElement.setAttribute('role', 'combobox');\r\n        this.inputElement.setAttribute('aria-haspopup', 'false');\r\n        this.inputElement.setAttribute('aria-autocomplete', 'list');\r\n        this._register(DOM.addDisposableListener(this.inputBox.inputElement, DOM.EventType.INPUT, function (e) { return _this.onType(); }));\r\n        this._register(DOM.addDisposableListener(this.inputBox.inputElement, DOM.EventType.KEY_DOWN, function (e) {\r\n            var keyboardEvent = new StandardKeyboardEvent(e);\r\n            var shouldOpenInBackground = _this.shouldOpenInBackground(keyboardEvent);\r\n            // Do not handle Tab: It is used to navigate between elements without mouse\r\n            if (keyboardEvent.keyCode === 2 /* Tab */) {\r\n                return;\r\n            }\r\n            // Pass tree navigation keys to the tree but leave focus in input field\r\n            else if (keyboardEvent.keyCode === 18 /* DownArrow */ || keyboardEvent.keyCode === 16 /* UpArrow */ || keyboardEvent.keyCode === 12 /* PageDown */ || keyboardEvent.keyCode === 11 /* PageUp */) {\r\n                DOM.EventHelper.stop(e, true);\r\n                _this.navigateInTree(keyboardEvent.keyCode, keyboardEvent.shiftKey);\r\n                // Position cursor at the end of input to allow right arrow (open in background)\r\n                // to function immediately unless the user has made a selection\r\n                if (_this.inputBox.inputElement.selectionStart === _this.inputBox.inputElement.selectionEnd) {\r\n                    _this.inputBox.inputElement.selectionStart = _this.inputBox.value.length;\r\n                }\r\n            }\r\n            // Select element on Enter or on Arrow-Right if we are at the end of the input\r\n            else if (keyboardEvent.keyCode === 3 /* Enter */ || shouldOpenInBackground) {\r\n                DOM.EventHelper.stop(e, true);\r\n                var focus_1 = _this.tree.getFocus();\r\n                if (focus_1) {\r\n                    _this.elementSelected(focus_1, e, shouldOpenInBackground ? 2 /* OPEN_IN_BACKGROUND */ : 1 /* OPEN */);\r\n                }\r\n            }\r\n        }));\r\n        // Result count for screen readers\r\n        this.resultCount = document.createElement('div');\r\n        DOM.addClass(this.resultCount, 'quick-open-result-count');\r\n        this.resultCount.setAttribute('aria-live', 'polite');\r\n        this.resultCount.setAttribute('aria-atomic', 'true');\r\n        this.element.appendChild(this.resultCount);\r\n        // Tree\r\n        this.treeContainer = document.createElement('div');\r\n        DOM.addClass(this.treeContainer, 'quick-open-tree');\r\n        this.element.appendChild(this.treeContainer);\r\n        var createTree = this.options.treeCreator || (function (container, config, opts) { return new Tree(container, config, opts); });\r\n        this.tree = this._register(createTree(this.treeContainer, {\r\n            dataSource: new DataSource(this),\r\n            controller: new QuickOpenController({ clickBehavior: 1 /* ON_MOUSE_UP */, keyboardSupport: this.options.keyboardSupport }),\r\n            renderer: (this.renderer = new Renderer(this, this.styles)),\r\n            filter: new Filter(this),\r\n            accessibilityProvider: new AccessibilityProvider(this)\r\n        }, {\r\n            twistiePixels: 11,\r\n            indentPixels: 0,\r\n            alwaysFocused: true,\r\n            verticalScrollMode: 3 /* Visible */,\r\n            horizontalScrollMode: 2 /* Hidden */,\r\n            ariaLabel: nls.localize('treeAriaLabel', \"Quick Picker\"),\r\n            keyboardSupport: this.options.keyboardSupport,\r\n            preventRootFocus: false\r\n        }));\r\n        this.treeElement = this.tree.getHTMLElement();\r\n        // Handle Focus and Selection event\r\n        this._register(this.tree.onDidChangeFocus(function (event) {\r\n            _this.elementFocused(event.focus, event);\r\n        }));\r\n        this._register(this.tree.onDidChangeSelection(function (event) {\r\n            if (event.selection && event.selection.length > 0) {\r\n                var mouseEvent = event.payload && event.payload.originalEvent instanceof StandardMouseEvent ? event.payload.originalEvent : undefined;\r\n                var shouldOpenInBackground = mouseEvent ? _this.shouldOpenInBackground(mouseEvent) : false;\r\n                _this.elementSelected(event.selection[0], event, shouldOpenInBackground ? 2 /* OPEN_IN_BACKGROUND */ : 1 /* OPEN */);\r\n            }\r\n        }));\r\n        this._register(DOM.addDisposableListener(this.treeContainer, DOM.EventType.KEY_DOWN, function (e) {\r\n            var keyboardEvent = new StandardKeyboardEvent(e);\r\n            // Only handle when in quick navigation mode\r\n            if (!_this.quickNavigateConfiguration) {\r\n                return;\r\n            }\r\n            // Support keyboard navigation in quick navigation mode\r\n            if (keyboardEvent.keyCode === 18 /* DownArrow */ || keyboardEvent.keyCode === 16 /* UpArrow */ || keyboardEvent.keyCode === 12 /* PageDown */ || keyboardEvent.keyCode === 11 /* PageUp */) {\r\n                DOM.EventHelper.stop(e, true);\r\n                _this.navigateInTree(keyboardEvent.keyCode);\r\n            }\r\n            // Support to open item with Enter still even in quick nav mode\r\n            else if (keyboardEvent.keyCode === 3 /* Enter */) {\r\n                DOM.EventHelper.stop(e, true);\r\n                var focus_2 = _this.tree.getFocus();\r\n                if (focus_2) {\r\n                    _this.elementSelected(focus_2, e);\r\n                }\r\n            }\r\n        }));\r\n        this._register(DOM.addDisposableListener(this.treeContainer, DOM.EventType.KEY_UP, function (e) {\r\n            var keyboardEvent = new StandardKeyboardEvent(e);\r\n            var keyCode = keyboardEvent.keyCode;\r\n            // Only handle when in quick navigation mode\r\n            if (!_this.quickNavigateConfiguration) {\r\n                return;\r\n            }\r\n            // Select element when keys are pressed that signal it\r\n            var quickNavKeys = _this.quickNavigateConfiguration.keybindings;\r\n            var wasTriggerKeyPressed = quickNavKeys.some(function (k) {\r\n                var _a = k.getParts(), firstPart = _a[0], chordPart = _a[1];\r\n                if (chordPart) {\r\n                    return false;\r\n                }\r\n                if (firstPart.shiftKey && keyCode === 4 /* Shift */) {\r\n                    if (keyboardEvent.ctrlKey || keyboardEvent.altKey || keyboardEvent.metaKey) {\r\n                        return false; // this is an optimistic check for the shift key being used to navigate back in quick open\r\n                    }\r\n                    return true;\r\n                }\r\n                if (firstPart.altKey && keyCode === 6 /* Alt */) {\r\n                    return true;\r\n                }\r\n                if (firstPart.ctrlKey && keyCode === 5 /* Ctrl */) {\r\n                    return true;\r\n                }\r\n                if (firstPart.metaKey && keyCode === 57 /* Meta */) {\r\n                    return true;\r\n                }\r\n                return false;\r\n            });\r\n            if (wasTriggerKeyPressed) {\r\n                var focus_3 = _this.tree.getFocus();\r\n                if (focus_3) {\r\n                    _this.elementSelected(focus_3, e);\r\n                }\r\n            }\r\n        }));\r\n        // Support layout\r\n        if (this.layoutDimensions) {\r\n            this.layout(this.layoutDimensions);\r\n        }\r\n        this.applyStyles();\r\n        // Allows focus to switch to next/previous entry after tab into an actionbar item\r\n        this._register(DOM.addDisposableListener(this.treeContainer, DOM.EventType.KEY_DOWN, function (e) {\r\n            var keyboardEvent = new StandardKeyboardEvent(e);\r\n            // Only handle when not in quick navigation mode\r\n            if (_this.quickNavigateConfiguration) {\r\n                return;\r\n            }\r\n            if (keyboardEvent.keyCode === 18 /* DownArrow */ || keyboardEvent.keyCode === 16 /* UpArrow */ || keyboardEvent.keyCode === 12 /* PageDown */ || keyboardEvent.keyCode === 11 /* PageUp */) {\r\n                DOM.EventHelper.stop(e, true);\r\n                _this.navigateInTree(keyboardEvent.keyCode, keyboardEvent.shiftKey);\r\n                _this.treeElement.focus();\r\n            }\r\n        }));\r\n        return this.element;\r\n    };\r\n    QuickOpenWidget.prototype.style = function (styles) {\r\n        this.styles = styles;\r\n        this.applyStyles();\r\n    };\r\n    QuickOpenWidget.prototype.applyStyles = function () {\r\n        if (this.element) {\r\n            var foreground = this.styles.foreground ? this.styles.foreground.toString() : null;\r\n            var background = this.styles.background ? this.styles.background.toString() : '';\r\n            var borderColor = this.styles.borderColor ? this.styles.borderColor.toString() : '';\r\n            var widgetShadow = this.styles.widgetShadow ? this.styles.widgetShadow.toString() : '';\r\n            this.element.style.color = foreground;\r\n            this.element.style.backgroundColor = background;\r\n            this.element.style.borderColor = borderColor;\r\n            this.element.style.borderWidth = borderColor ? '1px' : '';\r\n            this.element.style.borderStyle = borderColor ? 'solid' : '';\r\n            this.element.style.boxShadow = widgetShadow ? \"0 5px 8px \" + widgetShadow : '';\r\n        }\r\n        if (this.progressBar) {\r\n            this.progressBar.style({\r\n                progressBarBackground: this.styles.progressBarBackground\r\n            });\r\n        }\r\n        if (this.inputBox) {\r\n            this.inputBox.style({\r\n                inputBackground: this.styles.inputBackground,\r\n                inputForeground: this.styles.inputForeground,\r\n                inputBorder: this.styles.inputBorder,\r\n                inputValidationInfoBackground: this.styles.inputValidationInfoBackground,\r\n                inputValidationInfoForeground: this.styles.inputValidationInfoForeground,\r\n                inputValidationInfoBorder: this.styles.inputValidationInfoBorder,\r\n                inputValidationWarningBackground: this.styles.inputValidationWarningBackground,\r\n                inputValidationWarningForeground: this.styles.inputValidationWarningForeground,\r\n                inputValidationWarningBorder: this.styles.inputValidationWarningBorder,\r\n                inputValidationErrorBackground: this.styles.inputValidationErrorBackground,\r\n                inputValidationErrorForeground: this.styles.inputValidationErrorForeground,\r\n                inputValidationErrorBorder: this.styles.inputValidationErrorBorder\r\n            });\r\n        }\r\n        if (this.tree && !this.options.treeCreator) {\r\n            this.tree.style(this.styles);\r\n        }\r\n        if (this.renderer) {\r\n            this.renderer.updateStyles(this.styles);\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.shouldOpenInBackground = function (e) {\r\n        // Keyboard\r\n        if (e instanceof StandardKeyboardEvent) {\r\n            if (e.keyCode !== 17 /* RightArrow */) {\r\n                return false; // only for right arrow\r\n            }\r\n            if (e.metaKey || e.ctrlKey || e.shiftKey || e.altKey) {\r\n                return false; // no modifiers allowed\r\n            }\r\n            // validate the cursor is at the end of the input and there is no selection,\r\n            // and if not prevent opening in the background such as the selection can be changed\r\n            var element = this.inputBox.inputElement;\r\n            return element.selectionEnd === this.inputBox.value.length && element.selectionStart === element.selectionEnd;\r\n        }\r\n        // Mouse\r\n        return e.middleButton;\r\n    };\r\n    QuickOpenWidget.prototype.onType = function () {\r\n        var value = this.inputBox.value;\r\n        // Adjust help text as needed if present\r\n        if (this.helpText) {\r\n            if (value) {\r\n                DOM.hide(this.helpText);\r\n            }\r\n            else {\r\n                DOM.show(this.helpText);\r\n            }\r\n        }\r\n        // Send to callbacks\r\n        this.callbacks.onType(value);\r\n    };\r\n    QuickOpenWidget.prototype.navigateInTree = function (keyCode, isShift) {\r\n        var model = this.tree.getInput();\r\n        var entries = model ? model.entries : [];\r\n        var oldFocus = this.tree.getFocus();\r\n        // Normal Navigation\r\n        switch (keyCode) {\r\n            case 18 /* DownArrow */:\r\n                this.tree.focusNext();\r\n                break;\r\n            case 16 /* UpArrow */:\r\n                this.tree.focusPrevious();\r\n                break;\r\n            case 12 /* PageDown */:\r\n                this.tree.focusNextPage();\r\n                break;\r\n            case 11 /* PageUp */:\r\n                this.tree.focusPreviousPage();\r\n                break;\r\n            case 2 /* Tab */:\r\n                if (isShift) {\r\n                    this.tree.focusPrevious();\r\n                }\r\n                else {\r\n                    this.tree.focusNext();\r\n                }\r\n                break;\r\n        }\r\n        var newFocus = this.tree.getFocus();\r\n        // Support cycle-through navigation if focus did not change\r\n        if (entries.length > 1 && oldFocus === newFocus) {\r\n            // Up from no entry or first entry goes down to last\r\n            if (keyCode === 16 /* UpArrow */ || (keyCode === 2 /* Tab */ && isShift)) {\r\n                this.tree.focusLast();\r\n            }\r\n            // Down from last entry goes to up to first\r\n            else if (keyCode === 18 /* DownArrow */ || keyCode === 2 /* Tab */ && !isShift) {\r\n                this.tree.focusFirst();\r\n            }\r\n        }\r\n        // Reveal\r\n        newFocus = this.tree.getFocus();\r\n        if (newFocus) {\r\n            this.tree.reveal(newFocus);\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.elementFocused = function (value, event) {\r\n        if (!value || !this.isVisible()) {\r\n            return;\r\n        }\r\n        // ARIA\r\n        var arivaActiveDescendant = this.treeElement.getAttribute('aria-activedescendant');\r\n        if (arivaActiveDescendant) {\r\n            this.inputElement.setAttribute('aria-activedescendant', arivaActiveDescendant);\r\n        }\r\n        else {\r\n            this.inputElement.removeAttribute('aria-activedescendant');\r\n        }\r\n        var context = { event: event, keymods: this.extractKeyMods(event), quickNavigateConfiguration: this.quickNavigateConfiguration };\r\n        this.model.runner.run(value, 0 /* PREVIEW */, context);\r\n    };\r\n    QuickOpenWidget.prototype.elementSelected = function (value, event, preferredMode) {\r\n        var hide = true;\r\n        // Trigger open of element on selection\r\n        if (this.isVisible()) {\r\n            var mode = preferredMode || 1 /* OPEN */;\r\n            var context = { event: event, keymods: this.extractKeyMods(event), quickNavigateConfiguration: this.quickNavigateConfiguration };\r\n            hide = this.model.runner.run(value, mode, context);\r\n        }\r\n        // Hide if command was run successfully\r\n        if (hide) {\r\n            this.hide(0 /* ELEMENT_SELECTED */);\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.extractKeyMods = function (event) {\r\n        return {\r\n            ctrlCmd: event && (event.ctrlKey || event.metaKey || (event.payload && event.payload.originalEvent && (event.payload.originalEvent.ctrlKey || event.payload.originalEvent.metaKey))),\r\n            alt: event && (event.altKey || (event.payload && event.payload.originalEvent && event.payload.originalEvent.altKey))\r\n        };\r\n    };\r\n    QuickOpenWidget.prototype.show = function (param, options) {\r\n        this.visible = true;\r\n        this.isLoosingFocus = false;\r\n        this.quickNavigateConfiguration = options ? options.quickNavigateConfiguration : undefined;\r\n        // Adjust UI for quick navigate mode\r\n        if (this.quickNavigateConfiguration) {\r\n            DOM.hide(this.inputContainer);\r\n            DOM.show(this.element);\r\n            this.tree.domFocus();\r\n        }\r\n        // Otherwise use normal UI\r\n        else {\r\n            DOM.show(this.inputContainer);\r\n            DOM.show(this.element);\r\n            this.inputBox.focus();\r\n        }\r\n        // Adjust Help text for IE\r\n        if (this.helpText) {\r\n            if (this.quickNavigateConfiguration || types.isString(param)) {\r\n                DOM.hide(this.helpText);\r\n            }\r\n            else {\r\n                DOM.show(this.helpText);\r\n            }\r\n        }\r\n        // Show based on param\r\n        if (types.isString(param)) {\r\n            this.doShowWithPrefix(param);\r\n        }\r\n        else {\r\n            if (options && options.value) {\r\n                this.restoreLastInput(options.value);\r\n            }\r\n            this.doShowWithInput(param, options && options.autoFocus ? options.autoFocus : {});\r\n        }\r\n        // Respect selectAll option\r\n        if (options && options.inputSelection && !this.quickNavigateConfiguration) {\r\n            this.inputBox.select(options.inputSelection);\r\n        }\r\n        if (this.callbacks.onShow) {\r\n            this.callbacks.onShow();\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.restoreLastInput = function (lastInput) {\r\n        this.inputBox.value = lastInput;\r\n        this.inputBox.select();\r\n        this.callbacks.onType(lastInput);\r\n    };\r\n    QuickOpenWidget.prototype.doShowWithPrefix = function (prefix) {\r\n        this.inputBox.value = prefix;\r\n        this.callbacks.onType(prefix);\r\n    };\r\n    QuickOpenWidget.prototype.doShowWithInput = function (input, autoFocus) {\r\n        this.setInput(input, autoFocus);\r\n    };\r\n    QuickOpenWidget.prototype.setInputAndLayout = function (input, autoFocus) {\r\n        var _this = this;\r\n        this.treeContainer.style.height = this.getHeight(input) + \"px\";\r\n        this.tree.setInput(null).then(function () {\r\n            _this.model = input;\r\n            // ARIA\r\n            _this.inputElement.setAttribute('aria-haspopup', String(input && input.entries && input.entries.length > 0));\r\n            return _this.tree.setInput(input);\r\n        }).then(function () {\r\n            // Indicate entries to tree\r\n            _this.tree.layout();\r\n            var entries = input ? input.entries.filter(function (e) { return _this.isElementVisible(input, e); }) : [];\r\n            _this.updateResultCount(entries.length);\r\n            // Handle auto focus\r\n            if (entries.length) {\r\n                _this.autoFocus(input, entries, autoFocus);\r\n            }\r\n        });\r\n    };\r\n    QuickOpenWidget.prototype.isElementVisible = function (input, e) {\r\n        if (!input.filter) {\r\n            return true;\r\n        }\r\n        return input.filter.isVisible(e);\r\n    };\r\n    QuickOpenWidget.prototype.autoFocus = function (input, entries, autoFocus) {\r\n        if (autoFocus === void 0) { autoFocus = {}; }\r\n        // First check for auto focus of prefix matches\r\n        if (autoFocus.autoFocusPrefixMatch) {\r\n            var caseSensitiveMatch = void 0;\r\n            var caseInsensitiveMatch = void 0;\r\n            var prefix = autoFocus.autoFocusPrefixMatch;\r\n            var lowerCasePrefix = prefix.toLowerCase();\r\n            for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\r\n                var entry = entries_1[_i];\r\n                var label = input.dataSource.getLabel(entry) || '';\r\n                if (!caseSensitiveMatch && label.indexOf(prefix) === 0) {\r\n                    caseSensitiveMatch = entry;\r\n                }\r\n                else if (!caseInsensitiveMatch && label.toLowerCase().indexOf(lowerCasePrefix) === 0) {\r\n                    caseInsensitiveMatch = entry;\r\n                }\r\n                if (caseSensitiveMatch && caseInsensitiveMatch) {\r\n                    break;\r\n                }\r\n            }\r\n            var entryToFocus = caseSensitiveMatch || caseInsensitiveMatch;\r\n            if (entryToFocus) {\r\n                this.tree.setFocus(entryToFocus);\r\n                this.tree.reveal(entryToFocus, 0.5);\r\n                return;\r\n            }\r\n        }\r\n        // Second check for auto focus of first entry\r\n        if (autoFocus.autoFocusFirstEntry) {\r\n            this.tree.focusFirst();\r\n            this.tree.reveal(this.tree.getFocus());\r\n        }\r\n        // Third check for specific index option\r\n        else if (typeof autoFocus.autoFocusIndex === 'number') {\r\n            if (entries.length > autoFocus.autoFocusIndex) {\r\n                this.tree.focusNth(autoFocus.autoFocusIndex);\r\n                this.tree.reveal(this.tree.getFocus());\r\n            }\r\n        }\r\n        // Check for auto focus of second entry\r\n        else if (autoFocus.autoFocusSecondEntry) {\r\n            if (entries.length > 1) {\r\n                this.tree.focusNth(1);\r\n            }\r\n        }\r\n        // Finally check for auto focus of last entry\r\n        else if (autoFocus.autoFocusLastEntry) {\r\n            if (entries.length > 1) {\r\n                this.tree.focusLast();\r\n            }\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.getHeight = function (input) {\r\n        var _this = this;\r\n        var renderer = input.renderer;\r\n        if (!input) {\r\n            var itemHeight = renderer.getHeight(null);\r\n            return this.options.minItemsToShow ? this.options.minItemsToShow * itemHeight : 0;\r\n        }\r\n        var height = 0;\r\n        var preferredItemsHeight;\r\n        if (this.layoutDimensions && this.layoutDimensions.height) {\r\n            preferredItemsHeight = (this.layoutDimensions.height - 50 /* subtract height of input field (30px) and some spacing (drop shadow) to fit */) * 0.4 /* max 40% of screen */;\r\n        }\r\n        if (!preferredItemsHeight || preferredItemsHeight > QuickOpenWidget.MAX_ITEMS_HEIGHT) {\r\n            preferredItemsHeight = QuickOpenWidget.MAX_ITEMS_HEIGHT;\r\n        }\r\n        var entries = input.entries.filter(function (e) { return _this.isElementVisible(input, e); });\r\n        var maxEntries = this.options.maxItemsToShow || entries.length;\r\n        for (var i = 0; i < maxEntries && i < entries.length; i++) {\r\n            var entryHeight = renderer.getHeight(entries[i]);\r\n            if (height + entryHeight <= preferredItemsHeight) {\r\n                height += entryHeight;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        return height;\r\n    };\r\n    QuickOpenWidget.prototype.updateResultCount = function (count) {\r\n        this.resultCount.textContent = nls.localize({ key: 'quickInput.visibleCount', comment: ['This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers.'] }, \"{0} Results\", count);\r\n    };\r\n    QuickOpenWidget.prototype.hide = function (reason) {\r\n        if (!this.isVisible()) {\r\n            return;\r\n        }\r\n        this.visible = false;\r\n        DOM.hide(this.element);\r\n        this.element.blur();\r\n        // Clear input field and clear tree\r\n        this.inputBox.value = '';\r\n        this.tree.setInput(null);\r\n        // ARIA\r\n        this.inputElement.setAttribute('aria-haspopup', 'false');\r\n        // Reset Tree Height\r\n        this.treeContainer.style.height = (this.options.minItemsToShow ? this.options.minItemsToShow * 22 : 0) + \"px\";\r\n        // Clear any running Progress\r\n        this.progressBar.stop().hide();\r\n        // Clear Focus\r\n        if (this.tree.isDOMFocused()) {\r\n            this.tree.domBlur();\r\n        }\r\n        else if (this.inputBox.hasFocus()) {\r\n            this.inputBox.blur();\r\n        }\r\n        // Callbacks\r\n        if (reason === 0 /* ELEMENT_SELECTED */) {\r\n            this.callbacks.onOk();\r\n        }\r\n        else {\r\n            this.callbacks.onCancel();\r\n        }\r\n        if (this.callbacks.onHide) {\r\n            this.callbacks.onHide(reason);\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.setInput = function (input, autoFocus, ariaLabel) {\r\n        if (!this.isVisible()) {\r\n            return;\r\n        }\r\n        // If the input changes, indicate this to the tree\r\n        if (!!this.getInput()) {\r\n            this.onInputChanging();\r\n        }\r\n        // Adapt tree height to entries and apply input\r\n        this.setInputAndLayout(input, autoFocus);\r\n        // Apply ARIA\r\n        if (this.inputBox) {\r\n            this.inputBox.setAriaLabel(ariaLabel || DEFAULT_INPUT_ARIA_LABEL);\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.onInputChanging = function () {\r\n        var _this = this;\r\n        if (this.inputChangingTimeoutHandle) {\r\n            clearTimeout(this.inputChangingTimeoutHandle);\r\n            this.inputChangingTimeoutHandle = null;\r\n        }\r\n        // when the input is changing in quick open, we indicate this as CSS class to the widget\r\n        // for a certain timeout. this helps reducing some hectic UI updates when input changes quickly\r\n        DOM.addClass(this.element, 'content-changing');\r\n        this.inputChangingTimeoutHandle = setTimeout(function () {\r\n            DOM.removeClass(_this.element, 'content-changing');\r\n        }, 500);\r\n    };\r\n    QuickOpenWidget.prototype.getInput = function () {\r\n        return this.tree.getInput();\r\n    };\r\n    QuickOpenWidget.prototype.isVisible = function () {\r\n        return this.visible;\r\n    };\r\n    QuickOpenWidget.prototype.layout = function (dimension) {\r\n        this.layoutDimensions = dimension;\r\n        // Apply to quick open width (height is dynamic by number of items to show)\r\n        var quickOpenWidth = Math.min(this.layoutDimensions.width * 0.62 /* golden cut */, QuickOpenWidget.MAX_WIDTH);\r\n        if (this.element) {\r\n            // quick open\r\n            this.element.style.width = quickOpenWidth + \"px\";\r\n            this.element.style.marginLeft = \"-\" + quickOpenWidth / 2 + \"px\";\r\n            // input field\r\n            this.inputContainer.style.width = quickOpenWidth - 12 + \"px\";\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.gainingFocus = function () {\r\n        this.isLoosingFocus = false;\r\n    };\r\n    QuickOpenWidget.prototype.loosingFocus = function (e) {\r\n        var _this = this;\r\n        if (!this.isVisible()) {\r\n            return;\r\n        }\r\n        var relatedTarget = e.relatedTarget;\r\n        if (!this.quickNavigateConfiguration && DOM.isAncestor(relatedTarget, this.element)) {\r\n            return; // user clicked somewhere into quick open widget, do not close thereby\r\n        }\r\n        this.isLoosingFocus = true;\r\n        setTimeout(function () {\r\n            if (!_this.isLoosingFocus || _this.isDisposed) {\r\n                return;\r\n            }\r\n            var veto = _this.callbacks.onFocusLost && _this.callbacks.onFocusLost();\r\n            if (!veto) {\r\n                _this.hide(1 /* FOCUS_LOST */);\r\n            }\r\n        }, 0);\r\n    };\r\n    QuickOpenWidget.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this.isDisposed = true;\r\n    };\r\n    QuickOpenWidget.MAX_WIDTH = 600; // Max total width of quick open widget\r\n    QuickOpenWidget.MAX_ITEMS_HEIGHT = 20 * 22; // Max height of item list below input field\r\n    return QuickOpenWidget;\r\n}(Disposable));\r\nexport { QuickOpenWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Dimension } from '../../../../base/browser/dom.js';\r\nimport { QuickOpenWidget } from '../../../../base/parts/quickopen/browser/quickOpenWidget.js';\r\nimport { foreground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { attachQuickOpenStyler } from '../../../../platform/theme/common/styler.js';\r\nvar QuickOpenEditorWidget = /** @class */ (function () {\r\n    function QuickOpenEditorWidget(codeEditor, onOk, onCancel, onType, configuration, themeService) {\r\n        this.codeEditor = codeEditor;\r\n        this.themeService = themeService;\r\n        this.visible = false;\r\n        this.domNode = document.createElement('div');\r\n        this.quickOpenWidget = new QuickOpenWidget(this.domNode, {\r\n            onOk: onOk,\r\n            onCancel: onCancel,\r\n            onType: onType\r\n        }, {\r\n            inputPlaceHolder: undefined,\r\n            inputAriaLabel: configuration.inputAriaLabel,\r\n            keyboardSupport: true\r\n        });\r\n        this.styler = attachQuickOpenStyler(this.quickOpenWidget, this.themeService, {\r\n            pickerGroupForeground: foreground\r\n        });\r\n        this.quickOpenWidget.create();\r\n        this.codeEditor.addOverlayWidget(this);\r\n    }\r\n    QuickOpenEditorWidget.prototype.setInput = function (model, focus) {\r\n        this.quickOpenWidget.setInput(model, focus);\r\n    };\r\n    QuickOpenEditorWidget.prototype.getId = function () {\r\n        return QuickOpenEditorWidget.ID;\r\n    };\r\n    QuickOpenEditorWidget.prototype.getDomNode = function () {\r\n        return this.domNode;\r\n    };\r\n    QuickOpenEditorWidget.prototype.destroy = function () {\r\n        this.codeEditor.removeOverlayWidget(this);\r\n        this.quickOpenWidget.dispose();\r\n        this.styler.dispose();\r\n    };\r\n    QuickOpenEditorWidget.prototype.show = function (value) {\r\n        this.visible = true;\r\n        var editorLayout = this.codeEditor.getLayoutInfo();\r\n        if (editorLayout) {\r\n            this.quickOpenWidget.layout(new Dimension(editorLayout.width, editorLayout.height));\r\n        }\r\n        this.quickOpenWidget.show(value);\r\n        this.codeEditor.layoutOverlayWidget(this);\r\n    };\r\n    QuickOpenEditorWidget.prototype.getPosition = function () {\r\n        if (this.visible) {\r\n            return {\r\n                preference: 2 /* TOP_CENTER */\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    QuickOpenEditorWidget.ID = 'editor.contrib.quickOpenEditorWidget';\r\n    return QuickOpenEditorWidget;\r\n}());\r\nexport { QuickOpenEditorWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './editorQuickOpen.css';\r\nimport { EditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\r\nimport { QuickOpenEditorWidget } from './quickOpenEditorWidget.js';\r\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\r\nvar QuickOpenController = /** @class */ (function () {\r\n    function QuickOpenController(editor, themeService) {\r\n        this.themeService = themeService;\r\n        this.widget = null;\r\n        this.rangeHighlightDecorationId = null;\r\n        this.lastKnownEditorSelection = null;\r\n        this.editor = editor;\r\n    }\r\n    QuickOpenController.get = function (editor) {\r\n        return editor.getContribution(QuickOpenController.ID);\r\n    };\r\n    QuickOpenController.prototype.dispose = function () {\r\n        // Dispose widget\r\n        if (this.widget) {\r\n            this.widget.destroy();\r\n            this.widget = null;\r\n        }\r\n    };\r\n    QuickOpenController.prototype.run = function (opts) {\r\n        var _this = this;\r\n        if (this.widget) {\r\n            this.widget.destroy();\r\n            this.widget = null;\r\n        }\r\n        // Create goto line widget\r\n        var onClose = function (canceled) {\r\n            // Clear Highlight Decorations if present\r\n            _this.clearDecorations();\r\n            // Restore selection if canceled\r\n            if (canceled && _this.lastKnownEditorSelection) {\r\n                _this.editor.setSelection(_this.lastKnownEditorSelection);\r\n                _this.editor.revealRangeInCenterIfOutsideViewport(_this.lastKnownEditorSelection, 0 /* Smooth */);\r\n            }\r\n            _this.lastKnownEditorSelection = null;\r\n            // Return focus to the editor if\r\n            // - focus is back on the <body> element because no other focusable element was clicked\r\n            // - a command was picked from the picker which indicates the editor should get focused\r\n            if (document.activeElement === document.body || !canceled) {\r\n                _this.editor.focus();\r\n            }\r\n        };\r\n        this.widget = new QuickOpenEditorWidget(this.editor, function () { return onClose(false); }, function () { return onClose(true); }, function (value) {\r\n            _this.widget.setInput(opts.getModel(value), opts.getAutoFocus(value));\r\n        }, {\r\n            inputAriaLabel: opts.inputAriaLabel\r\n        }, this.themeService);\r\n        // Remember selection to be able to restore on cancel\r\n        if (!this.lastKnownEditorSelection) {\r\n            this.lastKnownEditorSelection = this.editor.getSelection();\r\n        }\r\n        // Show\r\n        this.widget.show('');\r\n    };\r\n    QuickOpenController.prototype.decorateLine = function (range, editor) {\r\n        var oldDecorations = [];\r\n        if (this.rangeHighlightDecorationId) {\r\n            oldDecorations.push(this.rangeHighlightDecorationId);\r\n            this.rangeHighlightDecorationId = null;\r\n        }\r\n        var newDecorations = [\r\n            {\r\n                range: range,\r\n                options: QuickOpenController._RANGE_HIGHLIGHT_DECORATION\r\n            }\r\n        ];\r\n        var decorations = editor.deltaDecorations(oldDecorations, newDecorations);\r\n        this.rangeHighlightDecorationId = decorations[0];\r\n    };\r\n    QuickOpenController.prototype.clearDecorations = function () {\r\n        if (this.rangeHighlightDecorationId) {\r\n            this.editor.deltaDecorations([this.rangeHighlightDecorationId], []);\r\n            this.rangeHighlightDecorationId = null;\r\n        }\r\n    };\r\n    QuickOpenController.ID = 'editor.controller.quickOpenController';\r\n    QuickOpenController._RANGE_HIGHLIGHT_DECORATION = ModelDecorationOptions.register({\r\n        className: 'rangeHighlight',\r\n        isWholeLine: true\r\n    });\r\n    QuickOpenController = __decorate([\r\n        __param(1, IThemeService)\r\n    ], QuickOpenController);\r\n    return QuickOpenController;\r\n}());\r\nexport { QuickOpenController };\r\n/**\r\n * Base class for providing quick open in the editor.\r\n */\r\nvar BaseEditorQuickOpenAction = /** @class */ (function (_super) {\r\n    __extends(BaseEditorQuickOpenAction, _super);\r\n    function BaseEditorQuickOpenAction(inputAriaLabel, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._inputAriaLabel = inputAriaLabel;\r\n        return _this;\r\n    }\r\n    BaseEditorQuickOpenAction.prototype.getController = function (editor) {\r\n        return QuickOpenController.get(editor);\r\n    };\r\n    BaseEditorQuickOpenAction.prototype._show = function (controller, opts) {\r\n        controller.run({\r\n            inputAriaLabel: this._inputAriaLabel,\r\n            getModel: function (value) { return opts.getModel(value); },\r\n            getAutoFocus: function (searchValue) { return opts.getAutoFocus(searchValue); }\r\n        });\r\n    };\r\n    return BaseEditorQuickOpenAction;\r\n}(EditorAction));\r\nexport { BaseEditorQuickOpenAction };\r\nregisterEditorContribution(QuickOpenController.ID, QuickOpenController);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './gotoLine.css';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { QuickOpenEntry, QuickOpenModel } from '../../../../base/parts/quickopen/browser/quickOpenModel.js';\r\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\r\nimport { registerEditorAction } from '../../../browser/editorExtensions.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\r\nimport { BaseEditorQuickOpenAction } from './editorQuickOpen.js';\r\nimport { GoToLineNLS } from '../../../common/standaloneStrings.js';\r\nvar GotoLineEntry = /** @class */ (function (_super) {\r\n    __extends(GotoLineEntry, _super);\r\n    function GotoLineEntry(line, editor, decorator) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this.decorator = decorator;\r\n        _this.parseResult = _this.parseInput(line);\r\n        return _this;\r\n    }\r\n    GotoLineEntry.prototype.parseInput = function (line) {\r\n        var numbers = line.split(',').map(function (part) { return parseInt(part, 10); }).filter(function (part) { return !isNaN(part); });\r\n        var position;\r\n        if (numbers.length === 0) {\r\n            position = new Position(-1, -1);\r\n        }\r\n        else if (numbers.length === 1) {\r\n            position = new Position(numbers[0], 1);\r\n        }\r\n        else {\r\n            position = new Position(numbers[0], numbers[1]);\r\n        }\r\n        var model;\r\n        if (isCodeEditor(this.editor)) {\r\n            model = this.editor.getModel();\r\n        }\r\n        else {\r\n            var diffModel = this.editor.getModel();\r\n            model = diffModel ? diffModel.modified : null;\r\n        }\r\n        var isValid = model ? model.validatePosition(position).equals(position) : false;\r\n        var label;\r\n        if (isValid) {\r\n            if (position.column && position.column > 1) {\r\n                label = strings.format(GoToLineNLS.gotoLineLabelValidLineAndColumn, position.lineNumber, position.column);\r\n            }\r\n            else {\r\n                label = strings.format(GoToLineNLS.gotoLineLabelValidLine, position.lineNumber);\r\n            }\r\n        }\r\n        else if (position.lineNumber < 1 || position.lineNumber > (model ? model.getLineCount() : 0)) {\r\n            label = strings.format(GoToLineNLS.gotoLineLabelEmptyWithLineLimit, model ? model.getLineCount() : 0);\r\n        }\r\n        else {\r\n            label = strings.format(GoToLineNLS.gotoLineLabelEmptyWithLineAndColumnLimit, model ? model.getLineMaxColumn(position.lineNumber) : 0);\r\n        }\r\n        return {\r\n            position: position,\r\n            isValid: isValid,\r\n            label: label\r\n        };\r\n    };\r\n    GotoLineEntry.prototype.getLabel = function () {\r\n        return this.parseResult.label;\r\n    };\r\n    GotoLineEntry.prototype.getAriaLabel = function () {\r\n        var position = this.editor.getPosition();\r\n        var currentLine = position ? position.lineNumber : 0;\r\n        return strings.format(GoToLineNLS.gotoLineAriaLabel, currentLine, this.parseResult.label);\r\n    };\r\n    GotoLineEntry.prototype.run = function (mode, _context) {\r\n        if (mode === 1 /* OPEN */) {\r\n            return this.runOpen();\r\n        }\r\n        return this.runPreview();\r\n    };\r\n    GotoLineEntry.prototype.runOpen = function () {\r\n        // No-op if range is not valid\r\n        if (!this.parseResult.isValid) {\r\n            return false;\r\n        }\r\n        // Apply selection and focus\r\n        var range = this.toSelection();\r\n        this.editor.setSelection(range);\r\n        this.editor.revealRangeInCenter(range, 0 /* Smooth */);\r\n        this.editor.focus();\r\n        return true;\r\n    };\r\n    GotoLineEntry.prototype.runPreview = function () {\r\n        // No-op if range is not valid\r\n        if (!this.parseResult.isValid) {\r\n            this.decorator.clearDecorations();\r\n            return false;\r\n        }\r\n        // Select Line Position\r\n        var range = this.toSelection();\r\n        this.editor.revealRangeInCenter(range, 0 /* Smooth */);\r\n        // Decorate if possible\r\n        this.decorator.decorateLine(range, this.editor);\r\n        return false;\r\n    };\r\n    GotoLineEntry.prototype.toSelection = function () {\r\n        return new Range(this.parseResult.position.lineNumber, this.parseResult.position.column, this.parseResult.position.lineNumber, this.parseResult.position.column);\r\n    };\r\n    return GotoLineEntry;\r\n}(QuickOpenEntry));\r\nexport { GotoLineEntry };\r\nvar GotoLineAction = /** @class */ (function (_super) {\r\n    __extends(GotoLineAction, _super);\r\n    function GotoLineAction() {\r\n        return _super.call(this, GoToLineNLS.gotoLineActionInput, {\r\n            id: 'editor.action.gotoLine',\r\n            label: GoToLineNLS.gotoLineActionLabel,\r\n            alias: 'Go to Line...',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 37 /* KEY_G */,\r\n                mac: { primary: 256 /* WinCtrl */ | 37 /* KEY_G */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    GotoLineAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        this._show(this.getController(editor), {\r\n            getModel: function (value) {\r\n                return new QuickOpenModel([new GotoLineEntry(value, editor, _this.getController(editor))]);\r\n            },\r\n            getAutoFocus: function (searchValue) {\r\n                return {\r\n                    autoFocusFirstEntry: searchValue.length > 0\r\n                };\r\n            }\r\n        });\r\n    };\r\n    return GotoLineAction;\r\n}(BaseEditorQuickOpenAction));\r\nexport { GotoLineAction };\r\nregisterEditorAction(GotoLineAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { matchesFuzzy } from '../../../../base/common/filters.js';\r\nimport { QuickOpenEntryGroup, QuickOpenModel } from '../../../../base/parts/quickopen/browser/quickOpenModel.js';\r\nimport { registerEditorAction } from '../../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\r\nimport { BaseEditorQuickOpenAction } from './editorQuickOpen.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nimport { QuickCommandNLS } from '../../../common/standaloneStrings.js';\r\nvar EditorActionCommandEntry = /** @class */ (function (_super) {\r\n    __extends(EditorActionCommandEntry, _super);\r\n    function EditorActionCommandEntry(key, keyAriaLabel, highlights, action, editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this.key = key;\r\n        _this.keyAriaLabel = keyAriaLabel;\r\n        _this.setHighlights(highlights);\r\n        _this.action = action;\r\n        _this.editor = editor;\r\n        return _this;\r\n    }\r\n    EditorActionCommandEntry.prototype.getLabel = function () {\r\n        return this.action.label;\r\n    };\r\n    EditorActionCommandEntry.prototype.getAriaLabel = function () {\r\n        if (this.keyAriaLabel) {\r\n            return strings.format(QuickCommandNLS.ariaLabelEntryWithKey, this.getLabel(), this.keyAriaLabel);\r\n        }\r\n        return strings.format(QuickCommandNLS.ariaLabelEntry, this.getLabel());\r\n    };\r\n    EditorActionCommandEntry.prototype.getGroupLabel = function () {\r\n        return this.key;\r\n    };\r\n    EditorActionCommandEntry.prototype.run = function (mode, context) {\r\n        var _this = this;\r\n        if (mode === 1 /* OPEN */) {\r\n            // Use a timeout to give the quick open widget a chance to close itself first\r\n            setTimeout(function () {\r\n                // Some actions are enabled only when editor has focus\r\n                _this.editor.focus();\r\n                try {\r\n                    var promise = _this.action.run() || Promise.resolve();\r\n                    promise.then(undefined, onUnexpectedError);\r\n                }\r\n                catch (error) {\r\n                    onUnexpectedError(error);\r\n                }\r\n            }, 50);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return EditorActionCommandEntry;\r\n}(QuickOpenEntryGroup));\r\nexport { EditorActionCommandEntry };\r\nvar QuickCommandAction = /** @class */ (function (_super) {\r\n    __extends(QuickCommandAction, _super);\r\n    function QuickCommandAction() {\r\n        return _super.call(this, QuickCommandNLS.quickCommandActionInput, {\r\n            id: 'editor.action.quickCommand',\r\n            label: QuickCommandNLS.quickCommandActionLabel,\r\n            alias: 'Command Palette',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: (browser.isIE ? 512 /* Alt */ | 59 /* F1 */ : 59 /* F1 */),\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: 'z_commands',\r\n                order: 1\r\n            }\r\n        }) || this;\r\n    }\r\n    QuickCommandAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        var keybindingService = accessor.get(IKeybindingService);\r\n        this._show(this.getController(editor), {\r\n            getModel: function (value) {\r\n                return new QuickOpenModel(_this._editorActionsToEntries(keybindingService, editor, value));\r\n            },\r\n            getAutoFocus: function (searchValue) {\r\n                return {\r\n                    autoFocusFirstEntry: true,\r\n                    autoFocusPrefixMatch: searchValue\r\n                };\r\n            }\r\n        });\r\n    };\r\n    QuickCommandAction.prototype._sort = function (elementA, elementB) {\r\n        var elementAName = (elementA.getLabel() || '').toLowerCase();\r\n        var elementBName = (elementB.getLabel() || '').toLowerCase();\r\n        return elementAName.localeCompare(elementBName);\r\n    };\r\n    QuickCommandAction.prototype._editorActionsToEntries = function (keybindingService, editor, searchValue) {\r\n        var actions = editor.getSupportedActions();\r\n        var entries = [];\r\n        for (var _i = 0, actions_1 = actions; _i < actions_1.length; _i++) {\r\n            var action = actions_1[_i];\r\n            var keybinding = keybindingService.lookupKeybinding(action.id);\r\n            if (action.label) {\r\n                var highlights = matchesFuzzy(searchValue, action.label);\r\n                if (highlights) {\r\n                    entries.push(new EditorActionCommandEntry(keybinding ? keybinding.getLabel() || '' : '', keybinding ? keybinding.getAriaLabel() || '' : '', highlights, action, editor));\r\n                }\r\n            }\r\n        }\r\n        // Sort by name\r\n        entries = entries.sort(this._sort);\r\n        return entries;\r\n    };\r\n    return QuickCommandAction;\r\n}(BaseEditorQuickOpenAction));\r\nexport { QuickCommandAction };\r\nregisterEditorAction(QuickCommandAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { equals } from '../../../base/common/arrays.js';\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { first } from '../../../base/common/collections.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { LRUCache } from '../../../base/common/map.js';\r\nimport { DocumentSymbolProviderRegistry } from '../../common/modes.js';\r\nvar TreeElement = /** @class */ (function () {\r\n    function TreeElement() {\r\n    }\r\n    TreeElement.prototype.remove = function () {\r\n        if (this.parent) {\r\n            delete this.parent.children[this.id];\r\n        }\r\n    };\r\n    TreeElement.findId = function (candidate, container) {\r\n        // complex id-computation which contains the origin/extension,\r\n        // the parent path, and some dedupe logic when names collide\r\n        var candidateId;\r\n        if (typeof candidate === 'string') {\r\n            candidateId = container.id + \"/\" + candidate;\r\n        }\r\n        else {\r\n            candidateId = container.id + \"/\" + candidate.name;\r\n            if (container.children[candidateId] !== undefined) {\r\n                candidateId = container.id + \"/\" + candidate.name + \"_\" + candidate.range.startLineNumber + \"_\" + candidate.range.startColumn;\r\n            }\r\n        }\r\n        var id = candidateId;\r\n        for (var i = 0; container.children[id] !== undefined; i++) {\r\n            id = candidateId + \"_\" + i;\r\n        }\r\n        return id;\r\n    };\r\n    TreeElement.empty = function (element) {\r\n        for (var _key in element.children) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    return TreeElement;\r\n}());\r\nexport { TreeElement };\r\nvar OutlineElement = /** @class */ (function (_super) {\r\n    __extends(OutlineElement, _super);\r\n    function OutlineElement(id, parent, symbol) {\r\n        var _this = _super.call(this) || this;\r\n        _this.id = id;\r\n        _this.parent = parent;\r\n        _this.symbol = symbol;\r\n        _this.children = Object.create(null);\r\n        return _this;\r\n    }\r\n    return OutlineElement;\r\n}(TreeElement));\r\nexport { OutlineElement };\r\nvar OutlineGroup = /** @class */ (function (_super) {\r\n    __extends(OutlineGroup, _super);\r\n    function OutlineGroup(id, parent, provider, providerIndex) {\r\n        var _this = _super.call(this) || this;\r\n        _this.id = id;\r\n        _this.parent = parent;\r\n        _this.provider = provider;\r\n        _this.providerIndex = providerIndex;\r\n        _this.children = Object.create(null);\r\n        return _this;\r\n    }\r\n    return OutlineGroup;\r\n}(TreeElement));\r\nexport { OutlineGroup };\r\nvar MovingAverage = /** @class */ (function () {\r\n    function MovingAverage() {\r\n        this._n = 1;\r\n        this._val = 0;\r\n    }\r\n    MovingAverage.prototype.update = function (value) {\r\n        this._val = this._val + (value - this._val) / this._n;\r\n        this._n += 1;\r\n        return this;\r\n    };\r\n    return MovingAverage;\r\n}());\r\nvar OutlineModel = /** @class */ (function (_super) {\r\n    __extends(OutlineModel, _super);\r\n    function OutlineModel(textModel) {\r\n        var _this = _super.call(this) || this;\r\n        _this.textModel = textModel;\r\n        _this.id = 'root';\r\n        _this.parent = undefined;\r\n        _this._groups = Object.create(null);\r\n        _this.children = Object.create(null);\r\n        _this.id = 'root';\r\n        _this.parent = undefined;\r\n        return _this;\r\n    }\r\n    OutlineModel.create = function (textModel, token) {\r\n        var _this = this;\r\n        var key = this._keys.for(textModel, true);\r\n        var data = OutlineModel._requests.get(key);\r\n        if (!data) {\r\n            var source = new CancellationTokenSource();\r\n            data = {\r\n                promiseCnt: 0,\r\n                source: source,\r\n                promise: OutlineModel._create(textModel, source.token),\r\n                model: undefined,\r\n            };\r\n            OutlineModel._requests.set(key, data);\r\n            // keep moving average of request durations\r\n            var now_1 = Date.now();\r\n            data.promise.then(function () {\r\n                var key = _this._keys.for(textModel, false);\r\n                var avg = _this._requestDurations.get(key);\r\n                if (!avg) {\r\n                    avg = new MovingAverage();\r\n                    _this._requestDurations.set(key, avg);\r\n                }\r\n                avg.update(Date.now() - now_1);\r\n            });\r\n        }\r\n        if (data.model) {\r\n            // resolved -> return data\r\n            return Promise.resolve(data.model);\r\n        }\r\n        // increase usage counter\r\n        data.promiseCnt += 1;\r\n        token.onCancellationRequested(function () {\r\n            // last -> cancel provider request, remove cached promise\r\n            if (--data.promiseCnt === 0) {\r\n                data.source.cancel();\r\n                OutlineModel._requests.delete(key);\r\n            }\r\n        });\r\n        return new Promise(function (resolve, reject) {\r\n            data.promise.then(function (model) {\r\n                data.model = model;\r\n                resolve(model);\r\n            }, function (err) {\r\n                OutlineModel._requests.delete(key);\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    OutlineModel._create = function (textModel, token) {\r\n        var cts = new CancellationTokenSource(token);\r\n        var result = new OutlineModel(textModel);\r\n        var provider = DocumentSymbolProviderRegistry.ordered(textModel);\r\n        var promises = provider.map(function (provider, index) {\r\n            var id = TreeElement.findId(\"provider_\" + index, result);\r\n            var group = new OutlineGroup(id, result, provider, index);\r\n            return Promise.resolve(provider.provideDocumentSymbols(result.textModel, cts.token)).then(function (result) {\r\n                for (var _i = 0, _a = result || []; _i < _a.length; _i++) {\r\n                    var info = _a[_i];\r\n                    OutlineModel._makeOutlineElement(info, group);\r\n                }\r\n                return group;\r\n            }, function (err) {\r\n                onUnexpectedExternalError(err);\r\n                return group;\r\n            }).then(function (group) {\r\n                if (!TreeElement.empty(group)) {\r\n                    result._groups[id] = group;\r\n                }\r\n                else {\r\n                    group.remove();\r\n                }\r\n            });\r\n        });\r\n        var listener = DocumentSymbolProviderRegistry.onDidChange(function () {\r\n            var newProvider = DocumentSymbolProviderRegistry.ordered(textModel);\r\n            if (!equals(newProvider, provider)) {\r\n                cts.cancel();\r\n            }\r\n        });\r\n        return Promise.all(promises).then(function () {\r\n            if (cts.token.isCancellationRequested && !token.isCancellationRequested) {\r\n                return OutlineModel._create(textModel, token);\r\n            }\r\n            else {\r\n                return result._compact();\r\n            }\r\n        }).finally(function () {\r\n            listener.dispose();\r\n        });\r\n    };\r\n    OutlineModel._makeOutlineElement = function (info, container) {\r\n        var id = TreeElement.findId(info, container);\r\n        var res = new OutlineElement(id, container, info);\r\n        if (info.children) {\r\n            for (var _i = 0, _a = info.children; _i < _a.length; _i++) {\r\n                var childInfo = _a[_i];\r\n                OutlineModel._makeOutlineElement(childInfo, res);\r\n            }\r\n        }\r\n        container.children[res.id] = res;\r\n    };\r\n    OutlineModel.prototype._compact = function () {\r\n        var count = 0;\r\n        for (var key in this._groups) {\r\n            var group = this._groups[key];\r\n            if (first(group.children) === undefined) { // empty\r\n                delete this._groups[key];\r\n            }\r\n            else {\r\n                count += 1;\r\n            }\r\n        }\r\n        if (count !== 1) {\r\n            //\r\n            this.children = this._groups;\r\n        }\r\n        else {\r\n            // adopt all elements of the first group\r\n            var group = first(this._groups);\r\n            for (var key in group.children) {\r\n                var child = group.children[key];\r\n                child.parent = this;\r\n                this.children[child.id] = child;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    OutlineModel._requestDurations = new LRUCache(50, 0.7);\r\n    OutlineModel._requests = new LRUCache(9, 0.75);\r\n    OutlineModel._keys = new /** @class */ (function () {\r\n        function class_1() {\r\n            this._counter = 1;\r\n            this._data = new WeakMap();\r\n        }\r\n        class_1.prototype.for = function (textModel, version) {\r\n            return textModel.id + \"/\" + (version ? textModel.getVersionId() : '') + \"/\" + this._hash(DocumentSymbolProviderRegistry.all(textModel));\r\n        };\r\n        class_1.prototype._hash = function (providers) {\r\n            var result = '';\r\n            for (var _i = 0, providers_1 = providers; _i < providers_1.length; _i++) {\r\n                var provider = providers_1[_i];\r\n                var n = this._data.get(provider);\r\n                if (typeof n === 'undefined') {\r\n                    n = this._counter++;\r\n                    this._data.set(provider, n);\r\n                }\r\n                result += n;\r\n            }\r\n            return result;\r\n        };\r\n        return class_1;\r\n    }());\r\n    return OutlineModel;\r\n}(TreeElement));\r\nexport { OutlineModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { illegalArgument } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { ITextModelService } from '../../common/services/resolverService.js';\r\nimport { OutlineModel, OutlineElement } from '../documentSymbols/outlineModel.js';\r\nimport { values } from '../../../base/common/collections.js';\r\nexport function getDocumentSymbols(document, flat, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var model, roots, _i, _a, child, flatEntries;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0: return [4 /*yield*/, OutlineModel.create(document, token)];\r\n                case 1:\r\n                    model = _b.sent();\r\n                    roots = [];\r\n                    for (_i = 0, _a = values(model.children); _i < _a.length; _i++) {\r\n                        child = _a[_i];\r\n                        if (child instanceof OutlineElement) {\r\n                            roots.push(child.symbol);\r\n                        }\r\n                        else {\r\n                            roots.push.apply(roots, values(child.children).map(function (child) { return child.symbol; }));\r\n                        }\r\n                    }\r\n                    flatEntries = [];\r\n                    if (token.isCancellationRequested) {\r\n                        return [2 /*return*/, flatEntries];\r\n                    }\r\n                    if (flat) {\r\n                        flatten(flatEntries, roots, '');\r\n                    }\r\n                    else {\r\n                        flatEntries = roots;\r\n                    }\r\n                    return [2 /*return*/, flatEntries.sort(compareEntriesUsingStart)];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction compareEntriesUsingStart(a, b) {\r\n    return Range.compareRangesUsingStarts(a.range, b.range);\r\n}\r\nfunction flatten(bucket, entries, overrideContainerLabel) {\r\n    for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\r\n        var entry = entries_1[_i];\r\n        bucket.push({\r\n            kind: entry.kind,\r\n            tags: entry.tags,\r\n            name: entry.name,\r\n            detail: entry.detail,\r\n            containerName: entry.containerName || overrideContainerLabel,\r\n            range: entry.range,\r\n            selectionRange: entry.selectionRange,\r\n            children: undefined,\r\n        });\r\n        if (entry.children) {\r\n            flatten(bucket, entry.children, entry.name);\r\n        }\r\n    }\r\n}\r\nregisterLanguageCommand('_executeDocumentSymbolProvider', function (accessor, args) {\r\n    var resource = args.resource;\r\n    if (!(resource instanceof URI)) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (model) {\r\n        return getDocumentSymbols(model, false, CancellationToken.None);\r\n    }\r\n    return accessor.get(ITextModelService).createModelReference(resource).then(function (reference) {\r\n        return new Promise(function (resolve, reject) {\r\n            try {\r\n                var result = getDocumentSymbols(reference.object.textEditorModel, false, CancellationToken.None);\r\n                resolve(result);\r\n            }\r\n            catch (err) {\r\n                reject(err);\r\n            }\r\n        }).finally(function () {\r\n            reference.dispose();\r\n        });\r\n    });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './quickOutline.css';\r\nimport '../../../../base/browser/ui/codiconLabel/codiconLabel.js'; // The codicon symbol styles are defined here and must be loaded\r\nimport '../../../contrib/documentSymbols/outlineTree.js'; // The codicon symbol colors are defined here and must be loaded\r\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\r\nimport { matchesFuzzy } from '../../../../base/common/filters.js';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { QuickOpenEntryGroup, QuickOpenModel } from '../../../../base/parts/quickopen/browser/quickOpenModel.js';\r\nimport { registerEditorAction } from '../../../browser/editorExtensions.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\r\nimport { DocumentSymbolProviderRegistry, SymbolKinds } from '../../../common/modes.js';\r\nimport { getDocumentSymbols } from '../../../contrib/quickOpen/quickOpen.js';\r\nimport { BaseEditorQuickOpenAction } from './editorQuickOpen.js';\r\nimport { QuickOutlineNLS } from '../../../common/standaloneStrings.js';\r\nvar SCOPE_PREFIX = ':';\r\nvar SymbolEntry = /** @class */ (function (_super) {\r\n    __extends(SymbolEntry, _super);\r\n    function SymbolEntry(name, type, description, range, highlights, editor, decorator) {\r\n        var _this = _super.call(this) || this;\r\n        _this.name = name;\r\n        _this.type = type;\r\n        _this.description = description;\r\n        _this.range = range;\r\n        _this.setHighlights(highlights);\r\n        _this.editor = editor;\r\n        _this.decorator = decorator;\r\n        return _this;\r\n    }\r\n    SymbolEntry.prototype.getLabel = function () {\r\n        return this.name;\r\n    };\r\n    SymbolEntry.prototype.getAriaLabel = function () {\r\n        return strings.format(QuickOutlineNLS.entryAriaLabel, this.name);\r\n    };\r\n    SymbolEntry.prototype.getIcon = function () {\r\n        return this.type;\r\n    };\r\n    SymbolEntry.prototype.getDescription = function () {\r\n        return this.description;\r\n    };\r\n    SymbolEntry.prototype.getType = function () {\r\n        return this.type;\r\n    };\r\n    SymbolEntry.prototype.getRange = function () {\r\n        return this.range;\r\n    };\r\n    SymbolEntry.prototype.run = function (mode, context) {\r\n        if (mode === 1 /* OPEN */) {\r\n            return this.runOpen(context);\r\n        }\r\n        return this.runPreview();\r\n    };\r\n    SymbolEntry.prototype.runOpen = function (_context) {\r\n        // Apply selection and focus\r\n        var range = this.toSelection();\r\n        this.editor.setSelection(range);\r\n        this.editor.revealRangeInCenter(range, 0 /* Smooth */);\r\n        this.editor.focus();\r\n        return true;\r\n    };\r\n    SymbolEntry.prototype.runPreview = function () {\r\n        // Select Outline Position\r\n        var range = this.toSelection();\r\n        this.editor.revealRangeInCenter(range, 0 /* Smooth */);\r\n        // Decorate if possible\r\n        this.decorator.decorateLine(this.range, this.editor);\r\n        return false;\r\n    };\r\n    SymbolEntry.prototype.toSelection = function () {\r\n        return new Range(this.range.startLineNumber, this.range.startColumn || 1, this.range.startLineNumber, this.range.startColumn || 1);\r\n    };\r\n    return SymbolEntry;\r\n}(QuickOpenEntryGroup));\r\nexport { SymbolEntry };\r\nvar QuickOutlineAction = /** @class */ (function (_super) {\r\n    __extends(QuickOutlineAction, _super);\r\n    function QuickOutlineAction() {\r\n        return _super.call(this, QuickOutlineNLS.quickOutlineActionInput, {\r\n            id: 'editor.action.quickOutline',\r\n            label: QuickOutlineNLS.quickOutlineActionLabel,\r\n            alias: 'Go to Symbol...',\r\n            precondition: EditorContextKeys.hasDocumentSymbolProvider,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 45 /* KEY_O */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: 'navigation',\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    QuickOutlineAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return undefined;\r\n        }\r\n        var model = editor.getModel();\r\n        if (!DocumentSymbolProviderRegistry.has(model)) {\r\n            return undefined;\r\n        }\r\n        // Resolve outline\r\n        return getDocumentSymbols(model, true, CancellationToken.None).then(function (result) {\r\n            if (result.length === 0) {\r\n                return;\r\n            }\r\n            _this._run(editor, result);\r\n        });\r\n    };\r\n    QuickOutlineAction.prototype._run = function (editor, result) {\r\n        var _this = this;\r\n        this._show(this.getController(editor), {\r\n            getModel: function (value) {\r\n                return new QuickOpenModel(_this.toQuickOpenEntries(editor, result, value));\r\n            },\r\n            getAutoFocus: function (searchValue) {\r\n                // Remove any type pattern (:) from search value as needed\r\n                if (searchValue.indexOf(SCOPE_PREFIX) === 0) {\r\n                    searchValue = searchValue.substr(SCOPE_PREFIX.length);\r\n                }\r\n                return {\r\n                    autoFocusPrefixMatch: searchValue,\r\n                    autoFocusFirstEntry: !!searchValue\r\n                };\r\n            }\r\n        });\r\n    };\r\n    QuickOutlineAction.prototype.symbolEntry = function (name, type, description, range, highlights, editor, decorator) {\r\n        return new SymbolEntry(name, type, description, Range.lift(range), highlights, editor, decorator);\r\n    };\r\n    QuickOutlineAction.prototype.toQuickOpenEntries = function (editor, flattened, searchValue) {\r\n        var controller = this.getController(editor);\r\n        var results = [];\r\n        // Convert to Entries\r\n        var normalizedSearchValue = searchValue;\r\n        if (searchValue.indexOf(SCOPE_PREFIX) === 0) {\r\n            normalizedSearchValue = normalizedSearchValue.substr(SCOPE_PREFIX.length);\r\n        }\r\n        for (var _i = 0, flattened_1 = flattened; _i < flattened_1.length; _i++) {\r\n            var element = flattened_1[_i];\r\n            var label = strings.trim(element.name);\r\n            // Check for meatch\r\n            var highlights = matchesFuzzy(normalizedSearchValue, label);\r\n            if (highlights) {\r\n                // Show parent scope as description\r\n                var description = undefined;\r\n                if (element.containerName) {\r\n                    description = element.containerName;\r\n                }\r\n                // Add\r\n                results.push(this.symbolEntry(label, SymbolKinds.toCssClassName(element.kind), description, element.range, highlights, editor, controller));\r\n            }\r\n        }\r\n        // Sort properly if actually searching\r\n        if (searchValue) {\r\n            if (searchValue.indexOf(SCOPE_PREFIX) === 0) {\r\n                results = results.sort(this.sortScoped.bind(this, searchValue.toLowerCase()));\r\n            }\r\n            else {\r\n                results = results.sort(this.sortNormal.bind(this, searchValue.toLowerCase()));\r\n            }\r\n        }\r\n        // Mark all type groups\r\n        if (results.length > 0 && searchValue.indexOf(SCOPE_PREFIX) === 0) {\r\n            var currentType = null;\r\n            var currentResult = null;\r\n            var typeCounter = 0;\r\n            for (var i = 0; i < results.length; i++) {\r\n                var result = results[i];\r\n                // Found new type\r\n                if (currentType !== result.getType()) {\r\n                    // Update previous result with count\r\n                    if (currentResult) {\r\n                        currentResult.setGroupLabel(this.typeToLabel(currentType || '', typeCounter));\r\n                    }\r\n                    currentType = result.getType();\r\n                    currentResult = result;\r\n                    typeCounter = 1;\r\n                    result.setShowBorder(i > 0);\r\n                }\r\n                // Existing type, keep counting\r\n                else {\r\n                    typeCounter++;\r\n                }\r\n            }\r\n            // Update previous result with count\r\n            if (currentResult) {\r\n                currentResult.setGroupLabel(this.typeToLabel(currentType || '', typeCounter));\r\n            }\r\n        }\r\n        // Mark first entry as outline\r\n        else if (results.length > 0) {\r\n            results[0].setGroupLabel(strings.format(QuickOutlineNLS._symbols_, results.length));\r\n        }\r\n        return results;\r\n    };\r\n    QuickOutlineAction.prototype.typeToLabel = function (type, count) {\r\n        switch (type) {\r\n            case 'module': return strings.format(QuickOutlineNLS._modules_, count);\r\n            case 'class': return strings.format(QuickOutlineNLS._class_, count);\r\n            case 'interface': return strings.format(QuickOutlineNLS._interface_, count);\r\n            case 'method': return strings.format(QuickOutlineNLS._method_, count);\r\n            case 'function': return strings.format(QuickOutlineNLS._function_, count);\r\n            case 'property': return strings.format(QuickOutlineNLS._property_, count);\r\n            case 'variable': return strings.format(QuickOutlineNLS._variable_, count);\r\n            case 'var': return strings.format(QuickOutlineNLS._variable2_, count);\r\n            case 'constructor': return strings.format(QuickOutlineNLS._constructor_, count);\r\n            case 'call': return strings.format(QuickOutlineNLS._call_, count);\r\n        }\r\n        return type;\r\n    };\r\n    QuickOutlineAction.prototype.sortNormal = function (searchValue, elementA, elementB) {\r\n        var elementAName = elementA.getLabel().toLowerCase();\r\n        var elementBName = elementB.getLabel().toLowerCase();\r\n        // Compare by name\r\n        var r = elementAName.localeCompare(elementBName);\r\n        if (r !== 0) {\r\n            return r;\r\n        }\r\n        // If name identical sort by range instead\r\n        var elementARange = elementA.getRange();\r\n        var elementBRange = elementB.getRange();\r\n        return elementARange.startLineNumber - elementBRange.startLineNumber;\r\n    };\r\n    QuickOutlineAction.prototype.sortScoped = function (searchValue, elementA, elementB) {\r\n        // Remove scope char\r\n        searchValue = searchValue.substr(SCOPE_PREFIX.length);\r\n        // Sort by type first if scoped search\r\n        var elementAType = elementA.getType();\r\n        var elementBType = elementB.getType();\r\n        var r = elementAType.localeCompare(elementBType);\r\n        if (r !== 0) {\r\n            return r;\r\n        }\r\n        // Special sort when searching in scoped mode\r\n        if (searchValue) {\r\n            var elementAName = elementA.getLabel().toLowerCase();\r\n            var elementBName = elementB.getLabel().toLowerCase();\r\n            // Compare by name\r\n            var r_1 = elementAName.localeCompare(elementBName);\r\n            if (r_1 !== 0) {\r\n                return r_1;\r\n            }\r\n        }\r\n        // Default to sort by range\r\n        var elementARange = elementA.getRange();\r\n        var elementBRange = elementB.getRange();\r\n        return elementARange.startLineNumber - elementBRange.startLineNumber;\r\n    };\r\n    return QuickOutlineAction;\r\n}(BaseEditorQuickOpenAction));\r\nexport { QuickOutlineAction };\r\nregisterEditorAction(QuickOutlineAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\r\nimport { ReferencesController } from '../../../contrib/gotoSymbol/peek/referencesController.js';\r\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\r\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\r\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\r\nvar StandaloneReferencesController = /** @class */ (function (_super) {\r\n    __extends(StandaloneReferencesController, _super);\r\n    function StandaloneReferencesController(editor, contextKeyService, editorService, notificationService, instantiationService, storageService, configurationService) {\r\n        return _super.call(this, true, editor, contextKeyService, editorService, notificationService, instantiationService, storageService, configurationService) || this;\r\n    }\r\n    StandaloneReferencesController = __decorate([\r\n        __param(1, IContextKeyService),\r\n        __param(2, ICodeEditorService),\r\n        __param(3, INotificationService),\r\n        __param(4, IInstantiationService),\r\n        __param(5, IStorageService),\r\n        __param(6, IConfigurationService)\r\n    ], StandaloneReferencesController);\r\n    return StandaloneReferencesController;\r\n}(ReferencesController));\r\nexport { StandaloneReferencesController };\r\nregisterEditorContribution(ReferencesController.ID, StandaloneReferencesController);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\r\nimport { IStandaloneThemeService } from '../../common/standaloneThemeService.js';\r\nimport { ToggleHighContrastNLS } from '../../../common/standaloneStrings.js';\r\nvar ToggleHighContrast = /** @class */ (function (_super) {\r\n    __extends(ToggleHighContrast, _super);\r\n    function ToggleHighContrast() {\r\n        var _this = _super.call(this, {\r\n            id: 'editor.action.toggleHighContrast',\r\n            label: ToggleHighContrastNLS.toggleHighContrast,\r\n            alias: 'Toggle High Contrast Theme',\r\n            precondition: undefined\r\n        }) || this;\r\n        _this._originalThemeName = null;\r\n        return _this;\r\n    }\r\n    ToggleHighContrast.prototype.run = function (accessor, editor) {\r\n        var standaloneThemeService = accessor.get(IStandaloneThemeService);\r\n        if (this._originalThemeName) {\r\n            // We must toggle back to the integrator's theme\r\n            standaloneThemeService.setTheme(this._originalThemeName);\r\n            this._originalThemeName = null;\r\n        }\r\n        else {\r\n            this._originalThemeName = standaloneThemeService.getTheme().themeName;\r\n            standaloneThemeService.setTheme('hc-black');\r\n        }\r\n    };\r\n    return ToggleHighContrast;\r\n}(EditorAction));\r\nregisterEditorAction(ToggleHighContrast);\r\n","import '../language/typescript/monaco.contribution';\nimport '../language/css/monaco.contribution';\nimport '../language/json/monaco.contribution';\nimport '../language/html/monaco.contribution';\nimport '../basic-languages/monaco.contribution';\n\nexport * from './edcore.main';"],"sourceRoot":""}